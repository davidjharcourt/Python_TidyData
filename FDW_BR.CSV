ID,Business Rule Description,Detailed Rule Text,ETL Spec Cross Reference,Quality Center ID/Reason for Change,Last Update Date,Last Update User,Comments,Implemented In,Subject Area,FDW Table Type,Functional Area,Manual ??,Organizational Scope,Source,Stability,Type of Rule
BR-42,1 Management Reporting Accident Month,"If  (PRODUCT_VALUE_1_2= '40' OR PRODUCT_VALUE_1_2='43') AND
(LENGTH(PRODUCT_VALUE)=8)  AND
(SUBSTR(PRODUCT_VALUE,8,1) = 'F' OR
 SUBSTR(PRODUCT_VALUE,8,1)= 'G' OR
 SUBSTR(PRODUCT_VALUE,8,1)= 'H'  OR
 SUBSTR(PRODUCT_VALUE,8,1)= 'I'),
Then
   REPORT_MONTH
Else-If  (PRODUCT_VALUE_1_2= '42' 
(LENGTH(PRODUCT_VALUE)=8)  AND
(SUBSTR(PRODUCT_VALUE,8,1) = 'A',
Then
   REPORT_MONTH
Else-If
   PRODUCT_VALUE_1_2= '41' AND
  (IASL_CD = '173' OR
    IASL_CD = '174' OR
 	IASL_CD = '183' OR
     IASL_CD = '184')
 Then
     REPORT_MONTH
  Else
      ACCIDENT_MONTH	","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
","FDW_Core defect 5797 for Medical Malpractice, add PV 42 logic.",6/22/2015,jjordan,"Set the management reporting accident year equal to the Accident_Month or Report_Month as determined from the internal annual statement line and product value
",,,,,,,,,
BR-22764,2 Management Reporting Accident Year,"If  (PRODUCT_VALUE_1_2= '40' OR PRODUCT_VALUE_1_2='43') AND
(LENGTH(PRODUCT_VALUE)=8)  AND
(SUBSTR(PRODUCT_VALUE,8,1) = 'F' OR
 SUBSTR(PRODUCT_VALUE,8,1)= 'G' OR
 SUBSTR(PRODUCT_VALUE,8,1)= 'H'  OR
 SUBSTR(PRODUCT_VALUE,8,1)= 'I'),
Then
   REPORT_YEAR
Else-If  (PRODUCT_VALUE_1_2= '42' 
(LENGTH(PRODUCT_VALUE)=8)  AND
(SUBSTR(PRODUCT_VALUE,8,1) = 'A',
Then
   REPORT_YEAR
Else-If
   PRODUCT_VALUE_1_2= '41' AND
  (IASL_CD = '173' OR
    IASL_CD = '174' OR
 	IASL_CD = '183' OR
     IASL_CD = '184')
 Then
     REPORT_YEAR
  Else
      ACCIDENT_YEAR","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
","FDW_Core defect 5797 for Medical Malpractice, add PV 42 logic.",6/22/2015,jjordan,"Set the management reporting accident year equal to the Accident_Month or Report_Month as determined from the internal annual statement line and product value
",,,,,,,,,
BR-21869,3 Statistical  Reporting Accident Year,,,,6/22/2015,jjordan,"Set the stat reporting accident year equal to the Accident Year, Report Year or management reporting accident year determined from the internal annual statement
",,,,,,,,,
BR-3,"4 Workers Comp Indemnity Description

	","If MINOR_LINE_CODE in ('600','601','605','610','615','620','630')
And (CLAIM_SYMBOL_CODE = ‘VOC’ 
set to ‘Vocational Rehab’
Or CLAIM_SYMBOL_CODE = ‘EL’ 
set to ‘Employers Liability’ 
Or CLAIM_SYMBOL_CODE = ‘W’ 
set to ‘Indemnity’ 
Or CLAIM_SYMBOL_CODE like (‘%MP’) 
set to ‘Medical Payment’)",,,6/22/2015,jjordan,Set the Annual Statement workers comp indmnity description based on the minor line and claim symbol.,Application,,,,No,"Claims
Financial/Investments",,,Computation
BR-6,5 Policy Term,"Calculate
POLICY_TERM = 
(((PT-EXP-YR * 12) + PT-EXP-MO) - 
((PT-EFF-YR * 12) + PT-EFF-MO))","ETL - F_Detail_Premiums
ETL - D_Policy_Support
",,6/22/2015,jjordan,"Calculate the policy term based onthe policy effective year and policy expiration year. 
",Application,,,,No,Financial/Investments,,,Computation
BR-7,6 Commission Amount ,"If Commiss_Amt = 0 and Commiss_Pcnt <> 0 
CHANGE-COMMISSION-AMOUNT = (Trans_Prem_Amt * Commiss_Pcnt / 100)
Else Commiss_Amt

If Direct_Ceded_Assumed_CD = ‘C’
(Commiss_Amt * -1)",ETL - F_Divisional_Premiums,,6/22/2015,jjordan,"Calculate the change commission amount
This decode is perfomed in the script for vw_divisional_premiums_src in ADW.   lak",Application,,,,No,Financial/Investments,,,Computation
BR-9,7 Commission Rate ,COMMISSION-RATE = (Commiss_pcnt / 100),ETL - F_Divisional_Premiums,,6/22/2015,jjordan,"Calculate the commission rate 
",Application,,,,No,Financial/Investments,,,Computation
BR-8,8 Change Written Premium Amount ,"Move Prem_Amt for Written
Move Non_Prem_Amt for Surcharges.

If Direct_Ceded_Assumed_CD = ‘C’
(Prem_Amt * -1) ",ETL - F_Divisional_Premiums,,6/22/2015,jjordan,"Calculate the change writtem premiums 
",Application,,,,No,Financial/Investments,,,Computation
BR-11,9 Change Reserve Amount ,"If Direct_Ceded_Assumed_CD = ‘C’
  LOSS_RSVEST_BAL_AMT * -1 
Else 
  LOSS_RSVEST_BAL_AMT
End-if",ETL - F_Divisional_Losses,,6/22/2015,jjordan,"Calculate the change reserve amount 
",Application,,,,No,Financial/Investments,,,Computation
BR-5,10 Exclude Profit Centers from Financial reporting ,"profit centers that are excluded from the financial reporting are listed in the table EXCLUDE_PROFIT_CENTERS.  The LOSS Financial reporting includes P&L, Annual Statement, AYPR, AYMR and NAYUAR.  ",,,6/22/2015,jjordan,"This business rule ONLY applies to LOSS Financials for the excluded profit center listed in the table.

Select profit centers are excluded from the Loss financial reporting, generally it's Crop hail. 
",Application,,,,No,Financial/Investments,,,Computation
BR-12,11 Complete Policy Number for Legacy data ,Concatenate the POLICY_SYMBOL || POLICY_NUMBER || POLICY_MODULE from D_POLICY,,,6/22/2015,jjordan,"Build the complete policy number from the policy-symbol, policy-number and policy-module
",Application,,,,No,Financial/Investments,,,Fact
BR-13,12 Complete Policy Number for EDW data ,Concatenate the POL_SYMBOL || POL_NO_CD || POL_VERSION_CD.,,,6/22/2015,jjordan,"Build the complete policy number from the policy-symbol, policy-number and policy-version
",Application,,,,No,Financial/Investments,,,Fact
BR-14,13 Selection criteria for Inland Marine Premiums Aggregate ,"WHERE D_PREMIUM_CATEGORY.PREM_INCOME_CATEGORY_30_CODE = 'I'
AND PRODUCT_VALUE_ID_1_2 IN ('06','16','26') 
AND
TRANSACTION_ACCOUNTING_YEAR > 1999 
AND THE STAT FORMAT ID IS ON THE D_STAT_INLAND_MARINE_PREMIUMS TABLE 
AND 
(TRANSACTION_ACCOUNTING DATE = IREPORT DATE YY 
	AND TRANSACTION ACOUNTING MONTH >= IREPORT DATE MM)
OR 
(TRANSACTION_ACCOUNTING_YEAR > I REPORT DATE YY)

",ETL - A_Inland_Marine_Premiums,,1/19/2018,mmconley,"Selection criteria for the premium transactions loaded to the table A_Inland_Marine_Premiums.

The Experience selection criteria were created to match the legacy system as of 2005.

sconley 1/19/18: Added source for PREM_INCOME_CATEGORY_30_CODE. See BR-23496 on how it is set.  'I' is for Income. 'T' (Tax) & 'S' (Surcharge) are not selected (stat_fromat_code 906).",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-15,14 Selection criteria for Inland Marine Losses Aggregate ,"WHERE SOURCE_PRODUCER_GROUP IN ('01','02','03','04','06','07','10')
AND PRODUCT_VALUE_ID_1_2 = '26'  
",ETL - A_Inland_Marine_Losses,,6/22/2015,jjordan,"Selection criteria for the loss and reserve transactions loaded to the table A_Inland_Marine_Losses.

The Experience selection criteria were created to match the legacy system as of 2005.
",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-16,15 Selection criteria for Auto Premiums Aggregate ,"WHERE SOURCE_PRODUCER_GROUP IN ('01','02','03','04','06','07','10','EW')
AND D_PREMIUM_CATEGORY.PREM_INCOME_CATEGORY_30_CODE = 'I'
AND PRODUCT_VALUE_ID_1_2 IN ('60','61','62')",ETL - A_Auto_Premiums,,1/19/2018,mmconley,"Selection criteria for the premium transactions loaded to the table A_Auto_Premiums.

The Experience selection criteria were created to match the legacy system as of 2005.

sconley 1/19/18: Added source for PREM_INCOME_CATEGORY_30_CODE. See BR-23496 on how it is set.  'I' is for Income. 'T' (Tax) & 'S' (Surcharge) are not selected (stat_fromat_code 906).",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-17,16 Selection criteria for Auto Losses Aggregate ,"WHERE SOURCE_PRODUCER_GROUP IN ('01','02','03','04','06','07','10')
AND PRODUCT_VALUE_ID_1_2 IN ('60','61','62')",ETL - A_Auto_Losses,,6/22/2015,jjordan,"Selection criteria for the loss and reserve transactions loaded to the table A_Auto_Losses

The Experience selection criteria were created to match the legacy system as of 2005.
",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-18,17 Selection criteria for Liability Premiums Aggregate ,"WHERE C.PRODUCT_VALUE_ID = A.PRODUCT_VALUE_1_8_ID
AND D.PREMIUM_CATEGORY_ID = A.PREMIUM_CATEGORY_ID
AND E.STAT_FORMAT_ID = A.STAT_FORMAT_ID 
AND D_PREMIUM_CATEGORY.PREM_INCOME_CATEGORY_30_CODE = 'I'
AND (PRODUCT_VALUE_ID_1_2 IN ('40','41','42','43')
 OR (PRODUCT_VALUE_ID_1_2 = '30' and PRODUCT_VALUE_7_CODE IN ('A','B','C','D','E','F','G','H','I','J','K','L','M','N','O')) 
 OR (PRODUCT_VALUE_ID_1_2 = '80' and PRODUCT_VALUE_7_8_CODE = '70')
 OR (PRODUCT_VALUE_ID_1_2 = '81' and PRODUCT_VALUE_7_8_CODE = '20')
 OR (PRODUCT_VALUE_ID_1_2 = '83' and PRODUCT_VALUE_7_8_CODE = '20'))",ETL - A_Liability_Premiums,9/21/12 MMO Updated per ETL spec selection criteria for A_Liability_Premiums.,1/19/2018,mmconley,"Selection criteria for the premium transactions loaded to the table A_Liability_Premiums.

The Experience selection criteria were created to match the legacy system as of 2005.

sconley 1/19/18: Added source for PREM_INCOME_CATEGORY_30_CODE. See BR-23496 on how it is set.  'I' is for Income. 'T' (Tax) & 'S' (Surcharge) are not selected.ncome. 'T' (Tax) & 'S' (Surcharge) are not selected (stat_fromat_code 906)
",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-19,18 Selection criteria for Liability Losses Aggregate ,"WHERE SOURCE_PRODUCER_GROUP IN ('01','02','03','04','06','07','10')
AND (PRODUCT_VALUE_ID_1_2 IN (‘03’,‘04’,'40','41','42','43')
 OR (PRODUCT_VALUE_ID_1_2 = '30' and PRODUCT_VALUE_7_CODE IN ('A','B','C','D','E','F','G','H','I','J','K','L','M','N','O')) 
 OR (PRODUCT_VALUE_ID_1_2 = '80' and PRODUCT_VALUE_7_8_CODE = '70')
 OR (PRODUCT_VALUE_ID_1_2 = '81' and PRODUCT_VALUE_7_8_CODE = '20')
 OR (PRODUCT_VALUE_ID_1_2 = '83' and PRODUCT_VALUE_7_8_CODE = '20'))  

WHERE SOURCE_PRODUCER_GROUP IN ('01','02','03','04','06','07','10')
AND (PRODUCT_VALUE_ID_1_2 IN ('40','41','42','43')
 OR (PRODUCT_VALUE_ID_1_2 = '30' and PRODUCT_VALUE_7_CODE IN ('A','B','C','D','E','F','G','H','I','J','K','L','M','N','O')) 
 OR (PRODUCT_VALUE_ID_1_2 = '80' and PRODUCT_VALUE_7_8_CODE = '70')
 OR (PRODUCT_VALUE_ID_1_2 = '81' and PRODUCT_VALUE_7_8_CODE = '20')
 OR (PRODUCT_VALUE_ID_1_2 = '83' and PRODUCT_VALUE_7_8_CODE = '20'))
",ETL - A_Liability_Losses,Defect 5362/Stat Format Code 216 and 316 (FDW-Core) ,6/22/2015,jjordan,"Selection criteria for the loss and reserve transactions loaded to the table A_Liability_Losses.

Updated since now reporting on stat format code 216 and 316.  Prior comment ""The Experience selection criteria were created to match the legacy system as of 2005"".
",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-20,19 Selection criteria for Ocean Marine Premiums Aggregate ,"WHERE SOURCE_PRODUCER_GROUP IN ('01','02','03','04','06','07','10','EW')
AND D_PREMIUM_CATEGORY.PREM_INCOME_CATEGORY_30_CODE = 'I'
AND PRODUCT_VALUE_ID_1_2 = '90'  
",ETL - A_Ocean_Marine_Premiums,,1/19/2018,mmconley,"Selection criteria for the premium transactions loaded to the table A_Ocean_Marine_Premiums.

The Experience selection criteria were created to match the legacy system as of 2005.

sconley 1/19/18: Added source for PREM_INCOME_CATEGORY_30_CODE. See BR-23496 on how it is set.  'I' is for Income. 'T' (Tax) & 'S' (Surcharge) are not selected.ncome. 'T' (Tax) & 'S' (Surcharge) are not selected (stat_fromat_code 906).
",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-21,20 Selection criteria for Ocean Marine Losses Aggregate ,"WHERE SOURCE_PRODUCER_GROUP IN ('01','02','03','04','06','07','10')
AND PRODUCT_VALUE_ID_1_2 = '90'  
",ETL - A_Ocean_Marine_Losses,,6/22/2015,jjordan,"Selection criteria for the loss and reserve transactions loaded to the table A_Ocean_Marine_Losses.

The Experience selection criteria were created to match the legacy system as of 2005.
",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-22,21 Selection criteria for Private Auto Premiums Aggregate ,"WHERE SOURCE_PRODUCER_GROUP IN ('01','02','03','04','06','07','10')
AND D_PREMIUM_CATEGORY.PREM_INCOME_CATEGORY_30_CODE = 'I'
AND PRODUCT_VALUE_ID_1_2 IN ('60','61','62')",ETL - A_Private_Auto_Premiums,,1/19/2018,mmconley,"Selection criteria for the premium transactions loaded to the table A_Private_Auto_Premiums.

The Experience selection criteria were created to match the legacy system as of 2005.

sconley 1/19/18: Added source for PREM_INCOME_CATEGORY_30_CODE. See BR-23496 on how it is set.  'I' is for Income. 'T' (Tax) & 'S' (Surcharge) are not selected.ncome. 'T' (Tax) & 'S' (Surcharge) are not selected (stat_fromat_code 906).",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-23,22 Selection criteria for Private Auto Losses Aggregate ,"WHERE SOURCE_PRODUCER_GROUP IN ('01','02','03','04','06','07','10')
AND PRODUCT_VALUE_ID_1_2 IN ('60','61','62')",ETL - A_Private_Auto_Losses,,6/22/2015,jjordan,"Selection criteria for the loss and reserve transactions loaded to the table A_Private_Auto_Losses

The Experience selection criteria were created to match the legacy system as of 2005.
",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-24,23 Selection criteria for Property Premiums Aggregate ,"WHERE SOURCE_PRODUCER_GROUP IN ('01','02','03','04','06','07','10')
AND D_PREMIUM_CATEGORY.PREM_INCOME_CATEGORY_30_CODE = 'I'
AND (PRODUCT_VALUE_ID_1_2 IN ('20','21','24','25')
 OR (PRODUCT_VALUE_ID_1_2 = '30' and PRODUCT_VALUE_7_CODE IN ('0','1','2','3','4','5','6','7','8','9')) 
 OR (PRODUCT_VALUE_ID_1_2 = '80' and PRODUCT_VALUE_7_8_CODE IN ('10','20','30','40','50','55','60','65'))
 OR (PRODUCT_VALUE_ID_1_2 = '81' and PRODUCT_VALUE_7_8_CODE IN ('10'))
 OR (PRODUCT_VALUE_ID_1_2 = '83' and PRODUCT_VALUE_7_8_CODE IN ('10','15'))) ",ETL - A_Property_Premiums,,1/19/2018,mmconley,"Selection criteria for the premium transactions loaded to the table A_Property_Premiums.

The Experience selection criteria were created to match the legacy system as of 2005.

sconley 1/19/18: Added source for PREM_INCOME_CATEGORY_30_CODE. See BR-23496 on how it is set.  'I' is for Income. 'T' (Tax) & 'S' (Surcharge) are not selected.ncome. 'T' (Tax) & 'S' (Surcharge) are not selected (stat_fromat_code 906).",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-25,24 Selection criteria for Property Losses Aggregate ,"WHERE SOURCE_PRODUCER_GROUP IN ('01','02','03','04','06','07','10')
AND (PRODUCT_VALUE_ID_1_2 IN (01’,'20','21','24','25')
 OR (PRODUCT_VALUE_ID_1_2 = '30' and PRODUCT_VALUE_7_CODE IN ('0','1','2','3','4','5','6','7','8','9')) 
 OR (PRODUCT_VALUE_ID_1_2 = '80' and PRODUCT_VALUE_7_8_CODE IN ('10','20','30','40','50','55','60','65'))
 OR (PRODUCT_VALUE_ID_1_2 = '81' and PRODUCT_VALUE_7_8_CODE IN ('10'))
 OR (PRODUCT_VALUE_ID_1_2 = '83' and PRODUCT_VALUE_7_8_CODE IN ('10','15')))
WHERE SOURCE_PRODUCER_GROUP IN ('01','02','03','04','06','07','10')
AND (PRODUCT_VALUE_ID_1_2 IN ('20','21','24','25')
 OR (PRODUCT_VALUE_ID_1_2 = '30' and PRODUCT_VALUE_7_CODE IN ('0','1','2','3','4','5','6','7','8','9')) 
 OR (PRODUCT_VALUE_ID_1_2 = '80' and PRODUCT_VALUE_7_8_CODE IN ('10','20','30','40','50','55','60','65'))
 OR (PRODUCT_VALUE_ID_1_2 = '81' and PRODUCT_VALUE_7_8_CODE IN ('10'))
 OR (PRODUCT_VALUE_ID_1_2 = '83' and PRODUCT_VALUE_7_8_CODE IN ('10','15')))",ETL - A_Property_Losses,Defect 5362/Stat Format Code 411 and 511 (FDW-Core),6/22/2015,jjordan,"Selection criteria for the loss and reserve transactions loaded to the table A_Property_Losses

Updated since now reporting on stat format code 411 and 511.  Prior comment ""The Experience selection criteria were created to match the legacy system as of 2005"".",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-26,25 Selection criteria for Fidelity and Crime Premiums Aggregate ,"WHERE PRODUCT_VALUE_ID_1_2 IN ('70','22')",ETL - A_Fidelity_Premiums,,6/22/2015,jjordan,"Selection criteria for the premium transactions loaded to the table A_Fidelity_Premiums.
",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-27,26 Selection criteria for Fidelity and Crime Losses Aggregate ,"WHERE PRODUCT_VALUE_ID_1_2 IN ('70','22')",ETL - A_Fidelity_Losses,,6/22/2015,jjordan,"Selection criteria for the loss and reserve transactions loaded to the table A_Fidelity_Losses
",Application,,,,No,Statistical Compliance,,,Action Enabler
BR-23229,27 Selection criteria for Work Comp Premiums Aggregate ,"Where CURRENT_PROFIT_CENTER <> 2100 AND
		 PRODUCT_VALUE_ID_1_2 in ('50', '17')  AND
		 D_PREMIUM_CATEGORY.PREM_INCOME_CATEGORY_30_CODE = 'I
           ' AND 
 		 transaction_accounting_year > 1977
              and 
                  If ((I_report_dates.report = ‘STAT PREMIUMS BREAKOUT’
                     Transaction_accounting_year = i_report_date.report_date  year
                      And 
                      transaction_accounting_month >= to i_report_date month)
                     OR
                       Transaction_accounting_year > i_report_date.report_date year)
                  And
                         i_report_date >= the report date from the ‘STAT REJECT FIX                      PREMIUMS’ row.

","ETL - A_Work_Comp_Premiums	",,1/19/2018,mmconley,"
sconley 1/19/18: Added source for PREM_INCOME_CATEGORY_30_CODE. See BR-23496 on how it is set.  'I' is for Income. 'T' (Tax) & 'S' (Surcharge) are not selected.ncome. 'T' (Tax) & 'S' (Surcharge) are not selected (stat_fromat_code 906).",Application,,Fact,,,Statistical Compliance,,,
BR-23265,28 Selection criteria for Work Comp Losses Aggregate,"DPPC.CURRENT_PROFIT_CENTER <> 2100 
AND PV.PRODUCT_VALUE_ID_1_2 in ( '50', '17')
AND IR.REPORT = 'STAT LOSSES BREAKOUT'
AND 
transaction_accounting_year > 1978
and 
(
    (
       If ((I_report_dates.report = ‘STAT PREMIUMS BREAKOUT’
                     Transaction_accounting_year = i_report_date.report_date  year
                      And 
                      transaction_accounting_month >= to i_report_date month)
                     OR
                       Transaction_accounting_year > i_report_date.report_date year)

)
AND  i_report_date >= the report date from the 'STAT REJECT FIX LOSSES row')

",ETL - A_Work_Comp_Losses,,11/26/2014,lkummer,,,,Fact,,,Statistical Compliance,,,
BR-21961,29 Selection criteria for D_Policy,"Create FDW policy rows for the EDW policies effective within the current month.  
Advance polices (Policy effective date in the future), advance transactions (Transaction Effective date in the future) and unverified policies(policy level attribute indicated that the policy information has been provided by the claims application, and is therefor unverified, or the transaction status indicating that the policy financials have been previously reported. should not be selected.

In order for the load to d_policy to be successful, the policy must have an associated place with at category of 'ST'",ETL - D_Policy,,6/22/2015,jjordan,"The intent of this rule is to only select financial transactions that will be reported in the current month. Using the following attributes: Accounting Year and Month, Previously Reported, and Unverified Policy.
",,,,,,,,,
BR-21998,30 Selection criterica for D_Geography,"Populate the columns in D_GEOGRAPHY by selecting data from VW_PLACE_STATE_PROVINCE

Include the rows from VW_PLACE_STATE_PROVINCE that do not exist on D_GEOGRAPHY
Select VW.FIPS_US_ALPHA_CD,
   VW.FIPS_US_NUMERIC_CD,
   VW.FIPS_STATE_PROVINCE_NM,
   VWC.ISO_COUNTRY_CD,
   VWC.COUNTRY_NM
From VW_PLACE_STATE_PROVINCE VW,
   VW_PLACE_COUNTRY VWC
   D_GEOGRAPHY G
Where 
   VW.PLACE_COUNTRY_ID = VWC.PLACE_COUNTRY_ID
   and VW.FIPS_US_ALPHA_CD <> G.STATE_PROVINCE_CODE
  
G.STATE_PROVINCE_CODE = VW.FIPS_US_ALPHA_CD
G.STATE_PROVINCE_DESC = VW.FIPS_STATE_PROVINCE_NM
G.REIN_STATE_PROVINCE_CODE = VW.FIPS_US_ALPHA_CD
G.REIN_STATE_PROVINCE_DESC, = VW.FIPS_STATE_PROVINCE_NM
G.SOURCE_STATE_CODE = VW.FIPS_US_ALPHA_CD
G.COUNTRY_DESC = VWC.COUNTRY_NM
G.FIPS_US_ALPHA_CODE = VW.FIPS_US_ALPHA_CD
G.FIPS_US_NUMERIC_CODE = VW.FIPS_US_NUMERIC_CD
G.FIPS_STATE_PROVINCE_NAME = VW.FIPS_STATE_PROVINCE_NM

If VWC.ISO_COUNTRY_CD = ‘CA’ 
  Then G.COUNTRY_CODE = ‘CAN’
           G.POSTAL_COUNTRY_CODE = ‘CAN’ 
   Else G.COUNTRY_CODE = VWC.ISO_COUNTRY_CD
          G.POSTAL_COUNTRY_CODE = VWC.ISO_COUNTRY_CD

If VW.FIPS_US_NUMERIC_CD is null or spaces 
  Then G.FIPS_US_NUMERIC_CODE is null 
         G.REIN_STATE_PROVINCE_CODE = ‘00’
",ETL - D_Geography,,8/1/2013,moreilly,,,,,,,,,,
BR-21999,31 Limits - Selection criteria for d_cvrg_limit  ,"Only select limits whose category is an Amount, a Percent, or 0(none)

IF VW_CVRG_LIMIT.CATG_CD in ('AMT', ‘PCNT’, ’0’)
   And VW_CVRG_LIMIT.VARIANCE_CATEGORY_CD = ‘0’ 

If there are multiple limit rows in EDW.VW_CVRG_LIMIT for VW_COVERAGE.CVRG_CD = 'DCEXPAND'
    Select the row where the APPLIES_TO_CD = RESPEXP (Response Expenses)
Else if only 1 limit exists
    Select that row.
",ETL - D_Cvrg_Limit,"PIM 13689: CR# 91- Data Compromise - FDW Changes for D_CVRG_LIMIT

4/12/17 sconley: ENTERPRISE.Data_Platform 1697 D_CVRG_LIMIT updates for ISO Property (DP-8497)",11/14/2017,mmconley,"In order to support the attachment point requirements for Agriguard, we bring in the coverage limit rows from EDW with a limit category of  0.  Then we evaluate the limit purpose text to determine how to populate the underlying limit elements in FDW D_CVRG_LIMIT.

12/5/16 sconley: Corrected QC defect #

4/12/17 sconley: Removed rule for DCEXPAND.  This is for the Aggregate limit and it is part of that rule. (QC 1679, DP-8497)",,,,,,,,,
BR-22690,32 Insured Address - Selection criteria for D_Insured,"In order for D_Insured data to be loaded into FDW, the Insured must have an associated address with a place category of MLG or HAD.  

The Insured information will use the associated address with the HAD place category.  If that is null then the MLG information is used instead.   In either case the info is put in Upper Case
",ETL - D_Insured,,6/22/2015,jjordan,,,,,,,,,,
BR-22006,33 Selection  criteria for ADW,"ADW selects all Premium records from EDW that have a Rating entity, including both back dated and future dated transactions, and calculates/stores earnings records at the coverage level for all coverages on a policy. Note, this is a technical distinction based on the EDW model.  If the  Rating Entity is missing then there isn't a CLASS Code associated with the coverage, and therefor isn't financially reported.

If the FINANCE  PREVIOUSLY  REPORTED IND is TRUE, these records are not pulled into ADW.",,,10/9/2013,moreilly,Note: The FINANCE  PREVIOUSLY  REPORTED IND is set to true for Policies Converted from PRO/ONCORE Legacy Systems,,,,,,,,,
BR-22007,34 Selection criteria for FDW Premium,"Premium Records from ADW must meet the following criteria to be pulled into FDW.
      1. The premium transaction must have an accounting month/year equal to the current accounting month/year as defined by the EDW_ACCTING_MO (aligns with Legacy PRO Close)
       2.  Taxes/Surcharges with a premium bearing indicator of FALSE (0 -value), and coverage codes of  'TAXSURCHRG', 'BMPTAXSUR', 'BRMPTAXSUR' will be loaded into FDW, as long as they meet the accounting month/year restriction above.
       3.  Unverified Policy indicator is set to false
       4.  Financial Reported Previously indicator is set to false
       5.  All other coverages with a premium bearing indicator of TRUE (1-value) will be loaded into FDW, as long as they meet the accounting month/year restriction above.
       6. Coverage type of 'REINS' is excluded from FDW. These are the coverage codes used for Facultative Reinsurance. Adding these to FDW would cause premium amounts to double.  These are simply for URS and Reinsurance
        7. Existence of a rating entity associated to the coverage, with a valid rate class(ADW)
        
",,,10/9/2013,moreilly,"Note: If the business coverage table has a 0 in the premium bearing indicator, even if the coverage has premium it will not be loaded into the FDW.

Note: If the coverage does NOT have a rating entity, it will not be pulled into ADW.",,,,,,,,,
BR-22008,35 Selection criteria for FDW Loss ,"Loss Records from ADW must meet the following criteria to be pulled into FDW.
      1. The loss transaction must have an accounting month/year equal to the current accounting month/year as defined by the EDW_ACCTING_MO (aligns with Legacy PRO Close)
     2. Loss records associated with Unverified policies are not loaded into FDW.
     3. Loss records associated with Financial_Reported_Previously_IND must be false.
     ",ETL - F_Divisional_Losses,,9/18/2013,moreilly,,,,,,,,,,
BR-22743,36 Selection criteria for Divisional Expense Payments,"Select claims where the VW_CLM_FIN_TRANS.CLM_FIN_TRANS_CATG_CD = ‘Payment’, 'RECOVERY' 
And VW_CLM_FIN_TRANS.LOSS_CATG_CD = ‘expense’
And VW_CLM_FIN_TRANS_LINEITEM.LINEITEM_CATG_CD <> 0
And AGG_CLM_FIN_TRANS.FINANCIAL_REPORTED_PREVIOUSLY_IND = 0
And VWA_POL_TERM.UNVRFY_POL_IND = 0

The exception to this rule would be 'expense' transactions that are marked as salvage or subrogation. Code copied below.  These are converted to beocme 'claimcost'.

 IIF (EXPENSE_PAYMENT_CATEGORY_CD = 'S' OR EXPENSE_PAYMENT_CATEGORY_CD = 'X',EXPENSE_PAYMENT_CATEGORY_CD,
       IIF((isnull(COLLECTION_CATG_CD) OR COLLECTION_CATG_CD = '0'),'0',COLLECTION_CATG_CD))",ETL - F_Div_Expense_Payment,,5/17/2016,rherbig,"See DP Defect # 55, FDW Core Defect 10066 and 10067.",,,,,,,,,
BR-22783,37 Selection criteria for Divisional Outstanding Reseve ,"Select claims where the VW_CLM_FIN_TRANS.CLM_TRANS_CATG_DESC = ‘Reserve’,'RECORES'
(And VW_CLM_FIN_TRANS.LOSS_CATG_CD in (‘claimcost’,'expense')
And AGG_CLM_FIN_TRANS.FINANCIAL_REPORTED_PREVIOUSLY_IND = 0
And VWA_POL_TERM.UNVRFY_POL_IND = 0)",ETL - F_Div_OS_Reserve,,5/17/2016,rherbig,,,,,,,,,,
BR-29,38 NAIC state code for the Annual Statement ,"Select INTERNAL_ANNUAL_STMT_LINE_CODE from D_IASL_PC
Select SUB_SYSTEM_DESC 
from D_TRANSACTION_ITEMS
Select COUNTRY_CODE 
from D_GEOGRAPHY

If INTERNAL_ANNUAL_STMT_LINE_CODE = '080' 
and COUNTRY_CODE <> 'CAN' 
and SUB_SYSTEM_DESC = 'Divisional' 

Select STATE_NUMBER 
from D_PRODUCER,  
Select GEOGRAPHY_ID 
from D_GEOGRAPHY 
where D_PRODUCER.STATE_NUMBER = D_GEOGRAPHY.SOURCE_STATE_CODE
If D_GEOGRAPHY.POSTAL_COUNTRY_CODE = 'USA' 
move GEOGRAPHY_ID to NAIC_STATE_ID.

Else move RISK_STATE_ID 
to NAIC_STATE_ID","ETL - A_AS_LOSSES   
ETL - A_AS_PREMIUMS  ETL - ETL - A_AS_UNDERWRITING  ETL - A_AS_ADJUSTMENTS",,6/22/2015,jjordan,"Logic in the A_AS_Premiums and A_AS_Losses mappings

Set the NAIC state code to the state code of the producer when the internal annual statement code = 080 (Ocean Marine) and the transaction is for a divisional premium or loss. 
",Application,,,,No,Accounting Services,,,Inference
BR-30,39 Reinsurance Transaction Type for Underwriting amounts for the Annual Statement ,"Select CURRENT_PROFIT_CENTER from AD_AS_PRODUCER_PC

Select REIN_TRANSACTION_TYPE_CODE 
from LK_COST_PC_REIN_TYPE 
where CURRENT_PROFIT_CENTER = PROFIT_CENTER move to WS.REIN_TRANS_CODE.  
Reject if not found.   

If ACCOUNT_NUMBER_1_CODE = '5'
and ACCOUNT_NUMBER_2_CODE = '1'
and ACCOUNT_NUMBER_3_CODE = '2'
  If ACCOUNT_NUMBER_4_CODE = '1' 
    WS.REIN_TRANS_CODE = 'DI'
  If ACCOUNT_NUMBER_4_CODE = '2'
    WS.REIN_TRANS_CODE = 'AT' 
  If ACCOUNT_NUMBER_4_CODE = '3'
    WS.REIN_TRANS_CODE = 'CT'
ELSE If COMPANY_CODE in ('07','12')
    WS.REIN_TRANS_CODE = 'DI'   

Select REIN_TRANSACTION_TYPE_DESC 
from LK_TRANSACTION_TYPE 
where WS.REIN_TRANS_CODE = REIN_TRANSACTION_TYPE_CODE ",ETL - A_AS_UNDERWRITING,,6/22/2015,jjordan,"Logic in the A_AS_Underwriting mappings

Set the reinsurnace transaction type based on the profit centers and account numbers.
",Application,,,,No,Accounting Services,,,Inference
BR-31,40 LAE Expense Payment codes for the Annual Statement ,"If AMOUNT_CATEGORY_1_DESC = ‘LAE’ 
and AMOUNT_CATEGORY_2_DESC = ‘Paid’ 
then select the EXPENSE_PAYMENT_ID 

If AMOUNT_CATEGORY_1_DESC = ‘LAE’ 
and AMOUNT_CATEGORY_2_DESC = ‘Recovery’ 
and AMOUNT_CATEGORY_5_DESC = ‘Unallocated’ 
then select the EXPENSE_PAYMENT_ID 
where ALAE_EXPENSE_PAYMENT_CODE = ‘UNP’

Else-If AMOUNT_CATEGORY_1_DESC = ‘LAE’ 
and AMOUNT_CATEGORY_2_DESC = ‘Recovery’ 
and AMOUNT_CATEGORY_5_DESC = ‘Allocated’ 
then select the EXPENSE_PAYMENT_ID 
where ALAE_EXPENSE_PAYMENT_CODE = ‘ALP’

Else select the EXPENSE_PAYMENT_ID where ALAE_EXPENSE_PAYMENT_CODE = ‘DEF’",ETL - A_AS_LOSSES,,6/22/2015,jjordan,"Logic in the A_AS_Losses mappings

Set the lae expense payment codes based on the amount categories and LAE expense payment codes. 
",Application,,,,No,Accounting Services,,,Inference
BR-32,"41 Catastrophe Indicator

	","Select CATASTROPHE_CODE 
from D_CATASTROPHE_CODE.

If CATASTROPHE_CODE in (0,1,2,3,4,5,6,7,8,9,10,999) set CATASTROPHE_IND = 'N' else 'Y'","ETL - A_AYPR_LOSSES_DIV  
ETL - A_AYPR_LOSSES_ASSCN",,6/22/2015,jjordan,Set the Catastrophe Indicator based on the catastrophe code being set to the default values.,Application,,,,No,"Accounting Services
Actuarial Services",,,Computation
BR-34,42 A & E Indicator,,ETL - D_Claim,,6/22/2015,jjordan,"Set the Asbestos and Environment Indicator based on the indicator on the Claim.	",Application,,,,No,"Accounting Services
Actuarial Services",,,Computation
BR-22870,42.1 A & E Indicator,"Select A_E_INDICATOR from D_CLAIM.

If A_E_INDICATOR = ‘E’ set to ‘Y’ else ‘N’.",ETL - D_Claim,,6/22/2015,jjordan,"Set the Asbestos and Environment Indicator based on the indicator on the Claim.	
",Application,,,,No,"Accounting Services
Actuarial Services",,,Computation
BR-35,43 SST Indicator,"If REINSURANCE_COMPANY_CODE in (‘2470’,’4070’,’9400’,’9600’) set to ‘Y’ else ‘N’.",,,6/22/2015,jjordan,"Set the SST Indicator based on the reinsurance company code.
",Application,,,,No,Actuarial Services,,,Computation
BR-36,44 Modified State Indicator,"If CURRENT_PROFIT_CENTER in (‘3540’, ‘1688’) 
  If REIN_STATE_PROVINCE_CODE = ‘04’ then ‘04’
  If REIN_STATE_PROVINCE_CODE = ‘42’ then ‘42’
Else ‘99’",,,6/22/2015,jjordan,"Set the modified state indicator based on the risk state code.
",Application,,,,No,Actuarial Services,,,Computation
BR-37,45 OCG Sale Actual Indicator for Claims,"Select OCG_ACTUAL_INDICATOR from D_CLAIM.  Decode (‘O’ ‘OCG’, ‘G’ ‘GAI’, ‘M’ ‘Mitsui’, ‘I’ ‘Infinity’) else ‘GAI’",,,6/22/2015,jjordan,"Set the OCG sale actual indicator based on the specific claim.
",Application,,,,No,Actuarial Services,,,Computation
BR-39,46 OCG Sale Actual Indicator for Policies,"Select OCG_INDICATOR from D_POLICY.  Decode (‘OCG’ ‘OCG’, ‘GAI’ ‘GAI’, ‘MIT’ ‘Mitsui’, ‘UNK’ ‘GAI’, ‘’ ‘GAI’)",,,6/22/2015,jjordan,"Set the OCG sale actual indicator based on the specific policy.
",Application,,,,No,Actuarial Services,,,Computation
BR-38,47 OCG Sale Reporting Indicator,"Select OWNER from AD_PROFIT_CENTER_STRUCTURE where CURRENT_PROFIT_CENTER = AD_PROFIT_CENTER_STRUCTURE.PROFIT_CENTER_ULTIMATE_CHILD
else ‘GAI’",,,6/22/2015,jjordan,"Set the OCG sale reporting indicator based on the profit center. 
",Application,,,,No,Actuarial Services,,,Computation
BR-21870,48 Parent Coverage,"For each coverage on a policy, determine its parent coverage, either an existing coverage on the policy, or the Coverage Family to which the coverage belongs.  
1.  Use the parent coverage specified in the coverage to Coverage Relationship.
2.  Use the value in the Coverage Family data element, as provided by the source application.
3.  Set the Coverage Family data element value to 0.
","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
",,6/22/2015,jjordan,Use this Parent Coverage for calls to obtain more data about the coverage.,Application,Agreement,,,,Enterprise,,,Computation
BR-21872,49 Bureau Line ID,"Assumption: 
-These statements must be executed in the order in which they are shown in   this rule.
-Once set, exit the code
The Bureau Line Code is used to get the Bureau Line ID from d_bureau_line.

/* Direct_Ceded_Assumed_CD in (‘A’,’C’) */
/* CVRG_CD = ‘TAXSURCHRG’  */
If (Assumed or Ceded) or (Tax or Surcharge)
   Then Set Bureau Line Code = 0 
End-if

If EDW Source Business Unit = 'Personal Lines Division'
	Set Bureau Line Code = '62', EXIT

Evaluate Organization Code, Policy Term Effective Date, IASL
   When Organization Code = '05'; Policy Term Effective Date = Any Effective Date; IASL = Any IASL
          Set Bureau Line Code = 51; EXIT
   When Organization Code ='10'; Policy Term Effective Date = Any Effective Date; IASL = Any IASL
          Set Bureau Line Code = 48; EXIT
  When Organization Code ='11';  Policy Term Effective Date Less than 10/01/1993;  IASL = Any IASL
           Set Bureau Line Code = 49; EXIT
   When Organization Code = '12' ; Policy Term Effective Date Less than 01/01/1995; IASL = Any IASL
            Set Bureau Line Code = 50; EXIT
   When Organization Code =13'; Policy Term Effective Date = Any Effective Date; IASL = Any IASL
            Set Bureau Line Code = 46; EXIT
   When Organization Code IN (‘01’, ‘02’, ‘03’, ‘04’, ‘11’); Policy Term Effective Date = Any Effective Date; IASL = '160' 
            Set Bureau Line Code = 19; EXIT
   When Organization Code IN ('15','16','17'); Policy Term Effective Date Less than 01/01/2000; IASL = Any IASL
            Set Bureau Line Code = 30; EXIT
End Evaluate
Evaluate Federal Information Processing Standard (FIPS) Alpha State Code
 When AB (Alberta), AS (Aisne), BC (British Columbia), FM (Federated States of Micronesia),  GU (Guam), MB (Manitoba), MH (Manche),  MH (Marshall Islands), MP (Northern Mariana Islands),  NB (New Brunswick), NL (Newfoundland & Labrodor), NS (Nova Scotia),  NT (Northwest Territories),  NU (Nunavut), ON (Ontario),   PE (Prince Edward Island), PW (Palau), QC (Quebec),  SK (Saskatchewan), UM (Baker Island), UM (Johnston Atoll), UM (Midway Islands), UM (U.S. Minor Outlying Islands), UM (Palmyra Atoll), UM (Wake Island), UM (Kingman Reef),  UM (Navassa Island), UM (Jarvis Island), UM (Howland Island), VI  (Virgin Islands of the U.S.),  YT  (Yukon);     Set Bureau Line Code = 61; Exit
End Evaluate
If NY Free Trade Zone = True(C1,C2,C3)
             Set Bureau Line Code = 65
End-if
If Contract Category = Binder; 
       Set Bureau Line Code = 56; EXIT
End-if
If Coverage in (Farm Property A-D Mine Subsidence, Mine Subsidence);       
           Set Bureau Line Code = 62; EXIT
End-if
If IASL = 080; 
     Set Bureau Line Code = 71; EXIT
End-if
If Wavied = True; 
       Set Bureau Line Code = 72; EXIT
End-if 
Evaluate Loss Category; Expense Payment Category, Claim Financial Transaction Category, Subline Code; FIPS Alpha State Code 
    When Loss Category = 'Expense';Claim Financial Transaction Category in ('Payment', 'Recovery'); Expense Payment Category NOT in (S,X); Subline Code in (‘105’, ‘106’, ’116’, ’136’, ’156’, ‘176’,’196’,‘470’, ‘930’, ‘001’,'002');  FIPS Alpha State Code = Any FIPS; 
               Set Bureau Line Code = 59; Exit
   When Loss Category = 'Expense'; Claim Financial Transaction Category in ('Payment', 'Recovery'); EXPENSE PAYMENT CATEGORY  NOT in ('S','X') Subline Code in (010','090','100','392','618','920','965','970'); FIPS Alpha State Code <> 'TX'; 
                Set Bureau Line Code = 59; Exit
When Loss Category = 'Expense'; Claim Financial Transaction Category in (‘Reserve’,'RECORES'); Subline Code NOT in ('001','002',‘317’, ‘325’, ’332’, ’334’, ’335’, ‘336’,’337’,'338','339',‘342’, ‘343’, ‘345’,’346’, ’347’, ’350’, ‘360’,’365’,‘611’,'615',‘620’,’621’,’622’,’623’,’915’);  FIPS Alpha State Code = Any FIPS; 
                 Set Bureau Line Code = 59; Exit
End Evaluate 
Evaluate FIPS Alpha State Code; Subline Code; IASL
--------------------------------------------------------------------------------------------------------------------------------------
TEXAS:
    When FIPS Alpha State Code = 'TX'; Subline Code = ‘470’;  IASL = Any IASL
              Set Bureau Line Code = 23; EXIT
    When FIPS Alpha State Code = 'TX'; Subline Code in (‘001’,'002);  IASL = Any IASL
             Set Bureau Line Code = 39; EXIT
    When FIPS Alpha State Code = 'TX'; Subline Code in(‘010’, ‘090’, '116', '136', '156', '176', '196', ’317', '332', '335', '342', '343', '345', '346', '347', '360', '365', ‘611’, ’615’, ’618’, ’620’, ‘621’, ‘622’, ‘623’, ‘920’, ‘930’, ‘970’, ‘965’, ‘015’, ’016’, ’017’, '018’, ‘027’, ‘029’, ‘035’, ‘045’, ‘055’, ’081’, ’082’,’083’, ’084’, ’085’,’086’, ’087’, ’088’, ’070’, ’090’, ’060’, ’061’, ’011’, ’012’, ’013’, ’014’, ’037’, ’039’, ’067’, ’069’, ’077’, ’079’);  IASL = Any IASL
             Set Bureau Line Code = 21; EXIT
    When FIPS Alpha State Code = 'TX'; Subline Code in ('105',‘106’,‘325’, ‘333’, ‘334’, ‘336’, ‘337’, ‘350’);IASL = 030; 
             Set Bureau Line Code = 24; EXIT
    When FIPS Alpha State Code = 'TX'; Subline Code in ('105',‘106’,‘325’, ‘333’, ‘334’, ‘336’, ‘337’, ‘350’); IASL <> 030; 
             Set Bureau Line Code = 21; EXIT 
------------------------------------------------------------------------------------------------------------------------------------------------------------------
NOT TEXAS:
    When FIPS Alpha State Code <> 'TX'; Subline Code = '470';  IASL = Any IASL
             Set Bureau Line Code = 13; EXIT
    When FIPS Alpha State Code <> 'TX'; Subline Code in ('001,'002)';  IASL = Any IASL
             Set Bureau Line Code = 40; EXIT
    When FIPS Alpha State Code <> 'TX'; Subline Code in ('105', ‘106’, ’116’, ’136’, ’156’, ’176’, ’196’, ‘325’,  ‘332’, ‘334’, ’335’, ‘337’, ’342’, ‘343’, ’345’, ’346’, ’347’, ‘350’, ’360’, ’365’, ‘611’, ’615’, ’618’, ’620’, ‘621’,  ‘622’, ‘623’, ’915’, ‘920’, ‘930’, ’317’, ‘333’, ‘336’, ‘392’, ‘010’, ‘090’, ‘100’, ‘970’, ‘965’, ‘015’, ’016’, ’017’, '018’, ‘027’, ‘029’, ‘035’, ‘045’, ‘055’, ’081’, ’082’,’083’, ’084’, ’085’,’086’, ’087’, ’088’, ’070’, ’090’, ’060’, ’061’, ’011’, ’012’, ’013’, ’014’, ’037’, ’039’, ’067’, ’069’, ’077’, ’079’);
          Set Bureau Line Code = 1; EXIT
End Evaluate

If Bureau Line Code not previously set
   Then Bureau Line Code = 0
End-if
","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve


","QC 4617 FDW Core
New Rules for Losses only:
Evaluate Loss Category; Expense Payment Category, CLM FIN TRANS CATG CD, Subline Code; FIPS ALPHA STATE Code (Losses only)


New Rules for Premiums and losses
NY Free Trade 

Evaluate FIPS ALPHA STATE Code; Subline Code; IASL

QC 4 mySurety_Intg sconley: Update for Surety.  Wherever there are checks for Subline Code 001 also add in check for Subline Code 002.

9/4/15 sconley: Added mapplet name to Comments and added comment to Detailed Rule Text.

4/24/17 sconley: ENTERPRISE.Data_Platform 1742 Add sublines to TEXAS and NOT TEXAS rules for ISO Property (JIRA DP-8780)

",5/23/2017,mmconley,"The intent of this rule is to assign the Bureau Line based on one or more of the following: Premium Category, Coverage Code, Charge Code, Organization Code, Policy Term Effective Date, Risk State, Free Trade Zone, Contract Category, IASL, Waived Indicator, Loss Category Code, Subline, Annual Statement Line.  



There is now a single maplett that will assign bureau line for all fact tables.
Mapplet: mp_d_bureau_line in FDW_EDW

Per Defect 4617, the loss portion of the rule was changed.

All,

Awhile back there was a change put into place that converts a Paid Expense to a Paid Loss if the Expense is for salvage or subrogation.  It looks like the bureau line logic below is not setting the code correctly in this situation.  Since the LOSS CATG CD is expense on these claims from EDW the logic is assigning a bureau line code of 59.  I attached a list of the claims from production that appear to have this issue.  Since these claims would really appear on the Annual Statement as Paid Losses I am proposing we probably need to make the following update.  Can one of you verify this is what you want to do?  Also, I assume we want to FF the existing records so if you could let me know what bureau line these should be that would help ( I think these should all be 01).

Proposed changes

The EXPENSE PAYMENT CATEGORY CD of S and X stands for salvage and subrogation.  Since these would be converted to Paid Losses we want to set the bureau line based on different logic.  In order to do that I could use the statement highlighted in green below to exclude setting these to 59.  What I think your rule would be for the remainder of the Paid Expenses that are converted to Paid Losses is attached is the spreadsheet Expense Bureau Line Code.  Please let me know if this is correct and I can work with a developer to add those rules below.

4/24/17 sconley: Added sublines to TEXAS and NOT TEXAS rules for ISO Property (DP-8780)

5/23/17 sconley: Added details as to for Assumed, Ceded, and Tax & Surcharge are identified 


",Application,Agreement,Dimension,,,,,,
BR-21873,50 Transaction Items ID ,,"ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - D_TRANSACTION_ITEMS",,6/22/2015,jjordan,"The intent of this rule is to define the appropriate data values required to access the transaction items table, and bring back the correct Tranasction Items ID to store on the appropriate fact table

Utilize Existing Lookup tables 
LK_FDW_TO_EDW_REF 
D_SOURCE_SYSTEM
LK_TRANSACTION_TYPE
LK_AMOUNT_TYPE
D_TRANSACTION_ITEMS",,Money,Fact,,,,,,
BR-22692,50.1 Transaction Items ID for Divisional Premiums,"If Direct_Ceded_Assumed_CD = ‘D’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = ‘0’

If Direct_Ceded_Assumed_CD in (‘A’, ‘C’)
IF contr_catg_CD <> ‘0’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = contr_catg_CD

ELSE-IF Involuntary_catg_CD <> ‘0’ 
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = Involuntary_catg_CD

ELSE
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = 0

If EDW.VW_PRC_RATING_NON_PREM.CHARGE_CATG_CD = ‘S’  or ‘T’
  Then source-system-id = 33
Else source-system-id = 4

(Select * 
from lk_transaction_type
Where SOURCE_TRANSACTION_TYPE = FDW_CODE 
And SOURCE_CONTRACT_TYPE_CODE = ‘0’ 
And SOURCE_SYSTEM_ID = source-system-id

Select * 
From lk_amount_type
Where MAJOR_SOURCE_CODE = ‘01’
And MINOR_SOURCE_CODE = ‘01’
And RECOVERY_SOURCE_CODE = ‘0’
And SOURCE_SYSTEM_ID = source-system-id)

Then
Select TRANSACTION_ITEMS_ID 
From D_TRANSACTION_ITEMS 
Where AMOUNT_CATEGORY_1_DESC = lk.amount_category_1_desc
And AMOUNT_CATEGORY_2_DESC = lk.amount_category_2_desc
And AMOUNT_CATEGORY_3_DESC = lk.amount_category_3_desc
And AMOUNT_CATEGORY_4_DESC = lk.amount_category_4_desc
And AMOUNT_CATEGORY_5_DESC = lk.amount_category_5_desc
And REIN_TRANSACTION_TYPE_CODE = lk.rein_transaction_type_code
And SUB_SYSTEM_DESC = lk.sub_system_desc
And SOURCE_SYSTEM_ID = lk.source_system_id

","ETL - F_Divisional_Premiums
ETL - D_TRANSACTION_ITEMS",,1/19/2018,mmconley,"The intent of this rule is to define the appropriate data values required to access the transaction items table, and bring back the correct Tranasction Items ID to store on the f_divisional_premiums table in the WRITTEN_TRANSACTIIONS_ID.

sconley 1/19/18: Added source for CHARGE_CATG_CD. CHARGE_CATG_CD applies to Taxes and Surcharges.
",,,,,,,,,
BR-22691,"50.2 Transaction Items ID for Detail Premiums

.","If Direct_Ceded_Assumed_CD = ‘D’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = ‘0’

If Direct_Ceded_Assumed_CD in (‘A’, ‘C’)
IF contr_catg_CD <> ‘0’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = contr_catg_CD

ELSE-IF Involuntary_catg_CD <> ‘0’ 
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = Involuntary_catg_CD

ELSE
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = 0

(Select * 
from lk_transaction_type
Where SOURCE_TRANSACTION_TYPE = FDW_CODE 
And SOURCE_CONTRACT_TYPE_CODE = ‘0’ 
And Source_System_Id = 10

Select * 
From lk_amount_type
Where MAJOR_SOURCE_CODE = ‘01’
And MINOR_SOURCE_CODE = ‘02’
And RECOVERY_SOURCE_CODE = ‘0’
And Source_System_Id = 10)

Then
Select TRANSACTION_ITEMS_ID 
From D_TRANSACTION_ITEMS 
Where AMOUNT_CATEGORY_1_DESC = lk.amount_category_1_desc
And AMOUNT_CATEGORY_2_DESC = lk.amount_category_2_desc
And AMOUNT_CATEGORY_3_DESC = lk.amount_category_3_desc
And AMOUNT_CATEGORY_4_DESC = lk.amount_category_4_desc
And AMOUNT_CATEGORY_5_DESC = lk.amount_category_5_desc
And REIN_TRANSACTION_TYPE_CODE = lk.rein_transaction_type_code
And SUB_SYSTEM_DESC = lk.sub_system_desc
And SOURCE_SYSTEM_ID = lk.source_system_id","ETL - F_Detail_Premiums
ETL - D_TRANSACTION_ITEMS",,6/22/2015,jjordan,"The intent of this rule is to define the appropriate data values required to access the transaction items table, and bring back the correct Tranasction Items ID to store on the f_detail_premiums table in the TRANSACTIION_ITEMS_ID",,,,,,,,,
BR-22723,50.3 Transaction Items ID for Unearned Premiums - UNEARNED RECORD,"If Direct_Ceded_Assumed_CD = ‘D’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = ‘0’

If Direct_Ceded_Assumed_CD in (‘A’, ‘C’)
IF contr_catg_CD <> ‘0’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = contr_catg_CD

ELSE-IF Involuntary_catg_CD <> ‘0’ 
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = Involuntary_catg_CD

ELSE
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = 0

(Select * 
from lk_transaction_type
Where SOURCE_TRANSACTION_TYPE = FDW_CODE 
And SOURCE_CONTRACT_TYPE_CODE = ‘0’ 
And Source_System_Id = 10

Select * 
From lk_amount_type
Where MAJOR_SOURCE_CODE = ‘01’
And MINOR_SOURCE_CODE = ‘03’
And RECOVERY_SOURCE_CODE = ‘0’
And Source_System_Id = 10)

Then
Select TRANSACTION_ITEMS_ID 
From D_TRANSACTION_ITEMS 
Where AMOUNT_CATEGORY_1_DESC = lk.amount_category_1_desc
And AMOUNT_CATEGORY_2_DESC = lk.amount_category_2_desc
And AMOUNT_CATEGORY_3_DESC = lk.amount_category_3_desc
And AMOUNT_CATEGORY_4_DESC = lk.amount_category_4_desc
And AMOUNT_CATEGORY_5_DESC = lk.amount_category_5_desc
And REIN_TRANSACTION_TYPE_CODE = lk.rein_transaction_type_code
And SUB_SYSTEM_DESC = lk.sub_system_desc
And SOURCE_SYSTEM_ID = lk.source_system_id","ETL - F_Unearned_Premiums
ETL - D_TRANSACTION_ITEMS",,12/24/2013,moreilly,,,,,,,,,,
BR-22727,50.4 Transaction Items ID for Unearned Premiums - INFORCE RECORD,"If Direct_Ceded_Assumed_CD = ‘D’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = ‘0’

If Direct_Ceded_Assumed_CD in (‘A’, ‘C’)
IF contr_catg_CD <> ‘0’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = contr_catg_CD

ELSE-IF Involuntary_catg_CD <> ‘0’ 
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = Involuntary_catg_CD

ELSE
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = 0

(Select * 
from lk_transaction_type
Where SOURCE_TRANSACTION_TYPE = FDW_CODE 
And SOURCE_CONTRACT_TYPE_CODE = ‘0’ 
And Source_System_Id = 10

This is the data to support the “inforce” row on the unearned premium fact:
Select * 
From lk_amount_type
Where MAJOR_SOURCE_CODE = ‘01’
And MINOR_SOURCE_CODE = ‘08’
And RECOVERY_SOURCE_CODE = ‘0’
And Source_System_Id = 10)

Then
Select TRANSACTION_ITEMS_ID 
From D_TRANSACTION_ITEMS 
Where AMOUNT_CATEGORY_1_DESC = lk.amount_category_1_desc
And AMOUNT_CATEGORY_2_DESC = lk.amount_category_2_desc
And AMOUNT_CATEGORY_3_DESC = lk.amount_category_3_desc
And AMOUNT_CATEGORY_4_DESC = lk.amount_category_4_desc
And AMOUNT_CATEGORY_5_DESC = lk.amount_category_5_desc
And REIN_TRANSACTION_TYPE_CODE = lk.rein_transaction_type_code
And SUB_SYSTEM_DESC = lk.sub_system_desc
And SOURCE_SYSTEM_ID = lk.source_system_id","ETL - F_Unearned_Premiums
ETL - D_TRANSACTION_ITEMS",,12/24/2013,moreilly,,,,,,,,,,
BR-22745,50.5 Transaction Items ID for  Divisional Expense Payments,"If Direct_Ceded_Assumed_CD in (‘A’, ‘C’)
  IF contr_catg_CD <> ‘0’
    Then CONTRACT-TYPE  = contr_catg_cd  
  Else 
 IF Involuntary_catg_cd = ‘F’ 
    Then CONTRACT-TYPE = 'FACILITY'
  Else  CONTRACT-TYPE = ‘0’

If EXPENSE_PAYMENT_CATEGORY_CD = ‘A’
  Then RECOVERY-TYPE = Expense_payment_category_cd
Else RECOVERY-TYPE = ‘exppay’ 

( Select * 
from lk_transaction_type
Where SOURCE_TRANSACTION_TYPE = Direct_Ceded_Assumed_CD
Aand SOURCE_CONTRACT_TYPE_CODE = CONTRACT-TYPE
And Source_System_Id = 48

Select * 
From lk_amount_type
Where MAJOR_SOURCE_CODE = clm_fin_trans_catg_cd
And MINOR_SOURCE_CODE = loss_catg_cd
And RECOVERY_SOURCE_CODE = RECOVERY-TYPE
And Source_System_Id = 48)

Then
Select TRANSACTION_ITEMS_ID 
From D_TRANSACTION_ITEMS 
Where AMOUNT_CATEGORY_1_DESC = lk.amount_category_1_desc
And AMOUNT_CATEGORY_2_DESC = lk.amount_category_2_desc
And AMOUNT_CATEGORY_3_DESC = lk.amount_category_3_desc
And AMOUNT_CATEGORY_4_DESC = lk.amount_category_4_desc
And AMOUNT_CATEGORY_5_DESC = lk.amount_category_5_desc
And REIN_TRANSACTION_TYPE_CODE = lk.rein_transaction_type_code
And SUB_SYSTEM_DESC = lk.sub_system_desc
And SOURCE_SYSTEM_ID = lk.source_system_id ","ETL - F_Div_Expense_Payment
ETL - D_TRANSACTION_ITEMS",,12/24/2013,moreilly,,,,,,,,,,
BR-21874,51 Company ID ,,"ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - D_Claim_Hist
",,11/11/2013,dzieverink,"The Company Data in EDW is considered Factory Party Data.  In those instances where the data is supported from a UWD, the GUI will collect & pass the company.  EDW will store the company as a Party with the Role of Legal Entity at the policy level",,,,,,,,,
BR-22813,51.1 Company ID Associated with the Financial Transaction,"An Insurance company must be associated to all financial transactions

Select COMPANY_ID
From D_COMPANY
Where COMPANY_CODE = LE_org_cd","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
",,6/22/2015,jjordan,"The intent of this rule is to assign the EDW party with a role of legal entity to the financial transaction
",,,,,,,,,
BR-22814,51.2 Company ID Associated with Claim History,"Select COMPANY_ID
From D_Company
Where org_cd = C.Company_Code",ETL - D_Claim_Hist,,6/22/2015,jjordan,,,,,,,,,,
BR-21875,52 Commission Transaction ID,"(Select * 
from lk_transaction_type
Where SOURCE_TRANSACTION_TYPE = FDW_CODE 
And SOURCE_CONTRACT_TYPE_CODE = ‘0’ 
And SOURCE_SYSTEM_ID = source-system-id

Select * 
From lk_amount_type
Where MAJOR_SOURCE_CODE = ‘01’
And MINOR_SOURCE_CODE = ‘04’
And RECOVERY_SOURCE_CODE = ‘0’
And SOURCE_SYSTEM_ID = source-system-id)

Then
Select TRANSACTION_ITEMS_ID 
From D_TRANSACTION_ITEMS 
Where AMOUNT_CATEGORY_1_DESC = lk.amount_category_1_desc
And AMOUNT_CATEGORY_2_DESC = lk.amount_category_2_desc
And AMOUNT_CATEGORY_3_DESC = lk.amount_category_3_desc
And AMOUNT_CATEGORY_4_DESC = lk.amount_category_4_desc
And AMOUNT_CATEGORY_5_DESC = lk.amount_category_5_desc
And REIN_TRANSACTION_TYPE_CODE = lk.rein_transaction_type_code
And SUB_SYSTEM_DESC = lk.sub_system_desc
And SOURCE_SYSTEM_ID = lk.source_system_id","ETL - F_Divisional_Premiums
",,6/22/2015,jjordan,"The intent of this rule is to define the data values required to access the Commission Transaction table, and bring back the correct Commission Transaction ID to store on the f_divisional_premiums in the COMMISSION_TRANSACTION_ID


Utilize Existing Lookup tables
LK_TRANSACTION TYPE
LK_AMOUNT_TYPE
D_TRANSACTION_ITEMS
D_SOURCE_SYSTEM
",,,,,,,,,
BR-21876,53 Policy ID,,"ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - A_Divisional_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - D_Claim_Hist",,6/22/2015,jjordan,"The intent of this rule is to define the data values required to access the Policy table, and bring back the correct Policy ID to store on the f_divisional_premiums in the POLICY_ID column
",,,,,,,,,
BR-22807,53.1 Policy ID Associated with the Financial Transaction,"Select POLICY_ID
From D_POLICY
Where POLICY_NUMBER = Pol_No_Cd
And POLICY_EFFECTIVE_DATE = Pol_Term_Eff_Dt
And PRODUCER = Producer
And POLICY_VERSION_CD = pol_version_cd","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - A_Divisional_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses",,6/22/2015,jjordan,,,,,,,,,,
BR-22806,53.2 Policy ID Associated with the Claim History,"Select POLICY_ID
From D_POLICY
Where POL_NO_CD = P.Policy_Number
And MGMT_CD = P.Producer_B_Code
And POL_TERM_EFF_DT = P.Policy_Effective_Date",ETL - D_Claim_Hist,,9/30/2013,dzieverink,,,,,,,,,,
BR-21877,54 Product Value,"Look-up tables, aliases, and source of tables used in determining the Product Value:
LK   = LK_MINOR_LINE_XREF  (Maintenance Center)
LK1 = LK_PV_1_8_MAIN_CD_XREF (.csv file in FTP folder)
LK2 = LK_PV_1_2_CVRG_CD_XREF  (Maintenance Center)
LK3 = LK_PV_3_8_REF_CD_XREF (.csv file in FTP folder)
LK4 = LK_PV_4_CLASS_CD_XREF (.csv file in FTP folder file)
LK5 = LK_PV_5_6_NAICS_CD_XREF (.csv file in FTP folder file)
LK6 = LK_PV_3_8_REF_CD_XREF (.csv file in FTP folder file)
LK7 = LK_INSUR_AGREEMENT_XREF (.csv file in FTP folder file)
LK8 = LK_PV_7_8_CLASS_CD_XREF (.csv file in FTP folder file)
","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums
ETL - Product_Value_Assignment
ETL - F_Div_OS_Reserve
",,6/22/2015,jjordan,"Prior to accessing the lookup tables the process to assign the product value must first determine if the coverage has a parent or is part of a coverage family.  Once determined, data can retrieved to assign the correct product value.

The intent of this rule is to define the appropriate data values required to access the product value table and bring back the correct Product Value ID and Product Value 1-8 ID to store on the f_divisional_premiums table.  The 8 digit product value code in entered with the policy to define the product from a legacy perspective. Whereas risk, coverage code, policy symbol, parent coverage code, cause of loss, naics code, class code from the EDW are used to determine the product value code from the multiple lookup tables.

PRODUCT_VALUE_ID
PRODUCT_VALUE_1_8_ID

1/16/14 sconley: Added look-up table info in the Detailed Rule Text.",,,,,,,,,
BR-23270,54.1 Determine Coverage Family or Coverage Parent,"In order to determine the appropriate product value, the Coverage Family or Coverage Parent must be determined.  This is accomplished by accessing the appropriate coverage data in the EDW.  In order to correctly access the data in the coverage relationship table, the process must get the active relationship rows by filtering out any rows with an Action Code of ""D""",,,3/26/2015,moreilly,,,,,,,,,,
BR-22855,54.2 Product Value Associated with the Financial Transaction,"Call routine for retrieving the 
product-value-1-8-cd and product-value-id-1-2 from lk_pv_1_2_cvrg_cd_xref, lk_pv_1_8_main_cd_xref, lk_pv_4_class_cd_xref, lk_5_6_naics_cd_xref, lk_insur_agreement_xref  (mp_product_value_assign_edw_xref)

Select PRODUCT_VALUE_ID
From D_PRODUCT_VALUE
Where PRODUCT_VALUE_ID_1_2 = product-value-1-2-cd
And PRODUCT_VALUE_ID_3_8 is null

Then 
  Select PRODUCT_VALUE_ID
  From D_PRODUCT_VALUE
  Where PRODUCT_VALUE_1_8_CODE = product-value-1-8-cd 

Concatenate the product value codes into 8 bytes:
(T.PV_1_2_CD||T.PV_3_CD||T.PV_4_CD||T.PV_5_6_CD|| T.PV_7_CD||T.PV_8_CD) PRODUCT-VALUE","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums
ETL - Product_Value_Assignment
ETL - F_Div_OS_Reserve
",,12/24/2013,moreilly,"PRODUCT_VALUE_ID
PRODUCT_VALUE_1_8_ID",,,,,,,,,
BR-22666,54.3 Cause of Loss Code,"If SUBLINE_CD = ‘116’
     Then ws.CAUSE_OF_LOSS_CD = ‘BASIC’
    Else-If SUBLINE_CD = ‘156’
     Then ws.CAUSE_OF_LOSS_CD = ‘BROAD’
    Else-If SUBLINE_CD = ‘136’
     Then ws.CAUSE_OF_LOSS_CD = ‘SPECIAL’
  Else ‘NONE’","ETL - F_Divisional_Premiums
ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums
ETL - Product_Value_Assignment",,1/22/2018,mmconley,1/22/18 sconley: Confirmed rule in Informatica,,,,,,,,,
BR-22667,54.4 Product Value Position 1-2 Cross Reference,"/* AGRI Sublines, CAUSE_OF_LOSS_CD derived in ws (working storage) BR-22666 */
When  SUBLINE_CD IN ( '116', '136', '156')
Select  LK2.CVRG_GROUP
           ,LK2.PV_3_CD
           ,LK2.PV_4_CD
           ,LK2.PV_5_6_CD
           ,LK2.PV_7_CD
           ,LK2_PV_8_CD 
From LK_PV_1_2_CVRG_CD_XREF LK2
Where 
        LK2.RISK_CATG_CD = VW_RISK.RISK_CATG_CD
And LK2.CVRG_CD = VW_COVERAGE.CVRG_CD
And LK2.POLICY_SYMBOL = VW_POL_TERM_HIST.POL_SYMBOL
And LK2.CAUSE_OF_LOSS_CD = ws.CAUSE_OF_LOSS_CD
And LK2.STAT_PACKAGE_IND = VW_POL_TERM_HIST.PACKAGE_IND
And LK2.CLAIMS_MADE_IND = VW_CVRG_HIST.CLAIMS_MADE_IND
And LK2.PARENT_BUSN_CVRG_CD = VW_COVERAGE.CVRG_CD (of parent coverage)
And LK2.WIND_EXCL_IND = VW_RISK_HIST. WIND_EXCL_IND
And LK2.THEFT_EXCL_IND = VW_RISK_HIST. THEFT_EXCL_IND
And LK2.VANDALISM_EXCL_IND = VW_RISK_HIST. VANDALISM_EXCL_IND
And LK2.SPRINKLER_LEAKAGE_EXCL_IND = VW_RISK_HIST. SPRINKLER_LEAKAGE_EXCL_IND
EXIT

/* AGRI sublines, CAUSE_OF_LOSS_CD = 'ANY' */
When  SUBLINE_CD IN ( '116', '136', '156')
Select  LK2.CVRG_GROUP
           ,LK2.PV_3_CD
           ,LK2.PV_4_CD
           ,LK2.PV_5_6_CD
           ,LK2.PV_7_CD
           ,LK2_PV_8_CD 
From LK_PV_1_2_CVRG_CD_XREF LK2
Where 
        LK2.RISK_CATG_CD = VW_RISK.RISK_CATG_CD
And LK2.CVRG_CD = VW_COVERAGE.CVRG_CD
And LK2.POLICY_SYMBOL = VW_POL_TERM_HIST.POL_SYMBOL
And LK2.CAUSE_OF_LOSS_CD = ' ANY'
And LK2.STAT_PACKAGE_IND = VW_POL_TERM_HIST.PACKAGE_IND
And LK2.CLAIMS_MADE_IND = VW_CVRG_HIST.CLAIMS_MADE_IND
And LK2.PARENT_BUSN_CVRG_CD = VW_COVERAGE.CVRG_CD (of parent coverage)
And LK2.WIND_EXCL_IND = VW_RISK_HIST. WIND_EXCL_IND
And LK2.THEFT_EXCL_IND = VW_RISK_HIST. THEFT_EXCL_IND
And LK2.VANDALISM_EXCL_IND = VW_RISK_HIST. VANDALISM_EXCL_IND
And LK2.SPRINKLER_LEAKAGE_EXCL_IND = VW_RISK_HIST. SPRINKLER_LEAKAGE_EXCL_IND
EXIT

/* Match on POLICY_SYMBOL, CAUSE_OF_LOSS_CD in ('ANY', 'NONE') */
Select  LK2.CVRG_GROUP
           ,LK2.PV_3_CD
           ,LK2.PV_4_CD
           ,LK2.PV_5_6_CD
           ,LK2.PV_7_CD
           ,LK2_PV_8_CD 
From LK_PV_1_2_CVRG_CD_XREF LK2
Where 
        LK2.RISK_CATG_CD = VW_RISK.RISK_CATG_CD
And LK2.CVRG_CD = VW_COVERAGE.CVRG_CD
And LK2.POLICY_SYMBOL = VW_POL_TERM_HIST.POL_SYMBOL
And LK2.CAUSE_OF_LOSS_CD in ('ANY', 'NONE')
And LK2.STAT_PACKAGE_IND = VW_POL_TERM_HIST.PACKAGE_IND
And LK2.CLAIMS_MADE_IND = VW_CVRG_HIST.CLAIMS_MADE_IND
And LK2.PARENT_BUSN_CVRG_CD = VW_COVERAGE.CVRG_CD (of parent coverage)
And LK2.WIND_EXCL_IND = VW_RISK_HIST. WIND_EXCL_IND
And LK2.THEFT_EXCL_IND = VW_RISK_HIST. THEFT_EXCL_IND
And LK2.VANDALISM_EXCL_IND = VW_RISK_HIST. VANDALISM_EXCL_IND
And LK2.SPRINKLER_LEAKAGE_EXCL_IND = VW_RISK_HIST. SPRINKLER_LEAKAGE_EXCL_IND
EXIT

/* POLICY_SYMBOL = 'ANY', CAUSE_OF_LOSS not specified */
Select  LK2.CVRG_GROUP
           ,LK2.PV_3_CD
           ,LK2.PV_4_CD
           ,LK2.PV_5_6_CD
           ,LK2.PV_7_CD
           ,LK2_PV_8_CD 
From LK_PV_1_2_CVRG_CD_XREF LK2
Where 
        LK2.RISK_CATG_CD = VW_RISK.RISK_CATG_CD
And LK2.CVRG_CD = VW_COVERAGE.CVRG_CD
And LK2.POLICY_SYMBOL = 'ANY'
And LK2.STAT_PACKAGE_IND = VW_POL_TERM_HIST.PACKAGE_IND
And LK2.CLAIMS_MADE_IND = VW_CVRG_HIST.CLAIMS_MADE_IND
And LK2.PARENT_BUSN_CVRG_CD = VW_COVERAGE.CVRG_CD (of parent coverage)
And LK2.WIND_EXCL_IND = VW_RISK_HIST. WIND_EXCL_IND
And LK2.THEFT_EXCL_IND = VW_RISK_HIST. THEFT_EXCL_IND
And LK2.VANDALISM_EXCL_IND = VW_RISK_HIST. VANDALISM_EXCL_IND
And LK2.SPRINKLER_LEAKAGE_EXCL_IND = VW_RISK_HIST. SPRINKLER_LEAKAGE_EXCL_IND
EXIT
","ETL - F_Divisional_Premiums
ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums
ETL - Product_Value_Assignment","sconley 1/23/18: ENTERPRISE.Data_Platform 1123 Added 4 new indicators to PV look-up for ISO Property (VANDALISM_EXCL_IND, SPRINKLER_EXCL_IND, WIND_EXCL_IND, THEFT_EXCL_IND) (JIRA DP-6705 & DP-6923).  The work was completed in 03/2017.",1/23/2018,mmconley,"sconley 9/3/14: Bolded the look-up table.

sconley 1/23/18: Reformatted rule and updated Where clauses to add 4 indicators for ISO Property and missing Parent coverage code. The indicators are coverages that are converted to indicators in the EDW Adaptor (EDW BR 849 Create Exclusion Indicators in EDW for ISO Property (BR-1197)) and put in EDW.VW_RISK_HIST.

The selected CVRG_GROUP is needed for the look-up to LK_PV_1_8_MAIN_CD_XREF, which gets PV 1_2.  Any or all of PV positions 3-8 may be populated (meaning they are populated in Maintenance Center).  If they are popuated, those fields can be NULL on LK_PV_1_8_MAIN_CD_XREF.",,,,,,,,,
BR-22668,54.5 Product Value Position 1-8 Cross Reference,"/* Match on POLICY_SYMBOL */
Select  LK1.PV_1_2_CD
           ,LK1.PV_3_CD
           ,LK1.PV_4_CD
           ,LK1.PV_5_6_CD
           ,LK1.PV_7_CD
           ,LK1_PV_8_CD 
From LK_PV_1_8_MAIN_CD_XREF LK1
Where 
        LK1.CVRG_GROUP = LK2.CVRG_GROUP
And LK1.POLICY_SYMBOL = VW_POL_TERM_HIST.POL_SYMBOL
And LK1.STAT_PACKAGE_IND = VW_POL_TERM_HIST.PACKAGE_IND
And LK1.CLAIMS_MADE_IND = VW_CVRG_HIST.CLAIMS_MADE_IND
And LK1.WIND_EXCL_IND = VW_RISK_HIST. WIND_EXCL_IND
And LK1.THEFT_EXCL_IND = VW_RISK_HIST. THEFT_EXCL_IND
And LK1.VANDALISM_EXCL_IND = VW_RISK_HIST. VANDALISM_EXCL_IND
And LK1.SPRINKLER_LEAKAGE_EXCL_IND = VW_RISK_HIST. SPRINKLER_LEAKAGE_EXCL_IND
EXIT

/* POLICY_SYMBOL = 'ANY' */
Select  LK1.CVRG_GROUP
           ,LK1.PV_3_CD
           ,LK1.PV_4_CD
           ,LK1.PV_5_6_CD
           ,LK1.PV_7_CD
           ,LK1_PV_8_CD 
From LK_PV_1_8_MAIN_CD_XREF LK1
Where 
        LK1.CVRG_GROUP = LK2.CVRG_GROUP
And LK1.POLICY_SYMBOL = 'ANY'
And LK1.STAT_PACKAGE_IND = VW_POL_TERM_HIST.PACKAGE_IND
And LK1.CLAIMS_MADE_IND = VW_CVRG_HIST.CLAIMS_MADE_IND
And LK1.WIND_EXCL_IND = VW_RISK_HIST. WIND_EXCL_IND
And LK1.THEFT_EXCL_IND = VW_RISK_HIST. THEFT_EXCL_IND
And LK1.VANDALISM_EXCL_IND = VW_RISK_HIST. VANDALISM_EXCL_IND
And LK1.SPRINKLER_LEAKAGE_EXCL_IND = VW_RISK_HIST. SPRINKLER_LEAKAGE_EXCL_IND
EXIT
","ETL - F_Divisional_Premiums
ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums
ETL - Product_Value_Assignment
ETL - LK_Governing_PV_State",,1/23/2018,mmconley,"sconley 1/23/18: Reformatted rule and updated Where clauses to add 4 indicators for ISO Property and missing package_ind and claims_made_ind. The ISO Property indicators are coverages that are converted to indicators in the EDW Adaptor (EDW BR 849 Create Exclusion Indicators in EDW for ISO Property (BR-1197)) and put in EDW.VW_RISK_HIST.

The input CVRG_GROUP is selected from LK_PV_1_2_CVRG_CD_XREF. 
-LK_PV_1_8_MAIN_CD_XREF sets PV_1_2.
-If any or all of PV positions 3-8 are NOT populated, they should be populated LK_PV_1_2_CVRG_CD_XREF (meaning they are populated in Maintenance Center).  
-If they are popuated with values, those are the values for that positon.
-If they are populated with a term, then there are additional look-ups or rules for that position to derive Product Value. ",,,,,,,,,
BR-22669,54.6 Product Value Position 3-8 Cross Reference,"If LK2.PV_3_CD is not null  
     Then LK2.PV_3_CD
Else-If LK1.PV_3_CD = ‘ORG_CD’
  Then 
    Select LK3.PV_3_8_CD 
    From LK_PV_3_8_REF_CD_XREF LK3
    Where LK3.REF_LIST_CD = ‘ORG_CD’
    And  LK3.ITEM_CD = VW.ORG_CD
Else-If LK1.PV_3_CD = ‘PRODUCT_TYPE’
  Then 
    Select LK3.PV_3_8_CD 
    From LK_PV_3_8_REF_CD_XREF LK3
    Where LK3.REF_LIST_CD = ‘PRODUCT_TYPE’
    And  LK3.ITEM_CD = VW_POL_TERM_HIST.PROD_LINE_CD

  Else 
      LK1.PV_3_CD
",ETL - Product_Value_Assignment,,7/18/2013,moreilly,,,,,,,,,,
BR-22670,54.7 Product Value Position 4 Cross Reference,"If LK2.PV_4_CD is not null  
     Then LK2.PV_4_CD
 Else
 If LK1.PV_4_CD not in (‘CLASS_CD’)
    Then  LK1.PV_4_CD
Else 
  If LK1.PV_4_CD = ‘CLASS_CD’
    Then 
     Select LK4.PV_4_CD 
      From LK_PV_4_CLASS_CD_XREF LK4
      Where LK4.CLASS_CD = VW.RATE_CLASS_CD
   If not found 
    Then
      Select LK4.PV_4_CD 
      From LK_PV_4_CLASS_CD_XREF LK4
      Where LK4.CLASS_CD (pos. 6) = ‘X’
      And  LK4.CLASS_CD (pos. 1-5) = VW.RATE_CLASS_CD (pos. 1-5)
  
    If not found 
      Then
      Select LK4.PV_4_CD 
      From LK_PV_4_CLASS_CD_XREF LK4
      Where LK4.CLASS_CD (pos. 5-6) = ‘XX’
      And  LK4.CLASS_CD (pos. 1-4) = VW.RATE_CLASS_CD (pos. 1-4)
     
      If not found 
      Then
       Select LK4.PV_4_CD 
       From LK_PV_4_CLASS_CD_XREF LK4
       Where LK4.CLASS_CD (pos. 4-6) = ‘XXX’
       And  LK4.CLASS_CD (pos. 1-3) = VW.RATE_CLASS_CD (pos. 1-3)
ELSE T.PV_4_CD = ‘9’

","ETL - F_Divisional_Premiums
ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums
ETL - Product_Value_Assignment",,7/18/2013,moreilly,,,,,,,,,,
BR-22671,54.8 Product Value Position 5-6 Cross Reference,"If LK2.PV_5_6_CD is not null  
 Then LK2.PV_5_6_CD
Else
   If LK1.PV_5_6_CD = ‘TYPE_OF_FARM’
   Then
    If VW.PRIMARY_FARM_CATG_CD is not null
     Then 
      (Select LK6.PV_3_8_CD 
       From LK_PV_3_8_REF_CD_XREF LK6
       Where LK6.REF_LIST_CD = ‘TYPE_OF_FARM’  
       And  LK6.ITEM_CD = VW.PRIMARY_FARM_CATG_CD)
     Else (‘AA’)
   Else
    If LK1.PV_5_6_CD = ‘NAICS_CD’
        Then 
           (Select LK5.PV_5_6_CD 
           From LK_PV_5_6_NAICS_CD_XREF LK5 
           Where LK5.NAICS_CD = VW.NAICS_CD)
    ELSE    
       IF LK1.PV_5_6_CD = ‘INSUR_AGREEMENT’
         Then
             Select LK7.PV_5_6_VALUE 
               From LK_INSUR_AGREEMENT_XREF LK7
               Where LK7.PARENT_COVERAGE_CODE  =  PARENT_CVRG_CD
                 And LK7.COVERAGE_CODE = CVRG_CD 
                 And LK7.FI_FORM = SFAA_FIN_INSTITUTION_FORM_CD
               If not found
               Select LK7.PV_5_6_VALUE 
               From LK_INSUR_AGREEMENT_XREF LK7
               Where LK7.PARENT_COVERAGE_CODE  =  PARENT_CVRG_CD
                 And LK7.COVERAGE_CODE = ‘ANY’
                 And LK7.FI_FORM = SFAA_FIN_INSTITUTION_FORM_CD
          else
              T.PV_5_6_CD = ‘3U’
   
   Else LK1.PV_5_6_CD
",ETL - Product_Value_Assignment,,11/25/2013,jjordan,,,,,,,,,,
BR-22664,54.9 Product Value Position 7 Cross Reference,"When Coverage Group = ‘DIROFF’;
Policy Symbol = ‘SDO’;
LK1.PV_1_2_CD = ‘40’;
Class Code = ‘01219’
     Set PV7 = ‘D’;
     EXIT

When Coverage Group = ‘DIROFF’;
Policy Symbol = ‘SDO’;
LK1.PV_1_2_CD = ‘40’;
Class Code = ‘01220’
     Set PV7 = ‘E’;
     EXIT

When Coverage Group = ‘DIROFF’;
Policy Symbol = ‘SDO’;
LK1.PV_1_2_CD = ‘40’;
Class Code = ‘01221’
     Set PV7 = ‘F’;
     EXIT

When Coverage Group = ‘DIROFF’;
Policy Symbol = ‘SDO’;
LK1.PV_1_2_CD = ‘40’;
Class Code = ‘01222’
     Set PV7 = ‘G’;
     EXIT

When Coverage Group = ‘DIROFF’;
Policy Symbol = ‘SDO’;
LK1.PV_1_2_CD = ‘40’;
Class Code = ‘01223’
     Set PV7 = ‘Z’;
     EXIT

When Coverage Group in ('CFS','CFS1',’ELDCR’,’ELDCR2’);
Discovery Indicator = 1;
Discovery Period Days No <= 59;
    Set PV7 = ‘A’;
    EXIT

When Coverage Group in ('CFS','CFS1',,’ELDCR’,’ELDCR2’);
Discovery Indicator = 1;
Discovery Period Days No = 60;
    Set PV7 = ‘B’;
    EXIT

When Coverage Group in ('CFS','CFS1',,’ELDCR’,’ELDCR2’);
Discovery Indicator = 1;
Discovery Period Days No > 60;
    Set PV7 = ‘C’;
    EXIT

When Coverage Group in ('CFS','CFS1',,’ELDCR’,’ELDCR2’);
Discovery Period Days No <= 59;
    Set PV7 = ‘D’;
    EXIT

When Coverage Group in ('CFS','CFS1',,’ELDCR’,’ELDCR2’);
Discovery Period Days No = 60;
    Set PV7 = ‘E’;
    EXIT

When Coverage Group in ('CFS','CFS1',,’ELDCR’,’ELDCR2’);
Discovery Period Days No >= 61;
Discovery Period Days No <= 364;
    Set PV7 = ‘F’;
    EXIT

When Coverage Group in ('CFS','CFS1',,’ELDCR’,’ELDCR2’);
Discovery Period Days No > 364;
    Set PV7 = ‘G’;
    EXIT

When Coverage Group in ('ESGL','ESGL1');
LK2.PV_7_CD IS NULL;
LK1.PV_1_2_CD = ‘40’;
Minor Line Code = ‘484’;
RS_FIPS_US_ALPHA_CD <> ‘TX’
    Set PV7 = ‘A’;
    EXIT

When Coverage Group in ('ESGL','ESGL1');
LK2.PV_7_CD IS NULL;
LK1.PV_1_2_CD = ‘40’;
Minor Line Code = ‘484’;
RS_FIPS_US_ALPHA_CD = ‘TX’
    Set PV7 = ‘B’;
    EXIT

When Coverage Group in ('ESGL','ESGL1');
LK2.PV_7_CD IS NULL;
LK1.PV_1_2_CD = ‘40’;
Minor Line Code <> ‘484’;
RS_FIPS_US_ALPHA_CD <> ‘TX’
    Set PV7 = ‘J’;
    EXIT

When Coverage Group in ('ESGL','ESGL1');
LK2.PV_7_CD IS NULL;
LK1.PV_1_2_CD = ‘40’;
Minor Line Code <>‘484’;
RS_FIPS_US_ALPHA_CD = ‘TX’
    Set PV7 = ‘K’;
    EXIT
                                        
When Coverage Group in ('ESGL','ESGL1');
LK2.PV_7_CD IS NULL;
LK1.PV_1_2_CD = ‘43’;
Minor Line Code = ‘486’;
RS_FIPS_US_ALPHA_CD <> ‘TX’
    Set PV7 = ‘D’;
    EXIT
                                        
When Coverage Group in ('ESGL','ESGL1');
LK2.PV_7_CD IS NULL;
LK1.PV_1_2_CD = ‘43’;
Minor Line Code = ‘486’;
RS_FIPS_US_ALPHA_CD = ‘TX’
    Set PV7 = ‘E’;
    EXIT
                          
When Coverage Group in ('ESGL','ESGL1');
LK2.PV_7_CD IS NULL;
LK1.PV_1_2_CD = ‘43’;
Minor Line Code <> ‘486’;’
    Set PV7 = ‘D’;
    EXIT

When Coverage Group in ('CFS4','MTC');
LK1.PV_7_CD = ‘CLASS_CD’;
LK8.MINOR_LINE_CD = Minor Line Code
LK8.BEGIN_CLASS_CD <= Class Code
LK8.END_CLASS_CD >= Class Code
    Set PV7||PV8 = LK8.PV_7_8_CD
    EXIT

When LK2.PV_7_CD IS NOT NULL;
    Set PV7 = LK2.PV_7_CD;
    EXIT

Set PV7 = LK1.PV_7_CD;

","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums
ETL - Product_Value_Assignment
","AFG.mySurety_Intg 2; FDW: Update to Business Rules for Product Value Pos. 7 & 8

AFG.mySurety_Intg 3; ADW: Update to Business Rules for Product Value Pos. 7 & 8

Enterprise.FDW_Core 7511; FDW: Update to Business Rules for Product Value Pos. 7 & 8 to add coverage group for Motor Truck Cargo to the part of the rule that does a look-up by minor line code and class code (LK8).

Enterprise.FDW_Core 7512; ADW: Update to Business Rules for Product Value Pos. 7 & 8 to add coverage group for Motor Truck Cargo to the part of the rule that does a look-up by minor line code and class code (LK8).

DP-5424 Update to business rule for SHS D & O to set position 7 of product value based on coverage code, policy symbol and PV1_2 value and class code.
",11/4/2016,dburns4,"The intent of this rule is to set position 7 of the product value or positions 7-8 of the product value for mySurety Surety coverages in coverage group CFS4.

For general liability coverages in coverage group ESGL or ESGL1, using product value positions 1 and 2, minor line, and state code.

For FIDCRIME and mySurety Fidelity coverages in coverage group CFS or CFS1, using claims made indicator, and the basic extended reporting period number.

For mySurety Surety coverages in coverage group CFS4 and Motor Truck Cargo coverages in coverage group MTC, using minor line code and class code go to LK_PV_7_8_CLASS_CD_XREF (alias LK8) table to set positions 7 and 8 of the product value.

LK1 = LK_PV_1_8_MAIN_CD_XREF
LK2 = LK_PV_1_2_CVRG_CD_XREF
LK8 = LK_PV_7_8_CLASS_CD_XREF

1/14/14 sconley:  Reformatted business rule to match Informatica code.  Revision reviewed by knienaber.

6/16/15 sconley:  No change to the business rule.  However the Manual Issuance projects (including PIM MTC & CE) have revised the Inland Marine coverage matrix to put all miscellaneous coverages (non T&S)  under risk IMOPS and make the coverage group MTC.  The rate classes for Inland Marine that are part of Manual Issuance have been added to table LK_PV_7_8_CLASS_CD_XREF.  
T&S under risk IMOPS are in coverage group MTC1.

1/26/16 sconley:  No change to the business rule.  Updated LK_PV_7_8_CLASS_CD_XREF for Bonds (minor lines 965 & 969) with data provided by Clayton Smith.

11/4/16 dburns:  Update business rule to set product value 7th position for SHS D & O based on coverage code = DIROFF with policy symbol = SDO, PV1_2 = 40 and then depending on class code.
",,,,,,,,,
BR-22672,54.10 Product Value Position 8 Cross Reference,"Calculate Total Number of Employees (values are calculated during processing)

When Foreign Employee Count IS NOT NULL;
    Set var_FOREIGN_EMPLOYEE_CNT = Foreign Employee Count

When Foreign Employee Count IS NULL;
    Set var_FOREIGN_EMPLOYEE_CNT = 0

When Domestic Employee Count IS NOT NULL;
    Set var_DOMESTIC_EMPLOYEE_CNT = Domestic Employee Count

When Domestic Employee Count IS NULL;
    Set var_DOMESTIC_EMPLOYEE_CNT = 0
    EXIT

When var_FOREIGN_EMPLOYEE_CNT + var_DOMESTIC_EMPLOYEE_CNT  < 99999
   Set TOTAL_NO_OF_EMPLOYEES = var_FOREIGN_EMPLOYEE_CNT + var_DOMESTIC_EMPLOYEE_CNT  

When var_FOREIGN_EMPLOYEE_CNT + var_DOMESTIC_EMPLOYEE_CNT  >= 99999
   Set TOTAL_NO_OF_EMPLOYEES = 99999  

TOTAL_EMPLOYEE_CNT = TOTAL_NO_OF_EMPLOYEES

Set Position 8 of the Product Value

/* For CFS4, pos. 7 & 8 are determined as part of BR-22664 Product Value Position 7 Cross Reference.  It there is not a match then pos. 7 & 8 will not be populated, which indicates there is a rule or data issue.
*/
When Coverage Group = 'CFS4';   
    EXIT

When Coverage Group in ('CFS','CFS1',’ELDCR’,’ELDCR2’);
TOTAL_EMPLOYEE_CNT <= 15;
    Set PV8 = ‘1’;
    EXIT

When Coverage Group in ('CFS','CFS1',’ELDCR’,’ELDCR2’);
TOTAL_EMPLOYEE_CNT >= 16 and TOTAL_EMPLOYEE_CNT <= 100;
    Set PV8 = ‘2’;
    EXIT

When Coverage Group in ('CFS','CFS1',’ELDCR’,’ELDCR2’);
TOTAL_EMPLOYEE_CNT >= 101 and TOTAL_EMPLOYEE_CNT <= 500;
    Set PV8 = ‘3’;
    EXIT

When Coverage Group in ('CFS','CFS1',’ELDCR’,’ELDCR2’);
TOTAL_EMPLOYEE_CNT >= 501 and TOTAL_EMPLOYEE_CNT <= 1000;
    Set PV8 = ‘4’;
    EXIT

When Coverage Group in ('CFS','CFS1',’ELDCR’,’ELDCR2’);
TOTAL_EMPLOYEE_CNT >= 1001 and TOTAL_EMPLOYEE_CNT <= 2500;
    Set PV8 = ‘5’;
    EXIT

When Coverage Group in ('CFS','CFS1',’ELDCR’,’ELDCR2’);
TOTAL_EMPLOYEE_CNT >= 2501 and TOTAL_EMPLOYEE_CNT <= 5000;
    Set PV8 = ‘6’;
    EXIT

When Coverage Group in ('CFS','CFS1',’ELDCR’,’ELDCR2’);
TOTAL_EMPLOYEE_CNT >= 5001 and TOTAL_EMPLOYEE_CNT <= 7500;
    Set PV8 = ‘7’;
    EXIT

When Coverage Group in ('CFS','CFS1',’ELDCR’,’ELDCR2’);
TOTAL_EMPLOYEE_CNT >= 7501 and TOTAL_EMPLOYEE_CNT <= 10000;
    Set PV8 = ‘8’;
    EXIT

When Coverage Group in ('CFS','CFS1',’ELDCR’,’ELDCR2’);
TOTAL_EMPLOYEE_CNT >= 10001; 
    Set PV8 = ‘9’;
    EXIT

When LK2.PV_7_CD IS NOT NULL;
    Set PV8 = LK2.PV_8_CD;
    EXIT

Set PV8 = LK1.PV_8_CD;


","ETL - F_Divisional_Premiums
ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums
ETL - Product_Value_Assignment","AFG.mySurety_Intg 2; FDW: Update to Business Rules for Product Value Pos. 7 & 8

AFG.mySurety_Intg 3; ADW: Update to Business Rules for Product Value Pos. 7 & 8",6/22/2015,jjordan,"The intent of this rule is to set position 8 of the product value.

Sum the foreign employee count and domestic employee count to get the total employee count.

For FIDCRIME and mySurety Fidelity coverages in coverage group CFS or CFS1, using the total employee count.

For mySurety Surety coverages in coverage group CFS4, positions 7 and 8 are determined as part of BR-22664 Product Value Position 7 Cross Reference.

LK1 = LK_PV_1_8_MAIN_CD_XREF
LK2 = LK_PV_1_2_CVRG_CD_XREF


1/14/14 sconley:  Reformatted business rule to match Informatica code.  Revision reviewed by knienaber.

1/16/14 sconley: Corrected:
TOTAL_EMPLOYEE_CNT >= 10001; 
    Set PV8 = ‘9’;",,,,,,,,,
BR-22746,54.11 Product Value ID for Expense Payments,"Call routine for retrieving the 
product-value-1-8-cd and product-value-id-1-2 from lk_pv_1_2_cvrg_cd_xref, lk_pv_1_8_main_cd_xref, lk_pv_4_class_cd_xref, lk_5_6_naics_cd_xref (mp_product_value_assign_edw_xref)

If previously_converted_ind = 1
   And pol_symbol_cd = ‘AMP’
     Then product-value-1-8-cd = ‘2626AA29’
Else 
 If previously_converted_ind = 1
   And pol_symbol_cd <> ‘AMP’
 Then 
 (Select  MINOR_LINE_CD
 From LK_MINOR_LINE_PKG_XREF LK
 Where LK.CVRG_CD = cvrg_cd
  And LK.POLICY_SYMBOL = Pol_symbol_cd
  And LK.RISK_CATG_CD = risk_catg_cd
  And LK.CVRG_CATG_CD = cvrg_catg_cd
  And LK.STAT_PACKAGE_IND = package_ind
  And LK.CLAIMS_MADE_IND = claims_made_ind)

If MINOR_LINE_CD = 180 and FIPS_US_ALPHA_CODE = TX ser MINOR_LINE_CD = 170.


 Select PRODUCT_VALUE_1_8_ID,
           PRODUCT_VALUE_ID
 From A_POLICY_CONV
 Where POLICY_NUMBER = Pol_No_Cd
  And POLICY_EFFECTIVE_DATE = Pol_Term_Eff_Dt
  And POLICY_VERSION_CD = Pol_version_cd
  And POLICY_MODULE = Pol_module_cd
  And POLICY_SYMBOL = Pol_symbol_cd
  And PRODUCER_B_CODE = Producer
  And COMPANY_CODE = LE_org_cd
  And CLASS_CODE = rate_class_cd
  And FIPS_US_ALPHA_CODE = rs_fips_us_alpha_cd
  And MINOR_LINE_CODE = Minor_line_cd      

If there is no match then use key below

Select PRODUCT_VALUE_1_8_ID,
           PRODUCT_VALUE_ID
   From A_POLICY_CONV
   Where POLICY_NUMBER = Pol_No_Cd
    And POLICY_EFFECTIVE_DATE = Pol_Term_Eff_Dt
    And POLICY_VERSION_CD = Pol_version_cd
    And POLICY_MODULE = Pol_module_cd
    And POLICY_SYMBOL = Pol_symbol_cd
    And PRODUCER_B_CODE = Producer
    And COMPANY_CODE = LE_org_cd
    And CLASS_CODE = rate_class_cd
    And FIPS_US_ALPHA_CODE = rs_fips_us_alpha_cd

If is NULL
  Then reject the row
Else
  Select PRODUCT_VALUE_ID
  From D_PRODUCT_VALUE
  Where PRODUCT_VALUE_ID_1_2 = product-value-1-2-cd
  And PRODUCT_VALUE_ID_3_8 is null","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
",,9/18/2013,moreilly,,,,,,,,,,
BR-22747,54.12 Product Value Position 1-8 ID for Expense Payments," Select PRODUCT_VALUE_ID
  From D_PRODUCT_VALUE
  Where PRODUCT_VALUE_1_8_CODE = product-value-1-8-cd ","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
",,9/18/2013,moreilly,,,,,,,,,,
BR-22797,54.13 Product Value ID for Outstanding Reserves,"Call routine for retrieving the minor_line and package_code from lk_minor_line_pkg_xref (mp_minor_line_pkg_assign_edw_xref)

If ADW.AGG_CLM_FIN_OS_RESV. PREVIOUSLY_CONVERTED_IND = ‘1’
  Then PRODUCT-VALUE = ‘2626AA29’
Else 
 If previously_converted_ind = 1
   And pol_symbol_cd <> ‘AMP’
 Then 
 (Select  MINOR_LINE_CD
 From LK_MINOR_LINE_PKG_XREF LK
 Where LK.CVRG_CD = cvrg_cd
  And LK.POLICY_SYMBOL = Pol_symbol_cd
  And LK.RISK_CATG_CD = risk_catg_cd
  And LK.CVRG_CATG_CD = cvrg_catg_cd
  And LK.STAT_PACKAGE_IND = package_ind
  And LK.CLAIMS_MADE_IND = claims_made_ind)

If MINOR_LINE_CD = 180 and FIPS_US_ALPHA_CODE = TX ser MINOR_LINE_CD = 170.


 Select PRODUCT_VALUE_1_8_ID,
           PRODUCT_VALUE_ID
 From A_POLICY_CONV
Where POLICY_NUMBER = Pol_No_Cd
  And POLICY_EFFECTIVE_DATE = Pol_Term_Eff_Dt
  And POLICY_VERSION_CD = Pol_version_cd
  And POLICY_MODULE = Pol_module_cd
  And POLICY_SYMBOL = Pol_symbol_cd
  And PRODUCER_B_CODE = Producer
  And COMPANY_CODE = LE_org_cd
  And CLASS_CODE = rate_class_cd
  And FIPS_US_ALPHA_CODE = rs_fips_us_alpha_cd
  And MINOR_LINE_CODE = Minor_line_cd      

If there is no match then use key below

Select PRODUCT_VALUE_1_8_ID,
           PRODUCT_VALUE_ID
   From A_POLICY_CONV
   Where POLICY_NUMBER = Pol_No_Cd
    And POLICY_EFFECTIVE_DATE = Pol_Term_Eff_Dt
    And POLICY_VERSION_CD = Pol_version_cd
    And POLICY_MODULE = Pol_module_cd
    And POLICY_SYMBOL = Pol_symbol_cd
    And PRODUCER_B_CODE = Producer
    And COMPANY_CODE = LE_org_cd
    And CLASS_CODE = rate_class_cd
    And FIPS_US_ALPHA_CODE = rs_fips_us_alpha_cd

If is NULL
  Then reject the row
",ETL - F_Div_OS_Reserve,,9/23/2013,moreilly,,,,,,,,,,
BR-21878,55 Producer/Profit Center ,"Select DIV_ID 
From LK_DIV_RULES_XREF
Where DIVISION = Profit_center (first 2 digits)

Select PRODUCER_PROFIT_CENTER_ID
From D_PRODUCER_PROFIT_CENTER
Where PRODUCER_A_CODE = mgmt_cd
And MAPPED_DIV_ID_CODE = div_id","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - A_Liability_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses

",,6/22/2015,jjordan,"The intent of this rule is to determine the legacy DIV_ID code from the first 2 digits of the Profit Center (mgmt_cd).  Then retrieve the correct producer profit cneter ID to store on the divisional fact tables as A_PRODUCER_PROFIT_CENTER_ID  
",,,,,,,,,
BR-21879,56 Product Detail ID ,"

","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Div_OS_Reserve
",,6/22/2015,jjordan,"The intent of this rule is to define the appropriate data values required to access the product detail table and bring back the correct Product Detail ID to store on the associated fact table.  The minor line and package code define a product from a legacy perspective. Whereas risk, coverage code and policy symbol from the EDW are used to locate the product in the lk_minor_line_pkg_xref table.

PRODUCT_DETAIL_ID",,,,,,,,,
BR-22749,56.1 Product Detail ID Associated with the Financial Transaction,"Call routine for retrieving the minor_line and package_code from lk_minor_line_pkg_xref (mp_minor_line_pkg_assign_edw_xref)

Select PRODUCT_DETAIL_ID 
From D_PRODUCT_DETAIL
Where MINOR_LINE_CODE = mp.Minor_line_cd  
  And PACKAGE_CODE = mp.Package_cd
  And CSP_INDICATOR = 1
 If null
  Then 
 Select PRODUCT_DETAIL_ID 
 From D_PRODUCT_DETAIL
 Where MINOR_LINE_CODE = mp.Minor_line_cd  
  And PACKAGE_CODE = ‘00’
  And CSP_INDICATOR = ‘0’","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums",,10/17/2013,moreilly,,,,,,,,,,
BR-22748,56.2 Product Detail ID Associated with Policy Conversion,"Call routine for retrieving the minor_line and package_code from lk_minor_line_pkg_xref (mp_minor_line_pkg_assign_edw_xref)

If previously_converted_ind = 1
  And  pol_symbol_cd <> ‘AMP’
Then 
 Select PRODUCT_DETAIL_ID
 From A_POLICY_CONV
 Where POLICY_NUMBER = Pol_No_Cd
  And POLICY_EFFECTIVE_DATE = Pol_Term_Eff_Dt
  And POLICY_VERSION_CD = Pol_version_cd
  And POLICY_MODULE = Pol_module_cd
  And POLICY_SYMBOL = Pol_symbol_cd
  And PRODUCER_B_CODE = Producer
  And COMPANY_CODE = LE_org_cd
  And CLASS_CODE = rate_class_cd
  And FIPS_US_ALPHA_CODE = rs_fips_us_alpha_cd
  And MINOR_LINE_CODE = Minor_line_cd  
If is NULL
    Then reject the row
Else 
Select PRODUCT_DETAIL_ID 
From D_PRODUCT_DETAIL
Where MINOR_LINE_CODE = mp.Minor_line_cd  
  And PACKAGE_CODE = mp.Package_cd
  And CSP_INDICATOR = 1
If null
  Then 
 Select PRODUCT_DETAIL_ID 
 From D_PRODUCT_DETAIL
 Where MINOR_LINE_CODE = mp.Minor_line_cd  
  And PACKAGE_CODE = ‘00’
  And CSP_INDICATOR = ‘0’","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
",,6/22/2015,jjordan,,,,,,,,,,
BR-21880,57 Premium Items ID ,"If EDW.VW_PRC_RATING_NON_PREM.
CHARGE_CATG_CD is not Null 
  Then PREMIUM-INCOME-IND = ‘0’ 
else  PREMIUM-INCOME-IND = ‘1’
PREMIUM-SOURCE-CODE = SRC_SYS_CD
Calculate
POLICY-TERM = 
(((PT-EXP-YR * 12) + PT-EXP-MO) – 
((PT-EFF-YR * 12) + PT-EFF-MO))
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘POLICY_ACTIVITY_CODE’
and EDW_ITEM_CD = Business_Activity_CD and EDW_ITEM_CD_2 = Cancel_catg_CD
   
POLICY-ACTIVITY-CODE = FDW_CODE
Select FDW_CODE
From LK_FDW_TO_EDW_REF
Where FDW_REF_DESC = ‘NEW_KIND_CODE’ 
and EDW_ITEM_CD = EDW.VW_PRC_RATING_NON_PREM.CHARGE_CATG_CD

if not null 
  then NEW-KIND-CODE = FDW_CODE
else NEW-KIND-CODE = ‘0’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘SUB_KIND_CODE’
and EDW_ITEM_CD = Business_Activity_CD
and EDW_ITEM_CD_2 = Cancel_catg_CD
   
SUB-KIND-CODE = FDW_CODE
If Direct_Ceded_Assumed_CD = ‘D’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘PREMIUM_TRNSCTN_DAC_CODE’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = ‘0’

If Direct_Ceded_Assumed_CD in (‘A’, ‘C’)
IF VW_reins_contr.contr_catg_CD <> ‘0’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘PREMIUM_TRNSCTN_DAC_CODE’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = contr_catg_CD
and EDW_REF_2_DESC = ‘CONTR_TYPE_REF’

ELSE-IF Involuntary_catg_CD <> ‘0’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘PREMIUM_TRNSCTN_DAC_CODE’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = Involuntary_catg_CD
and EDW_REF_2_DESC = ‘INVOLUNTARY_TYPE_REF’

ELSE
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘PREMIUM_TRNSCTN_DAC_CODE’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = ‘0’

PREMIUM-TRNSCTN-DAC-CODE = FDW_CODE
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘PAYMENT_INDICATOR’
and EDW_ITEM_CD = New_Busn_Ind

PAYMENT-INDICATOR = FDW_CODE
INSTALLATION-INDICATOR =  ‘0’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘BILLING_INDICATOR’
and EDW_ITEM_CD = BILLING_TYPE_CD

BILLING-INDICATOR = FDW_CODE


Select PREMIUM_ITEMS_ID
From FDW.d_premium_items dpi
Where dpi.TAX_LOCATION_CODE =
TAX-LOCATION-CODE
And dpi.PREMIUM_INCOME_INDICATOR =
PREMIUM-INCOME-IND
And dpi.PREMIUM_SOURCE_CODE =
PREMIUM-SOURCE-CODE
And dpi.POLICY_TERM = POLICY-TERM
And dpi.POLICY_ACTIVITY_CODE = 
POLICY-ACTIVITY-CODE
And dpi.NEW_KIND_CODE = NEW-KIND-CODE
And dpi.SUB_KIND_CODE = SUB-KIND-CODE
And dpi.PREMIUM_TRNSCTN_DAC_CODE = 
PREMIUM-TRNSCTN-DAC-CODE
And dpi.PAYMENT_INDICATOR = 
PAYMENT-INDICATOR
And dpi.INSTALLATION_INDICATOR = INSTALLATION-INDICATOR
And dpi.BILLING_CODE = BILLING-INDICATOR
and dpi.source_system_id = 48","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
",,1/19/2018,mmconley,"The intent of this rule is to define the appropriate data values required to access the premium items table and bring back the correct Premium Items ID to store on the premium fact tables.   The EDW data elements are translated to FDW legacy data elements prior to retreiving the Premium Items ID 

PREMIUM_ITEMS_ID

sconley 1/19/18: Added source for CHARGE_CATG_CD. CHARGE_CATG_CD applies to Taxes and Surcharges.",,,,,,,,,
BR-21881,58 Statistical Format ID,"Select STAT_FORMAT_ID
From D_STAT_FORMAT_PREMIUMS
Where STAT_FORMAT_CODE = stat_format_cd
And STAT_FORMAT_AREA = stat_format_area","ETL - F_Divisional_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses

",,6/22/2015,jjordan,STAT_FORMAT_ID,,,,,,,,,
BR-21882,59 Risk State ID ,"
","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - D_Policy_Daily
ETL - D_Stat_Liability_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
ETL - D_Claim_Hist
",,11/11/2013,dzieverink,,,,,,,,,,
BR-22809,59.1 Risk State ID ,"Select the risk state associated to the policy with a risk location category = 'RSA'

Select GEOGRAPHY_ID
  from D_GEOGRAPHY G
  where FIPS_US_Alpha_Cd = G.FIPS_US_Alpha_Code
  and FIPS_US_Numeric_Cd = G.FIPS_US_Numeric_Code
---------------------------------------------------------------------------------------------------------------
From VWTA_Risk_State_Province
 Where CATG_CD in (‘RSA’)

Select REIN_STATE_PROVINCE_CODE
  from D_GEOGRAPHY G
  where FIPS_US_Alpha_Cd = G.FIPS_US_Alpha_Code
  and FIPS_US_Numeric_Cd = G.FIPS_US_Numeric_Code","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - D_Policy_Daily
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve

",,6/22/2015,jjordan,"The intent of this rule is to assign the EDW premium transaction's location risk state or policy state to the financial transaction.
",,,,,,,,,
BR-22808,59.2 Risk State ID Associated with Claims History,"Select FIPS_US_ALPHA_CD, 
            FIPS_US_NUMERIC_CD
From VWTA_Risk_State_Province
 Where CATG_CD = ‘RSA’

Select GEOGRAPHY_ID
  from D_GEOGRAPHY G
  where FIPS_US_Alpha_Cd = G.FIPS_US_Alpha_Code
  and FIPS_US_Numeric_Cd = G.FIPS_US_Numeric_Code",ETL - D_Claim_Hist,,11/11/2013,dzieverink,,,,,,,,,,
BR-21883,60 Reinsurance Company ID ,"If contr_no_cd is null
Then contr_no_cd = ‘0000’

Select reinsurance_company_id 
From d_reinsurance_company
Where reinsurance_company_code = contr_no_cd
","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
",,9/8/2015,mmconley,"REINSURANCE_COMPANY_ID

The intent of this rule is to assign the EDW reinsurance contract number to the financial transaction

EDW source: vw_prc_rating_prem.cvrg_reins_contr_no
and vw_reins_contr.contr_no_cd 
(??? Not positive sconley 9/8/15) 

The field is moved from the divisional tables to the experience tables.
",,,,,,,,,
BR-21884,61 Premium Category ID ,"Select PREMIUM_CATEGORY_ID
From FDW.d_premium_category dpc
Where dpc.PREM_INCOME_CATEGORY_30_CODE =
PREM-INCOME-CATEGORY-30
And dpc.PREM_ACCOUNT_CATEGORY_32_CODE = PREM-ACCOUNT-CATEGORY-32
And dpc.PREM_BOOKING_CATEGORY_33_CODE = PREM-BOOKING-CATEGORY-33
And dpc.PREM_RENEWAL_CATEGORY_34_CODE = PREM-RENEWAL-CATEGORY-34
And dpc.PREM_TRNSCTN_CATEGORY_35_CODE = PREM-TRNSCTN-CATEGORY-35
And dpc.PREM_INSTALL_CATEGORY_36_CODE = 
PREM-INSTALL-CATEGORY-36
And dpc.PREM_HALF_CATEGORY_37_CODE = PREM-HALF-CATEGORY-37
And dpc.PREM_BILLING_CATEGORY_41_CODE = PREM-BILLING-CATEGORY-41
And dpc.PREM_ISSUED_CATEGORY_42_CODE =
PREM-ISSUED-CATEGORY-42
And dpc.SOURCE_SYSTEM_ID = 48
","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums

",,6/22/2015,jjordan,"PREMIUM_CATEGORY_ID

The intent of this rule is to define the appropriate data values required to access the premium category table and bring back the correct Premium Category ID to store on the premium fact tables.  The EDW data elements are translated to FDW legacy data elements prior to retreiving the Premium Category ID 

",,,,,,,,,
BR-21885,62 Division ID ,"The intent of this rule is to determine the legacy DIV_ID code from the first 2 digits of the Profit Center (mgmt_cd). 
","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Div_OS_Reserve
ETL - F_Divisional_Losses
ETL - D_Policy
ETL - D_Policy_Daily
",,6/22/2015,jjordan,DIV_ID_CODE,,,,,,,,,
BR-22775,62.1 Divisional ID based on Management Code,"Select DIV_ID 
From LK_DIV_RULES_XREF
Where DIVISION = MGMT_CD (first 2 digits)","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - F_Div_OS_Reserve
ETL - D_Policy
ETL - D_Policy_Daily
",,11/11/2013,dzieverink,,,,,,,,,,
BR-22774,62.2 Divisional ID based on Profit Center,"Select DIV_ID 
From LK_DIV_RULES_XREF
Where DIVISION = Profit_center (first 2 digits)","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses",,9/18/2013,moreilly,,,,,,,,,,
BR-23266,62.3 Divisional ID based on ADW rule,"Using the producer associated with the policy from EDW, we do the following 4 lookups against a COPY of FDW’s D_PRODUCER_PROFIT_CENTER_DAILY each using a different mapped div id code and pick ANY 1 record from the table:

MAPPED_DIV_ID_CODE <> 'C'  -> CURRENT_PROFIT_CENTER_not_c
MAPPED_DIV_ID_CODE = 'I' -> CURRENT_PROFIT_CENTER_i
MAPPED_DIV_ID_CODE = 'C' -> CURRENT_PROFIT_CENTER_c
MAPPED_DIV_ID_CODE = 'B' -> CURRENT_PROFIT_CENTER_b

This code attempts to assign the profit center:
DECODE (true
       ,NOT IN (SRC_SYS_CD, 'ELD_PAS', 'ENV-PAS', ‘UDPIM’, ‘MYS-PAS','BRIDGE-PAS') ,CURRENT_PROFIT_CENTER_not_c
        ,IN(SRC_SYS_CD, 'UDPIM', 'BRIDGE-PAS'),CURRENT_PROFIT_CENTER_i
         ,IN (SRC_SYS_CD, 'ELD_PAS', 'ENV-PAS') AND MGMT_CD <> '405959',CURRENT_PROFIT_CENTER_c
         ,SRC_SYS_CD = 'ELD_PAS' AND MGMT_CD = '405959',CURRENT_PROFIT_CENTER_b
 ,SRC_SYS_CD = ‘MYS-PAS',CURRENT_PROFIT_CENTER_b

…but if the result of the above DECODE is NULL, then use CURRENT_PROFIT_CENTER_c
",ETL - ADW,dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202),6/20/2016,dzieverink,included the ADW general rule for determining the DIV-ID when the profit center is not provided from the source-system,,,,,,,,,
BR-21886,63 Source System ID,"Select the SOURCE_SYSTEM_ID
From D_SOURCE_SYSTEM
Where SOURCE_SYSTEM_NAME = 
'Enterprise Data Warehouse'","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
ETL - D_Business_Cvrg
ETL - D_Pol_Trans_Cvrg
ETL - D_Policy
ETL - D_Policy_Support
ETL - D_Policy_Daily
ETL - D_Cvrg_Rate
ETL - D_Cvrg_Rate_Fctr
ETL - D_Claim_Legacy_Xref
ETL - D_Catastrophe_Code
ETL - D_Customer
ETL - D_Risk_Structure
ETL - D_Structured_Settlement
ETL - D_Claim_Fin_Trans
ETL - D_Claim_Support
ETL - D_Pol_Trans_Cvrg
ETL - D_System_Party
ETL - Lk_EDW_Annual_Stmt_Subline
ETL - D_Pol_Risk_Cvrg_Deduct
ETL - D_Pol_Risk_Cvrg_Limit
ETL - D_Lk_FDW_to_EDW_Ref
ETL - D_Pol_Risk_Cvrg_Rate
ETL - D_Pol_Risk_Cvrg_Rate_Fctr
ETL - Lk_Nal_Claim_Unit_Xref
",,1/13/2016,mmconley,"SOURCE_SYSTEM_ID

The intent of this rule is to determine the system that is the source of the transaction and to access the source system table to bring back the correct Source System ID.

1/13/16 sconley: Updated D_Risk to D_Risk_Structure (FDW_Core 8371). ",,,,,,,,,
BR-21887,64 Source Transaction,,"ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Divisional_Losses
",,10/13/2016,mmconley,SOURCE_TRANSACTION,,,,,,,,,
BR-22697,64.1 Source Transaction F_Divisional_Premiums,"If Direct_Ceded_Assumed_CD = ‘D’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = ‘0’

If Direct_Ceded_Assumed_CD in (‘A’, ‘C’)
IF contr_catg_CD <> ‘0’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = contr_catg_CD

ELSE-IF Involuntary_catg_CD <> ‘0’ 
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = Involuntary_catg_CD

ELSE
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = 0",ETL - F_Divisional_Premiums,,8/8/2013,moreilly,,,,,,,,,,
BR-22695,64.2 Source Transaction F_Detail_Premiums,"If Direct_Ceded_Assumed_CD = ‘D’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = ‘0’

If Direct_Ceded_Assumed_CD in (‘A’, ‘C’)
IF contr_catg_CD <> ‘0’
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = contr_catg_CD

ELSE-IF Involuntary_catg_CD <> ‘0’ 
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = Involuntary_catg_CD

ELSE
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘TRANS_TYPE_DET_PREM’
and EDW_ITEM_CD = Direct_Ceded_Assumed_CD 
and EDW_ITEM_CD_2 = 0",ETL - F_Detail_Premiums,,8/8/2013,moreilly,,,,,,,,,,
BR-23414,64.3 Source Transaction F_Divisional_Losses,"Sourced from ADW view:
VW_CLM_FEAT_DIRECT_ASSUMED_CD.DIRECT_ASSUMED_CD

Move DIRECT_ASSUMED_CD to SOURCE_TRANSACTION",ETL - F_Divisional_Losses,,10/13/2016,mmconley,"The view looks for DIRECT_ASSUMED_CD in EDW.VW_PRC_RATING_PREM, EDW.PRC_HIST, or ADW.ASSUMED_CLAIMS.  If a value is not found, DIRECT_ASSUMED_CD defaults to ‘D’.
",,,,,,,,,
BR-23457,65 Claims Made Indicator ,,,,3/17/2017,mmconley,,,,,,,,,,
BR-21891,65.1 Claims Made Indicator,"On FDW in FDW view PRODUCT_DETAIL_IASL_PC_VW_PREM
SELECT
D_PRODUCT_DETAILPRODUCT_DETAIL_ID, D_IASL_PC.INTERNAL_ANNUAL_STMT_LINE_CODE 
FROM
D_PRODUCT_DETAIL, 
D_IASL_PC 
WHERE D_PRODUCT_DETAIL.IASL_PC_ID = D_IASL_PC.IASL_PC_ID 
AND INTERNAL_ANNUAL_STMT_LINE_CODE in ('173','174','183','184')


When the PRODUCT_DETAIL_ID for the coverage in PRODUCT_DETAIL_IASL_PC_VW_PREM
  Set CLAIMS_MADE_INDICATOR = 'yes'
  EXIT

Set CLAIMS_MADE_INDICATOR = 'no'

For FIS, CLAIMS_MADE_INDICATOR = 'no'","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - F_Divisional_Losses
ETL - F_Div_Expense_Payment
ETL - F_Div_OS_Reserve

",,4/12/2017,mmconley,"CLAIMS_MADE_INDICATOR

sconley 4/10/17: Broke into sub-rules
sconley 4/12/17: Updated rules as to show how the field is actually derived.  There is a look-up from EDW view FDW.VW_F_DIVISIONAL_PREMIUMS.FDW_PRODUCT_DETAIL_ID to FDW view FDW.PRODUCT_DETAIL_IASL_PC_VW_PREM.PRODUCT_DETAIL_ID.
",,,,,,,,,
BR-23458,65.2 Claims Made Indicator ,"When VW_CVRG_HIST.CLAIMS_MADE_IND = 1
  Set CLAIMS_MADE_IND = 1
  EXIT

Set CLAIMS_MADE_IND = 0
(default)

For FIS, Set CLAIMS_MADE_IND = 0","ETL - D_Business_Cvrg
ETL - Premium_Fact_Core",ENTERPRISE .Data_Platform 1449 & 1562: Add CLAIMS_MADE_IND to D_BUSINESS_CVRG; JIRA DP-7783,4/12/2017,mmconley,"sconley 4/10/17: New rule to add CLAIMS_MADE_IND to D_BUSINESS_CVRG and add to key.  CLAIMS_MADE_IND already existed in PREMIUM_FACT_CORE as NOT NULL, so it will always be populated in D_BUSINESS_CVRG for EDW coverages.  (JIRA DP-7783, QC 1449, QC 1562)",,,,,,,,,
BR-21892,66 Statistical Data ID ,"_Select STAT_FORMAT_ID 
From D_STAT_PREMIUMS_STAGE
Where STAT_FORMAT_CODE = stat_format_cd
    And STAT_FORMAT_AREA = stat_format_area
    And SOURCE_SYSTEM_ID = source_system_id
Then 
   Select STAT_DATA_ID
    From D_STAT_DATA_PREMIUMS
    Where  STAT_FORMAT_CODE = stat_format_code
         And SIC_CODE = sic_code
         And CLASS_CODE = class_code
         And ZIP_CODE_FIRST5 = zip_code_first5
         And ZIP_CODE_LAST4 = zip_code_last4
         And BI_LIMIT = bi_limit 
         And BI_OR_PD_LIMIT = bi_or_pd_limit  
         And PD_LIMIT = pd_limit
         And MED_PAY_LIMIT = med_pay_limit
         And UNDER_INSURED_LIMIT = under_insured_limit
         And PIP_LIMIT = pip_limit
         And LIABILITY_LIMIT = liability_limit
         And LIMIT_CODE = limit_code
         And AGGREGATE_LIMIT = aggregate_limit
         And CONTENTS_LIMIT = contents_limit
         And MED_OR_UNINSURED_LIMIT = med_or_uninsured_limit
         And MEDICAL_LIMIT = medical_limit
         And POLICY_LIMIT = policy_limit
         And STRUCTURE_LIMIT = structure_limit
End-if","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Divisional_Losses",,3/17/2017,mmconley,STAT_DATA_ID,,,,,,,,,
BR-21893,67 Exposure and Exposure Basis - Premiums and Losses ,"To determine EXPOSURE and EXPOSURE_BASIS, several variables are set in this order and then used later in the rules.

in_EXPOSURE_AMT
v_TERM
v_EXPOSURE_DIVISOR
v_EXPOSURE_AMT
EXPOSURE_AMT 
EXPOSURE_BASIS

Rules are broken down into each variable to help better understand the ETL.
","The same mapplet is used by all the fact tables. 

ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Divisional_Losses
ETL - F_Div_Expense_Payment
ETL - F_Div_OS_Reserve

","FDW_Core 8358: Logic now hits a lookup table

FDW_Core 4840: Update Exposure and Exposure Basis

mySurety_Intg 6: Add risk PRINCIPAL to the rule

PIM 17286: Add risk JOBSITE to the rule

PIM 17833: Add rule for COVPROP/EQ 

DP-6711: Changed v_Term logic from Cvrg_End_Date - Pol_Eff_Dt to Cvrg_End_Date - Cvrg_Incept_Date",10/19/2017,mmconley,"12/3/13 S. Conley: It appears that if there is a flat-cancel the exposure = 0.
2/24/2014 S. Conley: Copied revised rule from FDW_Core 4840.
2/14/2014 S. Conley: Revised to add risk PRINCIPAL to rule for mySurety.
2/18/2015 S. Conley: Revised to add risk JOBSITE to rule for Builders Risk.
9/24/2015 S. Conley: Revised to add rule for COVPROP/EQ for Builders Risk.
Basis_cd = PERCLM for all.
For offsets, the exposure is negative.
For location level EQ (schdl_no 1) select limit from applies_to EACHLOC.  It is the only applies_to.
For policy level EQ (schdl_no 0) select limit from applies_to ANYONELOSS.  It is the required applies_to.

3/1/17 dzieverink: DP-6711 changes added

10/19/17: Reformated rules in DOORs. Moved existing comments to this level.  Attached WORD docs with rules for premiums and losses before revisions. History can also be found in BR-22778 & BR-22780.

          ",,,,,,,,,
BR-23491,67.1 in_EXPOSURE_AMT,"in_EXPOSURE_AMT = ADW.DIVISIONAL_PREMIUMS.EXPOSURE_AMT
(It is modified for offset/onset in ADW.)

/* Reinsurance source is ADW.DIVISIONAL_PREMIUMS_BUYBACK.EXPOSURE_AMT.
ADW input comes from EDW.VW_PRC_RATING.EXPOSURE_AMT. */",,,10/24/2017,mmconley,,,,,,,,,,
BR-23492,67.2 v_TERM,"Premiums and earnings use Cvrg_End_Date – Cvrg_Incept_Date.
Losses use (Cancel_Dt or Pol_Term_Exp_Dt) – Pol_Term_Eff_Dt.
Informatica Code:
DECODE (true
                      -- For premiums and earnings the CVRG_END_DT is easily available
                      ,NOT ISNULL(CVRG_END_DT)
                                  ,(((TO_INTEGER(GET_DATE_PART(CVRG_END_DT,'YYYY') ) * 12 ) + TO_INTEGER(GET_DATE_PART(CVRG_END_DT,'MM'))) - 
                                   ((TO_INTEGER(GET_DATE_PART(CVRG_INCEPTION_DT,'YYYY')) * 12 ) + TO_INTEGER(GET_DATE_PART(CVRG_INCEPTION_DT,'MM'))))

                     -- For losses, the CVRG_END_DT is harder to retrieve and this logic was used instead of the above
                      ,NOT ISNULL(CANCEL_DT)
                                  ,(((TO_INTEGER(GET_DATE_PART(CANCEL_DT,'YYYY') ) * 12 ) + TO_INTEGER(GET_DATE_PART(CANCEL_DT,'MM'))) - 
                                   ((TO_INTEGER(GET_DATE_PART(CVRG_INCEPTION_DT,'YYYY')) * 12 ) + TO_INTEGER(GET_DATE_PART(CVRG_INCEPTION_DT,'MM'))))

                      ,(((TO_INTEGER(GET_DATE_PART(POL_TERM_EXP_DT,'YYYY') ) * 12 ) + TO_INTEGER(GET_DATE_PART(POL_TERM_EXP_DT,'MM'))) - 
                       ((TO_INTEGER(GET_DATE_PART(CVRG_INCEPTION_DT,'YYYY')) * 12 ) + TO_INTEGER(GET_DATE_PART(CVRG_INCEPTION_DT,'MM'))))
)",,,10/19/2017,mmconley,,,,,,,,,,
BR-23493,67.3 v_EXPOSURE_DIVISOR,"It uses RISK_CATG_CD, CVRG_CD, and RATE_CLASS_CD for look-up to table LK_EXPOSURE and selects EXPOSURE_DIVISOR. 
v_EXPOSURE_DIVISOR is used in setting v_EXPOSURE_AMT.

Any change for v_EXPOSURE_DIVISOR may require a similar change for EXPOSURE_BASIS.

It compares fields LK_EXPOSURE.RISK_CATG_CODE, LK_EXPOSURE.COVERAGE_CODE, LK_EXPOSURE.CLASS_CODE.

It will look for a row in this order:
	
RISK_CATG_CD, CVRG_CD, RATE_CLASS_CD
	‘Any’, CVRG_CD, RATE_CLASS_CD
                RISK_CATG_CD, ‘Any’, RATE_CLASS_CD
	RISK_CATG_CD, CVRG_CD, ‘Any’
	‘Any’, CVRG_CD, ‘Any’
	RISK_CATG_CD, ‘Any’, ‘Any’
	‘Any’, ‘Any’, RATE_CLASS_CD
	
Set v_EXPOSURE_DIVISOR = LK_EXPOSURE.EXPOSURE_DIVISOR
EXIT


/* If a row is not found */
Set v_EXPOSURE_DIVISOR = 1
EXIT",,"sconley 10/31/17: ENTERPRISE.Data_Platform 2324, US20215, US21056: Exposure Changes Requested by PDC",10/31/2017,mmconley,"sconley 10/31/17: ENTERPRISE.Data_Platform 2324, US20215, US21056: Exposure Changes Requested by PDC",,,,,,,,,
BR-22778,67.4 v_EXPOSURE_AMT,"For the following RISK_CATG_CDs, CVRG_CDs, and RATE_CLASS_CDs execute the 3 rules following. The 3 rules do not use v_EXPOSURE_DIVISOR.

****************************************
RISK_CATG_CD = ‘FRMOPS’ 
CVRG_CD = ‘EMPLIAB’
RATE_CLASS_CD = ‘01350’ 

RISK_CATG_CD = ‘FRMOPS’ 
CVRG_CD = ‘CFO’
RATE_CLASS_CD = ‘07106’ 

RISK_CATG_CD = ‘PROFOPS’ 
CVRG_CD in (‘REALESPROF’,’SUPLERP’)
RATE_CLASS_CD = ‘81351’ 

RISK_CATG_CD = ‘PRODOPS’ 
CVRG_CD = ‘PRODUCTS’

/* If in_EXPOSURE_AMT is >= 1000 or <= -1000, divide by 1000 */
ABS (in_EXPOSURE_AMT / 1000) >= 1
  Set v_EXPOSURE_AMT = in_EXPOSURE_AMT / 1000
  EXIT

/* If in_EXPOSURE_AMT is < 1000 and > -1000 and <> 0, set to 1 or -1 to match sign of the exposure */
SIGN (in_EXPOSURE_AMT) <> 0
  Set v_EXPOSURE_AMT = SIGN (in_EXPOSURE_AMT)
  EXIT

/* If in_EXPOSURE_AMT is 0, set to 1 */
  Set v_EXPOSURE_AMT = 1
  EXIT
****************************************

For the following RISK_CATG_CDs and CVRG_CDs execute the 2 rules following. The 2 rules do not use v_EXPOSURE_DIVISOR.

RISK_CATG_CD = ‘PRODOPS’ 
CVRG_CD = ‘PRODUCTS’

RISK_CATG_CD = ‘PREMOPS’ 
CVRG_CD = ‘CGL’

/* If in_EXPOSURE_AMT is >= 1000 or <= -1000, divide by 1000 */
ABS (in_EXPOSURE_AMT / 1000) >= 1
  Set v_EXPOSURE_AMT = in_EXPOSURE_AMT / 1000
  EXIT

/* If in_EXPOSURE_AMT is < 1000 and > -1000, do not divide and set to in_EXPOSURE_AMT */ 
Set v_EXPOSURE_AMT = in_EXPOSURE_AMT
EXIT
****************************************

When RISK_CATG_CD = 'COVPROP'
CVRG_CD = 'EQ'
Limit APPLIES_TO_CD in (EACHLOC, ANYONELOSS)
LIMIT_AMT is not NULL 
ONSET_IND = 1
  Set v_EXPOSURE_AMT = LIMIT_AMT / v_EXPOSURE_DIVISOR
  EXIT    

When RISK_CATG_CD = 'COVPROP'
CVRG_CD = 'EQ'
Limit APPLIES_TO_CD in (EACHLOC, ANYONELOSS)
LIMIT_AMT is not NULL 
ONSET_IND <> 1
  Set v_EXPOSURE_AMT = (LIMIT_AMT * -1) / v_EXPOSURE_DIVISOR
  EXIT    

When in_EXPOSURE_AMT is NULL
  Set v_EXPOSURE_AMT = 0
  EXIT

When RISK_CATG_CD = ‘FPP’
CVRG_CD = ‘FPECOLL’ 
APPLIES_TO_CD ‘EACHAN’ LIMIT_AMT is not NULL 
  Set v_EXPOSURE_AMT = (LIMIT_AMT * in_EXPOSURE_AMT) / 1000
  EXIT

When RISK_CATG_CD = ‘FPP’
CVRG_CD = ‘FPECOLL’ 
APPLIES_TO_CD ‘EACHAN’ LIMIT_AMT is NULL 
  Set v_EXPOSURE_AMT = in_EXPOSURE_AMT / 1000
  EXIT

When RISK_CATG_CD = ‘AGGOPS’ 
CVRG_CD = ‘AGRIGD’
BASIS_CD ‘PERLAYER’ LIMIT_AMT is not NULL
ONSET_IND = 1
  Set v_EXPOSURE_AMT = BASIS_CD ‘PERLAYER’ LIMIT_AMT
  EXIT

When RISK_CATG_CD = ‘AGGOPS’ 
CVRG_CD = ‘AGRIGD’
BASIS_CD ‘PERLAYER’ LIMIT_AMT is not NULL
  Set v_EXPOSURE_AMT = BASIS_CD ‘PERLAYER’ LIMIT_AMT * -1
  EXIT

When RISK_CATG_CD = ‘AGGOPS’ 
CVRG_CD = ‘AGRIGD’
  Set v_EXPOSURE_AMT = 0
  EXIT

When RISK_CATG_CD = ‘VEH’
CVRG_CD = ‘SEQIP’ 
  Set v_EXPOSURE_AMT = in_EXPOSURE_AMT
  EXIT

When RISK_CATG_CD in (‘VEH’, ‘DOCPEOPLE’, ’NONOWNED’, ‘NONSSEL’, ’NONSSEMP’, ’NONSSPART’, ’NOSSELEMP’, ‘NOSSELVOL’, ‘NOSSEMP’, ‘NOSSVOL’, ‘INSDPEOPLE’)
v_TERM = 0
  Set v_EXPOSURE_AMT = in_EXPOSURE_AMT
  EXIT

When RISK_CATG_CD in (‘VEH’, ‘DOCPEOPLE’, ’NONOWNED’, ‘NONSSEL’, ’NONSSEMP’, ’NONSSPART’, ’NOSSELEMP’, ‘NOSSELVOL’, ‘NOSSEMP’, ‘NOSSVOL’, ‘INSDPEOPLE’)
  Set v_EXPOSURE_AMT = in_EXPOSURE_AMT * v_TERM
  EXIT

/* If you have not hit any of the exception rules above */
When in_EXPOSURE_AMT is not NULL
  Set v_EXPOSURE_AMT = in_EXPOSURE_AMT / v_EXPOSURE_DIVISOR
  EXIT

/* Default */
Set v_EXPOSURE_AMT = 0
  EXIT",,"sconley 103/31/17: ENTERPRISE.Data_Platform 2324, US20215, US21056: Exposure Changes Requested by PDC",10/31/2017,mmconley,"sconley 103/31/17: ENTERPRISE.Data_Platform 2324, US20215, US21056: Exposure Changes Requested by PDC
 
",,,,,,,,,
BR-23495,67.5 EXPOSURE_AMT,"This is the value moved to field EXPOSURE in the fact tables.

EXPOSURE_AMT = ROUND (v_EXPOSURE_AMT)
(default to ‘0’)",,Jira DP-3519 and QC DP 705 created to round the final amount of the exposure ,10/19/2017,mmconley,,,,,,,,,,
BR-22780,67.6 EXPOSURE_BASIS,"This is the value moved to field EXPOSURE_BASIS in the fact tables.

Any change for EXPOSURE_BASIS may require a similar change for v_EXPOSURE_DIVISOR.

/* If in_EXPOSURE_AMT is >= 1000 or <= -1000 */
/* Do not get EXPOSURE_BASIS from LK_EXPOSURE */
RISK_CATG_CD = ‘PRODOPS’ 
CVRG_CD = ‘PRODUCTS’
ABS (in_EXPOSURE_AMT / 1000) >= 1
  Set v_EXPOSURE_BASIS = 'Thousands of Dollars'
  EXIT

/* If in_EXPOSURE_AMT is >= 1000 or <= -1000 */
/* Do not get EXPOSURE_BASIS from LK_EXPOSURE */
RISK_CATG_CD = ‘PREMOPS’ 
CVRG_CD = ‘CGL’
ABS (in_EXPOSURE_AMT / 1000) >= 1
  Set v_EXPOSURE_BASIS = 'Thousands of Dollars'
  EXIT


Use RISK_CATG_CD, CVRG_CD, and RATE_CLASS_CD for look-up to table LK_EXPOSURE and select EXPOSURE_BASIS.

It compares fields LK_EXPOSURE.RISK_CATG_CODE, LK_EXPOSURE.COVERAGE_CODE, LK_EXPOSURE.CLASS_CODE.

It will look for a row in this order:
	
RISK_CATG_CD, CVRG_CD, RATE_CLASS_CD
	‘Any’, CVRG_CD, RATE_CLASS_CD
                RISK_CATG_CD, ‘Any’, RATE_CLASS_CD
	RISK_CATG_CD, CVRG_CD, ‘Any’
	‘Any’, CVRG_CD, ‘Any’
	RISK_CATG_CD, ‘Any’, ‘Any’
	‘Any’, ‘Any’, RATE_CLASS_CD
	
Set EXPOSURE_BASIS = LK_EXPOSURE.EXPOSURE_BASIS
EXIT


/* If a row is not found EXPOSURE_BASIS will be NULL */",,"sconley 10/31/17: ENTERPRISE.Data_Platform 2324, US20215, US21056: Exposure Changes Requested by PDC",10/31/2017,mmconley,"sconley 10/31/17: ENTERPRISE.Data_Platform 2324, US20215, US21056: Exposure Changes Requested by PDC


",,,,,,,,,
BR-21894,68 System of Record ID ,"Select SYSTEM_OF_RECORD_ID 
from D_SYSTEM_OF_RECORD 
Where SRC-SYS-CD = SYSTEM_OF_RECORD_CODE

(or Where SYSTEM_OF_RECORD_CODE = SRC_SYS_CD)","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - D_Claim_Legacy_Xref
",,11/11/2013,dzieverink,SYSTEM_OF_RECORD_ID,,,,,,,,,
BR-21896,69 Coverage Deductible ID ,"Select CVRG_DEDUCT_ID 
from D_CVRG_DEDUCT 
where VW_Cvrg_Deduct.CVRG_HIST_ID = EDW_CVRG_HIST_ID
and has the greatest CREATION-DATE

If not found 
   then move 0 
End-if","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve",,6/22/2015,jjordan,CVRG_DEDUCT_ID,,,,,,,,,
BR-21897,70 Coverage Limit ID ,"Select CVRG_LIMIT_ID 
from D_CVRG_LIMIT 
where VW_Cvrg_Limit.CVRG_HIST_ID = EDW_CVRG_HIST_ID 
and has the greatest CREATION-DATE

If not found 
   then move 0 
End-if ","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
",,6/22/2015,jjordan,CVRG_LIMIT_ID,,,,,,,,,
BR-21898,71 Coverage Rate ID ,"Select CVRG_RATE_ID 
from D_CVRG_RATE 
where VW_Cvrg_Rate.COVERAGE_RATING_ID = EDW_CVRG_RATING_ID
and has the greatest CREATION-DATE

If not found 
   then move 0 
End-if","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
",,6/22/2015,jjordan,CVRG_RATE_ID,,,,,,,,,
BR-21899,72 Coverage Rate Factor ID ,"Select CVRG_RATE_FCTR_ID 
from D_CVRG_RATE_FCTR 
where VW_Cvrg_Rate_Fctr.COVERAGE_RATING_ID = EDW_CVRG_RATING_ID
and has the greatest CREATION-DATE

If not found 
   then move 0 
End-if","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
",,6/22/2015,jjordan,CVRG_RATE_FCTR_ID,,,,,,,,,
BR-21900,73 Policy Transaction Coverage  ID ,"MOVE ‘P’ to PREMIUM-CATG-CD
** the aggregate premium table creates only a ‘P’ record for the FDW’s use.

Select POL_TRANS_CVRG_ID 
from D_POL_TRANS_CVRG 
where 
        BUSINESS_ACTIVITY_CD = VW_POL_TRANS.BUSINESS_ACTIVITY_CODE 
and ENDORSE_BILL_METHOD_CODE = VW_POL_TRANS.ENDORSE_BILL_METH_CD
and POLICY_CANCEL_CATG_CD = VW_POL_TRANS.CANCEL_CATG_CD
and POLICY_TRANS_REASON_CODE = VW_POL_TRANS.TRANS_REASON_CD 
and PREMIUM_CATG_CD = 'P'
and CANCEL_NO_RENEW_REASON_CD =  VW_POL_TRANS.CANCEL_NON_RENEW_CD
and CANCEL_EVIDENCE_CODE = VW_POL_TRANS_CANCEL_EVIDENCE_CD
and NON_PREM_CHARGE_CATG_CODE = VW_PRC_RATING_NON_PREM.CHARGE_CATG_CD
and NON_PREM_CHARGE_CODE = VW_PRC_RATING_NON_PREM.CHARGE_CD
and  LOCATION_UNIT_NUMBER = VW_POL_RISK_HIST.SCHDL_NO
and TRANSACTION_TYPE_CD  = VW_EDW_TRANS.TRANSCACTION_TYPE_CD
and SOURCE_SYSTEM_ID = 48 (for EDW)
    (D_SOURCE_SYSTEM_ID.SOURCE_SYSTEM_ID where SOURCE_SYSTEM_NAME = 'Enterprise Data Warehouse')
and AUDIT_IND = VW_CVRG_HIST.AUDIT_IND 
and AUDIT_FREQUENCY_CD = VW_CVRG_HIST.AUDIT_FREQUENCY_CD

If not found 
   then move 0 
End-if","ETL - F_Divisional_Premiums

",,1/19/2018,mmconley,"POL_TRANS_CVRG_ID

sconley 12/21/17: Updated selecttion criteria to add additional columns added to index of D_POL_TRANS_CVRG (ENTERPRISE.Data_Platform 2062 Premium Audit-Ind for CUBE needed in FDW)

sconley 1/19/18: CHARGE_CATG_CD applies to Taxes and Surcharges.",,,,,,,,,
BR-21901,74 Business Coverage ID ,,"ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
ETL - D_Claim_Hist

",,6/22/2015,jjordan,BUSINESS_CVRG_ID,,,,,,,,,
BR-22781,74.1 Business Coverage ID - premium transaction,"Select BUSINESS_CVRG_ID 
from D_BUSINESS_CVRG 
where IASL-CD = INTERNAL_ANNUAL_STMT_LINE_CODE
and SUBLINE-CD = SUBLINE_CODE
and CLASS-CD = CLASS_CODE
and RISK-CATG-CD = RISK_CATG_CODE
and CVRG-CATG-CD = COVERAGE_CATG_CODE
and CVRG-CD = COVERAGE_CODE
and CAN-BOOK-CLAIM-IND = CAN_BOOK_CLAIM_IND
and PREM-BEARING-IND = PREM_BEARING_IND
and HSB_COVERAGE_CD = HSB_COVERAGE_CD
and PRODUCT_PRICING_PLAN_CD = PRODUCT_PRICING_PLAN_CD
and PACKAGE_IND = STAT_PACKAGE_IND
and BLANKET_IND = BLANKET_IND


If not found 
   then move 0 
End-if","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
",,6/22/2015,jjordan,,,,,,,,,,
BR-22782,74.2 Business Coverage ID - loss transaction,"Select FDW_CODE
From LK_FDW_TO_EDW_REF 
Where FDW_REF_DESC = ‘SUBLINE_CODE’ 
    and EDW_ITEM_CD = subline_cd
if not null
  then 
    SUBLINE-CODE =  FDW_CODE
Else 
    SUBLINE-CODE = subline_cd 
then
Select BUSINESS_CVRG_ID 
from D_BUSINESS_CVRG 
where INTERNAL_ANNUAL_STMT_LINE_CODE = iasl_cd
and SUBLINE_CODE = SUBLINE-CODE
and CLASS_CODE = rate_class_cd
and RISK_CATG_CODE = risk_catg_cd
and COVERAGE_CATG_CODE = cvrg_catg_cd
and COVERAGE_CODE = cvrg_cd
and CAN_BOOK_CLAIM_IND = can_book_claim_ind
and PREM_BEARING_IND = prem_bearing_ind
and HSB_COVERAGE_CD = hsb_coverage_cd
and PRODUCT_PRICING_PLAN_CD = product_pricing_plan_cd
and STAT_PACKAGE_IND = package_ind
and BLANKET_IND = blanket_ind


If not found move 0 ","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve",,6/22/2015,jjordan,,,,,,,,,,
BR-22812,74.3 Business Coverage ID  - claim history,"Select BUSINESS_CVRG_ID
From D_BUSINESS_CVRG
Where iasl_cd = B.intermal_annual_stmt_line_code
And subline_cd = B.subline_code
And rate_class_cd = B.class_code
And risk_catg_cd = B.risk_catg_cd
And cvrg_catg_cd = B.coverage_catg_cd
And cvrg_cd = B.coverage_code
And can_book_claim_ind = B.can_book_claim_ind
And prem_bearing_ind = B.prem_bearing_ind",ETL - D_Claim_Hist,,6/22/2015,jjordan,,,,,,,,,,
BR-21902,75 Place ID ,"Select PLACE_ID 
from D_PLACE 
where the source columns match the d_place columns.

If not found 
   then move 0 
End-if","ETL - F_Divisional_Premiums
ETL - F_Divisional_Losses
",,6/22/2015,jjordan,PLACE_ID,,,,,,,,,
BR-21903,76 Risk ID ,"Select RISK_ID
from FDW.D_RISK_STRUCTURE 
where D_RISK_STRUCTURE.EDW_RISK_HIST_ID = 
Lastest corresponding RISK_HIST.RISK_HIST_ID within the accounting period

If not found 
   then move 0 
End-if","ETL - F_Divisional_Premiums
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
",,1/13/2016,mmconley,"RISK_ID

1/13/16 sconley: Updated D_RISK to D_RISK_STRUCTURE (FDW_Core 8371). ",,,,,,,,,
BR-23416,77 Terrorism,"If there are multiple risks on a policy and terrorism is supported by the product, then every risk must have a relationship to the operations level risk.  The operations level risk will be the parent and the other risks will be children or grandchildren. 
This relationship is needed to set the 8th position of the SIC code to support Bureau Reporting Requirements. (BR-21974 SIC Code - Terrorism Coverage Level - STAT Format)
In order for the Business Rule to work, the terrorism has to have a premium record ($0 or another amount).  Then the terrorism gets applied to all coverages under that risk (so far it has been an OPS risk) or the OPS risk’s children & grandchildren.  If there is another risk on the policy that is not a child of the OPS risk, the terrorism will not get applied to the coverages under that risk.
The terror cause of loss or exclusion for an OPS is applied to all coverages under the OPS.  If there is premium charged for terrorism, the premium indicator will be applied to all the premium bearing coverages under the OPS risk.
Terrorism does not attach to TAXSURCHRG.  TERRORISM_CVRG_ID = 0
If terrorism does not exist on the policy, TERRORISM_CVRG_ID = 0.
If a coverage is deleted and the same transaction also changes the terrorism, the terrorism will also change on the deleted coverage.",,,12/9/2016,mmconley,"12/8/16 sconley: Created BR-23416 and demoted BR-21904. Added additional information concerning terrorism in the Detailed Rule Text. 

-Comments were added to the Enterpise Requirements
(GAIG Database > GAIC Enterprise > Global Data Mapping > Data Mapping > 1. Requirements > Enterpise Requirements > (ER-2315 COVERAGE (Terrorism)) and (ER-1664 9.17 Risk Risk Relationship)) by M. O'Reilly.
-Comments were added to the Core Direct Enty Business Rules (GAIG Database > Core Direct Entry > Core Direct Entry Project > 2. Standards and Constraints > Core Direct Entry Business Rules> (BR-1414 31.21 Build Risk Risk Relationship)) by M. O'Reilly.
-It is not an EDW Business Rule and EDW does not validate risk and coverage relationships during the EDW load. 
-I was not able to link to these 3 business rules.",,,,,,,,,
BR-21904,77.1 Terrorism Coverage ID ,"Determine if terrorism exists on the policy.  
Look for CVRG_CD in (‘TERROR’,’TERRORCB’)  (in vw_prc_rating_prem).
If terrorism does not exist, set TERRORISM_CVRG_ID = 0 for every premium bearing coverage on the policy (in vw_cvrg_prem); EXIT

Get terrorism cause of loss or exclusion to be used for lookup to D_TERRORISM_CVRG. 
The terror_cvrg_cd will be applied to all the premium bearing coverages under the OPS risk.
The terror_cvrg_cd will be applied to all the premium bearing coverages under the risk where TERROR or TERRORCB is attached.

If cvrg_catg_cd in (‘CL’, ‘EXC’) and cvrg_cd in (‘TFIRE’, ’TCERT’, ‘TERROR1’, ’TALOTH’, ’TBOTH’, ’TERROR99’, ’TLIMIT’, ’TNCRT’) 
   terror_cvrg_cd = cvrg_cd
   cvrg_cd_terror = ‘TERROR’


Check if there is premium charged for terrorism.  
The indicator will be applied to all the premium bearing coverages under the OPS risk where TERROR is attached.
The indicator will be applied to all the premium bearing coverages under the risk where TERROR or TERRORCB is attached.

If cvrg_catg_cd = ‘CVRG’ and cvrg_cd in (‘TERROR’,’TERRORCB’) and vw_prc_rating_prem.catg_cd =   ‘P’ and vw_prc_rating_prem.prem_amt =  0
    terror_premium_ind = 0
    Else terror_premium_ind = 1
(We are checking P versus PRP because on a delete of TERROR, PRP may = 0, such as for a CNRW.  We still need to capture that premium was charge for TERROR.)

Select all child risks of the ‘OPS’ risk where EDW.VW_POL_RISK_REL.CATEGORY_CD = 0.
Select all child risks of the risk where TERROR or TERRORCB is attached where EDW.VW_POL_RISK_REL.CATEGORY_CD = 0.     (This is to exclude risks that are included in a blanket coverage.)
The EBOPS terrorism stays just with it and is not applied to the other coverage codes on the policy.  
The exception is BROPS which is a child risk of IMOPS.  The BROPS terrorism stays with it and is applied to its child risks. The IMOPS terrorism is applied to its child risks excluding BROPS.*
The terror_cvrg_cd will be applied to all the premium bearing coverages under the OPS risk and its child risks.
The terror_premium_ind will be applied to all the premium bearing coverages under the OPS risk and its child risks.
The cvrg_cd_terror = ‘ANY’ will be applied to all the premium bearing coverages under the OPS risk and its child risks.
The terror_cvrg_cd will be applied to all the premium bearing coverages under the risk where TERROR or TERRORCB is attached and its child risks.
The terror_premium_ind will be applied to all the premium bearing coverages under the risk where TERROR or TERRORCB is attached and its child risks.
The cvrg_cd_terror = ‘ANY’ will be applied to all the premium bearing coverages under the risk where TERROR or TERRORCB is attached and its child risks.


If CVRG_CD = TAXSURCHRG, set TERRORISM_CVRG_ID = 0.


Get Bureau Reporting Module
Select bureau_reporting_module
From LK_SUBLINE_CODE
Where SUBLINE_CODE = subline_cd

Get TERRORISM_CVRG_ID 
Select TERRORISM_CVRG_ID 
From D_TERRORISM_CVRG
Where TERRORISM_CVRG_CD = terror_cvrg_cd
And BUREAU_REPORTING_MODULE = bureau_reporting_module
And EXPECTED_PREMIUM_IND = terror_premium_ind
And CVRG_CD_TERROR = cvrg_cd_terror
If not found TERRORISM_CVRG_ID = 0

*A change was made to the staging view script on EDW in schema FDW.VW_CVRG_REL_TERRORISM in order to accommodate the separation of the selection of the ID for UDPIM Risk Catg Cd's of IMOPS (and its children) and BROPS (and its children).","ETL - F_Divisional_Premiums
ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
","FDW_Core 332: Add terrorism_cvrg_id
(Julie Jordan 1/17/2012)

FDW_Core 707: Add cvrg_cd_terror to lookup for terrorism_cvrg_id
(Julie Jordan 2/27/2012)

FDW_Core 780: In EDW POL_RISK_REL look for CATEGORY_CD = 0 when attaching terrorism; Check premium P instead of PRP to set TERROR_PREMIUM_IND
(Shelly Conley 3/20/12)

dzieverink 1/20/16: Updated the selection of Terrorism ID to include the special case for UDPIM IMOPS and BROPS to be separate. Change was made by Brian Davis and Kevin under Jira DP-5427
sconley 1/24/17: Additional stories & defects are DP-4956, DP-7390, & QC Enterprise.Data_Platform 1176

sconley 2/8/17: Add the new terrorism cvrg_cd TERRORCB for ISO Property.
Add in additional cause of losses and exclusions that are in the d_terrorism_cvrg table but were not in the ETL. DP-7436 & QC ENTERPRISE.Data_Platform 1397

",2/8/2017,mmconley,"TERRORISM_CVRG_ID

The intent of this rule is to assign the Terrorism Coverage Id for each premium bearing coverage based on whether terrorism exists on the policy, the terrorism cause of loss or exclusion, if premium is charged for terrorism, and the bureau reporting module.

11/16/15 sconley: This rule is used in conjuntion with BR-21974 SIC Code - Terrorism Coverage Level - STAT Format (BR-92).  This rule determines the Terrorism Coverage ID and BR-21974 sets the 8th position of the SIC code based on the terrorism.

1/24/17 sconley: Added some more wording about BROPS and IMOPS.

2/8/17 sconley: Updates for ISO Property (DP-7436).",,,,,,,,,
BR-21907,78 Statistical Format Area for Inland Marine Premiums (UIM),,"ETL - D_Stat_Format_Premiums 
ETL - D_Stat_Inland_Marine_Premiums",,12/29/2016,mmconley,,,,,,,,,,
BR-22481,78.1 TRANS_TYPE,"When the STANDARD_NAME in ( 'CSP_TRAN_TYPE_CODE', 'TRANS_TYPE') move STAT_BREAKOUT_CODE to TRANS_TYPE_CODE","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22482,78.2 CLASS,"When the STANDARD_NAME = 'CLASS'. Move STAT_BREAKOUT_CODE to CLASS_CODE  
Remove the leading spaces (LTRIM) and the trailing spaces (RTRIM)
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,9/9/2013,lkummer,,,,,,,,,,
BR-22483,78.3 DEDUCTIBLE_CODE,When the STANDARD_NAME = 'DEDUCTIBLE_CODE'  move STAT_BREAKOUT_CODE to DEDUCTIBLE_CODE ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22484,78.4 RATE_DEPARTURE_FACTOR,When the STANDARD_NAME = 'RATE_DEPARTURE_FACTOR' move STAT_BREAKOUT_CODE to RATE_DEPARTURE_FACTOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/5/2013,lkummer,,,,,,,,,,
BR-22485,78.5 RATING_MOD_FACTOR_IRPM_SRP,"When the STANDARD_NAME = 'RATING_MOD_FACTOR_IRPM_SRP' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_IRPM_SRP
If FIELD_LENGTH = 3, move ‘0’ to position 4.
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22486,78.6 RATE_MOD_FACTOR_EXPENSE,"When the STANDARD_NAME = 'RATE_MOD_FACTOR_EXPENSE' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_EXPENSE
If FIELD_LENGTH = 3, move ‘0’ to position 4.
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22487,78.7 RATE_MOD_FACTOR_PACKAGE,"When the STANDARD_NAME = 'RATE_MOD_FACTOR_PACKAGE' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_PACKAGE
If FIELD_LENGTH = 3, move ‘0’ to position 4.
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22488,78.8 CONSTRUCTION_TYPE,When the STANDARD_NAME = 'CONSTRUCTION_TYPE'  move STAT_BREAKOUT_CODE to CONSTRUCTION_TYPE ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22489,78.9 PROTECTION_CODE,When the STANDARD_NAME = 'PROTECTION_CODE'  move STAT_BREAKOUT_CODE to PROTECTION_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/5/2013,lkummer,,,,,,,,,,
BR-22490,78.10 ZIP_CODE,When the STANDARD_NAME = 'ZIP_CODE'. Move STAT_BREAKOUT_CODE to ZIP_CODE_FIRST5,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,9/11/2017,mmconley,sconley 9/11/17: Updated rule with Experience table name,,,,,,,,,
BR-22491,78.11 SIC_CODE,When the STANDARD_NAME = 'SIC_CODE'. Move STAT_BREAKOUT_CODE to SIC_CODE  ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/5/2013,lkummer,,,,,,,,,,
BR-22492,78.12 NO_OF_FAMILIES,When the STANDARD_NAME = 'NO_OF_FAMILIES'  Move STAT_BREAKOUT_CODE to NO_OF_FAMILIES,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/5/2013,lkummer,,,,,,,,,,
BR-22493,78.13 DEDUCTIBLE_AMOUNT,"When the STANDARD_NAME = 'DEDUCTIBLE_AMOUNT'  move STAT_BREAKOUT_CODE to DEDUCTIBLE_AMOUNT 
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22494,78.14 NO_OF_STORIES,When the STANDARD_NAME = 'NO_OF_STORIES' move STAT_BREAKOUT_CODE to NO_OF_STORIES,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22495,78.15 YEAR_BUILT,When the STANDARD_NAME = 'YEAR_BUILT' move STAT_BREAKOUT_CODE to YEAR_BUILT,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/5/2013,lkummer,,,,,,,,,,
BR-22496,78.16 OCCUPATION_COVERAGE,When the STANDARD_NAME = 'OCCUPATION_COVERAGE'  move STAT_BREAKOUT_CODE to OCCUPATION_COVERAGE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-23475,78.17 COVERAGE_FORM,,,,7/13/2017,mmconley,sconley 7/13/17: The field is not applicable to UIM.,,,,,,,,,
BR-23476,78.18 SIC_DESC,,,,7/13/2017,mmconley,sconley 5/10/16: The field is not applicable to UPR.,,,,,,,,,
BR-22270,79 Statistical Format Area for Inland Marine Losses (UIM),,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,5/22/2013,moreilly,,,,,,,,,,
BR-22462,79.1 COVERAGE_INCEPTION_DT,When the STANDARD_NAME = 'COVERAGE_INCEPTION_DATE' move STAT_BREAKOUT_CODE to COVERAGE_INCEPTION_DATE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22463,79.2 TYPE_OF_LOSS,When the STANDARD_NAME = 'TYPE_OF_LOSS'.  Move STAT_BREAKOUT_CODE to TYPE_OF_LOSS,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22464,79.3 CLASS,"When the STANDARD_NAME = 'CLASS'. Move STAT_BREAKOUT_CODE to CLASS_CODE Remove the leading spaces (LTRIM)  and any trailling spaces(RTRIM)
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,9/9/2013,lkummer,,,,,,,,,,
BR-22465,79.4 COVERAGE_CODE,When the STANDARD_NAME = 'COVERAGE_CODE'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22466,79.5 DEDUCTIBLE_CODE,When the STANDARD_NAME = 'DEDUCTIBLE_CODE'  move STAT_BREAKOUT_CODE to DEDUCTIBLE_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22467,79.6 CONSTRUCTION_TYPE,When the STANDARD_NAME = 'CONSTRUCTION_TYPE'  move STAT_BREAKOUT_CODE to CONSTRUCTION_TYPE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22468,79.7 PROTECTION_CODE,When the STANDARD_NAME = 'PROTECTION_CODE'  move STAT_BREAKOUT_CODE to PROTECTION_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22469,79.8 ZIP_CODE,When the STANDARD_NAME = 'ZIP_CODE'. Move STAT_BREAKOUT_CODE to ZIP_CODE_FIRST5,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,9/11/2017,mmconley,sconley 9/11/17: Updated rule with Experience table name,,,,,,,,,
BR-22470,79.9 SIC_CODE,When the STANDARD_NAME = 'SIC_CODE'. Move STAT_BREAKOUT_CODE to SIC_CODE  ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22471,79.10 NO_OF_STORIES,When the STANDARD_NAME = 'NO_OF_STORIES' move STAT_BREAKOUT_CODE to NO_OF_STORIES,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22472,79.11 YEAR_BUILT,When the STANDARD_NAME = 'YEAR_BUILT' move STAT_BREAKOUT_CODE to YEAR_BUILT,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22473,79.12 OCCUPATION_COVERAGE,When the STANDARD_NAME = 'OCCUPATION_COVERAGE'  move STAT_BREAKOUT_CODE to OCCUPATION_COVERAGE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22474,79.13 TERRITORY_CODE,When the STANDARD_NAME = 'TERRITORY_CODE'  move STAT_BREAKOUT_CODE to TERRITORY_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22475,79.14 NO_OF_FAMILIES,When the STANDARD_NAME = 'NO_OF_FAMILIES'  Move STAT_BREAKOUT_CODE to NO_OF_FAMILIES,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22476,79.15 RISK_LOCATION_NUMBER,"When the STANDARD_NAME = 'RISK_LOCATION_NUMBER'  
Move STAT_BREAKOUT_CODE to RISK_LOCATION_NUMBER
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,6/7/2016,mmconley,,,,,,,,,,
BR-22477,79.16 CAUSE_OF_LOSS,When the STANDARD_NAME = 'CAUSE_OF_LOSS'  Move STAT_BREAKOUT_CODE to CAUSE_OF_LOSS,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,6/7/2016,mmconley,,,,,,,,,,
BR-22478,79.17 DEDUCTIBLE_AMOUNT,When the STANDARD_NAME = 'DEDUCTIBLE_AMOUNT'  move STAT_BREAKOUT_CODE to DEDUCTIBLE_AMOUNT ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22479,79.18 TRANS_TYPE,"When the STANDARD_NAME = ‘TRANS_TYPE_CODE’
Move STAT_BREAKOUT_CODE to TRANS_TYPE_CODE
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-21906,"80 Statistical Format Area for Fidelity & Crime Premiums (UFC)
 ",,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,12/29/2016,mmconley,,,,,,,,,,
BR-22033,80.1 CLASS,"When the STANDARD_NAME = 'CLASS'. Move STAT_BREAKOUT_CODE to CLASS_CODE  
Remove the leading spaces (LTRIM) and trailing spaces (RTRIM)","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,11/10/2017,mmconley,,,,,,,,,,
BR-22032,80.2 COVERAGE_CODE,"Default COVERAGE_CODE = 3. 

When the STANDARD_NAME = 'COVERAGE_CODE'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE
  ","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22031,80.3 COVERAGE_FORM,"
When the STANDARD_NAME = 'COVERAGE_FORM'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22030,80.4 CRIME_FORM,"
When the STANDARD_NAME = 'CRIME_FORM'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE       ","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22029,80.5 DEDUCTIBLE_CODE,When the STANDARD_NAME = 'DEDUCTIBLE_CODE'  move  STAT_BREAKOUT_CODE to DEDUCTIBLE_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22028,80.6 EXCESS_INDICATOR,When the STANDARD_NAME = 'EXCESS_INDICATOR'  move  STAT_BREAKOUT_CODE to EXCESS_INDICATOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,1/3/2017,mmconley,,,,,,,,,,
BR-22027,80.7 NO_OF_ADDL_LOCATION,When the STANDARD_NAME = 'NO_OF_ADDL_LOCATION'  move  STAT_BREAKOUT_CODE to NO_OF_ADDL_LOCATION,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22026,80.8 NO_OF_EMPLOYEES,When the STANDARD_NAME = 'NO_OF_EMPLOYEES'  move  STAT_BREAKOUT_CODE to NO_OF_EMPLOYEES,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22025,80.9 NO_OF_PREMISES,When the STANDARD_NAME = 'NO_OF_PREMISES'  move  STAT_BREAKOUT_CODE to NO_OF_PREMISES,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22024,80.10 RATE_DATE,When the STANDARD_NAME = 'RATE_DATE'  move STAT_BREAKOUT_CODE to RATE_DATE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22023,80.11 RATE_GROUP,When the STANDARD_NAME = 'RATE_GROUP'  move STAT_BREAKOUT_CODE to RATE_GROUP,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22022,80.12 SIC_CODE,When the STANDARD_NAME = 'SIC_CODE'. Move STAT_BREAKOUT_CODE to SIC_CODE  ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22021,80.13 TERRITORY_CODE,"When the STANDARD_NAME = 'TERRITORY_CODE'  move STAT_BREAKOUT_CODE to TERRITORY_CODE
If FIELD_LENGTH = 2, move 0 to position 1 and STAT_BREAKOUT_CODE to position 2-3.","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22020,80.14 TOTAL_NO_OF_EMPLOYEES,"straight move from vwa_stat_premiums:
total foreign employes + total ","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22019,80.15 TYPE_OF_POLICY,When the STANDARD_NAME = 'TYPE_OF_POLICY'  move STAT_BREAKOUT_CODE to TYPE_OF_POLICY,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22018,80.16 ZIP_CODE,When the STANDARD_NAME = 'ZIP_CODE'. Move STAT_BREAKOUT_CODE to ZIP_CODE_FIRST5,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,9/11/2017,mmconley,sconley 9/11/17: Updated rule with Experience table name,,,,,,,,,
BR-22017,80.17 RATE_DEPARTURE_FACTOR,"When the STANDARD_NAME = 'RATE_DEPARTURE_FACTOR' move STAT_BREAKOUT_CODE to RATE_DEPARTURE_FACTOR

If RATE_DEPARTURE_FACTOR =  000, move 100. 
*Verify what is actually happening in the code and add comments to defect.","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22016,80.18 RATE_MOD_FACTOR_EXPENSE,"When the STANDARD_NAME = 'RATE_MOD_FACTOR_EXPENSE' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_EXPENSE

If RATE_MOD_FACTOR_EXPENSE = 999 or 000, move 1000.
If FIELD_LENGTH = 3, move ‘0’ to position 4.","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,4/5/2013,lkummer,,,,,,,,,,
BR-22015,80.19 RATE_MOD_FACTOR_EXPERIENCE,"When the STANDARD_NAME = 'RATE_MOD_FACTOR_EXPERIENCE' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_EXPERIENCE


If RATE_MOD_FACTOR_EXPERIENCE = 999 or 000, move 1000.
If FIELD_LENGTH = 3, move ‘0’ to position 4.","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22014,80.20 RATE_MOD_FACTOR_IRPM,When the STANDARD_NAME = 'RATE_MOD_FACTOR_IRPM' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_IRPM,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22013,80.21 RATE_MOD_FACTOR_PACKAGE,When the STANDARD_NAME = 'RATE_MOD_FACTOR_PACKAGE' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_PACKAGE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22012,80.22 RATE_MOD_FACTOR_SCHEDULE,"When the STANDARD_NAME = 'RATE_MOD_FACTOR_SCHEDULE' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_SCHEDULE
If RATE_MOD_FACTOR_SCHEDULE = 999 or 000, move 1000.
If FIELD_LENGTH = 3, move ‘0’ to position 4.","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22011,80.23 TRANS_TYPE,"When the STANDARD_NAME in ( 'CSP_TRAN_TYPE_CODE',  'TRANS_TYPE') move STAT_BREAKOUT_CODE to TRANS_TYPE_CODE","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22009,80.24 RATE_MOD_FACTOR_FINAL,"When the STANDARD_NAME = 'RATE_MOD_FACTOR_FINAL' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_FINAL

If RATE_MOD_FACTOR_FINAL = 999 or 000, move 1000.
If FIELD_LENGTH = 3, move ‘0’ to position 4.","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums",,3/18/2013,lkummer,,,,,,,,,,
BR-22046,81 Statistical Format Area for Fidelity & Crime Losses (UFC),,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,5/22/2013,moreilly,,,,,,,,,,
BR-22117,81.1 CLASS,"When the STANDARD_NAME = 'CLASS'. Move STAT_BREAKOUT_CODE to CLASS_CODE  
Remove the leading spaces (LTRIM)  and any trailling spaces(RTRIM)","ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,11/10/2017,mmconley,,,,,,,,,,
BR-22118,81.2 COVERAGE_CODE,"Default COVERAGE_CODE = 3. 
When the STANDARD_NAME = 'COVERAGE_CODE'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE  ","ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22119,81.3 COVERAGE_FORM,"
When the STANDARD_NAME = 'COVERAGE_FORM'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE","ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22120,81.4 CRIME_FORM,"
When the STANDARD_NAME = 'CRIME_FORM'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE       ","ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22121,81.5 DEDUCTIBLE_CODE,When the STANDARD_NAME = 'DEDUCTIBLE_CODE'  move  STAT_BREAKOUT_CODE to DEDUCTIBLE_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22122,81.6 EXCESS_INDICATOR,When the STANDARD_NAME = 'EXCESS_INDICATOR'  move  STAT_BREAKOUT_CODE to EXCESS_INDICATOR,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,1/3/2017,mmconley,,,,,,,,,,
BR-22123,81.7 NO_OF_ADDL_LOCATION,When the STANDARD_NAME = 'NO_OF_ADDL_LOCATION'  move  STAT_BREAKOUT_CODE to NO_OF_ADDL_LOCATION,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22124,81.8 NO_OF_EMPLOYEES,When the STANDARD_NAME = 'NO_OF_EMPLOYEES'  move  STAT_BREAKOUT_CODE to NO_OF_EMPLOYEES,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22125,81.9 NO_OF_PREMISES,When the STANDARD_NAME = 'NO_OF_PREMISES'  move  STAT_BREAKOUT_CODE to NO_OF_PREMISES,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22126,81.10 RATE_DATE,When the STANDARD_NAME = 'RATE_DATE'  move STAT_BREAKOUT_CODE to RATE_DATE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22127,81.11 RATE_GROUP,When the STANDARD_NAME = 'RATE_GROUP'  move STAT_BREAKOUT_CODE to RATE_GROUP,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22128,81.12 SIC_CODE,When the STANDARD_NAME = 'SIC_CODE'. Move STAT_BREAKOUT_CODE to SIC_CODE  ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22129,81.13 TERRITORY_CODE,"When the STANDARD_NAME = 'TERRITORY_CODE'  move STAT_BREAKOUT_CODE to TERRITORY_CODE
If FIELD_LENGTH = 2, move 0 to position 1 and STAT_BREAKOUT_CODE to position 2-3.","ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22130,81.14 TOTAL_NO_OF_EMPLOYEES,"straight move from vwa_stat_premiums:
total foreign employes + total ","ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22131,81.15 TYPE_OF_POLICY,When the STANDARD_NAME = 'TYPE_OF_POLICY'  move STAT_BREAKOUT_CODE to TYPE_OF_POLICY,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22132,81.16 ZIP_CODE,When the STANDARD_NAME = 'ZIP_CODE'. Move STAT_BREAKOUT_CODE to ZIP_CODE_FIRST5  ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,9/8/2017,mmconley,,,,,,,,,,
BR-22133,81.17 DISCOVERY_DATE,"When the STANDARD_NAME = 'DISCOVERY_DATE' move STAT_BREAKOUT_CODE to DISCOVERY_DATE

","ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22134,81.18 TYPE_OF_LOSS,"When the STANDARD_NAME = 'TYPE_OF_LOSS' move STAT_BREAKOUT_CODE to TYPE_OF_LOSS
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-22135,81.19 TRANS_TYPE,"When the STANDARD_NAME in ( 'CSP_TRAN_TYPE_CODE',  'TRANS_TYPE') move STAT_BREAKOUT_CODE to TRANS_TYPE_CODE","ETL - D_Stat_Format_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/20/2013,lkummer,,,,,,,,,,
BR-21908,82 Statistical Format Area for General Liability Premiums (UGL),,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,5/10/2013,moreilly,,,,,,,,,,
BR-22140,82.1 TRANS_TYPE,When the STANDARD_NAME = 'TRANS_TYPE'' move STAT_BREAKOUT_CODE to TRANS_TYPE_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22141,"82.2 RETRO_PAR_INDICATOR	",When the STANDARD_NAME = 'RETRO_PAR_INDICATOR'  move STAT_BREAKOUT_CODE to RETRO_PAR_INDICATOR ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22143,82.3 CLASS,"When the STANDARD_NAME = 'CLASS'. Move STAT_BREAKOUT_CODE to CLASS_CODE  
Remove the leading spaces (LTRIM)","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22144,82.4 TERRITORY_CODE,When the STANDARD_NAME = 'TERRITORY_CODE'  move STAT_BREAKOUT_CODE to TERRITORY_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22145,82.5 LIMIT_IND,When the STANDARD_NAME = 'LIMIT_IND'  move  STAT_BREAKOUT_CODE to LIMIT_IND,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22146,82.6 RISK_INDICATOR,When the STANDARD_NAME = RISK_INDICATOR'  move  STAT_BREAKOUT_CODE to RISK_INDICATOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22147,82.7 RATING_IDENTIFICATION_IND,When the STANDARD_NAME = 'RATING_IDENTIFICATION_IND'  Move STAT_BREAKOUT_CODE to RATING_IDENTIFICATION_IND,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22148,82.8 RATE_DEPARTURE_FACTOR,When the STANDARD_NAME = 'RATE_DEPARTURE_FACTOR'  Move STAT_BREAKOUT_CODE to RATE_DEPARTURE_FACTOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22149,82.9 RATING_MOD_FACTOR_IRPM_SRP,When the STANDARD_NAME = 'RATING_MOD_FACTOR_IRPM_SRP'  Move STAT_BREAKOUT_CODE to RATING_MOD_FACTOR_IRPM_SRP ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22151,82.10 RATE_MOD_FACTOR_EXPERIENCE,When the STANDARD_NAME = RATE_MOD_FACTOR_EXPERIENCE'  Move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_EXPERIENCE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22152,82.11 RATE_MOD_FACTOR_SCHEDULE,When the STANDARD_NAME = 'RATE_MOD_FACTOR_SCHEDULE'  Move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_SCHEDULE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22153,82.12 RATE_MOD_FACTOR_EXPENSE,When the STANDARD_NAME = 'RATE_MOD_FACTOR_EXPENSE'  Move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_EXPENSE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22154,82.13 RATE_MOD_FACTOR_PACKAGE,When the STANDARD_NAME = 'RATE_MOD_FACTOR_EXPENSE'  Move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_EXPENSE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22155,82.14 COVERAGE_CODE,When the STANDARD_NAME = 'COVERAGE_CODE'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE  ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22156,82.15 CLAIMS_MADE_ENTRY_DATE,When the STANDARD_NAME = 'CLAIMS_MADE_ENTRY_DATE'  Move STAT_BREAKOUT_CODE to CLAIMS_MADE_ENTRY_DATE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22157,82.16 RETRO_DATE,When the STANDARD_NAME = 'RETRO_DATE'.  Move STAT_BREAKOUT_CODE to RETRO_DATE ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22161,82.17 INCREASE_LIMITS_FACTOR,When the STANDARD_NAME = 'INCREASE_LIMITS_FACTOR'.  Move STAT_BREAKOUT_CODE to INCREASE_LIMITS_FACTOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22163,82.18 LOCATION_CODE,When the STANDARD_NAME = 'LOCATION_CODE'.  Move STAT_BREAKOUT_CODE to LOCATION_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22164,82.19 EXPOSURE_INDICATOR,When the STANDARD_NAME = 'EXPOSURE_INDICATOR'.  Move STAT_BREAKOUT_CODE to EXPOSURE_INDICATOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22165,82.20 ZIP_CODE,When the STANDARD_NAME = 'ZIP_CODE'. Move STAT_BREAKOUT_CODE to ZIP_CODE_FIRST5,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,9/11/2017,mmconley,sconley 9/11/17: Updated rule with Experience table name,,,,,,,,,
BR-22166,82.21 PROGRAM_CODE,"When the STANDARD_NAME = 'PROGRAM_CODE' move STAT_BREAKOUT_CODE to PROGRAM_CODE

Move '00' to PROGRAM_CODE for Premium per Informatica information provided by Prathima Tiruveedhi on 7/12/17.	

","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,7/18/2017,dburns4,Per Green Lanterns story US16262 for premiums populate PROGRAM_CODE = '00',,,,,,,,,
BR-22167,82.22 STATE_EXCEPTION_INDICATOR,When the STANDARD_NAME = 'STATE_EXCEPTION_INDICATOR'. Move STAT_BREAKOUT_CODE to STATE_EXCEPTION_INDICATOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22168,82.23 SIC_CODE,When the STANDARD_NAME = 'SIC_CODE'. Move STAT_BREAKOUT_CODE to SIC_CODE  ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22169,82.24 MOLD_DAMAGE_CODE,When the STANDARD_NAME = 'MOLD_DAMAGE_CODE'. Move STAT_BREAKOUT_CODE to MOLD_DAMAGE_CODE ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22170,82.25 CO_PAYMENT_PERCENT,"When the STANDARD_NAME = 'CO_PAYMENT_PERCENT'. Move STAT_BREAKOUT_CODE to CO_PAYMENT_PERCENT

The information from Informatica:  move 3 spaces

Move ('   ') to CO_PAYMENT_PERCENT","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,7/18/2017,dburns4,"Per Green Lanterns story US16262, from Informatica information from Prathima Tiruveedhi, move 3 spaces to co_payment_percent
",,,,,,,,,
BR-22171,82.26 NO_OF_FAMILIES,When the STANDARD_NAME = 'NO_OF_FAMILIES'. Move STAT_BREAKOUT_CODE to NO_OF_FAMILIES,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22172,82.27 FARM_TYPE,"When the STANDARD_NAME = 'FARM_TYPE'. Move STAT_BREAKOUT_CODE to FARM_TYPE  

From Informatica per Prathima:
iif(PRIMARY_FARM_CATG_CD != '0'
     ,lpad(PRIMARY_FARM_CATG_CD,10,' ')
     ,'          '
) 

","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,7/18/2017,dburns4,"Green Lanterns US16262 story for premium side to show how this field populated based on Information information provided by Prathima Tiruveedhi
",,,,,,,,,
BR-22173,82.28 FARM_OWNED_LEASED_CD,"When the STANDARD_NAME = 'FARM_OWNED_LEASED_CD'. Move STAT_BREAKOUT_CODE to FARM_OWNED_LEASED_CD

From Informatica per Prathima:
iif(OWNED_LEASED_CD != '0'
    ,lpad(OWNED_LEASED_CD,10,' ')
    ,'          '
) ","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,7/18/2017,dburns4,Green Lanterns US16262 story for premium side to show how this field populated based on Information information provided by Prathima Tiruveedhi,,,,,,,,,
BR-22174,82.29 FARM_ACREAGE,When the STANDARD_NAME = 'FARM_ACREAGE'. Move STAT_BREAKOUT_CODE to FARM_ACREAGE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22175,82.30 SUPPLEMENTAL_ERP_END_DT,When the STANDARD_NAME = 'SUPPLEMENTAL_ERP_END_DT''. Move STAT_BREAKOUT_CODE to SUPPLEMENTAL_ERP_END_DT,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22176,82.31 SUPPLEMENTAL_ERP_DURATION,When the STANDARD_NAME = 'SUPPLEMENTAL_ERP_DURATION'. Move STAT_BREAKOUT_CODE to SUPPLEMENTAL_ERP_DURATION,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,4/8/2013,moreilly,,,,,,,,,,
BR-22676,82.32 BI_DEDUCTIBLE_CODE,When the STANDARD_NAME = 'BI_DEDUCTIBLE_CODE'. Move STAT_BREAKOUT_CODE to BI_DEDUCTIBLE_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,9/26/2013,dzieverink,,,,,,,,,,
BR-22677,82.33 PD_DEDUCTIBLE_CODE,When the STANDARD_NAME = 'PD_DEDUCTIBLE_CODE'. Move STAT_BREAKOUT_CODE to PD_DEDUCTIBLE_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,9/26/2013,dzieverink,,,,,,,,,,
BR-22678,82.34 PD_LIMIT,When the STANDARD_NAME = 'PROPERTY_DAMAGE_LIMIT'. Move STAT_BREAKOUT_CODE to PD_LIMIT,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,9/26/2013,dzieverink,,,,,,,,,,
BR-22679,82.35 BI_LIMIT,When the STANDARD_NAME = 'BODILY_INJURY_LIMIT'. Move STAT_BREAKOUT_CODE to BI_LIMIT,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,9/26/2013,dzieverink,,,,,,,,,,
BR-22789,82.36 LIABILITY_LIMIT,When the STANDARD_NAME = 'LIABILITY_LIMIT'  move  STAT_BREAKOUT_CODE to LIABILITY_LIMIT,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,1/10/2018,mmconley,sconley 1/10/18: The field is not applicable to UGL.,,,,,,,,,
BR-22790,82.37 DEDUCTIBLE_CODE,When the STANDARD_NAME = 'DEDUCTIBLE_CODE'.  Move STAT_BREAKOUT_CODE to DEDUCTIBLE_CODE ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",,1/10/2018,mmconley,sconley 1/10/18: The field is not applicable to UGL.,,,,,,,,,
BR-23361,82.38 ATTACHMENT_POINT_SIZE_CODE,"When the STANDARD_NAME = 'ATTACHMENT_POINT_SIZE_CODE'. Move STAT_BREAKOUT_CODE to ATTACHMENT_POINT_SIZE_CODE
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums",FDW_Core 8193: Update Logic for Deductible Code and Attachment Point for both General Liability Premium and Loss,2/25/2016,mmconley,sconley 2/25/16: Added field to DOORs,,,,,,,,,
BR-22178,83 Statistical Format Area for General Liability Losses (UGL),,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,2/25/2016,mmconley,sconley 2/25/16: Added fields that are on d_stat_liability_losses but not applicable to UGL to avoid confusion on whether the fields should be populated for UGL.,,,,,,,,,
BR-22241,83.1 RATE_DATE,When the STANDARD_NAME = 'RATE_DATE'  move STAT_BREAKOUT_CODE to RATE_DATE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22242,83.2 TYPE_OF_LOSS,When the STANDARD_NAME = 'TYPE_OF_LOSS'  move STAT_BREAKOUT_CODE to TYPE_OF_LOSS,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22243,83.3 RETRO_PAR_INDICATOR ,When the STANDARD_NAME = 'RETRO_PAR_INDICATOR'  move STAT_BREAKOUT_CODE to RETRO_PAR_INDICATOR ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22244,83.4 CLASS,When the STANDARD_NAME = 'CLASS'. Move STAT_BREAKOUT_CODE to CLASS_CODE  ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22245,83.5 TERRITORY_CODE,"When the STANDARD_NAME = 'TERRITORY_CODE'  move STAT_BREAKOUT_CODE to TERRITORY_CODE

If FIELD_LENGTH = 2, move 0 to position 1 and STAT_BREAKOUT_CODE to position 2-3
.","ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2014,dburns4,,,,,,,,,,
BR-22246,83.6 LIMIT_IND,When the STANDARD_NAME = 'LIMIT_INDICATOR' move STAT_BREAKOUT_CODE to LIMIT_INDICATOR,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22247,83.7 LIABILITY_LIMIT,"When the STANDARD_NAME = 'LIABILITY_LIMIT'  move  STAT_BREAKOUT_CODE to LIABILITY_LIMIT

This is the information from Informatica for this field:
DECODE(true
                     ,PREVIOUSLY_CONVERTED_IND = 1 AND  NOT ISNULL(conv_LIABILITY_LIMIT), conv_UGL_LIABILITY_LIMIT
                     ,ugl_BODILY_INJURY_LIMIT
)","ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,7/18/2017,dburns4,"Green Lanterns US16262 story to obtain what the actual Informatica code was received information from Prathima Tiruveedhi

",,,,,,,,,
BR-22248,83.8 DEDUCTIBLE_CODE,When the STANDARD_NAME = 'DEDUCTIBLE_CODE'.  Move STAT_BREAKOUT_CODE to DEDUCTIBLE_CODE ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22249,83.9 RATING_IDENTIFICATION_IND,When the STANDARD_NAME = 'RATING_IDENTIFICATION_IND'  Move STAT_BREAKOUT_CODE to RATING_IDENTIFICATION_IND,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22250,83.10 COVERAGE_CODE,"Default COVERAGE_CODE = 3.

When the STANDARD_NAME = 'COVERAGE_CODE'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE 
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22251,83.11 CLAIMS_MADE_ENTRY_DATE,When the STANDARD_NAME = 'CLAIMS_MADE_ENTRY_DATE'  Move STAT_BREAKOUT_CODE to CLAIMS_MADE_ENTRY_DATE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22252,83.12 RECEIPT_OF_CLAIMS_NOTICE_DATE,"When the STANDARD_NAME = 'RECEIPT_OF_CLAIMS_NOTICE_DATE'  Move STAT_BREAKOUT_CODE to RECEIPT_OF_CLAIMS_NOTICE_DATE

This is the information from Informatica for this field:
DECODE(true
                     ,PREVIOUSLY_CONVERTED_IND = 1 AND  NOT ISNULL(conv_RECEIPT_OF_CLAIMS_NOTICE_DATE),conv_UGL_RECEIPT_OF_CLAIMS_NOTICE_DATE
                     ,LPAD(GET_DATE_PART(REPORT_TO_INSR_DT,'MM'),2,'0') || SUBSTR(GET_DATE_PART(REPORT_TO_INSR_DT,'YY') ,3,4)
)","ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,7/18/2017,dburns4,Green Lanterns US16262 story to obtain what the actual Informatica code was received information from Prathima Tiruveedhi,,,,,,,,,
BR-22253,83.13 RETRO_DATE,When the STANDARD_NAME = 'RETRO_DATE'  move STAT_BREAKOUT_CODE to RETRO_DATE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22254,83.14 LOCATION_CODE,When the STANDARD_NAME = 'LOCATION_CODE'.  Move STAT_BREAKOUT_CODE to LOCATION_CODE ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22255,83.15 EXPOSURE_INDICATOR,When the STANDARD_NAME = 'EXPOSURE_INDICATOR' move STAT_BREAKOUT_CODE to EXPOSURE_INDICATOR,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22256,83.16 PROGRAM_CODE,"When the STANDARD_NAME = 'PROGRAM_CODE' move STAT_BREAKOUT_CODE to PROGRAM_CODE

Information from Informatica for PROGRAM_CODE on the loss side:
DECODE (true
                      ,PREVIOUSLY_CONVERTED_IND = 1 AND  NOT ISNULL(conv_PROGRAM_CODE),conv_PROGRAM_CODE
                      ,SRC_SYS_CD='UDAGRI','00'
                      ,'  '
)
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,7/18/2017,dburns4,Green Lanterns US16262 story to obtain what the actual Informatica code was received information from Prathima Tiruveedhi,,,,,,,,,
BR-22257,83.17 ZIP_CODE,When the STANDARD_NAME = 'ZIP_CODE'. Move STAT_BREAKOUT_CODE to ZIP_CODE_FIRST5,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,9/11/2017,mmconley,sconley 9/11/17: Updated rule with Experience table name,,,,,,,,,
BR-22258,83.18 STATE_EXCEPTION_INDICATOR,When the STANDARD_NAME = 'STATE_EXCEPTION_INDICATOR' move STAT_BREAKOUT_CODE to STATE_EXCEPTION_INDICATOR,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22259,83.19 SIC_CODE,When the STANDARD_NAME = 'SIC_CODE'. Move STAT_BREAKOUT_CODE to SIC_CODE  ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22260,83.20 RISK_INDICATOR,When the STANDARD_NAME = 'RISK_INDICATOR' move STAT_BREAKOUT_CODE to RISK_INDICATOR,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22261,83.21 CO_PAYMENT_PERCENT,"When the STANDARD_NAME = 'CO_PAYMENT_PERCENT' move STAT_BREAKOUT_CODE to CO_PAYMENT_PERCENT

The information from Informatica:  move 3 spaces

Move ('   ') to CO_PAYMENT_PERCENT
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,7/18/2017,dburns4,"Per Green Lanterns story US16262, from Informatica information from Prathima Tiruveedhi, move 3 spaces to co_payment_percent",,,,,,,,,
BR-22262,83.22 MOLD_DAMAGE_CODE,When the STANDARD_NAME = 'MOLD_DAMAGE_CODE' move STAT_BREAKOUT_CODE to MOLD_DAMAGE_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22263,83.23 NO_OF_FAMILIES,When the STANDARD_NAME = 'NO_OF_FAMILIES_CD' move STAT_BREAKOUT_CODE to NO_OF_FAMILIES_CD,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22264,83.24 FARM_TYPE,"When the STANDARD_NAME = 'FARM_TYPE' move STAT_BREAKOUT_CODE to FARM_TYPE

From Informatica per Prathima:
iif(PRIMARY_FARM_CATG_CD != '0'
     ,lpad(PRIMARY_FARM_CATG_CD,10,' ')
     ,'          '
) 
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,7/18/2017,dburns4,Green Lanterns US16262 story for premium side to show how this field populated based on Information information provided by Prathima Tiruveedhi,,,,,,,,,
BR-22265,83.25 FARM_OWNED_LEASED_CD,"When the STANDARD_NAME = 'FARM_OWNED_LEASED_CD' move STAT_BREAKOUT_CODE to FARM_OWNED_LEASED_CD

From Informatica per Prathima:
iif(OWNED_LEASED_CD != '0'
    ,lpad(OWNED_LEASED_CD,10,' ')
    ,'          '
) 
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,7/18/2017,dburns4,Green Lanterns US16262 story for premium side to show how this field populated based on Information information provided by Prathima Tiruveedhi,,,,,,,,,
BR-22266,83.26 FARM_ACREAGE,When the STANDARD_NAME = 'FARM_ACREAGE' move STAT_BREAKOUT_CODE to FARM_ACREAGE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22267,83.27 TRANS_TYPE,When the STANDARD_NAME = 'TRANS_TYPE'' move STAT_BREAKOUT_CODE to TRANS_TYPE_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22268,83.28 SUPPLEMENTAL_ERP_END_DT,When the STANDARD_NAME = 'SUPPLEMENTAL_ERP_END_DT''. Move STAT_BREAKOUT_CODE to SUPPLEMENTAL_ER,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22269,83.29 SUPPLEMENTAL_ERP_DURATION,When the STANDARD_NAME = 'SUPPLEMENTAL_ERP_DURATION'. Move STAT_BREAKOUT_CODE to SUPPLEMENTAL_ER,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",,4/8/2013,moreilly,,,,,,,,,,
BR-22792,83.30 BI_LIMIT,When the STANDARD_NAME = 'BODILY_INJURY_LIMIT'. Move STAT_BREAKOUT_CODE to BI_LIMIT,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses
",,9/26/2013,dzieverink,,,,,,,,,,
BR-22793,83.31 PD_LIMIT,When the STANDARD_NAME = 'PROPERTY_DAMAGE_LIMIT'. Move STAT_BREAKOUT_CODE to PD_LIMIT,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses
",,9/26/2013,dzieverink,,,,,,,,,,
BR-22794,83.32 PD_DEDUCTIBLE_CODE,When the STANDARD_NAME = 'PD_DEDUCTIBLE_CODE'. Move STAT_BREAKOUT_CODE to PD_DEDUCTIBLE_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses
",,9/26/2013,dzieverink,,,,,,,,,,
BR-22795,83.33 BI_DEDUCTIBLE_CODE,When the STANDARD_NAME = 'BI_DEDUCTIBLE_CODE'. Move STAT_BREAKOUT_CODE to BI_DEDUCTIBLE_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses
",,9/26/2013,dzieverink,,,,,,,,,,
BR-23360,83.34 ATTACHMENT_POINT_SIZE_CODE,When the STANDARD_NAME = 'ATTACHMENT_POINT_SIZE_CODE'. Move STAT_BREAKOUT_CODE to ATTACHMENT_POINT_SIZE_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Liability_Losses",FDW_Core 8193: Update Logic for Deductible Code and Attachment Point for both General Liability Premium and Loss,2/25/2016,mmconley,sconley 2/25/16: Added field to DOORs,,,,,,,,,
BR-23362,83.35 COVERAGE_INCEPTION_DT,,ETL - D_Stat_Liability_Losses,FDW_Core 5362: Personal Liability and homeowners data is not included in the FDW aggregate tables,2/25/2016,mmconley,sconley 2/25/16: The field is not applicable to UGL. Field added for mainframe claims.,,,,,,,,,
BR-21910,84 Statistical Format Area for Commercial Auto Premiums (UCA),"Execute  Build SIC - Terrorism  Code for Stat Premiums (BR-21974)
Execute  Build Rate Factors for Stat Premiums (BR-21975)
Execute Build Stat Format Code (BR-21976)
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,12/29/2016,mmconley,"Removed the rule for price bracket, it now has it's own business rule",,,,,,,,,
BR-22272,84.1 TRANS_TYPE,"When the STANDARD_NAME in ( 'CSP_TRAN_TYPE_CODE',  'TRANS_TYPE') move STAT_BREAKOUT_CODE to TRANS_TYPE_CODE","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22273,84.2 CLASS,"When the STANDARD_NAME = 'CLASS'. Move STAT_BREAKOUT_CODE to CLASS_CODE  

If FIELD_LENGTH = 1, move 0 to positions 2-6.
If FIELD_LENGTH = 4, move 0 to positions 5-6.
If FIELD_LENGTH = 5, move 0 to positions 6.
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22274,84.3 TERRITORY_CODE,"When the STANDARD_NAME = 'TERRITORY_CODE'  move STAT_BREAKOUT_CODE to TERRITORY_CODE

If FIELD_LENGTH = 2, move 0 to positions 1 ","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22275,84.4 PREMIUM_DISCOUNT_INDICATOR,When the STANDARD_NAME = 'PREMIUM_DISCOUNT_INDICATOR' move STAT_BREAKOUT_CODE to PREMIUM_DISCOUNT_INDICATOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22276,84.5 PROGRAM_CODE,When the STANDARD_NAME = 'PROGRAM_CODE' move STAT_BREAKOUT_CODE to PROGRAM_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22277,84.6 RATE_DEPARTURE_FACTOR,"When the STANDARD_NAME = 'RATE_DEPARTURE_FACTOR' move STAT_BREAKOUT_CODE to RATE_DEPARTURE_FACTOR 

If RATE_DEPARTURE_FACTOR = spaces, move 100.","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22278,84.7 RATE_MOD_FACTOR_EXPENSE,"When the STANDARD_NAME = 'RATE_MOD_FACTOR_EXPENSE' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_EXPENSE 

If RATE_MOD_FACTOR_EXPENSE spaces, move 1000.
If FIELD_LENGTH = 3, move ‘0’ to position 4.","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22279,84.8 RATE_MOD_FACTOR_EXPERIENCE,"When the STANDARD_NAME = 'RATE_MOD_FACTOR_EXPERIENCE' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_EXPERIENCE

If RATE_MOD_FACTOR_EXPERIENCE spaces, move 1000.
If FIELD_LENGTH = 3, move ‘0’ to position 4.
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22280,84.9 RATE_MOD_FACTOR_MISC,"When the STANDARD_NAME = 'RATE_MOD_FACTOR_MISC' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_MISC

If RATE_MOD_FACTOR_MISC spaces, move 1000.
If FIELD_LENGTH = 3, move ‘0’ to position 4.
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22281,84.10 RATE_MOD_FACTOR_SCHEDULE,"When the STANDARD_NAME = 'RATE_MOD_FACTOR_SCHEDULE' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_SCHEDULE

If RATE_MOD_FACTOR_SCHEDULE spaces, move 1000.
If FIELD_LENGTH = 3, move ‘0’ to position 4.
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22282,84.11 RATING_MOD_FACTOR_IRPM_SRP,"When the STANDARD_NAME = 'RATE_MOD_FACTOR_IRPM_SRP' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_IRPM_SRP

If RATE_MOD_FACTOR_IPRM_SRP spaces, move 1000.
If FIELD_LENGTH = 3, move ‘0’ to position 4.
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22283,84.12 RATING_IDENTIFICATION_IND,When the STANDARD_NAME = 'RATING_IDENTIFICATION_IND'  Move STAT_BREAKOUT_CODE to RATING_IDENTIFICATION_IND  ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22284,84.13 RETRO_PAR_INDICATOR,When the STANDARD_NAME = 'RETRO_PAR_INDICATOR'  move STAT_BREAKOUT_CODE to RETRO_PAR_INDICATOR ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22285,84.14 SIC_CODE,When the STANDARD_NAME = 'SIZE_OF_RISK'  move STAT_BREAKOUT_CODE to SIZE_OF_RISK ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22286,84.15 ZIP_CODE,When the STANDARD_NAME = 'ZIP_CODE'. Move STAT_BREAKOUT_CODE to ZIP_CODE_FIRST5  ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,9/11/2017,mmconley,sconley 9/11/17: Updated rule with Experience table name,,,,,,,,,
BR-22287,84.16 SIZE_OF_RISK,When the STANDARD_NAME = 'SIZE_OF_RISK'  move STAT_BREAKOUT_CODE to SIZE_OF_RISK ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22288,84.17 STATE_EXCEPTION_INDICATOR,When the STANDARD_NAME = 'STATE_EXCEPTION_INDICATOR' move STAT_BREAKOUT_CODE to STATE_EXCEPTION_INDICATOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22289,84.18 ZONE_RATING_CODE,When the STANDARD_NAME = 'ZONE_RATING_CODE' move STAT_BREAKOUT_CODE to ZONE_RATING_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22290,84.19 MOD_ID,When the STANDARD_NAME = 'MOD_ID' move STAT_BREAKOUT_CODE to MOD_ID   ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22291,84.20 RATE,"When the STANDARD_NAME = 'RATE'  move STAT_BREAKOUT_CODE to RATE_AMOUNT

","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22292,84.21 RISK_LOCATION_NUMBER,When the STANDARD_NAME = 'RISK_LOCATION_NUMBER' move STAT_BREAKOUT_CODE to RISK_LOCATION_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22293,84.22 ANTI_THEFT_DEVICE,When the STANDARD_NAME = 'ANTI_THEFT_DEVICE' move STAT_BREAKOUT_CODE to ANTI_THEFT_DEVICE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22294,84.23 ORIGINAL_COST_NEW,"When the STANDARD_NAME = 'ORIGINAL_COST_NEW' move STAT_BREAKOUT_CODE to ORIGINAL_COST_NEW
If FIELD_LENGTH = 1, move 0 to positions 1-2 
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22295,84.24 OTC_COLL_COVERAGE,"When the STANDARD_NAME = 'OTC_COLL_COVERAGE' move STAT_BREAKOUT_CODE to OTC_COLL_COVERAGE
If FIELD_LENGTH = 2, move 0 to position 1 
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22296,84.25 VALUE_RATING_UNIT,When the STANDARD_NAME = 'VALUE_RATING_UNIT ' move STAT_BREAKOUT_CODE to VALUE_RATING_UNIT   ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22297,84.26 AGE_CODE,When the STANDARD_NAME = 'AGE_CODE' move STAT_BREAKOUT_CODE to AGE_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22298,84.27 COVERAGE_CODE,"When the STANDARD_NAME = 'COVERAGE_CODE'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE 

If FIELD_LENGTH = 1, move 0 to positions 1-2 and coverage_code to position 3.
If FIELD_LENGTH = 2, move 0 to position 1 and coverage_code to postion 2 & 3
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22299,84.28 AGGREGATE_LIMIT,When the STANDARD_NAME = 'AGGREGATE_LIMIT'  move  STAT_BREAKOUT_CODE to AGGREGATE_LIMIT,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22300,84.29 BODILY_INJURY_LIMIT,"When the STANDARD_NAME = 'BODILY_INJURY_LIMIT'  move  STAT_BREAKOUT_CODE to BI_LIMIT

If FIELD_LENGTH = 1, move 0 to position 1 
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22301,84.30 MED_PAY_LIMIT,"When the STANDARD_NAME = 'MED_PAY_LIMIT'  move  STAT_BREAKOUT_CODE to MED_PAY_LIMIT
If FIELD_LENGTH = 1, move 0 to position 1 ","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22302,84.31 PROPERTY_DAMAGE_LIMIT,"When the STANDARD_NAME = 'PROPERTY_DAMAGE_LIMIT'  move  STAT_BREAKOUT_CODE to PROPERTY_DAMAGE_LIMIT If FIELD_LENGTH = 1, move 0 to positions 1 ","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22303,84.32 UNINSURED_LIMIT,"When the STANDARD_NAME = 'UNINSURED_LIMIT'  move  STAT_BREAKOUT_CODE to UNINSURED_LIMIT

If FIELD_LENGTH = 1, move 0 to position 1 
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22304,84.33 UNDERINSURED_LIMIT,When the STANDARD_NAME = 'UNDERINSURED_LIMITS'  move  STAT_BREAKOUT_CODE to UNDERINSURED_LIMIT ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22305,84.34 LIMIT_IND,When the STANDARD_NAME = 'LIMIT_IND' move  STAT_BREAKOUT_CODE to LIMIT_IND ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22306,84.35 COVERAGE_INDICATOR,When the STANDARD_NAME = 'COVERAGE_INDICATOR'.  Move STAT_BREAKOUT_CODE to COVERAGE_INDICATOR ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22307,84.36 EXCESS_INDICATOR,When the STANDARD_NAME = 'EXCESS_INDICATOR' move STAT_BREAKOUT_CODE to EXCESS_INDICATOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,1/3/2017,mmconley,,,,,,,,,,
BR-22308,84.37 PIP_LIMIT,"When the STANDARD_NAME = 'PIP_LIMIT'  move  STAT_BREAKOUT_CODE to PIP_LIMIT If FIELD_LENGTH = 1, move 0 to positions 1 ","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22309,84.38 PIP_RATING_BASIS,When the STANDARD_NAME = 'PIP_RATING_BASIS'  move  STAT_BREAKOUT_CODE to PIP_RATING_BASIS ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22310,84.39 PIP_DEDUCTIBLE,"When the STANDARD_NAME = 'PIP_DEDUCTIBLE'  move  STAT_BREAKOUT_CODE to PIP_DEDUCTIBLE_CODE If FIELD_LENGTH = 1, move 0 to positions 1 ","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22311,84.40 UM_STACKING_IND,When the STANDARD_NAME = 'UM_STACKING_IND' move  STAT_BREAKOUT_CODE to UM_STACKING_IND ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22312,84.41 UIM_STACKING_IND,When the STANDARD_NAME = 'UIM_STACKING_IND' move  STAT_BREAKOUT_CODE to UIM_STACKING_IND ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22313,84.42 PRICE_BRACKET,When the STANDARD_NAME = 'PRICE_BRACKET' move STAT_BREAKOUT_CODE to PRICE_BRACKET,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22314,84.43 VEHICLE_COUNT,When the STANDARD_NAME = 'VEHICLE_COUNT ' move STAT_BREAKOUT_CODE to VEHICLE_COUNT   ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-22315,84.44 VEHICLE_ID_NO,When the STANDARD_NAME = 'VEHICLE_ID_NO' move STAT_BREAKOUT_CODE to VEHICLE_ID_NO,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,4/9/2013,moreilly,,,,,,,,,,
BR-23507,84.45 MECHANICAL_LIFT_IND,,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,10/31/2018,ragarwal,,,,,,,,,,
BR-23508,84.46 MODEL_YEAR,,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,10/31/2018,ragarwal,,,,,,,,,,
BR-23509,84.47 NO_OF_POWERED_VEHICLES,,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,10/31/2018,ragarwal,,,,,,,,,,
BR-23501,84.48 Stated_amt_code,When the STANDARD_NAME = STATED_AMT_CODE move STAT_BREAKOUT_CODE to = 'STATED_AMT_CODE';,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",,9/18/2018,lkummer,,,,,,,,,,
BR-23504,84.49 BLDG_OPEN_LOTS_CODE,When the STANDARD_NAME = BLDG_OPEN_LOTS_CODE move STAT_BREAKOUT_CODE to = 'BLDG_OPEN_LOTS_CODE';,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums",Added for Duck Creek - Garage Risks,10/30/2018,ragarwal,,,,,,,,,,
BR-22179,85 Statistical Format Area for Commercial Auto Losses (UCA),"Execute  SIC Code - Terrorism Coverage Level - STAT Format (BR-21974)
Execute Build Stat Format Code (BR-22535)
",ETL - D_Stat_Format_Losses,,12/29/2016,mmconley,,,,,,,,,,
BR-22317,85.1 RATE_DATE,"When the STANDARD_NAME = 'RATE_DATE'  move STAT_BREAKOUT_CODE to RATE_DATE

When the STANDARD_NAME = 'RATE_MONTH'  move the STAT_BREAKOUT_CODE to RATE_DATE first 2 bytes  When the STANDARD_NAME = 'RATE_YEAR'  move the STAT_BREAKOUT_CODE to RATE_DATE bytes 3 and 4.","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22318,85.2 TYPE_OF_LOSS,"When the STANDARD_NAME = 'TYPE_OF_LOSS'  move STAT_BREAKOUT_CODE to TYPE_OF_LOSS

If FIELD_LENGTH = 2, Move 0 to position 1.   
If FIELD_LENGTH = 1, Move 0 to positions 1-2. ","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22319,85.3 RETRO_PAR_INDICATOR,When the STANDARD_NAME = 'RETRO_PAR_INDICATOR'  move STAT_BREAKOUT_CODE to RETRO_PAR_INDICATOR ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22320,85.4 CLASS,"When the STANDARD_NAME = 'CLASS'. Move STAT_BREAKOUT_CODE to CLASS_CODE  

If FIELD_LENGTH = 4, move 0 to positions 5-6.
If FIELD_LENGTH = 5, move 0 to positions 6.","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22321,85.5 TERRITORY_CODE,"When the STANDARD_NAME = 'TERRITORY_CODE'  move STAT_BREAKOUT_CODE to TERRITORY_CODE

If FIELD_LENGTH = 2, move 0 to positions 1","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22322,85.6 ZONE_RATING_CODE,When the STANDARD_NAME = 'ZONE_RATING_CODE' move STAT_BREAKOUT_CODE to ZONE_RATING_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22323,85.7 STATE_EXCEPTION_INDICATOR,When the STANDARD_NAME = 'STATE_EXCEPTION_INDICATOR' move STAT_BREAKOUT_CODE to STATE_EXCEPTION_INDICATOR,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22324,85.8 RATING_IDENTIFICATION_IND,When the STANDARD_NAME = 'RATING_IDENTIFICATION_IND'  Move STAT_BREAKOUT_CODE to RATING_IDENTIFICATION_IND  ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22325,85.9 ZIP_CODE,When the STANDARD_NAME = 'ZIP_CODE'. Move STAT_BREAKOUT_CODE to ZIP_CODE_FIRST5,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,9/11/2017,mmconley,sconley 9/11/17: Updated rule with Experience table name,,,,,,,,,
BR-22326,85.10 PROGRAM_CODE,When the STANDARD_NAME = 'PROGRAM_CODE' move STAT_BREAKOUT_CODE to PROGRAM_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22327,85.11 SIC_CODE,When the STANDARD_NAME = 'SIC_CODE'. Move STAT_BREAKOUT_CODE to SIC_CODE  ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22328,85.12 ANTI_THEFT_DEVICE,When the STANDARD_NAME = 'ANTI_THEFT_DEVICE' move STAT_BREAKOUT_CODE to ANTI_THEFT_DEVICE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22329,85.13 ORIGINAL_COST_NEW,"When the STANDARD_NAME = 'ORIGINAL_COST_NEW' move STAT_BREAKOUT_CODE to ORIGINAL_COST_NEW

If FIELD_LENGTH = 1, move 0 to positions 1-2","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22330,85.14 OTC_COLL_COVERAGE,"When the STANDARD_NAME = 'OTC_COLL_COVERAGE' move STAT_BREAKOUT_CODE to OTC_COLL_COVERAGE

If FIELD_LENGTH = 2, move 0 to position 1
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22331,85.15 VALUE_RATING_UNIT,When the STANDARD_NAME = 'VALUE_RATING_UNIT ' move STAT_BREAKOUT_CODE to VALUE_RATING_UNIT   ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22332,85.16 AGE_CODE,When the STANDARD_NAME = 'AGE_CODE' move STAT_BREAKOUT_CODE to AGE_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22333,85.17 COVERAGE_CODE,When the STANDARD_NAME = 'COVERAGE_CODE'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22334,85.18 AGGREGATE_LIMIT,When the STANDARD_NAME = 'AGGREGATE_LIMIT'  move  STAT_BREAKOUT_CODE to AGGREGATE_LIMIT,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22335,85.19 LIABILITY_LIMIT,When the STANDARD_NAME = 'LIABILITY_LIMIT'  move  STAT_BREAKOUT_CODE to LIABILITY_LIMIT,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22336,85.20 MED_OR_UNINSURED_LIMIT,When the STANDARD_NAME = 'MED_OR_UNINSURED_LIMIT'  move  STAT_BREAKOUT_CODE to MED_OR_UNINSURED_LIMIT,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22337,85.21 UNDERINSURED_LIMIT,When the STANDARD_NAME = 'UNDERINSURED_LIMIT'  move  STAT_BREAKOUT_CODE to UNDERINSURED_LIMIT,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22338,85.22 LIMIT_IND,When the STANDARD_NAME = 'LIMIT_IND'  move  STAT_BREAKOUT_CODE to LIMIT_IND ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22339,85.23 FACILITY_LOSS_TYPE,When the STANDARD_NAME = 'FACILITY_LOSS_TYPE' move STAT_BREAKOUT_CODE to FACILITY_LOSS_TYPE ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22340,85.24 PIP_LIMIT,"When the STANDARD_NAME = 'PIP_LIMIT'  move  STAT_BREAKOUT_CODE to PIP_LIMIT

If FIELD_LENGTH = 1, move 0 to positions 1","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22341,85.25 PIP_RATING_BASIS,When the STANDARD_NAME = 'PIP_RATING_BASIS'  move  STAT_BREAKOUT_CODE to PIP_RATING_BASIS ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22342,85.26 PIP_DEDUCTIBLE,"When the STANDARD_NAME = 'PIP_DEDUCTIBLE'  move  STAT_BREAKOUT_CODE to PIP_DEDUCTIBLE

If FIELD_LENGTH = 1, move 0 to positions 1","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22343,85.27 PRICE_BRACKET,When the STANDARD_NAME = 'PRICE_BRACKET' move STAT_BREAKOUT_CODE to PRICE_BRACKET,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22344,85.28 VEHICLE_COUNT,When the STANDARD_NAME = 'VEHICLE_COUNT ' move STAT_BREAKOUT_CODE to VEHICLE_COUNT   ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22345,85.29 VEHICLE_ID_NO,When the STANDARD_NAME = 'VEHICLE_ID_NO' move STAT_BREAKOUT_CODE to VEHICLE_ID_NO,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-22346,85.30 TRANS_TYPE,When the STANDARD_NAME = 'TRANS_TYPE'  move  STAT_BREAKOUT_CODE to TRANS_TYPE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,4/9/2013,moreilly,,,,,,,,,,
BR-23482,85.31 MODEL_YEAR,Field Length = 4,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",Added for MA Auto conversion,8/29/2017,dzieverink,,,,,,,,,,
BR-23483,85.32 RISK_INDICATOR,Field Length = 1,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",Added for MA Auto conversion,8/29/2017,dzieverink,,,,,,,,,,
BR-23484,85.33 TOTAL_PARTIAL_LOSS,"TOTAL_PARTIAL_LOSS = EDW.CLM_FEAT_HIST.TOTAL_LOSS_IND

Field Length = 1","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses","Added for MA Auto conversion

DP-2271",8/29/2017,dzieverink,,,,,,,,,,
BR-23485,85.34 VIN_NUMBER,"Moves from EDW via RISK_VEHICLE.VIN_CD

Field Length = 17 (pad 0's if number sent is less than 17 digits)","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses","Added for MA Auto conversion

DP-2271",8/29/2017,dzieverink,,,,,,,,,,
BR-23486,85.35 ACCIDENT_STATE,Field Length = 3,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",Added for MA Auto conversion,8/29/2017,dzieverink,,,,,,,,,,
BR-23487,85.36 PREM_TOWN,"PREM_TOWN = ISO_TERRITORY_CD

Field Length = 3","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",Added for MA Auto conversion,8/29/2017,dzieverink,,,,,,,,,,
BR-23488,85.37 PASSIVE_RESTRAINT_CODE,"Moves from EDW via RISK_VEHICLE.VEHIC_PASSIVE_RESTRAINT_CD

Field Length = 1","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",Added for MA Auto conversion,8/29/2017,dzieverink,,,,,,,,,,
BR-23489,85.38 SYMBOL_OCN_CODE,"When Risk_State = 'MA' 
	Set Symbol_OCN_Code = LK.Symbol_OCN_Code (Original_Cost_New)

Field Length = 2","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses","Added for MA Auto conversion

DP-2220",8/29/2017,dzieverink,,,,,,,,,,
BR-23512,85.39 NO_OF_POWERED_VEHICLES,,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,10/31/2018,ragarwal,"Updated DOORS 
",,,,,,,,,
BR-23513,85.40 STATED_AMT_CODE,,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,10/31/2018,ragarwal,Updtaed DOORS,,,,,,,,,
BR-23514,85.41 MECHANICAL_LIFT_IND,,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses",,10/31/2018,ragarwal,Updated DOORS,,,,,,,,,
BR-23506,"85.42 BLDG_OPEN_LOTS_CODE	","When the STANDARD_NAME = BLDG_OPEN_LOTS_CODE move STAT_BREAKOUT_CODE to = 'STATED_AMT_CODE';
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Auto_Losses
","Added for Duck Creek - Garage Risks
",10/30/2018,ragarwal,,,,,,,,,,
BR-21911,86 Statistical Format Area for Property Premiums (UPR),"Execute  Build SIC - Terrorism  Code for Stat Premiums (BR-21974)
Execute  Build Rate Factors for Stat Premiums (BR-21975)
Execute Build Stat Format Code (BR-21976)
If STAT_FORMAT_CODE = ‘UPR’ 
     then
If CVRG_CD in (( ‘FINCHRG’, ‘BMP’, ’BRMP’ , ‘AQUA’) 
   or CVRG_GROUP = ‘SBP’)  
   then TRANS_TYPE_CD = ‘2’ 
else TRANS_TYPE_CD =  ‘1’  
TERRITORY_CODE: see detailed rules for UPR Territory Code - Premiums and Losses (BR-22587)
lpad(SUBSTR (RATE_CLASS_CD,1,6),6,' ') 
CONSTRUCTION_TYPE: see detailed rules for UPR Construction Type - Premiums & Losses (BR-23348) and UPR Construction Type Earthquake - Premiums and Losses (BR-22592)
PROTECTION_CODE: see detailed rules for UPR Protection Code – Premiums and Losses (BR-22570)
DEDUCTIBLE_CODE: see detailed rules for UPR Deductible Code – Premiums and Losses (BR-22593)
COVERAGE_CODE: see detailed rules for UPR Coverage Code – Premiums and Losses (BR-22514)
If  lk_minor_line_pkg_xref.COVERAGE_CODE_ FORM_CODE is not null
  Then POLICY_FORM = COVERAGE_CODE_FORM_CODE 
Else
   If Subline in (‘105’,’106’)
     Then 
     If CVRG_CHILD_PF = ‘BASIC’
       Then POLICY_FORM = ‘1’
     Else
     if CVRG_CHILD_PF = ‘BROAD’
       Then POLICY_FORM = ‘2’
     Else
     if CVRG_CHILD_PF in ( ‘BROADSPCL’)
       Then POLICY_FORM = ‘3’
     Else
      if CVRG_CHILD_PF in ( ‘SPECIAL’)
       Then POLICY_FORM = ‘6’
   Else 
       POLICY_FORM = ‘9’
Else 
    POLICY_FORM =  ‘ ’ (space)
CO_INSURANCE_IND: see detailed rules for Coinsurance Indicator – Premiums and Losses (BR-26000)
INCREASE_LIMITS_FCTR (1) = ‘0’
INCREASE_LIMITS_FCTR (2-4) = ws.INCREASE_LIMITS_FCTR 
If INCREASE_LIMITS_FCTR = ‘0000’ 
  Then INCREASE_LIMITS_FCTR = ‘    ‘  (4 spaces)
  (if there is not an INCREASED_LIMITS_FACTOR
   rate factor we want the default to be spaces)
IF SUBLINE_CD = ‘970’
  If HSB_COVERAGE_CD in (‘010’,’012’)
    Move ‘225’
  Else 
    If HSB_COVERAGE_CD in (‘013’,’014’,’022’)
      Move ‘100’
    Endif
  Endif
Else
    Move ws.RATE_DEPART_FCTR
Move
Move
If ws.RATE_MOD_FCTR_LOSS_FREE = ‘000’ 
  Move ‘100’
Else
  Move ws.RATE_MOD_FCTR_LOSS_FREE   
  (chg default from 000 to 100)
If ws. RATE_MOD_FCTR_MULTI_LOC = ‘000’ 
  Move ‘100’
Else
  Move RATE_MOD_FCTR_MULTI_LOC
  (chg default from 000 to 100)
Move
Default = ‘100’
(chg default from 000 to 100)
If POSTAL_CD is blank then POSTAL_CD = ‘     ‘ 

YEAR_BUILT: see detailed rules for UPR Year Built – Premiums and Losses (BR-22605 & BR-23453 (Earthquake))
SIC_CODE
STATE_EXCEPTION_INDICATOR: see detailed rules for UPR State Exception Indicator – Premiums and Losses (BR-22598)
If SUBLINE_CD = ‘930’  
    Then BLDG_GRADE_CODE = ‘99’
Else 
  IF FIPS_US_Alpha_CD in (‘FL’, ‘WA’)
    IF BCEG_CD is not null    
      Then BLDG_GRADE_CODE = BCEG_CD 
      (If BCEG_CD is one digit include a leading ‘0’)
    Else BLDG_GRADE_CODE = ‘99‘ 
 Else BLDG_GRADE_CODE = ‘  ‘ 
(Chg default for ‘FL’ & ’WA’ from ‘00’ to ‘99’)
If SUBLINE_CD in (‘115’,‘116’,’135’,’136’,’155’,’156’, ‘106’)
  Then
     If PTF_UPR_MDC1_IND = ‘1’
       Then MOLD_DAMAGE_CD = ‘A’
     Else
     If PTF_UPR_MDC2_IND = ‘1’
       Then MOLD_DAMAGE_CD = ‘B’
  Else MOLD_DAMAGE_CD = ‘9’
Else MOLD_DAMAGE_CD = ‘ ‘ space
IF SUBLINE_CD = ‘970’
  If HSB_COVERAGE_CD in (‘010’,’012’)
    Then RATING_INDENT_IND = ‘4’
  Else 
    RATING_INDENT_IND = ‘3’ 
  Endif
Else
  If SRC_SYS_CD in (‘UDPIM’,'BRIDGE-PAS')
    Then RATING_INDENT_IND = ‘ ‘ (space)
  Else
    If lk.PARENT_BUSN_CVRG_CD = ‘FPFSFPP’
      Then RATING_INDENT_IND = ‘6’ 
    else RATING_INDENT_IND = 2
PROGRAM_CODE: see detailed rules for UPR Program Code - Premiums (BR-23371) 
If SUBLINE_CD in (‘116’, ‘136’, ‘156’) 
  IF PTF_UPR_OLCC_IND = ‘1’
   Then ORD_LAW_COV_CD = ‘5’
  Else ORD_LAW_COV_CD = ‘1’
Else ORD_LAW_COV_CD = ‘ ’
(Chg default from ‘0’ to ‘ ’)
TYPE_OF_COVERAGE: see detailed rules for UPR Type of Coverage - Premiums and Losses (BR-23351)
ATTACHMENT_IND: see detailed rules for UPR Attachment Indicator – Premiums and Losses (BR-23352)
Default = ‘    ‘ (4 spaces)
WIND_CATATROPHE_IND: see detailed rules for Wind Catastrophe Indicator - UPR Premiums (BR-23454)
Select POL_LIMIT_AMT
from FDW.d_cvrg_limit  cl
Where cl.EDW_CVRG_HIST_ID = CVRG_HIST_ID

Select DEDUCT_AMT,
          DEDUCT_PCNT
From FDW.d_cvrg_deduct  cd
Where cd.EDW_CVRG_HIST_ID = CVRG_HIST_ID

IF SUBLINE_CD = ‘930’
   Then DEDUCT_AMT = ‘0000000000’
        
If SUBLINE_CD = ‘106’
  and CVRG_CD = ‘LIVELOV’
    Then DEDUCT_AMT = POL_LIMIT_AMT/DEDUCT_PCNT
  Else 
     DEDUCT_AMT = cd.DEDUCT_AMT (left pad 0)
Else  
   DEDUCT_AMT = ‘0000000000’
If SUBLINE_CD = ‘930’
  Then EXPOSURE_IND = 1
Else EXPOSURE_IND = =  ‘ ’
(Chg default from ‘0’ to ‘ ’)
If SUBLINE_CD = ‘930’ 
  If  SAFEGUARD_CD = ‘SPRINKLER’
    Then RISK_INDICATOR = ‘1’
  Else RISK_INDICATOR = ‘2’
Else RISK_INDICATOR =  ‘ ’
(Chg default from ‘0’ to ‘ ’)
RATE_GRADE: see detailed rules for UPR Rate Grade – Premiums and Losses (BR-22612)
NO_OF_STORIES: see detailed rules for UPR Number of Stories - Premiums & Losses (BR-23347) and UPR Number of Stories Earthquake - Premiums and Losses (BR-22613)
If SUBLINE_CD in (‘116’,’136’,’156’,’176’,’196’)
   Then RATE_GROUP = ‘9’ 
Else RATE_GROUP = ‘ ‘ (space)
Default  =  ‘ ‘ (space)
If Safeguard_CD = SPRINKLER 
Then SPRINKLER_ID = 1
Else ‘0’
REPLACEMENT_COST_ENDORSEMENT: see detailed rules for UPR Replacement Cost Endorsement - Premiums (BR-23450)

","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums","UWD.PIM 18006: Updates for TYPE_OF_COVERAGE & ATTACHMENT_IND for Earthquake.

FDW_Core 10217: Updates for CONSTRUCTION_TYPE & NO_OF_STORIES.

FDW_Core 10262: Updates for DEDUCTIBLE_CODE.

dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202)

dzieverink 1/6/17: Added Replacement Cost Ind logic per Rick's stat area doc for ISO Property (QC DP-1129)",7/5/2017,mmconley,"10/13/15 sconley: FDW_Core 9593 Updated NO_OF_STORIES to reference revised rules for populating stat area for UPR Number of Stories Premiums & Losses (BR-23347) & UPR Number of Stories Earthquake - Premiums & Losses (BR-22613).

1/7/16 sconley: 
-Updated COVERAGE_CD to reference detailed rules for populating stat area for UPR Coverage Code - Premiums and Losses (BR-22514). No rule change, no defect.
-UWD.PIM 18006 Updated TYPE_OF_COVERAGE to reference detailed rules for populating stat area for UPR Type of Coverage - Premiums and Losses (BR-23351)
-UWD.PIM 18006 Updated ATTACHMENT_IND to reference detailed rules for populating stat area for UPR Attachment Indicator - Premiums and Losses (BR-23352)

1/26/16 sconley: FDW_Core 10217 Updated CONSTRUCTION_TYPE to reference revised rules for populating stat area for UPR Construction Type - Premiums & Losses (BR-23348) and UPR Construction Type Earthquake - Premiums and Losses (BR-22592).

3/14/16 sconley: Updated QC # to 10217 for CONSTRUCTION_TYPE & NO_OF_STORIES.

4/18/16 sconley:  FDW_Core 10262.  Updated DEDUCTIBLE_CODE to reference revised rules for populating stat area for UPR Deductible Code - Premiums and Losses (BR-22593).

5/3/16 sconley: Updated RATE_GRADE to reference rules for populating stat area for UPR Rate Grade - Premiums and Losses (BR-22612).

5/9/16 sconley: Updated PROGRAM_CODE to reference rules for populating stat area for UPR Program Code - Premiums (BR-23371).

2/6/17 sconley: Updated REPLACEMENT_COST_ENDORSEMENT to reference rules for populating stat area for UPR Replacement Cost Endorsement - Premiums (BR-23450).

2/20/17 sconley: Updated YEAR_BUILT to reference rules for populating stat area for UPR Year Built - Premiums & Losses  (BR-22605 & BR-23453 (Earthquake)).

3/10/17 sconley: Updated PROTECTION_CODE to reference revised rules for populating stat area for UPR Protection Code - Premiums and Losses (BR-22570).
Updated STATE_EXCEPTION_INDICATOR to reference revised rules for populating stat area for UPR State Exception Indicator - Premiums and Losses (BR-22598).

3/15/17 sconley: Updated WIND_CATASTROPHE_IND to reference revised rules for populating stat area for Wind Catastrophe Indicator - UPR Premiums (BR-23454).

7/5/17 sconley: Updated CO_INSURANCE_IND to reference revised rules for populating stat area for Coinsurance Indicator - UPR Premiums and Losses (BR-26000).
",,,,,,,,,
BR-22349,86.1 TRANS_TYPE,"When the STANDARD_NAME in ( 'CSP_TRAN_TYPE_CODE', 'TRANS_TYPE_CODE') move STAT_BREAKOUT_CODE to TRANS_TYPE_CODE","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22350,86.2 TERRITORY_CODE,When the STANDARD_NAME = 'TERRITORY_CODE'  move STAT_BREAKOUT_CODE to TERRITORY_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,7/12/2017,mmconley,,,,,,,,,,
BR-22351,86.3 CLASS,"When the STANDARD_NAME = 'CLASS'. Move STAT_BREAKOUT_CODE to CLASS_CODE. 
 
If FIELD_LENGTH = 3, Move 0 to position 4.   
Remove the leading spaces (LTRIM)
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22352,86.4 CONSTRUCTION_TYPE,"When the STANDARD_NAME = 'CONSTRUCTION_TYPE'  move STAT_BREAKOUT_CODE to CONSTRUCTION_TYPE

IF CONTRUCTION_TYPE = ‘ ‘ or ‘  ‘ (1 or 2 spaces)
Move ‘   ‘ 3 spaces.
If FIELD_LENGTH = 1, move 0 to positions 1-2 and STAT_BREAKOUT_CODE to position 3.
If FIELD_LENGTH = 2, move 0 to positions 1 and STAT_BREAKOUT_CODE to positions 2-3
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,1/26/2016,mmconley,sconley 1/26/16:  See revised rules for populating construction_type in the stat area for UPR (BR-23348 & BR-22592),,,,,,,,,
BR-22353,86.5 PROTECTION_CODE,"When the STANDARD_NAME = 'PROTECTION_CODE'  move STAT_BREAKOUT_CODE to PROTECTION_CODE

If FIELD_LENGTH = 1, move 0 to position 1 and STAT_BREAKOUT_CODE to position 2
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22354,86.6 DEDUCTIBLE_CODE,When the STANDARD_NAME = 'DEDUCTIBLE_CODE'  move STAT_BREAKOUT_CODE to DEDUCTIBLE_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22355,86.7 COVERAGE_CODE,When the STANDARD_NAME = 'COVERAGE_CODE'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22356,86.8 POLICY_FORM,When the STANDARD_NAME = 'POLICY_FORM'  move STAT_BREAKOUT_CODE to POLICY_FORM,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22357,86.9 CO_INSURANCE_IND,When the STANDARD_NAME = 'CO_INSURANCE_IND' move STAT_BREAKOUT_CODE to CO_INSURANCE_IND,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22358,86.10 INCREASE_LIMITS_FACTOR,When the STANDARD_NAME = 'INCREASE_LIMITS_FACTOR' move STAT_BREAKOUT_CODE to INCREASED_LIMITS_FACTOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22359,86.11 RATE_DEPARTURE_FACTOR,When the STANDARD_NAME = 'RATE_DEPARTURE_FACTOR' move STAT_BREAKOUT_CODE to RATE_DEPARTURE_FACTOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22360,86.12 RATING_MOD_FACTOR_IRPM_SRP,When the STANDARD_NAME = 'RATING_MOD_FACTOR_IRPM_SRP' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_IRPM_SRP,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22361,86.13 RATE_MOD_FACTOR_EXPENSE,When the STANDARD_NAME = 'RATE_MOD_FACTOR_EXPENSE' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_EXPENSE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22362,86.14 RATE_MOD_FACTOR_LOSS_FREE,When the STANDARD_NAME = 'RATE_MOD_FACTOR_LOSS_FREE' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_LOSS_FREE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22363,86.15 RATE_MOD_FACTOR_MULTI_LOC,When the STANDARD_NAME = 'RATE_MOD_FACTOR_MULTI_LOC' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_MULTI_LOC,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22364,86.16 RATE_MOD_FACTOR_PACKAGE,When the STANDARD_NAME = 'RATE_MOD_FACTOR_PACKAGE' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_PACKAGE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22365,86.17 RATE_MOD_FACTOR_OTHER,When the STANDARD_NAME = 'RATE_MOD_FACTOR_OTHER' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_OTHER,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22366,86.18 ZIP_CODE,When the STANDARD_NAME = 'ZIP_CODE'. Move STAT_BREAKOUT_CODE to ZIP_CODE_FIRST5,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,9/11/2017,mmconley,sconley 9/11/17: Updated rule with Experience table name,,,,,,,,,
BR-22367,86.19 YEAR_BUILT,When the STANDARD_NAME = 'YEAR_BUILT' move STAT_BREAKOUT_CODE to YEAR_BUILT,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,2/20/2017,mmconley,,,,,,,,,,
BR-22368,86.20 SIC_CODE,When the STANDARD_NAME = 'SIC_CODE'. Move STAT_BREAKOUT_CODE to SIC_CODE  ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22369,86.21 STATE_EXCEPTION_INDICATOR,When the STANDARD_NAME = 'STATE_EXCEPTION_INDICATOR' move STAT_BREAKOUT_CODE to STATE_EXCEPTION_INDICATOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22370,86.22 BLDG_GRADE_CODE,When the STANDARD_NAME = 'BLDG_GRADE_CODE' move STAT_BREAKOUT_CODE to BUILDING_GRADE_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22371,86.23 MOLD_DAMAGE_CODE,"When the STANDARD_NAME IN ('MOD_ID',  'MOLD_DAMAGE_CODE' ) move STAT_BREAKOUT_CODE to MOLD_DAMAGE_CODE","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22372,86.24 RATING_IDENTIFICATION_IND,When the STANDARD_NAME = 'RATING_MOD_FACTOR_IRPM_SRP' move STAT_BREAKOUT_CODE to RATE_MOD_FACTOR_IRPM_SRP,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22373,86.25 PROGRAM_CODE,When the STANDARD_NAME = 'PROGRAM_CODE' move STAT_BREAKOUT_CODE to PROGRAM_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22374,86.26 ORDINANCE/LAW_COV_ID_CODE,"When the STANDARD_NAME = 'ORDINANCE/LAW_COV_ID_CODE' move STAT_BREAKOUT_CODE to ORDINANCE_OR_LAW_IND
(stat area field name ORDINANCE_LAW_COV_ID_CODE))","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/27/2017,mmconley,sconley 4/27/17: Added stat area field name.,,,,,,,,,
BR-22375,86.27 TYPE_OF_COVERAGE,When the STANDARD_NAME = 'TYPE_OF_COVERAGE'  move STAT_BREAKOUT_CODE to TYPE_OF_COVERAGE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,1/26/2016,mmconley,sconley 1/26/16:  See revised rules for populating type_of_coverage in the stat area for UPR (BR-23351),,,,,,,,,
BR-22376,86.28 ATTACHMENT_INDICATOR,When the STANDARD_NAME = 'ATTACHMENT_INDICATOR' move STAT_BREAKOUT_CODE to ATTACHMENT_INDICATOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,1/26/2016,mmconley,sconley 1/26/16:  See revised rules for populating attachment_ind in the stat area for UPR (BR-23352),,,,,,,,,
BR-22377,86.29 LOSS_COST_DATE,When the STANDARD_NAME = 'LOSS_COST_DATE'  Move STAT_BREAKOUT_CODE to LOSS_COST_DATE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22378,86.30 WIND_CATASTROPHE_IND,"When the STANDARD_NAME = 'WIND_CONSTRUCTION_IND' move STAT_BREAKOUT_CODE to WIND_CONSTRUCTION_IND

If FIELD_LENGTH = 1, move 0 to position 1 and STAT_BREAKOUT_CODE to position 2
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22379,86.31 DEDUCTIBLE_AMOUNT,When the STANDARD_NAME = 'DEDUCTIBLE_AMOUNT'  move STAT_BREAKOUT_CODE to DEDUCTIBLE_AMOUNT ,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22380,86.32 EXPOSURE_INDICATOR,When the STANDARD_NAME = 'EXPOSURE_INDICATOR' move STAT_BREAKOUT_CODE to EXPOSURE_INDICATOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22381,86.33 RISK_INDICATOR,When the STANDARD_NAME = 'RISK_INDICATOR' move STAT_BREAKOUT_CODE to RISK_INDICATOR,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22382,86.34 RATE_GRADE,When the STANDARD_NAME = 'RATE_GRADE' move STAT_BREAKOUT_CODE to RATE_GRADE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22383,86.35 NO_OF_STORIES,When the STANDARD_NAME = 'NO_OF_STORIES' move STAT_BREAKOUT_CODE to NO_OF_STORIES,"ETL - D_Stat_Property_Premiums


",,10/13/2015,mmconley,sconley 10/13/15: See revised rules for populating no_of_stories in the stat area for UPR (BR-23347 & BR-22613).,,,,,,,,,
BR-22384,86.36 RATE_GROUP,When the STANDARD_NAME = 'RATE_GROUP' move STAT_BREAKOUT_CODE to RATE_GROUP,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22385,86.37 OCCUPANCY,When the STANDARD_NAME = 'OCCUPANCY' move STAT_BREAKOUT_CODE to OCCUPANCY_CODE,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22386,86.38 SPRINKLER_ID,When the STANDARD_NAME = 'SPRINKLER_ID' move STAT_BREAKOUT_CODE to SPRINKLER_ID,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,4/5/2013,moreilly,,,,,,,,,,
BR-22387,86.39 REPLACEMENT_COST_ENDORSEMENT,When the STANDARD_NAME = 'REPLACEMENT_COST_ENDORSEMENT' move STAT_BREAKOUT_CODE to REPLACEMENT_COST_ENDORSEMENT,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,6/27/2017,mmconley,,,,,,,,,,
BR-22180,87 Statistical Format Area for Property Losses (UPR),,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,12/29/2016,mmconley,"sconley 2/25/16, 5/4/16, 5/9/16, 5/10/16: Added fields that are on d_stat_property_losses but not applicable to UPR to avoid confusion as to whether the fields should be populated for UPR.",,,,,,,,,
BR-22389,87.1 RATE_DATE,When the STANDARD_NAME = 'RATE_DATE'  move STAT_BREAKOUT_CODE to RATE_DATE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22390,87.2 TYPE_OF_LOSS,"When the STANDARD_NAME = 'TYPE_OF_LOSS'  move STAT_BREAKOUT_CODE to TYPE_OF_LOSS

If FIELD_LENGTH = 2, Move 0 to position 1.   
If FIELD_LENGTH = 1, Move 0 to positions 1-2","ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22391,87.3 TERRITORY_CODE,When the STANDARD_NAME = 'TERRITORY_CODE'  move STAT_BREAKOUT_CODE to TERRITORY_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,9/8/2017,mmconley,,,,,,,,,,
BR-22392,87.4 CLASS,"When the STANDARD_NAME = 'CLASS'. Move STAT_BREAKOUT_CODE to CLASS_CODE  

If FIELD_LENGTH = 3, Move 0 to position 4.   
If FIELD_LENGTH = 2, Move 0 to positions 3-4.   
Remove the leading spaces (LTRIM)
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22393,87.5 COVERAGE_CODE,When the STANDARD_NAME = 'COVERAGE_CODE'.  Move STAT_BREAKOUT_CODE to COVERAGE_CODE ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22394,87.6 RATING_IDENTIFICATION_IND,When the STANDARD_NAME = 'RATING_IDENTIFICATION_IND'  Move STAT_BREAKOUT_CODE to RATING_IDENTIFICATION_IND  ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22395,87.7 CONSTRUCTION_TYPE,"When the STANDARD_NAME = 'CONSTRUCTION_TYPE'  move STAT_BREAKOUT_CODE to CONSTRUCTION_TYPE

IF CONSTRUCTION_TYPE = ‘ ‘ or ‘  ‘ (1 or 2 spaces)
Move ‘   ‘ 3 spaces.
If FIELD_LENGTH = 1, move 0 to positions 1-2 and STAT_BREAKOUT_CODE to position 3.
If FIELD_LENGTH = 2, move 0 to positions 1 and STAT_BREAKOUT_CODE to positions 2-3.
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,1/26/2016,mmconley,sconley 1/26/16:  See revised rules for populating construction_type in the stat area for UPR (BR-23348 & BR-22592),,,,,,,,,
BR-22396,87.8 PROTECTION_CODE,"When the STANDARD_NAME = 'PROTECTION_CODE'  move STAT_BREAKOUT_CODE to PROTECTION_CODE

If FIELD_LENGTH = 1, move 0 to position 1 
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22397,87.9 DEDUCTIBLE_CODE,"When the STANDARD_NAME = 'DEDUCTIBLE_CODE'  move STAT_BREAKOUT_CODE to DEDUCTIBLE_CODE

If FIELD_LENGTH = 1, move 0 to position 1
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22398,87.10 CLASS_LIMIT,When the STANDARD_NAME = 'CLASS_LIMIT' move STAT_BREAKOUT_CODE to CLASS_LIMIT,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22399,87.11 SIC_CODE,When the STANDARD_NAME = 'SIC_CODE'. Move STAT_BREAKOUT_CODE to SIC_CODE  ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22400,87.12 STATE_EXCEPTION_INDICATOR,When the STANDARD_NAME = 'STATE_EXCEPTION_INDICATOR' move STAT_BREAKOUT_CODE to STATE_EXCEPTION_INDICATOR,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22401,87.13 BLDG_GRADE_CODE,When the STANDARD_NAME = 'BUILDING_GRADE_CODE' move STAT_BREAKOUT_CODE to BUILDING_GRADE_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22402,87.14 CO_INSURANCE_IND,When the STANDARD_NAME = 'CO_INSURANCE_IND' move STAT_BREAKOUT_CODE to CO_INSURANCE_IND,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22403,87.15 PROGRAM_CODE,When the STANDARD_NAME = 'PROGRAM_CODE' move STAT_BREAKOUT_CODE to PROGRAM_CODE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22404,87.16 ORDINANCE/LAW_COV_ID_CODE,"When the STANDARD_NAME = 'ORDINANCE/LAW_COV_ID_CODE' move STAT_BREAKOUT_CODE to ORDINANCE_OR_LAW_COV_CODE
(stat area field name ORDINANCE_LAW_COV_ID_CODE))","ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/27/2017,mmconley,4/27/17 sconley: Added stat area field name and corrected field name in d_stat_property_losses.,,,,,,,,,
BR-22405,87.17 ZIP_CODE,When the STANDARD_NAME = 'ZIP_CODE'. Move STAT_BREAKOUT_CODE to ZIP_CODE_FIRST5,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,9/11/2017,mmconley,sconley 9/11/17: Updated rule with Experience table name,,,,,,,,,
BR-22406,87.18 YEAR_BUILT,"When the STANDARD_NAME = 'YEAR_BUILT' move STAT_BREAKOUT_CODE to YEAR_BUILT

If FIELD_LENGTH = 2, move 19 to positions 1-2
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22407,87.19 DEDUCTIBLE_AMOUNT,When the STANDARD_NAME = 'DEDUCTIBLE_AMOUNT'  move STAT_BREAKOUT_CODE to DEDUCTIBLE_AMOUNT ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22408,87.20 MOLD_DAMAGE_CODE,"When the STANDARD_NAME IN ('MOD_ID',  'MOLD_DAMAGE_CODE' ) move STAT_BREAKOUT_CODE to MOLD_DAMAGE_CODE","ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22409,87.21 LIMIT_AMOUNT,When the STANDARD_NAME = 'LIMIT_AMOUNT'  move STAT_BREAKOUT_CODE to LIMIT_AMOUNT ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22410,87.22 RISK_INDICATOR,When the STANDARD_NAME = 'RISK_INDICATOR' move STAT_BREAKOUT_CODE to RISK_INDICATOR,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22411,87.23 TYPE_OF_COVERAGE,When the STANDARD_NAME = 'TYPE_OF_COVERAGE'  move STAT_BREAKOUT_CODE to TYPE_OF_COVERAGE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,1/26/2016,mmconley,sconley 1/26/16:  See revised rules for populating type_of_coverage in the stat area for UPR (BR-23351),,,,,,,,,
BR-22412,87.24 ATTACHMENT_INDICATOR,When the STANDARD_NAME = 'ATTACHMENT_INDICATOR' move STAT_BREAKOUT_CODE to ATTACHMENT_INDICATOR,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,1/26/2016,mmconley,sconley 1/26/16:  See revised rules for populating attachment_ind in the stat area for UPR (BR-23352),,,,,,,,,
BR-22413,87.25 RATE_GRADE,When the STANDARD_NAME = 'RATE_GRADE' move STAT_BREAKOUT_CODE to RATE_GRADE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22414,87.26 NO_OF_STORIES,When the STANDARD_NAME = 'NO_OF_STORIES' move STAT_BREAKOUT_CODE to NO_OF_STORIES,ETL - D_Stat_Property_Losses,,10/13/2015,mmconley,sconley 10/13/15: See revised rules for populating no_of_stories in the stat area for UPR (BR-23347 & BR-22613).,,,,,,,,,
BR-22415,87.27 RATE_GROUP,When the STANDARD_NAME = 'RATE_GROUP' move STAT_BREAKOUT_CODE to RATE_GROUP,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22416,87.28 OCCUPATION_COVERAGE,When the STANDARD_NAME = 'OCCUPATION_COVERAGE'.  Move STAT_BREAKOUT_CODE to OCCUPATION_COVERAGE ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22417,87.29 POLICY_FORM,When the STANDARD_NAME = 'POLICY_FORM'  move STAT_BREAKOUT_CODE to POLICY_FORM,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22418,87.30 EXPOSURE_INDICATOR,When the STANDARD_NAME = 'EXPOSURE_INDICATOR' move STAT_BREAKOUT_CODE to EXPOSURE_INDICATOR,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22419,87.31 TRANS_TYPE,When the STANDARD_NAME = 'TRANS_TYPE' move STAT_BREAKOUT_CODE to TRANS_TYPE,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-22420,87.32 SPRINKLER_ID,When the STANDARD_NAME = 'SPRINKLER_ID'  Move STAT_BREAKOUT_CODE to SPRINKLER_ID  ,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Losses",,4/5/2013,moreilly,,,,,,,,,,
BR-23386,87.33 RATE_MONTH,When the STANDARD_NAME = 'RATE_DATE'  move the first 2 digits of the STAT_BREAKOUT_CODE to RATE_MONTH,,,5/9/2016,mmconley,sconley 5/9/16 Added rule,,,,,,,,,
BR-23388,87.34 RATE_YEAR,When the STANDARD_NAME = 'RATE_DATE' and the FIELD_LENGTH = 6 move the last 4 digits of the STAT_BREAKOUT_CODE to RATE_YEAR,,,5/9/2016,mmconley,sconley 5/9/16 Added rule,,,,,,,,,
BR-23356,87.35 EXPOSURE,,ETL - D_Stat_Property_Losses,FDW_Core 5362: Personal Liability and homeowners data is not included in the FDW aggregate tables,2/25/2016,mmconley,sconley 2/25/16: The field is not applicable to UPR. Fields added for mainframe claims.,,,,,,,,,
BR-23357,87.36 LIMIT_CODE,,"ETL - D_Stat_Property_Losses
",FDW_Core 5362: Personal Liability and homeowners data is not included in the FDW aggregate tables,2/25/2016,mmconley,sconley 2/25/16: The field is not applicable to UPR. Fields added for mainframe claims.,,,,,,,,,
BR-23358,87.37 STAT_IND,,"ETL - D_Stat_Property_Losses
",FDW_Core 5362: Personal Liability and homeowners data is not included in the FDW aggregate tables,2/25/2016,mmconley,sconley 2/25/16: The field is not applicable to UPR. Fields added for mainframe claims.,,,,,,,,,
BR-23359,87.38 EXCEPTION_CODE,,ETL - D_Stat_Property_Losses,FDW_Core 5362: Personal Liability and homeowners data is not included in the FDW aggregate tables,2/25/2016,mmconley,sconley 2/25/16: The field is not applicable to UPR.,,,,,,,,,
BR-23363,87.39 BUILDING_EXPOSURE,,,,2/25/2016,mmconley,sconley 2/25/16: The field is not applicable to UPR.,,,,,,,,,
BR-23364,87.40 BUILDING_CONTENTS_EXPOSURE,,,,2/25/2016,mmconley,sconley 2/25/16: The field is not applicable to UPR.,,,,,,,,,
BR-23365,87.41 RETRO_PAR_INDICATOR,,,,2/25/2016,mmconley,sconley 2/25/16: The field is not applicable to UPR.,,,,,,,,,
BR-23368,87.42 DEDUCTIBLE_TYPE,,,,5/4/2016,mmconley,sconley 5/4/16: The field is not applicable to UPR.,,,,,,,,,
BR-23369,87.43 AGENCY_CODE,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23370,87.44 PLACE_CODE,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23372,87.45 BASIC_PERILS,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23373,87.46 CSP_TRAN_TYPE_CODE,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23374,87.47 ZONE_RATING_CODE,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23375,87.48 EXCESS_INDICATOR,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23376,87.49 TYPE_OF_POLICY,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23377,87.50 GROUP_INDICATOR,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23389,87.51 NO_OF_FAMILIES,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23390,87.52 FIRE_RATE,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23391,87.53 CAUSE_OF_LOSS,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23392,87.54 FARM_TYPE,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23393,87.55 WATER_PROTECTION_IND,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23394,87.56 WIND_COVERAGE_CODE,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23395,87.57 BUSINESS_LINE,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23396,87.58 COVERAGE_INCEPTION_DATE,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR.,,,,,,,,,
BR-23397,87.59 KIND_IND,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR. ,,,,,,,,,
BR-23398,87.60 ORDINANCE_OR_LAW_COVE_CODE,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR. ,,,,,,,,,
BR-23399,87.61 SAA_SUBLINE,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR. ,,,,,,,,,
BR-23400,87.62 HAZARD_GRADE,,,,5/9/2016,mmconley,sconley 5/9/16: The field is not applicable to UPR. ,,,,,,,,,
BR-23401,87.63 LIABILITY_LIMIT,,,,5/10/2016,mmconley,sconley 5/10/16: The field is not applicable to UPR.,,,,,,,,,
BR-23402,87.64 RATE_GROUP_SPECIAL,,,,5/10/2016,mmconley,sconley 5/10/16: The field is not applicable to UPR.,,,,,,,,,
BR-23404,87.65 RATE_GROUP_STANDARD,,,,5/10/2016,mmconley,sconley 5/10/16: The field is not applicable to UPR.,,,,,,,,,
BR-23231,88 Statistical Format Area for Workers Compensation Premiums (UWC),,"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Work_Comp_Premiums",,12/29/2016,mmconley,,,,,,,,,,
BR-23232,88.1 AGGREGATE_DEDUCTIBLE_AMOUNT,"When the STANDARD_NAME = 'AGGREGATE_DEDUCTIBLE_AMOUNT'. 
Move STAT_BREAKOUT_CODE to AGGREGATE_DEDUCTIBLE_AMOUNT","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Work_Comp_Premiums",,6/6/2014,lkummer,,,,,,,,,,
BR-23233,88.2 AGGREGATE_DEDUCTIBLE_DOLLARS,"When the STANDARD_NAME = 'AGGREGATE_DEDUCTIBLE_DOLLARS'. 
Move STAT_BREAKOUT_CODE tO AGGREGATE_DEDUCTIBLE_DOLLARS","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Work_Comp_Premiums",,6/6/2014,lkummer,,,,,,,,,,
BR-23234,88.3 CLASS,"When the STANDARD_NAME = 'CLASS'. Move STAT_BREAKOUT_CODE to CLASS_CODE  
Remove the leading spaces (LTRIM)  and any trailling spaces(RTRIM)","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Work_Comp_Premiums",,9/11/2017,mmconley,,,,,,,,,,
BR-23235,88.4 DEDUCTIBLE_AMOUNT,"When the STANDARD_NAME = 'DEDUCTIBLE_AMOUNT'. Move STAT_BREAKOUT_CODE to DEDUCTIBLE_AMOUNT
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Work_Comp_Premiums",,6/6/2014,lkummer,,,,,,,,,,
BR-23237,88.5 DEDUCTIBLE_TYPE,"When the STANDARD_NAME = 'DEDUCTIBLE_TYPE'. 
Move STAT_BREAKOUT_CODE to DEDUCTIBLE_TYPE","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Work_Comp_Premiums",,6/6/2014,lkummer,,,,,,,,,,
BR-23238,88.6 DIVIDEND_PLAN,"When the STANDARD_NAME = 'DIVIDEND_PLAN'. 
Move STAT_BREAKOUT_CODE to DIVIDEND_PLAN","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Work_Comp_Premiums",,6/6/2014,lkummer,,,,,,,,,,
BR-23240,88.7 EXPOSURE_COVERAGE_CODE,"When the STANDARD_NAME = 'EXPOSURE_COVERAGE_CODE''. 
Move STAT_BREAKOUT_CODE to EXPOSURE_COVERAGE_CODE","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Work_Comp_Premiums",,6/6/2014,lkummer,,,,,,,,,,
BR-23241,88.8 RATE,"When the STANDARD_NAME = 'RATE'. 
Move STAT_BREAKOUT_CODE to RATE_AMOUNT","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Work_Comp_Premiums",,6/6/2014,lkummer,,,,,,,,,,
BR-23242,88.9 RETRO_PLAN_CODE,"When the STANDARD_NAME = 'RETRO_PLAN_CODE'. 
Move STAT_BREAKOUT_CODE to RETRO_PLAN_CODE","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Work_Comp_Premiums",,12/30/2016,mmconley,,,,,,,,,,
BR-23243,88.10 SIC_CODE,"When the STANDARD_NAME = 'SIC_CODE'. 
Move STAT_BREAKOUT_CODE to SIC_CODE","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Work_Comp_Premiums",,6/6/2014,lkummer,,,,,,,,,,
BR-23245,88.11 TYPE_OF_POLICY,"When the STANDARD_NAME = 'TYPE_OF_POLICY'. 
Move STAT_BREAKOUT_CODE to TYPE_OF_POLICY","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Work_Comp_Premiums",,6/6/2014,lkummer,,,,,,,,,,
BR-23417,89 Statistical Format Area for Workers Compensation Losses (UWC),,"ETL - D_Stat_Format_Losses
ETL - D_Stat_Work_Comp_Losses",,12/30/2016,mmconley,,,,,,,,,,
BR-23418,89.1 RETRO_PLAN_CODE,"When the STANDARD_NAME = 'RETRO_PLAN_CODE'
    Move STAT_BREAKOUT_CODE to RETRO_PLAN_CODE","ETL - D_Stat_Format_Losses
ETL - D_Stat_Work_Comp_Losses",,12/30/2016,mmconley,,,,,,,,,,
BR-23419,89.2 CLASS,"When the STANDARD_NAME = 'CLASS'
    Move STAT_BREAKOUT_CODE to CLASS_CODE  
    Remove the leading spaces (LTRIM)  and any trailling spaces(RTRIM)","ETL - D_Stat_Format_Losses
ETL - D_Stat_Work_Comp_Losses",,9/11/2017,mmconley,,,,,,,,,,
BR-23428,89.3 INJURY_TYPE_CODE,"When the STANDARD_NAME = 'INJURY_TYPE_CODE'
    Move STAT_BREAKOUT_CODE to INJURY_TYPE_CODE","ETL - D_Stat_Format_Losses
ETL - D_Stat_Work_Comp_Losses",,1/4/2017,mmconley,,,,,,,,,,
BR-23429,89.4 WEEKLY_WAGE,"When the STANDARD_NAME = 'WEEKLY_WAGE'
    Move STAT_BREAKOUT_CODE to WEEKLY_WAGE","ETL - D_Stat_Format_Losses
ETL - D_Stat_Work_Comp_Losses",,1/4/2017,mmconley,,,,,,,,,,
BR-23430,89.5 CLAIMANT_DATE_OF_BIRTH,"When the STANDARD_NAME = 'CLAIMANT_DATE_OF_BIRTH'
    Move STAT_BREAKOUT_CODE to CLAIMANT_DATE_OF_BIRTH","ETL - D_Stat_Format_Losses
ETL - D_Stat_Work_Comp_Losses",,1/5/2017,mmconley,,,,,,,,,,
BR-23431,89.6 SETTLEMENT_METHOD,"When the STANDARD_NAME = 'SETTLEMENT_METHOD'
    Move STAT_BREAKOUT_CODE to SETTLEMENT_METHOD","ETL - D_Stat_Format_Losses
ETL - D_Stat_Work_Comp_Losses",,1/5/2017,mmconley,,,,,,,,,,
BR-23432,89.7 TYPE_OF_LOSS,"When the STANDARD_NAME = 'TYPE_OF_LOSS'
    Move STAT_BREAKOUT_CODE to TYPE_OF_LOSS","ETL - D_Stat_Format_Losses
ETL - D_Stat_Work_Comp_Losses",,1/9/2017,mmconley,,,,,,,,,,
BR-23433,89.8 JURISDICTION_STATE,"When the STANDARD_NAME = 'JURISDICTION_STATE'
    Move STAT_BREAKOUT_CODE to JURISDICTION_STATE","ETL - D_Stat_Format_Losses
ETL - D_Stat_Work_Comp_Losses",,12/30/2016,mmconley,,,,,,,,,,
BR-23434,89.9 LOSS_COVERAGE_CODE,"When the STANDARD_NAME = 'LOSS_COVERAGE_CODE'
    Move STAT_BREAKOUT_CODE to LOSS_COVERAGE_CODE","ETL - D_Stat_Format_Losses
ETL - D_Stat_Work_Comp_Losses",,12/30/2016,mmconley,,,,,,,,,,
BR-23435,89.10 SIC_CODE,"When the STANDARD_NAME = 'SIC_CODE'
    Move STAT_BREAKOUT_CODE to SIC_CODE","ETL - D_Stat_Format_Losses
ETL - D_Stat_Work_Comp_Losses",,12/30/2016,mmconley,,,,,,,,,,
BR-21912,90 Producer A Code,Select PRODUCER_A_CODE from D_PRODUCER_PROFIT_CENTER,"ETL - A_Liability_Premiums
ETL - A_Auto_Premiums
ETL - A_Private_Auto_Premiums",,10/22/2013,dzieverink,,,,,,,,,,
BR-21913,91 Internal Annual Statement Line Personal/Commercial Indicator,Select IASL_PC_ID from D_PRODUCT_DETAIL,"ETL - A_Liability_Premiums
ETL - A_Auto_Premims
ETL - A_Private_Auto_Premiums",,10/22/2013,dzieverink,,,,,,,,,,
BR-21914,92 Class Code,"



","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses
ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
ETL - D_Stat_Work_Comp_Premiums
ETL - D_Stat_Work_Comp_Losses",,12/30/2016,mmconley,"Note:  BR 22482 & BR 22464
& BR 22033 & BR 22117
contain an additional rule for class code.  The rules will  rtrim and ltrim the field when it is pulled from the stat area and put into the lob table.  This will happen for all LOB's  There should be no spaces before or after the class code.  The rules below(89.1 & 89.2)  for spaces and zeros are to allow for proper spacing in the stat area.   ",,,,,,,,,
BR-22590,"92.1 Class Code UGL, UIM, UPR, UCA, UWC","When building the STAT are for UGL and UIM and UPR and UCA and UWC:

Class = rate_class_cd for 6 positions.   Left pad with spaces","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Property_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
ETL - D_Stat_Work_Comp_Premiums
ETL - D_Stat_Work_Comp_Losses",,1/23/2018,mmconley,"Note:  BR 22482 & BR 22464
& BR 22033 & BR 22117
contain an additional rule for class code.  The rules will  rtrim and ltrim the field when it is pulled from the stat area and put into the lob table.  This will happen for all LOB's  There should be no spaces before or after the class code.  The rules below(89.1 & 89.2)  for spaces and zeros are to allow for proper spacing in the stat area.   

(from proc:
RTRIM(LTRIM (v_statdatatable (1).substring_value)))

sconley 1/23/18: If MDM class code is invalid, stat area is not populated and data is shifted. See commnents for BR-23469.",,,,,,,,,
BR-22588,92.2 UFC Class Code - Premiums and Losses,"When building the STAT area for UFC:

Class = rate_class_cd for 6 positions.  Left pad with spaces.   If the rate class cd is null, fill with 6 spaces.","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses
",,1/23/2018,mmconley,"sconley 12/30/16: Reformatted BR

sconley 1/23/18: If MDM class code is invalid, stat area is not populated and data is shifted. See commnents for BR-23469.",,,,,,,,,
BR-23441,92.3 UWC Class Code - Premiums and Losses,"When building the STAT area for UWC:

Class = VW_PRC_RATING.RATE_CLASS_MDM_CD for 4 positions.  ","ETL - D_Stat_Work_Comp_Premiums
ETL - D_Work_Comp_Losses
",,1/23/2018,mmconley,"sconley 12/30/16: Reformatted BR

sconley 1/23/18: If MDM class code is invalid, stat area is populated with '0'. See commnents for BR-23469.",,,,,,,,,
BR-23469,92.4 MDM Class Code Retrieval,"If RATE_CLASS_CD is from MDM, it is populated in VW_PRC_RATING.RATE_CLASS_MDM_CD.  However, this field contains more data than the actual class code.

When loading FDW.PREMIUM_FACT_CORE on EDW, the RATE_CLASS_CD is retrieved from MDM.  In premium_fact_core_stg1 mapping, there is mapplet lkp_vw_rate_stat_class that goes against the MDM SQL server view VW_RATE_STAT_CLASS.MDM_CD = VW_PRC_RATING.RATE_CLASS_MDM_CD.  Fields CLASS_CD & SUFFIX_CD from MDM are concatenated into output field in_CLASS_CD_SUFFIX_CD of the mapplet.

Then the ETL checks first if VW_PRC_RATING.REF_RATE_CLASS_ID is populated to get VW_REF_RATE_CLASS.RATE_CLASS_CD, else it uses in_CLASS_CD_SUFFIX_CD from the mapplet.

DECODE (true
    ,NOT ISNULL(REF_RATE_CLASS_ID),in_RATE_CLASS_CD
    ,in_CLASS_CD_SUFFIX_CD
)

Example of MDM_CLASS_CD:
EDW.VW_PRC_RATING.RATE_CLASS_MDM_CD = WC-3881A-ERC-NYCIRB-US-NY-002
MDM.VW_RATE_STAT_CLASS.MDM_CD = WC-3881A-ERC-NYCIRB-US-NY-002
MDM.VW_RATE_STAT_CLASS.CLASS_CD = 3881
MDM.VW_RATE_STAT_CLASS.SUFFIX_CD = A
(For numeric only class codes, the SUFFIX_CD is NULL.)
Mapplet lkp_vw_rate_stat_class in_CLASS_CD_SUFFIX_CD = 3881A
PREMIUM_FACT_CORE.RATE_CLASS_CD = 3881A ",,,1/23/2018,mmconley,"7/13/17 sconley: Added information to DOORS

1/23/18 sconley: See US23208. This information sent to PDC.
Current state of how things are working.
We expect that the front-end is sending a valid MDM class code.
The EDW ETL does not validate the MDM class code.
The FDW ETL calls Kalido with the MDM class code in EDW in order to break the class code down.  

If the MDM rate class code is invalid:
The class code is NULL in d_business_cvrg.
The check that runs at the beginning of the FDW load will kick-out the coverages with invalid MDM class codes on a report.  In PROD, this will stop the FDW load in order to review/fix the data.
For WC, class code is populated with ‘0’ in the stat area.  It is the last field on the stat area.
For other stat lines, we do not default the class code and the stat data is shifted in the stat area.

",,,,,,,,,
BR-21974,93 SIC Code - Terrorism Coverage Level - STAT Format,"**Review for UWC when source information is available(see comments)**
If IASL_CD = '160' 
	then SIC_CD_5 = '0', SIC_CD_6_7 = '00', and SIC_CD_8 = '0'

If (SIC_CD = 0
  or SIC_CD is null)
Then 
   Select SIC_CD 
   From lk_pv_5_6_naics_cd_xref
   Where NAICS_CD = lk.NAICS_CD
      If SIC_CD is not null
         Then ws.SIC_CD_1_4 = lk.SIC_CD 
      Else 
          ws.SIC_CD_1_4 = ‘0000’
      End-if
Else 
        ws.SIC_CD_1_4 = SIC_CD  
End-if

If CMRCL_DEREG_EXEMPT_IND <> 0
   Then Ws.SIC_CD_5 = ‘D’ 
Else 
  If NY_FREE_TRADE_ZONE_CD not in (‘0’, 'NOTELIG')
     Then Ws.SIC_CD_5 = ‘F’ 
   Else 
     Ws.SIC_CD_5 = ‘0’ 
   End-if
End-if

Ws.SIC_CD_6_7 = ‘00’ 

/*
The rest of the rule is for the 8th position.  
PIM, E&S, and CUBE,  Great American Custom policies will get the 8th position from d_terrorism_cvrg.
all other policies will get the 8th position from lk_pv_1_8_MAIN_cd_xref  
*/

If SRC_SYS_CD in (‘UDPIM’, 'SES-PAS','GAC-PAS',’REFAPP’,'BRIDGE-PAS', 'I360-PAS')
    Select LEGACY_PRO_CD from d_terrorism_cvrg  
        where FDW_TERRORISM_CVRG_ID =
                  d_terrorism_cvrg.TERRORISM_CVRG_ID
        If LEGACY_PRO_CD is null
            SIC_CD_8 = 0
        Else SIC_CD_8 = LEGACY_PRO_CD
        End-if

Else 
    Select  CVRG_GROUP,
          PARENT_BUSN_CVRG_CD
          from lk_pv_1_2_cvrg_cd_xref  lk
       where lk.RISK_CATG_CD = RISK_CATG_CD
          and lk.CVRG_CD = CVRG_CD
          and lk.CVRG_CATG_CD = CVRG_CATG_CD
          and lk.POLICY_SYMBOL  = POL_SYMBOL_CD 
     If not found
                Select  CVRG_GROUP,
                           PARENT_BUSN_CVRG_CD
                from lk_pv_1_2_cvrg_cd_xref  lk
                where  lk.RISK_CATG_CD = RISK_CATG_CD
                    and lk.CVRG_CD = CVRG_CD
                    and lk.CVRG_CATG_CD = CVRG_CATG_CD
                    and lk.POLICY_SYMBOL  = ‘ANY’  

                Select  SIC_CD_8,
                            STAT_FORMAT_CD
                  from lk_pv_1_8_MAIN_cd_xref  lk
                where  lk.CVRG_GROUP = CVRG_GROUP
                   and lk.POLICY_SYMBOL = POL_SYMBOL_CD
            If not found 
                 Select  SIC_CD_8,
                         STAT_FORMAT_CD
                 from lk_pv_1_8_MAIN_cd_xref  lk
                where  lk.CVRG_GROUP = CVRG_GROUP
                and POLICY_SYMBOL = ‘ANY’
             End-if
        End-if

If is null
  Then ws.SIC_CD_8 = ‘0’
else
 If CVRG_GROUP in (‘AGRI9’)
   If PTF_SICC1_IND = ‘1’
      Then ws.SIC_CD_8 = ‘I’
   Else 
     If PTF_SICC2_IND = ‘1’
       Then ws.SIC_CD_8 = ‘J’
      end-if
    end-if
  Else ws.SIC_CD_8 = ‘I’ 
  End-if
Else  ws.SIC_CD_8 = lk.SIC_CD_8
End-if

IIF(SRC_SYS_CD = 'DIRCTENTRY' AND SOURCE_BUSINESS_UNIT = 'Specialty Human Services' AND NOT ISNULL(SIC_CD_8)
   , SIC_CD_8
      , IIF(SRC_SYS_CD = 'DIRCTENTRY' AND SOURCE_BUSINESS_UNIT = 'Specialty Human Services' AND NOT ISNULL(SIC_CD_8_any)
            ,SIC_CD_8_any
            , IIF(SRC_SYS_CD = 'DIRCTENTRY' AND SOURCE_BUSINESS_UNIT = 'Specialty Human Services'
                   ,'0'
                   ,IIF(IN(SRC_SYS_CD, 'UDPIM','SES-PAS','GAC-PAS','ENV-PAS','UDFC','REFAPP','DIRCTENTRY','BRIDGE-PAS', 'I360-PAS', 'SHR-ACORD')
                          ,IIF( NOT ISNULL(LEGACY_PRO_CD)  
                                ,LEGACY_PRO_CD
                          ,'0'
                          )
                             ,IIF(NOT ISNULL(SIC_CD_8)
                                   ,IIF(CVRG_GROUP='AGRI9'
                                        ,IIF(PTF_SICC1_IND = 1
                                        ,'I'
                                   ,IIF(PTF_SICC2_IND = 1
                                   ,'J'
                                   ,'I'
                          )
                   ) 
                  ,SIC_CD_8
             )
            ,IIF(NOT ISNULL(SIC_CD_8_any)
                  ,SIC_CD_8_any
                 ,'0'
             )
      )
)
)
)
)

","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Property_Losses
ETL - D_Stat_Auto_Losses
ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Work_Comp_Premiums
ETL - D_Stat_Work_Comp_Losses","ENTERPRISE.FDW_Core 9241: Add REFAPP to BR-21974 to Determine 8th Position of SIC_CD

dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202)

Jira DP-7434 with Data Platform QC-1376 modified code to add check for source system code ""DIRCTENTRY"" and busines unit name ""Specialty Human Services"".

AMiller: With US41789 - Added 'SHR-ACORD' to check for new source system code (02/20/2019). ",2/20/2019,amiller6,"UWC:  assuming SIC code 1-4 will be passed.
Commercial deregulation for WC is ‘No’.  
NY free trade zone does not apply to WC.

So 5-7 will be 000

position 8 is TBD.  we have not reviewed Terrorism for Work Comp yet  lak 7/15/2014

7/27/15 sconley: FDW_Core 9241 Added REFAPP to SRC_SYS_CD check to determine 8th position of SIC_CD based on Terrorism.

9/9/15 sconley:  EDW sources:
vw_party_hist.naics_cd for the Primary Insured (PRI)
vw_pol_term_hist.cmrcl_dereg_exempt_ind
vw_pol_term_hist.ny_free_trade_zone_cd

11/16/15 - dburns4 - Added Great American Custom (GAC-PAS) to the comment about the 8th position (GAC-PAS was already in the rule but not the comment

11/16/15 sconley: This rule is used in conjuntion with BR-21904 Terrorism Coverage ID (BR-77) which determines the Terrorism Coverage ID.  This rule sets the 8th position of the SIC code based on terrorism for the specified source systems.

08/25/16 dzieverink: Updated rule to include adding zeros for WC records (IASL_CD = 160). Jire DP-3386 and QC 706

Feb 2017 dburns4 - For SHS D & O project where policy data gets in to EDW via Direct Entry, added check for source system code of ""DIRCTENTRY"" and source business name ""Specialty Human Services"" to qualification for 8th position of SIC Code..",,,,,,,,,
BR-23157,"93.1 SIC Code - Terrorism Coverage Level - STAT Format

Specialty E&S - Master/Certificate (aka Bordereau)","In order to support the Master/Certificate (aka Bordereau) policies for SES, the decision was made to create multiple INSOPS risks on a Single Master policy.  

Each instance of INSOPS represents a certifcate; and will also support it's own instance of the Terrorism Coverages(s).

As of 9/2013; the business has agreed that if Terrorism exists on the policy, then it will be Uniform across all intances of the INSOPS Risk.

The expecatation is that the 8th position of the SIC Code will be the same for all Certificates on the policy.","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",,7/24/2017,mmconley,,,,,,,,,,
BR-21986,94 SIC Code - Policy Level,"If (SIC_CD = 0
  or SIC_CD is null)
Then 
   Select SIC_CD 
   From lk_pv_5_6_naics_cd_xref
   Where NAICS_CD = lk.NAICS_CD
      If SIC_CD is not null
         Then ws.SIC_CD_1_4 = lk.SIC_CD 
      Else 
          ws.SIC_CD_1_4 = ‘0000’
Else 
        ws.SIC_CD_1_4 = SIC_CD  

If CMRCL_DEREG_EXEMPT_IND <> 0
   Then Ws.SIC_CD_5 = ‘D’ 
Else 
  If NY_FREE_TRADE_ZONE_CD not in (‘0’, 'NOTELIG')
     Then Ws.SIC_CD_5 = ‘F’ 
Else 
     Ws.SIC_CD_5 = ‘0’ 

Ws.SIC_CD_6_7 = ‘00’ 

ws.SIC_CD_8 = ‘0’","ETL - D_Policy_Support
ETL - D_Policy_Daily",,7/31/2015,mmconley,"7/31/15: sconley: EDW source:
vw_party_hist.sic_cd where vw_pol_term_party.role_cd = 'PRI'
vw_party_hist.naics_cd where vw_pol_term_party.role_cd = 'PRI'.",,,,,,,,,
BR-22005,95 Rate Factors for STAT,"Select 
RATE_DEPARTURE_FACTOR,
EXPENSE_MODIFIER,
IRPM_MODIFIER,
PACKAGE_MODIFICATION_FACTOR,
LOSS_EXPERIENCE_MODIFIER,
SCHEDULE_MODIFIER,
LOSS_FREE_CREDIT,
INCREASED_LIMIT_FACTOR,
MULTI_LOCATION_MULTIPLIER,
LOSS_COST_MODIFIER,
DRUG_FREE_WORKPLACE_FACTOR
From FDW.d_cvrg_rate_fctr crf
Where crf.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

If Found
Move ws.RATE_DEPART_FCTR = (crf.RATE_DEPARTURE_FACTOR * 100)  (left fill with 0)
Move ws.RATE_MOD_FCTR_EXPENSE = (crf.EXPENSE_MODIFIER * 100)   (left fill with 0)
Move ws. RATING_MOD_FCTR_IRPM_SRP = (crf.IRPM_MODIFIER * 100)   (left fill with 0)
Move ws.RATE_MOD_FCTR_PACKAGE = (crf.PACKAGE_MODIFICATION_FACTOR * 100)(left fill with 0)
Move ws.RATE_MOD_FCTR_EXPERIENCE = (crf.LOSS_EXPERIENCE_MODIFIER * 100)  (left fill with 0)
Move ws.RATE_MOD_FCTR_SCHEDULE = (crf.SCHEDULE_MODIFIER * 100)   (left fill with 0)
Move ws.RATE_MOD_FCTR_LOSS_FREE = (crf.LOSS_FREE_CREDIT * 100)   (left fill with 0)
Move ws.INCREASE_LIMITS_FCTR = (crf.INCREASED_LIMIT_FACTOR * 100)   (left fill with 0)
Move ws.RATE_MOD_FCTR_ MULTI_LOC = (crf.MULTI_LOCATION_MULTIPLIER * 100)  (left fill with 0)
Move ws.RATE_MOD_LOSS_COST = (crf.LOSS_COST_MODIFIER * 100)    (left fill with 0)
Move ws.RATE_DRUG_FREE_WRKPL = (crf.DRUG_FREE_WORKPLACE_FACTOR * 100)   (left fill with 0)
Else
  If NOT found
     If SRC_SYS_CD = ‘UDAGRI’ and IASL_CD in (‘010’,’021’,’030’,’171’)
        Ws.RATE_DEPART_FCTR = ‘999’
    Else
       Ws.RATE_DEPART_FCTR = ‘000’
   End- if
End- if
Ws.RATE_MOD_FCTR_EXPENSE = ‘000’
Ws.RATE_MOD_FCTR_IRPM_SRP = ‘000’ 
Ws.RATE_MOD_FCTR_PACKAGE = ‘000’
Ws.RATE_MOD_FCTR_EXPERIENCE = ‘000’ 
Ws.RATE_MOD_FCTR_SCHEDULE = ‘000’
Ws.RATE_MOD_FCTR_ LOSS_FREE = ‘000’ 
ws.INCREASE_LIMITS_FCTR = ‘000’
Ws.RATE_MOD_FCTR_MULTI_LOC = ‘000’
Ws.RATE_MOD_LOSS_COST = ‘000’
Ws.RATE_DRUG_FREE_WRKPL = ‘000’
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Property_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,7/19/2017,mmconley,"See Business Rules for each rate factor to move the data from d_cvrg_rate_fctr to the stat area for each applicable LOB.

4/17/14 sconley: Added additional info to BR Description and updated the WHERE clause.",,,,,,,,,
BR-22610,96 Type of Coverage,,,,1/7/2016,mmconley,1/7/16 sconley:  Changed format and made sub-rule for UPR Premiums and Losses.,,,,,,,,,
BR-23351,96.1 UPR Type of Coverage - Premiums and Losses,"Subline 930 is for Earthquake.

Check if there is premium charged for Builders Risk Earthquake.
(risk_catg_cd = 'COVPROP', cvrg_cd = 'EQ'; src_sys_cds are 'UDPIM' and 'BRIDGE-PAS')
(We are checking P versus PRP because on a delete of EQ, PRP may = 0, such as for a CNRW.  We still need to capture that premium was charge for EQ.)

/* Builders Risk */
When SUBLINE_CD = '930'
SRC_SYS_CD in ('UDPIM','BRIDGE-PAS')
RISK_CATG_CD = 'COVPROP'
VW_PRC_RATING_PREM.CATG_CD = 'P'
VW_PRC_RATING_PREM.PREM_AMT > 0
  Set TYPE_OF_COVERAGE = '3'
  EXIT

/* Builders Risk */
When SUBLINE_CD = '930'
SRC_SYS_CD in ('UDPIM','BRIDGE-PAS')
RISK_CATG_CD = 'COVPROP'
VW_PRC_RATING_PREM.CATG_CD = 'P'
VW_PRC_RATING_PREM.PREM_AMT = 0
  Set TYPE_OF_COVERAGE = '1'
  EXIT

When SUBLINE_CD = '930'
CVRG_CD = 'EQ'
  Set TYPE_OF_COVERAGE = '1'
  EXIT

When SUBLINE_CD = '930' 
CVRG_CD = 'EQSL'
  Set TYPE_OF_COVERAGE = '2'
  EXIT

When SUBLINE_CD = '930'
CVRG_CD = 'EQSUBLMT'
  Set TYPE_OF_COVERAGE = '3'
  EXIT

When SUBLINE_CD = '930'
CVRG_CD = 'EQSLSUBLMT'
  Set TYPE_OF_COVERAGE = '4'
  EXIT

When SUBLINE_CD = '930'
FIPS_US_ALPHA_CD = 'CA'
  Set TYPE_OF_COVERAGE = '3'
  EXIT

When SUBLINE_CD = '930'
FIPS_US_ALPHA_CD != 'CA'
  Set TYPE_OF_COVERAGE = '1'
  EXIT

TYPE_OF_COVERAGE = ' ' (space)
(default is ' ' (space))","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses","UWD.PIM 18006: Updates to UPR stat area for Builders Risk Earthquake coverage for premiums and losses.

dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202)

dzieverink 1/6/17: Added EQ logic per ISO Property project. (QC DP-1172)

2/14/17 sconley: ENTERPRISE.Data_Platform 1422 ETL Fixes for UPR Stat Area: Type of Coverage and Rate Grade

7/21/17 sconley: ENTERPRISE.Data_Platform 2101  Revise rules for Builders Risk since DIC src_sys_cd is also 'UDPIM'; Rally US12922",7/21/2017,mmconley,"1/7/16 sconley: 
-Subline '930' is Earthquake.
-UDPIM SBP Earthquake coverage is not premium bearing.
-Changed format and made sub-rule for UPR Premiums and Losses. 
-UWD.PIM 18006: Updated for UDPIM Builders Risk earthquake.

2/14/17 sconley: Update to rearrange the rules so that the Builders Risk rules are executted first. DP-7797, DP-7887, Defect 1422. 

7/21/17 sconley: Revise rules for Builders Risk since DIC src_sys_cd is also 'UDPIM'. For DIC we were hitting UDPIM rules set-up for Builders Risk.  Rally US12922; Defect 2101.",,,,,,,,,
BR-21917,97 Coverage Code,See Specific Rule for each stat format code below  ,"ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,9/9/2015,mmconley,"


",,,,,,,,,
BR-22512,97.1 UIM Coverage Code - Premiums,,ETL - D_Stat_Inland_Marine_Premiums,,3/22/2016,mmconley,3/22/16 sconley: COVERAGE_CODE is not a stat area field for UIM Premiums.,,,,,,,,,
BR-22513,97.2 UIM Coverage Code - Losses,Coverage_cd = '00',ETL - D_Stat_Inland_Marine_Losses,,7/13/2017,mmconley,,,,,,,,,,
BR-22506,97.3 UFC Coverage Code - Premiums and Losses ,"When ISO_COVERAGE_CD (in EDW.CVRG_HIST) is not null
  Set COVERAGE_CODE = ISO_COVERAGE_CD;
EXIT

When SRC_SYS_CD = 'ELD_PAS';
  Set COVERAGE_CODE = '03';
 EXIT

When COVERAGE_CODE = 'ERISA';
  Set COVERAGE_CODE = '01';
  EXIT

When RATE_CLASS_CD >= '700';
When RATE_CLASS_CD <= '799'
  Set COVERAGE_CODE = '09';
  EXIT

When RATE_CLASS_CD in ('815','851','852','853','854','871')
  Set COVERAGE_CODE = '09';
  EXIT

When SUBLINE_CD = '965';
  Set COVERAGE_CODE = '31';
  EXIT

When DISCOVERY_IND = 0;
When PTF_UFC_SFAA_IND = 1;
  Set COVERAGE_CODE = '02';
  EXIT

When DISCOVERY_IND = 0;
  Set COVERAGE_CODE = '01';
  EXIT

When DISCOVERY_IND = 1;
When PTF_UFC_SFAA_IND = 1;
  Set COVERAGE_CODE = '04';
  EXIT

When DISCOVERY_IND = 1;
  Set COVERAGE_CODE = '03';
  EXIT

Set COVERAGE_CODE = '  ' (2 spaces);
  EXIT","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
D_Stat_Crm_Fdlty_Srty_Losses",9/17/14 AFG.mySurety_Intg 27: Coverage_Code for mySurety ERISA policies should be coded to '1',3/8/2019,jpinto,"SFAA RULES FOR TYPE OF COVERAGE CODE
The Type of Coverage Code must be reported for all Mercantile Establishments policies (both the Commercial Crime Policy and the Crime Protection Policy), all Governmental Entities policies, and all Financial Institutions policies.

If there is Mercantile Establishment and the Coverage Form = B (form of coverage codes 90 (Personal Accts of Specified Persons, 96 (Forgery or Alteration), 98 (Warehouse Receipts), and 99 (Credit, Debit or Charge Cards) report TYPE OF COVERAGE CODE 1 for Sustained coverage, and report TYPE OF COVERAGE CODE 3 for Discovery coverage.

If there is Government Entities and the Coverage Form = B (form of coverage codes 
96 (Forgery or Alteration) and 99 (Credit, Debit or Charge Cards) report TYPE OF COVERAGE CODE 1 for Sustained coverage, and report TYPE OF COVERAGE CODE 3 for Discovery coverage


PTF_UFC_SFAA_IND is set by BR-22228 Policy Term Form SFAA.

9/14/14 S. Conley: Added in additonal rule for ERISA. Reformatted Detailed Rule Text.  Combined premiums and losses into one rule since ETL executes the same code per Kevin. (Mapplet mp_stat_ufc_common)
Added in-link to to BR-22228.   

",,,,,,,,,
BR-22507,97.4 UFC Coverage Code - Losses,"If SRC_SYS_CD = 'ELD_PAS'  
     Then Coverage_code = ‘03’ 
Else 
 If RATE_CLASS_CD between 700 and 799
     or rate_class_cd in (815, 851, 852, 853, 854, 871) 
     Then Coverage_code = ‘09’ 
Else 
  If subline = ‘965'
        Coverage_code = ‘31’
   Else
     If discovery_ind = 0
       If PTF_UFC_SFAA_IND = 1
           Coverage code = ‘02’
      Else  
          Coverage Code = ‘01’
   else
     If discovery_ind  = 1     
       If PTF_UFC_SFAA_IND = 1
          Coverage code = ‘04’
      Else 
          Coverage code = ‘03’
Else 
        Coverage code = ‘  ‘ ( 2 spaces)
",ETL - D_Stat_Crm_Fdlty_Srty_Losses,FDW_Core 5047,9/16/2014,mmconley,"Update loss rules to match premiums per Lori Kummer's business requirements document attached to Fid Crime defect 12514.
9/16/14 S. Conley:  Combined premiums and losses into one rule since ETL executes the same code per Kevin (Mapplet mp_stat_ufc_common)


",,,,,,,,,
BR-22508,"97.5 UGL Coverage Code - Premiums 

The intent of this rule is to set the coverage code based on source system, claims made indicator, coverage code, or retroactive date.","If ISO_COVERAGE_CD (in EDW.CVRG_HIST) is not null
   Then COVERAGE_CD = ISO_COVERAGE _CD
Else
   Perform existing logic
End-if.

When building the UGL STAT area,

Set the coverage code based on source system, claims made indicator, coverage code, or retroactive date.

IF SRC_SYS_CD = 'UDAGRI'  
  Then COVERAGE_CD = '3'  
   Else
         If CLAIMS_MADE_IND <> 1
             Then COVERAGE_CD = ‘3’
              Else  
                 If CVRG_CD = ‘SUPLERP’
                      If CVRG_RETROACTIVE_DT is not null
                          Then COVERAGE_CD = ‘2’
                          else COVERAGE_CD = '5'
                       End-if
                   else
                       If CVRG_RETROACTIVE_DT is not null
                            then COVERAGE_CD = ‘1’
                            Else COVERAGE_CD = '4'  
                        End-if
                     end-if
               end-if 
End-if","ETL - D_Stat_Liability_Premiums
",,3/8/2019,jpinto,"When the source system is UDAGRI, set the code = 3

For all other source systems; if the claims made indicator is False, set the code = 3

For all other source systems; if the claims made indicator is true and coverage code is 'SUPLERP' and the retroactive date is not null, set the code = 2

For all other source systems; if the claims made indicator is true and coverage code is 'SUPLERP' and the retroactive date is null, set the code =5

For all other source systems; if the claims made indicator is true and coverage code is NOT 'SUPLERP' and the retroactive date is not null, set the code =1

For all other source systems; if the claims made indicator is true and coverage code is NOT 'SUPLERP' and the retroactive date is null, set the code =4

",,,,,,,,,
BR-22509,97.6 UGL Coverage Code - Losses,"If ISO_COVERAGE_CD (in EDW.CVRG_HIST) is not null
   Then COVERAGE_CD = ISO_COVERAGE _CD
Else
   Perform existing logic
End-if.

IF SRC_SYS_CD in (‘UDAGRI’,’UDEL’)  
  Then COVERAGE_CD = ‘3’  
Else
  If SRC_SYS_CD in ('ELD_PAS')  
    If CLAIMS_MADE_IND <> 1
      Then COVERAGE_CD = ‘3’
    Else  
     If CVRG_CD = ‘SUPLERP’
         If CVRG_RETROACTIVE_DT is not null
            Then COVERAGE_CD = ‘2’
         else COVERAGE_CD = '5'
       else
         If CVRG_RETROACTIVE_DT is not null
           then COVERAGE_CD = ‘1’
     Else COVERAGE_CD = '4'  
else COVERAGE_CD = ‘0’
",ETL - D_Stat_Liability_Losses,,3/8/2019,jpinto,,,,,,,,,,
BR-22510,97.7 UCA Coverage Code - Premiums ,default to '000',ETL - D_Stat_Auto_Premiums,,5/22/2013,moreilly,,,,,,,,,,
BR-22511,97.8 UCA Coverage Code - Losses,default to '000',"ETL - D_Stat_Auto_Losses
",,5/22/2013,moreilly,,,,,,,,,,
BR-22514,97.9 UPR Coverage Code - Premiums and Losses,"Call the mapplett mp_minor_line_pkg_assign_edw_xref to retrieve: 
  (Select PARENT_BUSN_CVRG_CD, PACKAGE_CD, 
          MINOR_LINE_CD, COVERAGE_CODE_FORM_CODE
   From lk_minor_line_pkg_xref)
If COVERAGE_CODE_FORM_CODE is null
  Then COVERAGE_CODE_FORM_CODE = ' ' (space)

/* subline_cd check updated to match code */
/* Change in PIM requirements */
If SUBLINE_CD in ('930','116','136','156','176','196','015','016','017','018',
'027','029','035','045','055','081','082','083','084','085','086','087','088','070',
'090','060','061','011','012','013','014','037','039','067','069','077','079') 
Then COVERAGE_CD = 
     COVERAGE_CODE_FORM_CODE
Else
    If SRC_SYS_CD in ('UDPIM','BRIDGE-PAS') 
        If FIPS_US_Alpha_CD = 'TX'
            Then COVERAGE_CD = '3'
        Else ' ' (space)
    Else ' ' (space)
(Defaults to ' ' (space))","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses
","dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202)

dzieverink 1/6/17: Added additional subline codes per Rick's stat area doc for ISO Property

sconley 6/9/17: ENTERPRISE.Data_Platform 1981 Update COVERAGE_CODE; DP-9669).",6/9/2017,mmconley,"1/7/16 sconley: 
-Combined premiums and losses into 1 rule.
-The UDPIM Builders Risk Earthquake requirement is:
If PIM BR, move to 1 Coverage Code.  
I did not change the rule to specifically add this because the mapplett call to lk_minor_line_pkg_xref for COVPROP/EQ will return coverage_code_form_code = '1'.   The subline for Earthquake is '930' so coverage_cd will get set correctly to '1'.

sconley 6/9/17: ETL for ISO Property (QC 1129 or 1172) added rules but were not documented in DOORs. The ETL would never hit the rulse and per P. Ferguson were not needed because we are correctly retrieving the COVERAGE_CODE_FORM_CODE column in LK_MINOR_LINE_PKG_XREF. I had the rules removed from the ETL. See story or defect for email. (DP-9569, QC 1981)
 ",,,,,,,,,
BR-23337,98 Coverage Form,,,,9/9/2015,mmconley,9/9/15 sconley: Broke into sub-rules for UFC and UIM.,,,,,,,,,
BR-22034,98.1 UFC Coverage Form - Premiums and Losses,"When building the UFC STAT Area:
For premiums, 
If SRC_SYS_CD = 'ELD_PAS'  
     Then Coverage_form = ‘10’ 
Else
  Select  coverage_form          
     from lk_cvrg_crime_form  lkc
   where lkc.coverage_code = CVRG_CD
       and lkc.parent_busn_cvrg_code = PARENT_CVRG_CD
       and (lkc.begin_class_code  <= RATE_CLASS=CD <= lkc.end_class_code )
     if is null
then   
   Select  coverage_form          
      from lk_cvrg_fi_form  lkd
    where lkd.coverage_code = CVRG_CD
        and lkd.parent_busn_cvrg_code = PARENT_CVRG_CD
        and lkd.fi_form = SFAA_FIN_INSTITUTION_FORM_CD
     if is null
 then
     coverage_form  = ‘  ’   
","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,9/9/2015,mmconley,"ELD only has premium data.

9/9/15 sconley: Created sub-rule for UFC.",,,,,,,,,
BR-23339,98.2 UIM Coverage Form - Premiums,Move NULL to COVERAGE_FORM,ETL - D_Stat_Inland_Marine_Premiums,,7/13/2017,mmconley,COVERAGE_FORM is not in the UIM stat area but it exists on d_stat_inland_marine_premiums. The field is NULL for UIM.,,,,,,,,,
BR-22035,99 Crime Form,"When building the UFC STAT Area:
Select  crime_form          
from lk_cvrg_crime_form  lkc
where lkc.coverage_code = CVRG_CD
    and lkc.parent_cov_code = PARENT_BUSN_CVRG_CD
And (lkc.begin_class_code  <= RATE_CLASS_CD <= lkc.end_class_code)
Else   crime_form  = ‘   ’  ","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,11/25/2013,jjordan,,,,,,,,,,
BR-21918,100 Territory Code,"IIF(SRC_SYS_CD='SHR-ACORD','001',
      IIF(SUBLINE_CD='965','   ', 
             IIF(FIPS_US_ALPHA_CD='TX','   ',
                   IIF(ISNULL(ISO_REPORTING_TERRITORY_CD),
                          IIF(ISNULL(RATING_TERRITORY_CD),'000',RATING_TERRITORY_CD),
                          ISO_REPORTING_TERRITORY_CD
                   )
             )
      )
","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses
ETL - D_Stat_Property_Losses
",,2/25/2019,amiller6,"The intent of this rule is to set the territory code based on source system, state, subline, ISO reporting territory and Rating territory

02/25/2019: Updated rule for 'SHR-ACORD;",,,,,,,,,
BR-22587,100.1 UPR Territory Code - Premiums and Losses,"IF SUBLINE_CD = 970
   Then TERRITORY_CODE =  ‘999’
Else
  If ISO_REPORTING_TERRITORY_CD is not null   
     then TERRITORY_CODE =  ISO_REPORTING_TERRITORY_CD 
Else
    IF RATING_TERRITORY_CD is not null   
       then TERRITORY_CODE = RATING_TERRITORY_CD
else TERRITORY_CODE = ‘   ’ (3 spaces)
(Chg default from ‘000’ to ‘  ’ (3 spaces))","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses",,7/12/2017,mmconley,"sconley 5/4/16: Reformatted BR Description

aconley 2/17/17: Added premiums to the rule",,,,,,,,,
BR-22583,100.2 UGL Territory Code - Premiums and Losses,"If SRC_SYS_CD in (‘ELD_PAS’, 'MAL-PAS')
   If FIPS_US_ALPHA_CD = ‘TX’
     Then TERRITORY_CODE = ‘001’
   Else TERRITORY_CODE = ‘000’
     then TERRITORY_CODE =  ‘   ‘ (3 spaces)
Else
  If ISO_REPORTING_TERRITORY_CD is not null   
    then TERRITORY_CODE =  ISO_REPORTING_TERRITORY_CD 
 Else 
   IF RATING_TERRITORY_CD is not null   
    then TERRITORY_CODE = RATING_TERRITORY_CD
else TERRITORY_CODE = ‘000’","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",Discovered during discussion for Specialty E&S Direct Feed project (customs) defect 44.  So not directly related to defect 44.  Just updating so BR matches code per Shelly Conley 2/28/14 email,5/19/2016,dzieverink,"sconley 5/4/16: Reformatted BR Description

dzieverink 5/19/16: 
Defect DP 37 May 2016:
Added logic for MAL-PAS
",,,,,,,,,
BR-22536,100.3 UFC Territory Code - Premiums and Losses,"IF SUBLINE_CD = ‘965’(ISO Buglary & Theft)
   then TERRITORY_CODE =  ‘   ‘ (3 spaces)
Else
 If FIPS_US_ALPHA_CD = ‘TX’
     then TERRITORY_CODE =  ‘   ‘ (3 spaces)
Else
  If ISO_REPORTING_TERRITORY_CD is not null   
    then TERRITORY_CODE =  ISO_REPORTING_TERRITORY_CD 
 Else 
   IF RATING_TERRITORY_CD is not null   
    then TERRITORY_CODE = RATING_TERRITORY_CD
else TERRITORY_CODE = ‘000’
","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses
",,5/4/2016,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-22539,100.4 UIM Territory Code - Losses,"If ISO_REPORTING_TERRITORY_CD is not null   
    then TERRITORY_CODE =  ISO_REPORTING_TERRITORY_CD 
 Else 
   IF RATING_TERRITORY_CD is not null   
    then TERRITORY_CODE = RATING_TERRITORY_CD
else TERRITORY_CODE = ‘000’","ETL - D_Stat_Inland_Marine_Losses
",,6/7/2016,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-22643,100.5 UCA Territory Code - Premiums,"If ISO_REPORTING_TERRITORY_CD is not null   
    then TERRITORY_CODE =  ISO_REPORTING_TERRITORY_CD 
 Else 
   IF RATING_TERRITORY_CD is not null   
    then TERRITORY_CODE = RATING_TERRITORY_CD
else TERRITORY_CODE = ‘000’",ETL - D_Stat_Auto_Premiums,,5/4/2016,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-22644,100.6 UCA Territory Code - Losses,"If ISO_REPORTING_TERRITORY_CD is not null   
    then TERRITORY_CODE =  ISO_REPORTING_TERRITORY_CD 
 Else 
   IF RATING_TERRITORY_CD is not null   
    then TERRITORY_CODE = RATING_TERRITORY_CD
else TERRITORY_CODE = ‘000’","ETL - D_Stat_Auto_Losses
",,5/4/2016,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-21925,101 Deductible Code,"

","ETL - D_Stat_Liability_Losses
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses
ETL - D_Stat_Property_Losses",,9/17/2013,moreilly,"For Fid Crime LOB:
The Deductible Amount for excess policies will be sourced from the Attachment Point in EDW 
The attachment point will be stored in the deductible amount with a purpose of ATTPOINT of the edw.cvrg_deduct table",,,,,,,,,
BR-22763,101.1 UGL Deductible Code - Losses,"If  SRC_SYS_CD not!= ‘ENV-PAS’ and Product Value positions 1_2 
    or PV_1_2 = '41' and Coverage Code = 'AGRIGD' and Underlying Limit Amount >= 985,00,000
    Then BI Deductible Code = ‘99’
Else
     If PV_1_2 = ‘41’ and Coverage Code= “AGRIGD’ and Underlying Limit Amount < 500,000 
         Then BI Deductible Code = ‘01’
     Else
           If  PV_1_2 = ‘41’ and Coverage Code = ‘AGRIGD’
           Then BI Deductible Code = (UNDERLYING_LIMIT_AMT/1,000,000)
If SRC_SYS_CD not = ‘ENV-PAS’ and Product Value positions 1_2 
    or PV_1_2 = '41' and Coverage Code <> 'AGRIGD' and Deductible Purpose Code = ‘ATTPOINT’
 and Deduct Amount >= 98,500,000
     Then BI Deductible Code = ‘99’
Else
     If PV_1_2 = ‘41’ and Coverage Code <> “AGRIGD’ and Deductible Purpose Code = ‘ATTPOINT’
         And Deduct Amount < 500,000
         Then BI Deductible Code = ‘01’
     Else
          If  PV_1_2 = ‘41’ and Coverage Code <> ‘AGRIGD’ and Deductible Purpose Code = ‘ATTPOINT’
              Then BI Deductible Code = (Deduct Amount/1,000,000)                     

 Else
Select Deduct Size CD
From LK_DEDUCT_SIZE_CODE
Where lk.STAT_CODE = 'UGL'
And LK.RISK_STATE = FIPS_US_ALPHA_CD
And LK.DEDUCT_DESC = CD.DEDUCT_BASIS
And (LK.DEDUCT_MIN_AMOUNT <= CD.DEDUCT_AMT <= LK.DEDUCT_MAX_AMOUNT)
If  Not null
    Then BI Deductible Code - Deduct Size CD
Else
If  is null
   Then
   Select Deduct Size CD
  From LK_DEDUCT_SIZE_CODE
Where lk.STAT_CODE = 'UGL'
And LK.RISK_STATE = 'XX'
And LK.DEDUCT_DESC = CD.DEDUCT_BASIS
And (LK.DEDUCT_MIN_AMOUNT <= CD.DEDUCT_AMT <= LK.DEDUCT_MAX_AMOUNT)
If  Not null
   Then BI Deductible Code = Deduct Size CD
Else BI Deductible Code = '  ' (2 spaces)

OLD NOTES: Use Pol Limit amt in Pol Limit Min/Max amoount with 'x' in Aggr Limit Min/Max amount
If Null go to the next line
If state <> 'TX' and Per Occur Limit Amt = 'x' (not equal to 0) or Aggr Pol Term Limit Amt = 'x' (not equal to 0)
Use Per Occur Limit in Pol Limit Min.Max Amount and Aggr Pol Term Limit Amt in Aggr Pol Term Limit Amt Min/Max amount.
",ETL - D_Stat_Liability_Losses,"Defect 8016 and 8193
",5/10/2016,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-22801,101.2 UGL Deductible Code - Premiums,"If  SRC_SYS_CD not!= ‘ENV-PAS’ and Product Value positions 1_2 
    or PV_1_2 = '41' and Coverage Code = 'AGRIGD' and Underlying Limit Amount >= 985,00,000
    Then BI Deductible Code = ‘99’
Else
     If PV_1_2 = ‘41’ and Coverage Code= “AGRIGD’ and Underlying Limit Amount < 500,000 
         Then BI Deductible Code = ‘01’
     Else
           If  PV_1_2 = ‘41’ and Coverage Code = ‘AGRIGD’
           Then BI Deductible Code = (UNDERLYING_LIMIT_AMT/1,000,000)
If SRC_SYS_CD not = ‘ENV-PAS’ and Product Value positions 1_2 
    or PV_1_2 = '41' and Coverage Code <> 'AGRIGD' and Deductible Purpose Code = ‘ATTPOINT’
 and Deduct Amount >= 98,500,000
     Then BI Deductible Code = ‘99’
Else
     If PV_1_2 = ‘41’ and Coverage Code <> “AGRIGD’ and Deductible Purpose Code = ‘ATTPOINT’
         And Deduct Amount < 500,000
         Then BI Deductible Code = ‘01’
     Else
          If  PV_1_2 = ‘41’ and Coverage Code <> ‘AGRIGD’ and Deductible Purpose Code = ‘ATTPOINT’
              Then BI Deductible Code = (Deduct Amount/1,000,000)                     

 Else
Select Deduct Size CD
From LK_DEDUCT_SIZE_CODE
Where lk.STAT_CODE = 'UGL'
And LK.RISK_STATE = FIPS_US_ALPHA_CD
And LK.DEDUCT_DESC = CD.DEDUCT_BASIS
And (LK.DEDUCT_MIN_AMOUNT <= CD.DEDUCT_AMT <= LK.DEDUCT_MAX_AMOUNT)
If  Not null
    Then BI Deductible Code - Deduct Size CD
Else
If  is null
   Then
   Select Deduct Size CD
  From LK_DEDUCT_SIZE_CODE
Where lk.STAT_CODE = 'UGL'
And LK.RISK_STATE = 'XX'
And LK.DEDUCT_DESC = CD.DEDUCT_BASIS
And (LK.DEDUCT_MIN_AMOUNT <= CD.DEDUCT_AMT <= LK.DEDUCT_MAX_AMOUNT)
If  Not null
   Then BI Deductible Code = Deduct Size CD
Else BI Deductible Code = '  ' (2 spaces)

OLD NOTES: Use Pol Limit amt in Pol Limit Min/Max amoount with 'x' in Aggr Limit Min/Max amount
If Null go to the next line
If state <> 'TX' and Per Occur Limit Amt = 'x' (not equal to 0) or Aggr Pol Term Limit Amt = 'x' (not equal to 0)
Use Per Occur Limit in Pol Limit Min.Max Amount and Aggr Pol Term Limit Amt in Aggr Pol Term Limit Amt Min/Max amount.
",ETL - D_Stat_Liability_Premiums,"Defect 8016 and 8193
",5/10/2016,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-22593,101.3 UPR Deductible Code - Premiums and Losses,"/* Rules for Earthquake – subline 930 */
When Subline = ‘930’;
SRC_SYS_CD = ‘UDAGRI’;
Risk State NOT IN (‘CA’, ’KY’);
Set DEDUCTUBLE_CODE = ‘05’;
    EXIT

/* There may be an AMT in D_CVRG_DEDUCT for UDPIM or ISO Property EQ, but only select PCNT.  If there is not a PCNT, DEDUCTIBLE_CODE will get set to 99.  This means for any flat amount deductible, DEDUCTIBLE_CODE will get set to 99 . */
When Subline = ‘930’;
D_CVRG_DEDUCT.DEDUCT_PCNT IS NULL;
Set DEDUCTUBLE_CODE = ‘99’
  EXIT

/* Look-up using deductible percent directly & not using the range */
When Subline = ‘930’;
Select DEDUCT_SIZE_CD 
From LK_DEDUCT_SIZE_CODE
Where LK_DEDUCT_SIZE_CODE.STAT_CODE = ‘UPR’
     And LK_DEDUCT_SIZE_CODE.CVRG_CD = ‘PCNT’
     And LK_DEDUCT_SIZE_CODE .RISK_STATE = ‘XX’
     And LK_DEDUCT_SIZE_CODE.DEDUCT_AMOUNT = D_CVRG_DEDUCT.DEDUCT_PCNT

When row is found;
Set DEDUCTUBLE_CODE = LK_DEDUCT_SIZE_CODE.DEDUCT_SIZE_CD;  
  EXIT

When row is not found;
D_CVRG_DEDUCT.DEDUCT_PCNT > 40;
Set DEDUCTUBLE_CODE = ‘98’;
  EXIT

When row is not found;
D_CVRG_DEDUCT.DEDUCT_PCNT < 40;
Set DEDUCTUBLE_CODE = ‘97’;
  EXIT

When row is not found;
Set DEDUCTUBLE_CODE = ‘99’
  EXIT

/* Rules for Non-Earthquake */
When SUBLINE_CD = ‘027’; (cvrg_cd = ‘GROUP2’)
    1) Use the D_CVRG_DEDUCT Selection Criteria for cvrg_cd ‘GROUP2’ (DOORs BR-21973) to get the DEDUCT_PCNT and the DEDUCT_AMT. These values from D_CVRG_DEDUCT are populated in S_D_STAT_FORMAT_PREMIUM_STG2.DEDUCT_PCNT & DEDUCT.AMT)
    2) If the deductible is a percent ((D_CVRG_DEDUCT.DEDUCT_PCNT is NOT NULL and <> 0), use the Per Occurrence Limit ranking for cvrg_cd GROUP2 (DOORs BR-23562) to get the Per Occurrence Limit Amount. This value from D_CVRG_LIMIT is populated in S_D_STAT_FORMAT_PREMIUM_STG2. PER_OCCUR_LIMIT_AMT.
    3) Determine var_DEDUCT_AMT.
        (Use values from S_D_STAT_FORMAT_PREMIUM_STG2)
        When the deductible is a percent:
            Set var_DEDUCT_AMT =  
            D_CVRG_LIMIT.PER_OCCUR_LIMIT_AMT * (D_CVRG_DEDUCT.DEDUCT_PCNT / 100) 
       When the deductible is NOT a percent:
           Set var_DEDUCT_AMT = D_CVRG_DEDUCT.DEDUCT_AMT
    4) Continue to Select DEDUCT_SIZE_CD;

When SUBLINE_CD = ‘106’;
DEDUCT_AMT > 25000;
  Set DEDUCTUBLE_CODE = ‘90’;
  EXIT;

When SUBLINE_CD = ‘106’;
CVRG_CD = ‘LIVELOV’;
  Set var_DEDUCT_AMT = D_CVRG_LIMIT.POL_LIMIT_AMT/D_CVRG_DEDUCT.DEDUCT_PCNT
  (If D_CVRG_LIMIT.POL_LIMIT_AMT is NULL, set dividend to 0) 
  Continue to Select DEDUCT_SIZE_CD; 
 
When SUBLINE_CD NOT IN (‘106’,’930’);
  Set var_DEDUCT_AMT = D_CVRG_DEDUCT.DEDUCT_AMT
  Continue to Select DEDUCT_SIZE_CD;

Select DEDUCT_SIZE_CD 
From LK_DEDUCT_SIZE_CODE
Where LK_DEDUCT_SIZE_CODE.STAT_CODE = ‘UPR’
     And LK_DEDUCT_SIZE_CODE.CVRG_CD = ‘ANY’
     And LK_DEDUCT_SIZE_CODE .RISK_STATE = ‘XX’
     And (LK_DEDUCT_SIZE_CODE.DEDUCT_MIN_AMOUNT <= var_DEDUCT_AMT <=
              LK_DEDUCT_SIZE_CODE.DEDUCT_MAX_AMOUNT)

When row is found;
Set DEDUCTUBLE_CODE = LK_DEDUCT_SIZE_CODE.DEDUCT_SIZE_CD  
  EXIT

When row is not found;
Set DEDUCTUBLE_CODE = ‘01’
  EXIT","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses
","FDW_Core 10262: UPR Earthquake: New requirements for DEDUCTIBLE_CODE

sconley 6/12/17: ENTERPRISE.Data_Platform 1981: New rules for ISO Property subline 027; DP-9669

sconley 8/9/17: Added comment about flat deductibles.",8/9/2017,mmconley,"4/18/16 sconley:  FDW_Core 10262.  Combined Premiums and Losses into 1 rule in DOORs.  Reformated rule.  During analysis it was discovered that losses were not executing the same rules as premiums so losses were updated to match premiums.  

sconley 5/4/16: Reformatted BR Description

sconley 6/12/17: New rules for ISO Property subline 027 (cvrg_cd 'GROUP2'). If the Wind deductible is a percent, multiple Per Occurrence limt by percent & use that value for look-up to LK_DEDUCT_SIZE_CODE. 
A DUR deductible (such as for TIMELEMENT) will get set to '01'. Per P. Ferguson, the instructions state that time deductibles should be reported as Full Coverage. (QC 1981, DP-9669).",,,,,,,,,
BR-22519,101.4 UFC Deductible Code - Premiums and Losses,"Deductible _code
(If SFAA & TX(ISO Misc Module)) 
Select DEDUCT_AMT
  From FDW.d_cvrg_deduct  cd
 Where cd.EDW_CVRG_HIST_ID = CVRG_HIST_ID

 If subline = ‘965’(ISO Buglary & Theft)
   Then    
   Select DEDUCT_SIZE_CD 
     From lk_deduct_size_code
    Where lk.STAT_CODE = ‘UFC’
        And lk.CVRG_CD = ‘ANY’
        And lk.RISK_STATE = ‘XX’
        And (lk.DEDUCT_MIN_AMOUNT <= DEDUCT_AMT <= lk.DEDUCT_MAX_AMOUNT)
       If not null 
             Then DEDUCT_CD = DEDUCT_SIZE_CD 
        Else DEDUCT_CD = ‘00’
         (left fill positions 1-6 with 0)
Else
  If the deduct_amt >= 100000000
      Deductible_code =  '99999999'
   else
    DEDUCTIBLE_CODE = DEDUCT_AMT 
(left fill with 0)","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,5/10/2016,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-22520,101.5 UIM Deductible Code - Premiums and Losses,"When CVRG_CD = ‘FLOOD’
    1) Use the D_CVRG_DEDUCT Selection Criteria DOORs BR-21973) to get the DEDUCT_PCNT and the DEDUCT_AMT. These values from D_CVRG_DEDUCT are populated in S_D_STAT_FORMAT_PREMIUM_STG2.DEDUCT_PCNT & DEDUCT.AMT)
    2) When the deductible is an amount:
           Set var_DEDUCT_AMT = D_CVRG_DEDUCT.DEDUCT_AMT
           Continue to Select DEDUCT_SIZE_CD;
    3) If the deductible is a percent ((D_CVRG_DEDUCT.DEDUCT_PCNT is NOT NULL and <> 0), use the Per Occurrence Limit for cvrg_cd FLOOD. This value from D_CVRG_LIMIT is populated in S_D_STAT_FORMAT_PREMIUM_STG2.PER_OCCUR_LIMIT_AMT.
    4) Determine var_DEDUCT_AMT.
         (Use values from S_D_STAT_FORMAT_PREMIUM_STG2)
        When the deductible is a percent:
            Set var_DEDUCT_AMT =  
            D_CVRG_LIMIT.PER_OCCUR_LIMIT_AMT * (D_CVRG_DEDUCT.DEDUCT_PCNT / 100)        
    5) Continue to Select DEDUCT_SIZE_CD;

When CVRG_CD <> ‘FLOOD’;
  Set var_DEDUCT_AMT = D_CVRG_DEDUCT.DEDUCT_AMT
  Continue to Select DEDUCT_SIZE_CD;

Select DEDUCT_SIZE_CD 
From LK_DEDUCT_SIZE_CODE
Where LK_DEDUCT_SIZE_CODE.STAT_CODE = ‘UIM’
     And LK_DEDUCT_SIZE_CODE.CVRG_CD = ‘ANY’
     And LK_DEDUCT_SIZE_CODE .RISK_STATE = ‘XX’
     And (LK_DEDUCT_SIZE_CODE.DEDUCT_MIN_AMOUNT <= var_DEDUCT_AMT <=
              LK_DEDUCT_SIZE_CODE.DEDUCT_MAX_AMOUNT)

/* When there is a DUR deductible, the look-up returns '01' (for deduct_amt = 0) */ 
When row is found;
Set DEDUCTUBLE_CODE = LK_DEDUCT_SIZE_CODE.DEDUCT_SIZE_CD  
  EXIT

When row is not found;
Set DEDUCTUBLE_CODE = ‘00’
  EXIT
","ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses","sconley 1/3/18: ENTERPRISE.Data_Platform - Defect 2688 FDW Update for UIM DEDUCTIBLE_CODE, US21342, US21602: Change for FLOOD coverage for DIC
",1/3/2018,mmconley,"7/31/15 sconley: Corrected FDW table name.
EDW source vw_prcdeductible.deduct_amt.

2/2/16 sconley: Corrected lk_deduct_size_code name. 
Per Kevin, d_cvrg_deduct is loaded before the stat area fields and the deductile amt is selected from d_cvrg_deduct.

sconley 5/4/16: Reformatted BR Description

sconley 1/3/18: ENTERPRISE.Data_Platform - Defect 2688 FDW Update for UIM DEDUCTIBLE_CODE, US21342, US21602: Change for FLOOD coverage for DIC.  If the FLOOD deductible is a percent, we need to get the FLOOD Per Occurrence limt, multiply it by the percent, and then use that amount for the look-up.",,,,,,,,,
BR-22501,102 Deductible Amount,"
","ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses
ETL - D_Stat_Work_Comp_Premiums
ETL - D_Stat_Work_Comp_Losses",,7/11/2014,lkummer,,,,,,,,,,
BR-22594,102.1 UPR Deductible Amount - Losses,"If cd.DEDUCT_AMT is not null
  Then DEDUCT_AMT = DEDUCT_AMT (left fill with 0)
Else DEDUCT_AMT = ‘0000000000’","ETL - D_Stat_Property_Losses
",,5/4/2016,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-22585,102.2 UPR Deductible Amount - Premiums,"Select POL_LIMIT_AMT
from FDW.d_cvrg_limit  cl
Where cl.EDW_CVRG_HIST_ID = CVRG_HIST_ID

Select DEDUCT_AMT,
          DEDUCT_PCNT
From FDW.d_cvrg_deduct  cd
Where cd.EDW_CVRG_HIST_ID = CVRG_HIST_ID

IF SUBLINE_CD = ‘930’
  And SRC_SYS_CD in ('UDPIM','BRIDGE-PAS')
  And DEDUCT_AMT is not null AND DEDUCT_AMT != 0
  Then DEDUCT_AMT

IF SUBLINE_CD = ‘930’
  And SRC_SYS_CD in ('UDPIM','BRIDGE-PAS')
  And DEDUCT_AMT is null OR DEDUCT_AMT = 0
  And DEDUCT_PCNT is not null AND DEDUCT_PCNT != 0
  Then DEDUCT_AMT = (DEDUCT_PCNT/100) * (EXPOSURE_AMT)
		**Note: Actual exposure amount being used, not the one that is modified or rounded and stored on the fact tables**

If Cvrg_Cd = 'ORCHVINE'
    Then DEDUCT_AMT = '500'
        
If SUBLINE_CD = ‘106’
  and CVRG_CD = ‘LIVELOV’
    Then DEDUCT_AMT = POL_LIMIT_AMT/DEDUCT_PCNT
  Else 
     DEDUCT_AMT = cd.DEDUCT_AMT (left pad 0)
Else  
   DEDUCT_AMT = ‘0000000000’",ETL - D_Stat_Property_Premiums,10007,4/17/2018,dzieverink,"if the coverage code is 'LIVELOV' or subline cd = 930
   deductible amount = limit_amt/deduct_pcnt
else 
    deductible amount  = deductible amount from the d_cvrg_deduct table

if deductible amount is null default to zero

deductible amount should be lpad with 0 for 10 positions

2/23/16 - dzieverink - Added ORCHVINE defaulting rule to the amount logic

sconley 5/4/16: Reformatted BR Description

dzieverink 4/17/18 - Added special rules for EQ coverage deductible amount.",,,,,,,,,
BR-22582,102.3 UIM Deductible Amount - Premiums,"Select POL_LIMIT_AMT
from FDW.d_cvrg_limit  cl
Where cl.EDW_CVRG_HIST_ID = CVRG_HIST_ID

Select DEDUCT_AMT,
          DEDUCT_PCNT
From FDW.d_cvrg_deduct  cd
Where cd.EDW_CVRG_HIST_ID = CVRG_HIST_ID

IF CVRG_CD = ‘FLOOD’
  And SRC_SYS_CD in ('UDPIM','BRIDGE-PAS')
  And DEDUCT_AMT is not null AND DEDUCT_AMT != 0
  Then DEDUCT_AMT

IF CVRG_CD = ‘FLOOD’
  And SRC_SYS_CD in ('UDPIM','BRIDGE-PAS')
  And DEDUCT_AMT is null OR DEDUCT_AMT = 0
  And DEDUCT_PCNT is not null AND DEDUCT_PCNT != 0
  Then DEDUCT_AMT = (DEDUCT_PCNT/100) * (EXPOSURE_AMT)
		**Note: Actual exposure amount being used, not the one that is modified or rounded and stored on the fact tables**

If SUBLINE_CD = ‘106’
  and CVRG_CD = ‘LIVELOV’
    Then DEDUCT_AMT = POL_LIMIT_AMT/DEDUCT_PCNT
  Else 
     DEDUCT_AMT = cd.DEDUCT_AMT (left pad 0)
Else  
   DEDUCT_AMT = ‘0000000000’

Note: If Deductible Amount is not set using hardcoded logic above. The ETL will use the deduct amount sent and then use that in a lookup on LK Deduct Size Code (Stat Code = UPR) and return the value associated to the range that the sent amount falls into. For example, if 12,500 was sent. The lookup would return 10,000 since 12,500 is within the range (10001 to 25000) that is associated with that row on the table. ",ETL - D_Stat_Inland_Marine_Premiums,,5/15/2018,dzieverink,"sconley 5/4/16: Reformatted BR Description

dzieverink 4/17/18 - Added special rules for Flood coverage deductible amount.",,,,,,,,,
BR-23498,102.3.1 UIM Deductible Amount - Losses,"iif(isnull(DEDUCT_AMT),'0000000000',

lpad(DEDUCT_AMT,10,'0'))",ETL - D_Stat_Inland_Marine_Losses,,4/17/2018,dzieverink,,,,,,,,,,
BR-23247,"102.4 UWC Deductible Amount -  Premiums and Losses	",Use the 4 digit field (scope Class Code) that represents this policy's deductible.,"ETL - D_Stat_Work_Comp_Premiums
ETL - D_Stat_Work_Comp_Losses",,7/13/2017,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-23269,103 Attachment Point Code ,"If PV_1_2 = ‘41’ and Coverage Code= “AGRIGD’ look for underlying_limit_amt in new lookup table and set the ATTACHMENT_POINT_CODE field equal to the value in the ATTACH_SIZE_CODE field
 
Else
If PV_1_2 = ‘41’ and Coverage Code <> “AGRIGD’ look for deduct_amt in new lookup table and set the ATTACHMENT_POINT_CODE field equal to the value in the ATTACH_SIZE_CODE field 
Else
       ATTACHMENT_POINT_CODE = ‘00’.


These are the values that will be used as part of the new lookup table called LK_ATTACH_POINT_CODE

Attachment      Attachment                                          Attachment          
Point                       Point Range                                          Point Code

100,00                    0  to 100,000                                                         21
250,000                 100,001 to 250,000                                             25
300,000                 250,001 to 300,000                                             26
500,000                 300,001 to 500,000                                             50
750,000                 500,001 to 750,000                                             51
1,000,000              750,001 to 1,000,000                                          52
1,500,000              1,000,001 to 1,500,000                                      53
2,000,000              1,500,001 to 2,000,000                                      54
2,500,000              2,000,001 to 2,500,000                                      55
3,000,000              2,500,001 to 3,000,000                                      70
4,000,000              3,000,001 to 4,000,000                                      71
5,000,000              4,000,001 to 5,000,000                                      57
6,000,000              5,000,001 to 6,000,000                                      72
7,000,000              6,000,001 to 7,000,000                                      73
7,500,000              7,000,001 to 7,500,000                                      74
8,000,000              7,500,001 to 8,000,000                                      75
9,000,000              8,000,001 to 9,000,000                                      76
10,000,000            9,000,001 to 10,000,000                                    59
Over 10,000,000  10,000,001  to 999,999,999                                93  
","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",Defect 8193,1/30/2015,dburns4,,,,,,,,,,
BR-21927,"104 Claims Made Entry Date


","CLAIMS_MADE_ENTRY_DT
IF SRC_SYS_CD = ‘UDAGRI’  
   Then CLAIMS_MADE_ENTRY_DT = SPACES 
 Else 
    IF SRC_SYS_CD in (‘ELD_PAS’ ,’ENV-PAS’, 'SES_PAS', 'GAC-PAS') 
          If ORIG_CLAIMS_MADE_ENTRY_DT is not null
            Then CLAIMS_MADE_ENTRY_DT =              	ORIG_CLAIMS_MADE_ENTRY_DT (MMYY)
             Else CLAIMS_MADE_ENTRY_DT = ‘0000’ 
             End-if
       Else SPACES
       End-If
    End-if

Premium & Losses:  The rule is applied to both premiums and losses.  

IF SRC_SYS_CD in (ELD_PAS ,'MAL-PAS', ENV-PAS, 'SES-PAS', 'GAC-PAS') 
     If ORIG_CLAIMS_MADE_ENTRY_DT is not null
        Then CLAIMS_MADE_ENTRY_DT =  ORIG_CLAIMS_MADE_ENTRY_DT (MMYY)
             Else CLAIMS_MADE_ENTRY_DT = SPACES 
End-If



IF SRC_SYS_CD in (‘ELD_PAS’ ,'MAL-PAS', ‘ENV-PAS’, 'SES-PAS', 'GAC-PAS', ‘DIRCTENTRY’, ‘REFAPP’)
     If ORIG_CLAIMS_MADE_ENTRY_DT is not null
        Then CLAIMS_MADE_ENTRY_DT =  ORIG_CLAIMS_MADE_ENTRY_DT (MMYY)
             Else CLAIMS_MADE_ENTRY_DT = SPACES 
End-If
    
On the loss side, we then apply the conversion rule from Rick with:

      If PREVIOUSLY_CONVERTED_IND = 1 and conv_CLAIMS_MADE_ENTRY_DATE is not null, 
                   move conv_CLAIMS_MADE_ENTRY_DATE to conv_UGL_CLAIMS_MADE_ENTRY_DATE


Per Bryan Saleeba, the code is found in ""MP_STAT_UGL_COMMON mapplet in the FDW_EDW folder.
","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses","7/25/14 - Defect 89 - Specialty E & S not setting correct value on losses side for CLAIM_MADE_ENTRY_DATE.  

Qualifier of ""DIRCTENTRY"" added via Jira story DP-7434 and code under Data Platform QC-1376

8/4/17-dlburns for Rally Story US17461, QC2243 to add ""REFAPP' to the condition to populate claims made entry date if there for General Liability project.

",8/7/2017,dburns4,"7/25/14 - Defect 89 - code does not match business rule from DOORS on either premium or losses for CLAIM_MADE_ENTRY_DATE.
08/08/14:  Kevin removed the UDAGRI part and let default pick it up (to set to spaces) and implemented the same rule for Premium and Losses.  The Losses side also has an additional rule for conversion added by Rick.

In addition to combining the rule for Premium and Losses in to one rule also changed:
PREMIUM side:  Adding GAC-PAS and changed default value to spaces.  Typo in BR shows SES_PAS and should be SES-PAS.   
LOSSES:  No check made for Specialty E & S in the code.   Business rule and code modified to add ENV-PAS, SES-PAS, GAC-PAS and changed default value to spaces.  

dzieverink 5/19/16: 
Defect DP 37 May 2016:
Added logic for MAL-PAS


information:
When building the UGL Stat Area, determine the Claims Made Entry Date using the source system and the Original Claims Made Entry Date.

Default Claims Made Entry Date to spaces.

When the source system is in (ELD_PAS, ENV-PAS, SES-PAS, GAC-PAS), and Original Claims Made Entry Date is NOT Null, set the Claims Made Entry Date equal to the  Original Claims Made Entry Date.

When the source system is in (ELD_PAS, ENV-PAS, SES-PAS, GAC-PAS), and Original Claims Made Entry Date is Null, set the Claims Made Entry Date equal to 0000 spaces
Also for source system = UDAGRI, move spaces to claims made entry date
Feb 2017:  For SHS D & O project, the policy data is put in to EDW via Direct Entry.  Therefore, needed to added qualifier of ""DIRCTENTRY"" so that claims made entry date will be populated if date is provided,  else spaces.  Jira story DP-7434 with Data Platform Defect QC-1376 for code changes.
8/4/17 - For General Liability project, add qualifier for CUBE of ""REFAPP"" to condition so if claims made entry date is sent, we use that date.  See Rally Story US17459, QC2241.

",,,,,,,,,
BR-21928,105 Transaction Type Code,"
","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses
",,5/23/2017,mmconley,sconley 5/23/17: Added Property tables that were missing,,,,,,,,,
BR-23084,105.1 UIM UPR UCA UGL UFC Transaction Type Code - Losses,"When building the stat format LOSS area for ALL Stat Format Codes, use the below rule to set the transaction type code.

The category codes come from the EDW Claim data.  Some of them are included in the loss staging area. The category codes are a mixture of upper and lower case letters.  In the Informatica code all category codes are converted to upper case for the comparison in this rule.

Source System Code refers to the claim policy Source System Code and is determined when the loss staging area is built.

Subline Code 090 is for PIM SBP Data Compromise.  SBP is reported under the Company Program Exception module therefore it is excluded from the rules that apply to Fire and Allied Lines.

When Subline Code in ('015', '016', '017', '018', '027', '029', '035', '045', '055', '060', '061', '070', '090', '116', '136', '156', '176', '196', '611', '618', '620', '621', '622', '623', '631', '660', '661', '662', '663', '615', '625', '635', '638') 
or (Subline Code = ‘090’ and Source System Code <> ‘UDPIM’ or 'BRIDGE-PAS');
Claim Financial Transaction Category Code in ('Payment','RECOVERY'); 
Loss Category Code = ‘claimcost’; 
Collection Category Code = ‘Salvage’
    Set Transaction Type Code = 4; 
    EXIT

When Subline Code in ('015', '016', '017', '018', '027', '029', '035', '045', '055', '060', '061', '070', '090', '116', '136', '156', '176', '196', '611', '618', '620', '621', '622', '623', '631', '660', '661', '662', '663', '615', '625', '635', '638') 
or (Subline Code = ‘090’ and Source System Code <> ‘UDPIM’ or 'BRIDGE-PAS'); 
Claim Financial Transaction Category Code in ('Payment','RECOVERY'); 
Loss Category Code = ‘expense’; 
Expense Payment Category Code in (‘S’,’X’); 
Collection Category Code = ‘Salvage’
    Set Transaction Type Code = 4;
    EXIT

When Subline Code in ('015', '016', '017', '018', '027', '029', '035', '045', '055', '060', '061', '070', '090', '116', '136', '156', '176', '196', '611', '618', '620', '621', '622', '623', '631', '660', '661', '662', '663', '615', '625', '635', '638') 
or (Subline Code = ‘090’ and Source System Code <> ‘UDPIM’ or 'BRIDGE-PAS'); 
Claim Financial Transaction Category Code in ('Payment','RECOVERY'); 
Loss Category Code = ‘claimcost’; 
Collection Category Code = ‘Subro’
    Set Transaction Type Code = 5;
    EXIT

When Subline Code in ('015', '016', '017', '018', '027', '029', '035', '045', '055', '060', '061', '070', '090', '116', '136', '156', '176', '196', '611', '618', '620', '621', '622', '623', '631', '660', '661', '662', '663', '615', '625', '635', '638') 
or (Subline Code = ‘090’ and Source System Code <> ‘UDPIM’ or 'BRIDGE-PAS'); 
Claim Financial Transaction Category Code in ('Payment','RECOVERY'); 
Loss Category Code = ‘expense’; 
Expense Payment Category Code in (‘S’,’X’); 
Collection Category Code = ‘Subro’
    Set Transaction Type Code = 5;
    EXIT

When Claim Financial Transaction Category Code in ('Payment','RECOVERY'); 
Loss Category Code = ‘claimcost’
    Set Transaction Type Code = 6;
    EXIT

When Claim Financial Transaction Category Code in ('Payment','RECOVERY'); 
Loss Category Code = ‘expense’
Expense Payment Category Code in (‘S’,’X’); 
    Set Transaction Type Code = 6; EXIT

When Claim Financial Transaction Category Code in ('Payment','RECOVERY'); 
Loss Category Code = ‘expense’
    Set Transaction Type Code = 8;
    EXIT

When Claim Financial Transaction Category Code in ('Reserve','RECORES');
Loss Category Code = ‘claimcost’
    Set Transaction Type Code = 7; 
    EXIT

When Claim Financial Transaction Category Code in ('Reserve','RECORES'); 
Loss Category Code = ‘expense’
    Set Transaction Type Code = 9;
    EXIT

Set Transaction Type Code = 9;
    EXIT
","ETL - D_Stat_Liability_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Auto_Losses
ETL - D_Stat_Property_Losses","FDW_Core 4679: Additions for Expense Reserves & Expense Reserve Recovery (Herbig)

FDW_Core 4982: Additional criteria added to losses for subline 090; Revamped the BR.  (Conley)

dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202)",9/8/2017,mmconley,"While working on FDW_Core 4679, Kevin Nienaber discovered that that the leading zero was missing on all the sublines with the leading zero, so he updated the Informatica code and changed it to a DECODE versus nested IF stattements.

sconley 5/4/16: Reformatted BR Description

sconley 9/8/17: Added D_Stat_Property_Losses to ETL Spec Cross Reference",,,,,,,,,
BR-22525,105.2 UIM Transaction Type Code - Premiums,"If CVRG_CD in ('AQUA', 'BMP', 'BRMP', 'EXPCO', EXPERADIN', 'FINCHRG', 'INEXOPER', 'LIVESURC', 'MANLIAB', 'MANPDAM', 'WAIVEPREM')
    or CVRG_GROUP = 'SBP'
Then TRANS_TYPE_CODE = ‘2’ 
Else TRANS_TYPE_CODE = ‘1’  ",ETL - D_Stat_Inland_Marine_Premiums,,9/8/2017,mmconley,"sconley 5/4/16: Reformatted BR Description

sconley 5/23/17: Added all the coverages & check for CVRG_GROUP 'SBP' that are in the Informatica ETL. Approved by P. Ferguson. All of the coverage codes are bureau reported with limited coding since they are missing critical values such as the class code. CVRG_GROUP 'SBP' is only applicable to UPR.

sconley 9/8/17: Update field to TRANS_TYPE_CODE",,,,,,,,,
BR-22527,105.3 UFC Transaction Type Code - Premiums,"If CVRG_CD in ('AQUA', 'BMP', 'BRMP', 'EXPCO', 'EXPERADIN', 'FINCHRG', 'INEXOPER', 'LIVESURC', MANLIAB', 'MANPDAM', 'WAIVEPREM') 
    or CVRG_GROUP = 'SBP'
Then TRANS_TYPE_CODE = '2'
Else TRANS_TYPE_CODE = '1'",ETL - D_Stat_Crm_Fdlty_Srty_Premiums,,9/8/2017,mmconley,"2/23/16 - Now a part of the UFC Stat Area

sconley 5/4/16: Reformatted BR Description

sconley 5/23/17: Added all the coverages & check for CVRG_GROUP 'SBP' that are in the Informatica ETL. Approved by P. Ferguson. All of the coverage codes are bureau reported with limited coding since they are missing critical values such as the class code. CVRG_GROUP 'SBP' is only applicable to UPR.

sconley 9/8/17: Update field to TRANS_TYPE_CODE",,,,,,,,,
BR-22529,"105.4 UGL Transaction Type Code - Premiums

When Building the STAT Format area for UGL Premiums,

Default transaction type code to '1'

Based on certain coverage code values, set the transaction type code to '2'
When the coverage code is in the following:
('AQUA','BMP','BRMP','EXPCO','EXPERADIN','FINCHRG','INEXOPER','LIVESURC','MANLIAB', 'MANPDAM','WAIVEPREM'), set the transaction type code to '2'","If CVRG_CD in ('AQUA', 'BMP', 'BRMP', 'EXPCO', EXPERADIN', 'FINCHRG', 'INEXOPER', 'LIVESURC', 'MANLIAB', 'MANPDAM', 'WAIVEPREM')
    or CVRG_GROUP = 'SBP'
Then TRANS_TYPE_CODE = ‘2’ 
Else TRANS_TYPE_CODE = ‘1’  ",ETL - D_Stat_Liability_Premiums,,9/8/2017,mmconley,"sconley 5/4/16: Reformatted BR Description

sconley 5/23/17: Added all the coverages & check for CVRG_GROUP 'SBP' that are in the Informatica ETL. Approved by P. Ferguson. All of the coverage codes are bureau reported with limited coding since they are missing critical values such as the class code. CVRG_GROUP 'SBP' is only applicable to UPR.

sconley 9/8/17: Update field to TRANS_TYPE_CODE",,,,,,,,,
BR-22531,105.5 UCA Transaction Type Code - Premiums,"If CVRG_CD in ('AQUA', 'BMP', 'BRMP', 'EXPCO', EXPERADIN', 'FINCHRG', 'INEXOPER', 'LIVESURC', 'MANLIAB', 'MANPDAM', 'WAIVEPREM')
    or CVRG_GROUP = 'SBP'
Then TRANS_TYPE_CODE = ‘2’ 
Else TRANS_TYPE_CODE = ‘1’  ",ETL - D_Stat_Auto_Premiums,,9/8/2017,mmconley,"sconley 5/4/16: Reformatted BR Description

sconley 5/23/17: Added all the coverages & check for CVRG_GROUP 'SBP' that are in the Informatica ETL. Approved by P. Ferguson. All of the coverage codes are bureau reported with limited coding since they are missing critical values such as the class code. CVRG_GROUP 'SBP' is only applicable to UPR.

sconley 9/8/17: Update field to TRANS_TYPE_CODE",,,,,,,,,
BR-22533,105.6 UPR Transaction Type Code - Premiums,"If CVRG_CD in ('AQUA', 'BMP', 'BRMP', 'EXPCO', EXPERADIN', 'FINCHRG', 'INEXOPER', 'LIVESURC', 'MANLIAB', 'MANPDAM', 'WAIVEPREM')
   or CVRG_GROUP = ‘SBP’
   or SUBLINE_CODE = ‘090’
Then TRANS_TYPE_CODE = ‘2’ 
Else TRANS_TYPE_CODE = ‘1’  ",ETL - D_Stat_Property_Premiums,"sconley 5/19/17: ENTERPRISE.Data_Platform 1916 Add subline '090' to the rule for setting TRANS_TYPE_CODE to '2' (JIRA DP-9667)
",9/8/2017,mmconley,"sconley 5/4/16: Reformatted BR Description

sconley 5/19/17: For ISO Property, add subline '090' to the rule for setting TRANS_TYPE_CODE to '2' (QC 1916, JIRA DP-9667) 090 is reported under CPE module.

sconley 5/23/17: Added all the coverages & check for CVRG_GROUP 'SBP' that are in the Informatica ETL. Approved by P. Ferguson. All of the coverage codes are bureau reported with limited coding since they are missing critical values such as the class code. CVRG_GROUP 'SBP' is only applicable to UPR.

sconley 9/8/17: Update field to TRANS_TYPE_CODE",,,,,,,,,
BR-21930,106 Program Code,,"ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Property_Losses",,12/31/2013,moreilly,,,,,,,,,,
BR-22603,106.1 UGL Program Code - Premiums and Losses,Default to '00',"ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",,5/9/2016,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-23371,106.2 UPR Program Code - Premiums,"If SRC_SYS_CD  in (‘UDPIM’,'BRIDGE-PAS')
  Then PROGRAM_CODE = ‘ ’ space
Else 
  If MULTI_LINE_IND = ‘0’
    If lk.PACKAGE_CD = ‘26’
      Then PROGRAM_CODE = ‘L’
    Else PROGRAM_CODE = ‘ ‘ space
 Else PROGRAM_CODE = ‘ ‘ space",ETL - D_Stat_Property_Premiums,,6/20/2016,dzieverink,"sconley 5/9/16: Moved rule from BR-21911 (UPR Stat Area Prem) to under Program Code and corrected spelling of PROGRAM_CODE.
EDW source: vw_pol_term_hist.multi_line_ind
FDW source: lk_minor_line_pkg_xref.package_cd

dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202)",,,,,,,,,
BR-22601,106.3 UPR Program Code - Losses,"IF SRC_SYS_CD = ‘UDAGRI’  
  Then PROGRAM_CODE = ‘0’  
   Else PROGRAM_CODE =  ‘ ‘ space
End-If","ETL - D_Stat_Property_Losses
",,5/9/2016,mmconley,"sconley 5/4/16: Reformatted BR Description
sconley 5/9/16: Corrected spelling of PROGRAM_CODE",,,,,,,,,
BR-22646,106.4 UCA Program Code - Premiums ,Default to '00',"ETL - D_Stat_Auto_Premiums
",,5/9/2016,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-22659,106.5 UCA Program Code - Losses,Default to '0',ETL - D_Stat_Auto_Losses,,5/9/2016,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-21931,107 Risk Location Code,,,,5/22/2013,moreilly,,,,,,,,,,
BR-23473,108 Risk Location Number,,,,7/13/2017,mmconley,,,,,,,,,,
BR-22523,"108.1 UIM Risk Location Number - Losses	", Default = ‘0’,ETL - D_Stat_Inland_Marine_Losses,,7/13/2017,mmconley,7/13/17 sconley:  Changed format and made sub-rule for UIM Losses.,,,,,,,,,
BR-23474,"108.2 UCA Risk Location Number - Premiums	", Default = ‘0’,ETL - D_Stat_Auto_Premiums,,7/13/2017,mmconley,7/13/17 sconley:  Changed format and made sub-rule for UCA Premiums.,,,,,,,,,
BR-21932,109 Location Code,"Default Locaction_cd to '000'
","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",,5/1/2013,moreilly,LOCATION_CD = ‘000’ (default),,,,,,,,,
BR-23444,110 Excess Indicator,,,,1/3/2017,mmconley,1/3/17 sconley: Reformatted Business Rule Description,,,,,,,,,
BR-21933,110.1 UFC Excess Indicator - Premiums and Losses,"If  STAT_FORMAT-CODE =  ‘UFC’
	When the CVRG_HIST.Primary_ind = 0
     		Excess_indicator = 1
	Else 
      		Excess_indicator = 0
                 End-when
Else
	Continue
End-if","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,1/3/2017,mmconley,"1 = excess policy(true)
0 = primary policy(false)

1/3/17 sconley: Reformatted Business Rule Description",,,,,,,,,
BR-22653,110.2 UCA Excess Indicator - Premiums,Move 0,"ETL - D_Stat_Auto_Premiums
",,1/3/2017,mmconley,"1 = excess policy(true)
0 = primary policy(false)

1/3/17 sconley: Reformatted Business Rule Description",,,,,,,,,
BR-22036,111 Number of Additional Locations,"If foreign_location_cnt or domestic_location_cnt is NULL, then convert to 0 for the calculation. 
No_of_addl_location:
If (foreign_locations_cnt + domestic_location_cnt) = 999, then no_of_addl_location = 998
Else
If (foreign_locations_cnt + domestic_location_cnt) > 999 then no_of_addl_location = 999
Else 
No_of_addl_location = (foreign_locations_cnt + domestic_location_cnt) - 1
end
/* Do not want a negative number
If No_of_addl_location < 0 then No_of_addl_location = 0

When this data is moved to the UFC stat area, left pad with 0s.","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",AFG.mySurety_Intg 9: Revise rule for NO_ADDL_LOCATION when no locations exist because mySurety does not populate this data,3/31/2014,mmconley,"3/25/14: S. Conley: Cvrg level fields. EDW Source:
vw_cvrg_hist.foreign_location_cnt
vw_cvrg_hist.domestic_location_cnt

The rule for setting the no_of_addl_location is done in m_premium_Fact_core_stg2.

",,,,,,,,,
BR-22037,112 Number of Employees,"
Current Rule as of July 2018

If ATM_DEBIT_CREDIT_CARD_CNT is not null then TOTAL NUMBER OF EMPLOYEES = ATM_DEBIT_CREDIT_CARD_CNT

If ATM_DEBIT_CREDIT_CARD_CNT is Null then TOTAL NUMBER OF EMPLOYEES = (foreign_employee_Cnt+domestic_employee_cnt) 
And retain logic that if employee count is >= 100000 to set value to 99999

if coverage cd = 'ERISA' then  No_of_employees = 5

**Previous Rule **
(Foreign_rateable_empolyee_cnt + domestic_ratable_employee_cnt) = No of employees

if No_of_employees >= 100000 then No_of_employees = 99999 else  no_of_employees

if coverage cd = 'ERISA' then  No_of_employees = 5

When this data is moved to the UFC stat area, left pad with 0s.

New rule for SHR-ACORD only: 
DECODE(TRUE
                      ,SRC_SYS_CD='SHR-ACORD', '00000'
                      ,ISNULL(in_NO_OF_EMPLOYEES),'00000'
                      ,LPAD(TO_CHAR(in_NO_OF_EMPLOYEES),5,'0')
                      )","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",AFG.mySurety_Intg 7: Default NO_OF_EMPLOYEES to 5 for coverage ERISA,2/25/2019,amiller6,"July 2018: Updated to populate Number of Employees with Number of ATM's when applicable as part of ISO Crime changes requested by PDC


2/24/14: S. Conley: Cvrg level fields. EDW Source:
vw_cvrg_hist.foreign_rateable_employee_cnt
vw_cvrg_hist.domestic_rateable_employee_cnt

2/25/2019: A. Miller added rule for SHR-ACORD source system to default Number of employees. ",,,,,,,,,
BR-22038,113 Number of Premises,"(FOREIGN_LOCATION_CNT + DOMESTIC_LOCATION_CNT) = no_of_premises 

If no_of_premises >= 1000 
No_of_premises = 999
Else
No_of_premises","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,3/24/2014,mmconley,"3/25/14: S. Conley: Cvrg level fields. EDW Source:
vw_cvrg_hist.foreign_location_cnt
vw_cvrg_hist.domestic_location_cnt",,,,,,,,,
BR-22041,114 Total Number of Employees,"Foreign_employee_cnt + domestic_employee_cnt

Rule for SHR-ACORD source system only: 
DECODE(TRUE
                      ,SRC_SYS_CD='SHR-ACORD', '00001'
                      ,ISNULL(in_TOTAL_NO_OF_EMPLOYEES),'00000'
                      ,LPAD(TO_CHAR(in_TOTAL_NO_OF_EMPLOYEES),5,'0')
                      )

","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,2/25/2019,amiller6,"2/24/14 S. Conley:  Policy level fields. EDW Source:
vw_pol_term_hist.foreign_employee_cnt
vw_pol_term_hist.domestic_employee_cnt

2/25/2019: A. Miller added rule for SHR-ACORD source system to default Total_no_of_employees",,,,,,,,,
BR-22040,115 Rate Group,,"ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses
ETL - D_Stat_Property_Losses
",,5/23/2013,moreilly,,,,,,,,,,
BR-22616,115.1 UFC Rate Group - Premiums and Losses,"IF SUBLINE_CD = ‘965’
  IF crime_form  in (120, 121, 125, 126, 130,131, 132, 148, 149, 150, 151, 152, 153, 154, 156)
    Then  RATE_GROUP = ‘23’
    ELSE
         RATE_GROUP = ‘  ‘ (2 spaces)
    End-If
 ELSE
     RATE_GROUP = ‘  ‘ (2 spaces)
 End-If
","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,1/6/2017,dzieverink,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-22614,115.2 UPR Rate Group - Premiums and Losses,"When SUBLINE_CD in (‘035’,’037’,’039’,’045’,’067’,’069’,’070’,’083’,’086’,’088’);
Stat Area COVERAGE_CODE in ('1', ‘3');
VW_RISK_PERSONAL_PROPERTY. OCCUPANCY_GROUP_MDM_CD is NOT NULL;
  Set RATE_GROUP based on VW_RISK_PERSONAL_PROPERTY.            OCCUPANCY_GROUP_MDM_CD 
OCCUPANCY_GROUP_MDM_CD                                 		RATE_GROUP
APARTMENT                                					A
CONTRACTOR							B
INDUSTRIAL							C
INSTITUTAL						                D
MERCANTILE							E
MOTEL								F
OFFICE								G
SERVICE							H

  EXIT 

When SUBLINE_CD in (‘116’,’136’,’156’,’176’,’196’);
  Set RATE_GROUP = ‘9’;
  EXIT

Set RATE_GROUP = ‘ ‘ (space);
  EXIT","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses
","dzieverink 1/6/17: Added Personal Prop Occ Group Catg logic based on Rick's stat area doc for ISO Property (QC DP-1172 & DP-1129)

sconley 2/17/17: Revised rules to check if OCCUPANCY_GROUP_MDM_CD is NULL.
JIRA Stories DP-7797 & DP-7887, ENTERPRISE.Data_Platform Defect 1422",2/16/2017,mmconley,"sconley 5/4/16: Reformatted BR Description
sconley 5/9/16: Add Premiums to the BR Description

sconley 2/16/17: Added check for if Occupancy Group Category is NULL.  If it is NULL we want the code to drop down to the original rules.
The Rate Group is derived and stored in variable var_OCCUPANCY_GROUP_MDM_CD in Informatica so if the MDM CDs is not populated or is not listed in the rule, the variable will be NULL.",,,,,,,,,
BR-22042,116 Type Of  Policy - UFC,"For premiums
If SRC_SYS_CD = 'ELD_PAS'  
    Then Type_of_Policy = ‘02’
Else 
(losses start here)
If SUBLINE_CD = ‘965’(ISO Buglary& Theft)
    Then Type_of_Policy = ‘10’
Else
  If rate_class_cd between 700 and 799 
    or rate_class_cd in (815, 851, 852, 853, 854, 871) 
       then Type_of_policy = '09'
Else   
  If rate_class_cd between 960 and 979
       Then Type_of_policy = '01'
Else 
   If PARENT_BUSN_CVRG_CD = ‘SAA’
       Then Type_of_policy = '02'
Else  Type_of_policy = '01'

Else
IIF(SRC_SYS_CD='SHR-ACORD','09',
      IIF(SUBLINE_CD='965','10',
             IIF(RATE_CLASS_CD>='700' AND RATE_CLASS_CD<='799' or IN(RATE_CLASS_CD,'815','851','852','853','854','871'),'09',
                   IIF(RATE_CLASS_CD>='960' and RATE_CLASS_CD<='979','01',
                          IIF(PARENT_BUSN_CVRG_CD='SAA','02','01')
                   )

","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,2/25/2019,amiller6,"ELD does not have losses

2/25/2019: A. Miller - Updated business rule for 'SHR-ACORD' ",,,,,,,,,
BR-23257,"117 Type of Policy - UWC	","if class code = 9823 or 9827 or 
WC = Standard workers compensation policy
AL = Alternative workers compensation coverage
GP = Group policy
EX = Excess workers compensation policy
NS = Non-standard workers compensation coverage
EL = Employers liability policy
ML = Massachusetts Large Risk rating option 
SF = Self insured in conjunction with a self insured group","ETL - D_Stat_Work_Comp_Premiums
ETL - D_Stat_Work_Comp_Losses
",,7/15/2014,lkummer,,,,,,,,,,
BR-22043,118 Zip Codes - STAT Area Only,"
","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses
ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,7/23/2014,dburns4,We do not store the non US zip codes in the stat area because we would of had to increase the size of the field and we can get this information from d_place using the postal_cd.,,,,,,,,,
BR-23161,"118.1 UPR Zip Codes - Premiums and Losses	","When FIPS_US_ALPHA_CD in (‘AB’, ‘AS’, ‘BC’, ‘FM‘, ‘GU’, ‘MB’, ‘MH’, ‘MP’, ‘NB’, ‘NL’, ‘NS’, ‘NT‘, ‘NU’, ‘ON’, ‘PE’, ‘PW’, ‘QC’, ‘SK’, ‘UM’, ’VI’, ‘YT’);
When PLACE_COUNTRY.COUNTRY_NAME <> ‘United States’
 Set ZIP_CODE = ‘00000‘;
    EXIT
If POSTAL_CD is NULL;
    Set ZIP_CODE = ‘00000‘;
    EXIT

 Set ZIP_CODE = POSTAL_CD;","ETL - D_Stat_Property_Premiums
ETL  D_Stat_Property_Losses","PIM 13765: Added rule to match Infomatica code 
Defect 6293-changes for foreign address to determine zip code - stat area only for Premiums & Losses",5/3/2016,mmconley,"1/23/14 sconley: Added rule to match Infomatica code determined during investigation of PIM 13765.  Per Kevin, at this time this is executed independently for each stat area ETL except UGL.
7/23/14 dburns - Updated rule for zip code in stat area to check country name not equal United Stated for foreign addresses instead of FIPS_US_ALPHA_CD for Canadian provinces.
7/23/14 dburns - While doing the change for defect 6293, Kevin Nienaber updated the code for UPR so that  both  the Premiums and Losses stat area ETLs execute the same code(as was done earlier for UGL)  so combined in to one rule.

",,,,,,,,,
BR-23164,118.2 UPR Zip Codes - Losses,"
When FIPS_US_ALPHA_CD in (‘AB’, ‘AS’, ‘BC’, ‘FM‘, ‘GU’, ‘MB’, ‘MH’, ‘MP’, ‘NB’, ‘NL’, ‘NS’, ‘NT‘, ‘NU’, ‘ON’, ‘PE’, ‘PW’, ‘QC’, ‘SK’, ‘UM’, ’VI’, ‘YT’);
Set ZIP_CODE = ‘00000‘;
    EXIT
If POSTAL_CD is NULL;
    Set ZIP_CODE = ‘00000‘;
    EXIT
 Set ZIP_CODE = POSTAL_CD;",,,7/23/2014,dburns4,"7/23/14 - combined premiums and losses in to one rule since ETLs execute the same code after defect 6293.
",,,,,,,,,
BR-23162,118.3 UIM Zip Codes - Premiums and Losses,"
When FIPS_US_ALPHA_CD in (‘AB’, ‘AS’, ‘BC’, ‘FM‘, ‘GU’, ‘MB’, ‘MH’, ‘MP’, ‘NB’, ‘NL’, ‘NS’, ‘NT‘, ‘NU’, ‘ON’, ‘PE’, ‘PW’, ‘QC’, ‘SK’, ‘UM’, ’VI’, ‘YT’);
When PLACE_COUNTRY.COUNTRY_NAME <> ‘United States’
    Set ZIP_CODE = ‘00000‘;
    EXIT

If POSTAL_CD is NULL;
    Set ZIP_CODE = ‘00000‘;
    EXIT

 Set ZIP_CODE = POSTAL_CD;","ETL - D_Stat_Inland_Marine_Premiums
ETL -
D_Stat_Inland_Marine_Losses	","PIM 13765: Added rule to match Infomatica code
Defect 6293-changes for foreign address to determine zip code - stat area only",7/13/2017,mmconley,"1/23/14 sconley: Added rule to match Infomatica code determined during investigation of PIM 13765.  Per Kevin, at this time this is executed independently for each stat area ETL except UGL.
7/23/14 dburns - Updated rule for zip code in stat area to check country name not equal United Stated for foreign addresses instead of FIPS_US_ALPHA_CD for Canadian provinces.
7/23/14 dburns - While doing the change for defect 6293, Kevin Nienaber updated the code for UIM so that  both  the Premiums and Losses stat area ETLs execute the same code(as was done earlier for UGL)  so combined in to one rule.
",,,,,,,,,
BR-22572,118.4 UIM Zip Codes - Losses,"When FIPS_US_ALPHA_CD in (‘AB’, ‘AS’, ‘BC’, ‘FM‘, ‘GU’, ‘MB’, ‘MH’, ‘MP’, ‘NB’, ‘NL’, ‘NS’, ‘NT‘, ‘NU’, ‘ON’, ‘PE’, ‘PW’, ‘QC’, ‘SK’, ‘UM’, ’VI’, ‘YT’);
Set ZIP_CODE = ‘00000‘;
    EXIT
If POSTAL_CD is NULL;
    Set ZIP_CODE = ‘00000‘;
    EXIT
 Set ZIP_CODE = POSTAL_CD;","

",,7/23/2014,dburns4,"7/23/14 - combined premiums and losses in to one rule since ETLs execute the same code after defect 6293.
",,,,,,,,,
BR-22541,"118.5 UGL Zip Codes - Premiums and Losses

When building the UGL STAT Area:

In order to support Canadian business for Specialty E&S and Great American Customs , we must default the zip code to a valid zip code. Utilizing Country Name and Policy Symbol.  Set the zip code as follows: the valid  policy symbol are (XS, UM, AL, BTA, PL, STA, TPA).  

For ELD, when the address is a Canadian address, default the zip code to 60173.  This is the zip code for  Schaumburg, IL where ELD is located.

When a Candian address is received from any other LOB (other than Specialty E&S, Great American Customs or ELD), then default the zip code to zeros.

When an address is in the United States, use the zip code associated to the risk location for the associated financial transaction.","When SRC_SYS_CD = 'ELD_PAS';
COUNTRY_NM <> 'United States';
    Set ZIP_CODE = ‘60173’;
    EXIT

When SRC_SYS_CD = 'MAL-PAS';
COUNTRY_NM <> 'United States';
     Set ZIP_CODE = '10170'
     EXIT

When SRC_SYS_CD in ('SES-PAS','GAC-PAS');
COUNTRY_NM <> 'United States';
    Set ZIP_CODE = ‘45202’;
    EXIT

When FIPS_US_ALPHA_CD in (‘AB’, ‘AS’, ‘BC’, ‘FM‘, ‘GU’, ‘MB’, ‘MH’, ‘MP’, ‘NB’, ‘NL’, ‘NS’, ‘NT‘, ‘NU’, ‘ON’, ‘PE’, ‘PW’, ‘QC’, ‘SK’, ‘UM’, ’VI’, ‘YT’);
When PLACE_COUNTRY.COUNTRY_NAME <> ‘United States’
Or POSTAL_CD is NULL;
    Set ZIP_CODE = ‘00000‘;
    EXIT

Set ZIP_CODE = POSTAL_CD;

","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
","PIM 13765: Updated rule to match Infomatica code
Defect 6293-changes for foreign address to determine zip code - stat area only",5/19/2016,dzieverink,"1/28/14 sconley:  Updated rule to match Informatica code determined during investigation of PIM 13765.  Per Kevin, both UGL Premiums and Losses stat area ETLs execute the same code.
7/22/14 dburns - Updated rule for zip code in stat area to check country name not equal United Stated for foreign addresses.

dzieverink 5/19/16: 
Defect DP 37 May 2016:
Added logic for MAL-PAS
",,,,,,,,,
BR-22543,118.6 UFC Zip Codes - Premiums and Losses,"When FIPS_US_ALPHA_CD in (‘AB’, ‘AS’, ‘BC’, ‘FM‘, ‘GU’, ‘MB’, ‘MH’, ‘MP’, ‘NB’, ‘NL’, ‘NS’, ‘NT‘, ‘NU’, ‘ON’, ‘PE’, ‘PW’, ‘QC’, ‘SK’, ‘UM’, ’VI’, ‘YT’);
When PLACE_COUNTRY.COUNTRY_NAME <> ‘United States’
    Set ZIP_CODE = ‘00000‘;
    EXIT

If POSTAL_CD is NULL;
    Set ZIP_CODE = ‘00000‘;
    EXIT

 Set ZIP_CODE = POSTAL_CD;","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL -
D_Stat_Crm_Fdlty_Srty_Losses","PIM 13765: Updated rule to match Infomatica code
Defect 6293-changes for foreign address to determine zip code - stat area only",7/23/2014,dburns4,"1/23/14 sconley: Updated rule to match Infomatica code determined during investigation of PIM 13765.  Per Kevin, at this time this is executed independently for each stat area ETL except UGL.
7/23/14 dburns - Updated rule for zip code in stat area to check country name not equal United Stated for foreign addresses instead of FIPS_US_ALPHA_CD for Canadian provinces.
7/23/14 dburns - While doing the change for defect 6293, Kevin Nienaber updated the code for UFC so that  both  the Premiums and Losses stat area ETLs execute the same code(as was done earlier for UGL)  so combined in to one rule.
",,,,,,,,,
BR-23165,"118.7 UFC Zip Codes - Losses	","When FIPS_US_ALPHA_CD in (‘AB’, ‘AS’, ‘BC’, ‘FM‘, ‘GU’, ‘MB’, ‘MH’, ‘MP’, When FIPS_US_ALPHA_CD in (‘AB’, ‘AS’, ‘BC’, ‘FM‘, ‘GU’, ‘MB’, ‘MH’, ‘MP’, ‘NB’, ‘NL’, ‘NS’, ‘NT‘, ‘NU’, ‘ON’, ‘PE’, ‘PW’, ‘QC’, ‘SK’, ‘UM’, ’VI’, ‘YT’);
Set ZIP_CODE = ‘00000‘;
    EXIT
If POSTAL_CD is NULL;
    Set ZIP_CODE = ‘00000‘;
    EXIT
 Set ZIP_CODE = POSTAL_CD;",,,7/23/2014,dburns4,"7/23/14 - combined premiums and losses in to one rule since ETLs execute the same code after defect 6293.
",,,,,,,,,
BR-23163,118.8 UCA Zip Codes - Premiums and Losses,"When FIPS_US_ALPHA_CD in (‘AB’, ‘AS’, ‘BC’, ‘FM‘, ‘GU’, ‘MB’, ‘MH’, ‘MP’, ‘NB’, ‘NL’, ‘NS’, ‘NT‘, ‘NU’, ‘ON’, ‘PE’, ‘PW’, ‘QC’, ‘SK’, ‘UM’, ’VI’, ‘YT’);
When PLACE_COUNTRY.COUNTRY_NAME <> ‘United States’
    Set ZIP_CODE = ‘00000‘;
    EXIT

If POSTAL_CD is NULL;
    Set ZIP_CODE = ‘00000‘;
    EXIT

 Set ZIP_CODE = POSTAL_CD;","ETL - D_Stat_Auto_Premiums
ERL - D_Stat_Auto_Losses","PIM 13765: Updated rule to match Infomatica code
Defect 6293-changes for foreign address to determine zip code - stat area only",7/23/2014,dburns4,"1/23/14 sconley: Split rule 'UCA Zip Codes - Premiums and Losses' into 2 rules.  Updated premiums rule to match Infomatica code determined during investigation of PIM 13765.   Updated losses rule to match Infomatica code determined during investigation of PIM 13765. Per Kevin, at this time this is executed independently for each stat area ETL except UGL.
7/23/14 dburns - Updated rule for zip code in stat area to check country name not equal United Stated for foreign addresses instead of FIPS_US_ALPHA_CD for Canadian provinces.
7/23/14 dburns - While doing the change for defect 6293, Kevin Nienaber updated the code for UCA so that  both  the Premiums and Losses stat area ETLs execute the same code(as was done earlier for UGL) so combined in to one rule.
",,,,,,,,,
BR-22649,118.9 UCA Zip Codes -  Losses,"When FIPS_US_ALPHA_CD in (‘AB’, ‘AS’, ‘BC’, ‘FM‘, ‘GU’, ‘MB’, ‘MH’, ‘MP’, ‘NB’, ‘NL’, ‘NS’, ‘NT‘, ‘NU’, ‘ON’, ‘PE’, ‘PW’, ‘QC’, ‘SK’, ‘UM’, ’VI’, ‘YT’);
Set ZIP_CODE = ‘00000‘;
    EXIT
If POSTAL_CD is NULL;
    Set ZIP_CODE = ‘00000‘;
    EXIT
 Set ZIP_CODE = POSTAL_CD;","
",,7/23/2014,dburns4,"7/23/14 - combined premiums and losses in to one rule since ETLs execute the same code after defect 6293.

",,,,,,,,,
BR-21934,119 Exposure Indicator,,"ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Property_Losses",,5/23/2013,moreilly,,,,,,,,,,
BR-22621,"119.1 UGL Exposure Indicator - Premiums and Losses

When Building the UGL Stat Area set the Exposure Indicator using the Actual Exposure Indicator from the source system. 

When the source system does not send the Actual Exposure Indicator, set the Exposure Indicator to False (0).","IF ACTUAL_EXPOSURE_INDICATOR is not null   
Then 
         EXPOSURE_INDICATOR =  ACTUAL_EXPOSURE_INDICATOR
Else
          EXPOSURE_INDICATOR = ‘0’
End-If","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",Defect 6572 - default not set for exposure indicator in non-PROD environments,7/23/2014,dburns4,"7/23/14-via defect 6572, ETL process updated in non-PROD environments to set default of '0' during May 2014.  PRODUCTION environment was setting the default to '0' per the requirements.",,,,,,,,,
BR-22620,119.2 UPR Exposure Indicator - Premiums and Losses,"If SUBLINE = ‘930’
  Then EXPOSURE_IND = 1
  Else EXPOSURE_IND = ‘ ’
End-If","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses",,7/27/2017,mmconley,sconley 7/27/17: Added ETL Spec Cross Ref D_Stat_Property_Premiums,,,,,,,,,
BR-21935,120 Risk Indicator,,"ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses",,5/2/2013,moreilly,,,,,,,,,,
BR-22586,120.1 UPR Risk Indicator - Losses (Obsolete),"Obsolete: See 120.3 UPR Risk Indicator – Premiums and Losses (BR-22555)

If CVRG_CD IN (‘EQKA’, ‘FPGEQK’) & SAFEGUARD_CD = ‘SPRINKLER’ 
   then RISK_IND = 1 
Else
   If SUBLINE = ‘930’
     Then RISK_IND = 2
Else RISK_IND = ‘ ’  (space)",ETL - D_Stat_Property_Losses,,7/25/2017,mmconley,sconley 7/27/17: Added Obsolete to the description,,,,,,,,,
BR-22556,"120.2 UGL Risk Indicator - Premiums and Losses

When Building the UGL Stat Area, set the Risk Indicator based on subline.

Default Risk Indicator to False (0).

When the subline is equal to 365, set the Ris Indicator to True (1) on premium side.  When subline is equal to 317 or 365 set Risk Indicator to True (1) on loss side.
Premium Side: If subline is equal to 365 and it’s one of the 8 Product Recall coverage codes, set the Risk Indicator to 7; else if subline is equal to 365 set Risk Indicator to 1.
Loss Side:  If subline is equal to 365 and it’s one of the 8 Product Recall coverage codes, set the Risk Indicator to 7; else if subline is equal to  317 or 365 set Risk Indicator to 1. Premium Side: If subline is equal to

Updated Rule (for both Premium and Loss):

If Subline = 365 check for Specialty E&S product recall coverage codes or TERROR and set to 7.
If Subline = 365 check for Agri product recall (withdrawal) coverage code and set to 8.
Otherwise, set to zero.

NOTE:  A late change was made for the subline_cd value for the Product Recall excess products for Specialty E & S.  The Excess products (coverage codes are EXCNMPDRC,  EXCNMDRC,  EXCMPTPTRC, EXRSTRTRC) will have subline_cd = 325 now instead of 365.  TERROR for policy symbol PRX (excess) will have subline_cd = 325.  The policy symbol PRC and coverage codes (CNSMPRDRC, CNSMGDRC, CMPTPTRC, RSTRTRC, TERROR) will continue to be subline_cd = 365.

We are not updating the code at this time to remove the Excess coverage codes EXCNMPDRC,  EXCNMDRC,  EXCMPTPTRC, EXRSTRTRC since they will never have subline_cd = 365 now and so the logic will fail the first check of subline_cd = 365 and the logic will fall through and risk_indicator = 0 for the Excess coverage code which is what is wanted.




","PREMIUM:
If  SUBLINE_CD =’365’ 
  Then RISK_IND = ‘1’ 
Else  RISK_IND =  ‘0’
End-if

LOSS:
If  SUBLINE_CD = '317' or SUBLINE_CD =’365’ 
  Then RISK_IND = ‘1’ 
Else  RISK_IND =  ‘0’
End-if

Updated rule:
PREMIUM:
If (SUBLINE_CD = 365 and coverage code in (CNSMPRDRC, CNSMGDRC, CMPTPTRC, RSTRTRC, EXCNMPDRC, EXCNMDRC, EXCMPTPTRC, EXRSTRTRC))
                 Then RISK_INDICATOR = '7'
            Else
                  If  SUBLINE_CD =365 
                               Then RISK_INDICATOR = '1' 
       Else
               RISK_INDICATOR =  '0'.


LOSS:
If (SUBLINE_CD = 365 and coverage code in (CNSMPRDRC, CNSMGDRC, CMPTPTRC, RSTRTRC, EXCNMPDRC, EXCNMDRC, EXCMPTPTRC, EXRSTRTRC))
                 Then RISK_INDICATOR = '7'
            Else
                  If  SUBLINE_CD in ('317' or '365') 
                               Then RISK_INDICATOR = '1' 
       Else
               RISK_INDICATOR =  '0'

Updated Rule (for both Premium and Loss): (NOTE comment in Business Rule Description and Comment columns regarding Specialty E & S excess coverages):


If subline_cd = 365 
If coverage code in (CNSMPRDRC, CNSMGDRC, CMPTPTRC, RSTRTRC, EXCNMPDRC,  EXCNMDRC,  EXCMPTPTRC, EXRSTRTRC, TERROR) 
                Risk_Indicator =  7 
     Else 
           If coverage code =  LTDPRODWD 
                        Risk_Indicator =  8 
           Else 
                  Risk_indicator = 0 
Else 
        Risk_Indicator = 0 






","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",Defect 10234 - RISK_IND for Product Recall Projects for Specialty E & S and Agri.  (See comments for additional changes done late in UAT testing.),1/18/2018,bkirkpatrick,"3/25/16 - Checked with Kevin to see what the current code was and found that business rule did not reflect current code.  Business rule indicated that for both Premium and Loss side the code was the same but it was not.  I updated business rule to reflect that the Loss side checked if subline code was 317 or 365 set risk indicator to 1.

3/25/16 - Updated business rule to add additional logic for Product Recall Project where for subline = 365 and if Product Recall (identified as Product Recall by one of 8 new coverage codes) set Risk Indicator to 7.  The rest of the business rule did not change.

3/30/16 - PDC requested a change in requirements for setting of risk indicator to modify how to set risk indicator for Specialy E & S product recall and then added in check for Agri product recall coverage code.
Now If Subline = 365 check for Specialty E&S product recall coverage codes or TERROR and set to 7.
If Subline = 365 check for Agri product recall (withdrawal) coverage code and set to 8.
Otherwise, set to zero.

05/03/16 - Updating comments on Defect 10234 since a late change was made for the subline_cd value for the Product Recall excess products for Specialty E & S.  The Excess products (coverage codes are EXCNMPDRC,  EXCNMDRC,  EXCMPTPTRC, EXRSTRTRC) will have subline_cd = 325 now instead of 365.  TERROR for policy symbol PRX (excess) will have subline_cd = 325.  The policy symbol PRC and coverage codes (CNSMPRDRC, CNSMGDRC, CMPTPTRC, RSTRTRC, TERROR) will continue to be subline_cd = 365.

We are not updating the code at this time to remove the Excess coverage codes EXCNMPDRC,  EXCNMDRC,  EXCMPTPTRC, EXRSTRTRC since they will never have subline_cd = 365 now and so the logic will fail the first check of subline_cd = 365 and the logic will fall through and risk_indicator = 0 for the Excess coverage code which is what is wanted.


",,,,,,,,,
BR-22555,120.3 UPR Risk Indicator - Premiums and Losses,"RISK_INDICATOR only applies to Earthquake (subline 930). 
Sources are vw_cvrg_hist.blanket_coverage_ind (only populated by ISO Property) and vw_risk_structure_safeguard.safeguard_cd.

/* The RISK_CATG_CD for Builders Risk Earthquake is ‘COVPROP’ which is for UDPIM & BRIDGE-PAS */
When SUBLINE_CD = ‘930’ 
SRC_SYS_CD in ('UDPIM','BRIDGE-PAS')
RISK_CATG_CD = 'COVPROP'
  EXIT

When SUBLINE_CD = ‘930’ 
BLANKET_COVERAGE_IND is NULL
SAFEGUARD_CD = 'SPRINKLER'
  Set RISK_INDICATOR = '1'
  EXIT

When SUBLINE_CD = ‘930’ 
BLANKET_COVERAGE_IND is NULL
SAFEGUARD_CD is NULL OR SAFEGUARD_CD <> 'SPRINKLER'
  Set RISK_INDICATOR = '2'
  EXIT

When SUBLINE_CD = ‘930’ 
BLANKET_COVERAGE_IND = '1'
SAFEGUARD_CD = 'SPRINKLER'
  Set RISK_INDICATOR = '3'
  EXIT

When SUBLINE_CD = ‘930’ 
BLANKET_COVERAGE_IND = '1'
SAFEGUARD_CD is NULL OR SAFEGUARD_CD <> 'SPRINKLER'
  Set RISK_INDICATOR = '4'
  EXIT

Set RISK_INDICATOR = ‘ ’
(default)

Comments:
---------------
ISO Property & DIC
See BR-23466 for additional information.
-The physical building attributes (fields) are on risk BLDG.
- PERSPROP, TIMELEMENT, & IMPROVMNTS are children of BLDG and the physical building attributes are not populated.
-Determine parent BLDG risk of PERSPROP, TIMELEMENT, & IMPROVMNTS risks.
-Select vw_risk_structure_safeguard fields from parent BLDG in order to set risk_indicator for PERSPROP, TIMELEMENT, & IMPROVMNTS.
- For BLDG, select vw_risk_structure_safeguard fields from BLDG in order to set risk_indicator.
","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses
","dzieverink 1/6/17: Added blanket indication logic per Rick's stat area doc for ISO Property (QC DP 1172)

sconley 3/15/17: ENTERPRISE.Data_Platform 1551 UPR Stat Area Fixes for RISK_INDICATOR and WIND_CATASTROPHE_IND for ISO Property (JIRA DP-8424)
sconley 4/4/17: Updated rule to add in additional check for if SAFEGUARD_CD is NULL.  It is on same defect 1551.

sconley 7/12/17: ENTERPRISE.Data_Platform Defect 2101 UPR CO_INSURANCE_IND, RISK_INDICATOR  SPRINKLER_ID, TYPE_OF_COVERAGE: New Requirements; US17230

sconley 7/26/17: ENTERPRISE.Data_Platform 2101  Revise rules for Builders Risk since DIC src_sys_cd is also 'UDPIM'; Rally US12922
",7/26/2017,mmconley,"sconley 3/15/17: Fixed rules.  
-RISK_INDICATOR only applies to Earthquake (subline 930). 
-Sources are vw_cvrg_hist.blanket_coverage_ind (only populated by ISO Property) and vw_risk_structure_safeguard.safeguard_cd.
-Combined premiums and losses into 1 rule. They were not executing same rules. 
-Added specific rule for UDPIM and BRIDGE-PAS.

sconley 6/27/17:  Prathima needed to add edw_trans_id to join to vw_cvrg_hist for RISK_INDICATOR. Story US15622. Defect ENTERPRISE.Data_Platform 1981.

sconley 7/12/17: Added comments to rule with requirements for ISO Property & DIC; QC 2101, US17230

sconley 7/26/17: Revise rules for Builders Risk since DIC src_sys_cd is also 'UDPIM'. For DIC we were hitting UDPIM rules set-up for Builders Risk.  Rally US12922; Defect 2101.
",,,,,,,,,
BR-21936,121 State Exception Indicator,,"ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Property_Losses
ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
",,7/19/2013,moreilly,,,,,,,,,,
BR-22673,121.1 UCA State Exception Indicator - Premiums and Losses,"If Stat_Format_Code = 'UCA'
IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'StateException' AND EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
THEN Set STATE_EXCEPTION_CD = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
Else
If FIPS_US_ALPHA_ST = ‘VA’
   If CVRG_CD = ‘MEPAY’
     Then STATE_EXCEPTION_IND = 2
   Else If CVRG_CD = ‘INCOMELOSS’
      Then STATE_EXCEPTION_IND = 3
     Else STATE_EXCEPT_IND = ‘0’
Else 
If FIPS_US_ALPHA_ST = ‘NJ’
  And VEHICLE_CATEGORY_CD in (‘P’)
  And SPECIAL_USE_CATG_CD in (‘0’, ‘AN’)
  If CVRG_CD = ‘COLL’
   If QUALIFYING_SAFETY_FEATURE_NO = 1 
       Then STATE_EXCEPTION_IND = 1
    Else if QUALIFYING_SAFETY_FEATURE_NO = 2
       Then STATE_EXCEPTION_IND = 2
    Else if QUALIFYING_SAFETY_FEATURE_NO >= 3
       Then STATE_EXCEPTION_IND = 3
    Else if QUALIFYING_SAFETY_FEATURE_NO is null 
       Then STATE_EXCEPTION_IND = 9
Else
If FIPS_US_ALPHA_ST = ‘NY’
   and CVRG_CD = ‘OBEL’
   and RATE_CLASS_CD in (‘9502’,’9503’,’9504’,’9505’,’9506’,’9507’,’9508’,’9509’)  
    Then STATE_EXCEPTION_IND = ‘ ‘
Else
If FIPS_US_ALPHA_ST = ‘KY’
   and CVRG_CD = ‘GEPIP’
    Then STATE_EXCEPTION_IND = ‘ ‘
If FIPS_US_ALPHA_ST = ‘NV’
    And SUBLINE_CD IN (‘620’, ‘621’, ‘622’,’623’)
    And VEHICLE_CATEGORY_CD in (‘P’)
        If VEHIC_PASSIVE_RESTRAINT_CD = ‘NVCODE1’ 
             then STATE_EXCEPTION_IND = 1
        else If VEHIC_PASSIVE_RESTRAINT_CD = ‘NVCODE2’ 
             then STATE_EXCEPTION_IND = 2
        else If VEHIC_PASSIVE_RESTRAINT_CD = ‘NVCODE3’ 
             then STATE_EXCEPTION_IND = 3
        else If VEHIC_PASSIVE_RESTRAINT_CD = ‘NVCODE4’ 
             then STATE_EXCEPTION_IND = 4
        else If VEHIC_PASSIVE_RESTRAINT_CD = ‘NVCODE8’ 
             then STATE_EXCEPTION_IND = 8
        else If VEHIC_PASSIVE_RESTRAINT_CD = '0' or null 
             then STATE_EXCEPTION_IND = 9
  else STATE_EXCEPTION_IND = ' '
If FIPS_US_ALPHA_ST = ‘ND’
    And SUBLINE_CD IN (‘611’, ‘620’, ‘621’, ‘622’,’623’)
       If GROSS_VEHICLE_WEIGHT_NO <=6500 
then STATE_EXCEPTION_IND = 1
     Else if GROSS_VEHICLE_WEIGHT_NO > 6500 
then STATE_EXCEPTION_IND = 2
     else STATE_EXCEPTION_IND = 1
 else STATE_EXCEPTION_IND = ‘ ‘
Else 
  Select STATE_EXCEPT_CD 
   From LK_STATE_EXCEPT_AUTO 
  Where lk.SUBLINE_CD = SUBLINE_CD 
   And lk.RISK_STATE = FIPS_US_ALPHA_ST
   And lk.TORT_PERCENT_CD = TORT_PERCENT_CD
   And lk.UM_ATFAULT_LIAB_LI_CD = UM_ATFAULT_LIAB_LI_CD
   And lk.DEFENSIVE_DRIVER_CREDIT_IND = DEFENSIVE_DRIVER_CREDIT_IND
   And lk.WORK_LOSS_COORD_IND = WORK_LOSS_COORD_IND
   And lk.WAIVE_PIP_BENEFIT_IND = WAIVE_PIP_BENEFIT_IND
   And lk.NY_SUPPL_SPOUSAL_IND = ELIMINATE_SPOUSAL_IND
   And lk.LIMIT_NON_ECONOMIC_LOSS_IND = LIMIT_NON_ECONOMIC_LOSS_IND
  If not null
    then
    STATE_EXCEPT_IND = lk.STATE_EXCEPT_CD
   Else STATE_EXCEPT_IND = ‘0’
Else 
 Select STATE_EXCEPT_CD 
 From LK_STATE_EXCEPT_AUTO
 Where lk.SUBLINE_CD = SUBLINE_CD 
  And lk.RISK_STATE = FIPS_US_ALPHA_ST
  And lk.TORT_PERCENT_CD = TORT_PERCENT_CD
  And lk.UM_ATFAULT_LIAB_LI_CD = UM_ATFAULT_LIAB_LI_CD
  And lk.DEFENSIVE_DRIVER_CREDIT_IND = DEFENSIVE_DRIVER_CREDIT_IND
  And lk.WORK_LOSS_COORD_IND = WORK_LOSS_COORD_IND
  And lk.WAIVE_PIP_BENEFIT_IND = WAIVE_PIP_BENEFIT_IND
  And lk.NY_SUPPL_SPOUSAL_IND = ELIMINATE_SPOUSAL_IND
  And lk.LIMIT_NON_ECONOMIC_LOSS_IND = LIMIT_NON_ECONOMIC_LOSS_IND
If not null
    then
    STATE_EXCEPT_IND = lk.STATE_EXCEPT_CD 
Else 
If (FIPS_US_ALPHA_ST in (‘KY’, ‘MO’)
         And SUBLINE_CD = ‘621’)
  OR (If FIPS_US_ALPHA_ST in (‘AL’)
         And SUBLINE_CD = ‘623’)
Then 
  Select STATE_EXCEPT_CD 
   From LK_STATE_EXCEPT_VEH_COUNT
   Where lk.SUBLINE_CD = SUBLINE_CD 
    And lk.RISK_STATE = FIPS_US_ALPHA_ST
    And lk.UM_STACKING_IND = INDIVIDUALLY_OWNED_IND
    And lk.UIM_STACKING_CD = UIM_STACKING_IND
    And lk.ADPIP_EXISTS_IND = ADPIP_EXISTS_IND 
    And (lk.VEHICLE_MIN_COUNT <= VEHICLE_COUNT <= lk.VEHICLE_MAX_COUNT)
   If not null
      then
      STATE_EXCEPT_IND = lk.STATE_EXCEPT_CD 
If FIPS_US_ALPHA_ST in (‘MN’)
  And SUBLINE_CD = ‘615’
   Then 
  Select STATE_EXCEPT_CD 
   From LK_STATE_EXCEPT_VEH_COUNT
   Where lk.SUBLINE_CD = SUBLINE_CD 
    And lk.RISK_STATE = FIPS_US_ALPHA_ST
    And lk.UM_STACKING_IND = PIP_STACKING_IND
    And lk.UIM_STACKING_CD = UIM_STACKING_IND
    And lk.ADPIP_EXISTS_IND = ADPIP_EXISTS_IND 
    And (lk.VEHICLE_MIN_COUNT <= VEHICLE_COUNT <= lk.VEHICLE_MAX_COUNT)
   If not null
      then
      STATE_EXCEPT_IND = lk.STATE_EXCEPT_CD 
Else 
Select STATE_EXCEPT_CD 
 From LK_STATE_EXCEPT_VEH_COUNT
 Where lk.SUBLINE_CD = SUBLINE_CD 
  And lk.RISK_STATE = FIPS_US_ALPHA_ST
  And lk.UM_STACKING_IND = UM_STACKING_IND
  And lk.UIM_STACKING_CD = UIM_STACKING_IND
  And lk.ADPIP_EXISTS_IND = ADPIP_EXISTS_IND 
  And (lk.VEHICLE_MIN_COUNT <= VEHICLE_COUNT <= lk.VEHICLE_MAX_COUNT)
 If not null
    then
    STATE_EXCEPT_IND = lk.STATE_EXCEPT_CD 
Else STATE_EXCEPT_IND = ‘0’
END","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,10/31/2018,ragarwal,"sconley 5/4/16: Reformatted BR Description

ragarwal 10/23/18: Added logic to pass through data, if available,  from EDW.PRC_RATING_EXTENSIONS ",,,,,,,,,
BR-22598,121.2 UPR State Exception Indicator - Premiums and Losses,"/* See comments for more details */
When FIPS_US_ALPHA_CD = ‘HI’
SUBLINE_CODE = ‘027’
CVRG_CD ‘HURREXCL’ exists for the risk
'HURREXCL' VW_CVRG_HIST.ACTION_CD in ('A','E','C')
    Set STATE_EXCEPTION_INDICATOR = ‘2’
    EXIT

/* Added check for delete of HURREXCL because HURREXCL does exist for the risk and the rules would drop down and set STATE_EXCEPTION_INDICATOR to space */
When FIPS_US_ALPHA_CD = ‘HI’
SUBLINE_CODE = ‘027’
CVRG_CD ‘HURREXCL’ does not exist for the risk or 'HURREXCL' VW_CVRG_HIST.ACTION_CD = ‘D’
    Set STATE_EXCEPTION_INDICATOR = ‘1’
    EXIT

When SRC_SYS_CD in (‘UDPIM’, 'BRIDGE-PAS')
   Set STATE_EXCEPTION_INDICATOR = ‘ ’ (space)
   EXIT

When FIPS_US_ALPHA_CD in (‘NY’, ’FL’)
    Set STATE_EXCEPTION_INDICATOR = ‘1’
    EXIT

STATE_EXCEPTION_INDICATOR = ‘ ’  (space)
(default)","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses
","dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202)

sconley 3/1/17: JIRA DP-7778, DP-8175, QC defect ENTERPRISE.Data_Platform 1503: New Requirement for STATE_EXCEPTION_INDICATOR for ISO Property.
sconley 5/1/17:  JIRA DP-8780, QC Defect ENTERPRISE.Data_Platform 1742 to add in action_cd check for HURREXCL.
sconley 5/17/17:  JIRA DP-9664, QC Defect ENTERPRISE.Data_Platform 1742 to add check for deletion of HURREXCL.
",5/17/2017,mmconley,"sconley 2/26/16: Updated Description & ETL Cross Ref to include Premiums

sconley 5/4/16: Reformatted BR Description

dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202)

sconley 3/14/17: Reformated BR and added rules for Hawaii.  For ISO Property we need to check if HURREXCL exists and then find its risk.  If the risk state = ‘HI’ (Hawaii) and the risk has any coverages where SUBLINE_CD = ‘027’ (cvrg_cd GROUP2), set the STATE_EXCEPTION_INDICATOR for those coverages per the rules. There should only be 1 coverage per risk.
On EDW table FDW.LKP_STAT_PREM_HURREXCL contains the edw_trans_id and coverage_id for subline 027 coverages from the query:
SELECT * FROM FDW.PREMIUM_FACT_CORE
JOIN  VW_CVRG_REL 
ON PREMIUM_FACT_CORE.POL_EDW_TRANS_ID =VW_CVRG_REL.EDW_TRANS_ID
JOIN VW_COVERAGE
ON VW_CVRG_REL.CHILD_CVRG_ID = VW_COVERAGE.COVERAGE_ID
WHERE  PREMIUM_FACT_CORE.RS_FIPS_US_ALPHA_CD = 'HI'
AND PREMIUM_FACT_CORE.SUBLINE_CD = '027'
AND VW_COVERAGE.CVRG_CD = 'HURREXCL'
AND VW_CVRG_REL.ACTION_CD IN ('A', 'E', 'C').
Then for those coverage_ids & prc_rating_ids, field CVRG_CD_HEX is set to 'HURREXCL' on EDW in FDW.S_D_STAT_FORMAT_PREMIUM_STG1 & FDW.S_D_STAT_FORMAT_PREMIUM_STG2.

sconley 5/1/17: Added vw_cvrg_hist for source of HURREXCL action_cd.  (DP-8780, QC 1742). Revisions also coming for above joins.

sconley 5/17/17: Added check to see if HURREXCL has been deleted. (DP-9664, QC 1742)
",,,,,,,,,
BR-22548,"121.3 UGL State Exception Indicator - Premiums and Losses

Determine the state exception code for lead coverage using source system, coverage code, policy symbol, subline and state name. 

Default the State Exception Indicator to spaces.

When the source system is ELD_PAS or ENV-PAS
set the state exception indicator to spaces.


When the policy symbol in:  (XS, UM, AL, BTA, PL, STA, TPA)
When source system is 'SES-PAS' or 'GAC-PAS'
use the attached matrix to set the state exception indicator.

When the State Name is Massachusetts (MA) and the subline is 334 or 337, set the State Exception Indicator to 9.

When the State Name is Maryland (MD) , set the State Exception Indicator to 8.

When the State Name is New Jersey (NJ) and the coverage code is 'LIMLEAD', set the State Exception Indicatory to 3.

When the State Name is New Jersey (NJ) and the coverage code is NOT  'LIMLEAD', set the State Exception Indicatory to 9.

No further changes needed for Rhode Island per BCS and will leave Rhode Island to use space as default value.

See comments for explanation of why Premium and Loss side code different - 12/23/15.","
If SRC_SYS_CD = 'SES-PAS' and Policy_Symbol in (XS, UM, AL, BTA, PL, STA, TPA)
If SRC_SYS_CD in ('SES-PAS', 'GAC-PAS')

Then use worksheet below (found in system in LK_STATE_EXCEPT_LIAB)

Data Steward sheet

 
Rule Description
 
End-If

If SRC_SYS_CD in (‘ELD_PAS’, 'MAL-PAS', 'ENV-PAS') 
    Then STATE_EXCEPT_IND = ‘ ’
Else 
If FIPS_US_Alpha_CD = ‘MA’
  And SUBLINE_CD in (‘334’,‘337’)
   Then STATE_EXCEPT_IND = ‘9’
Else
 IF FIPS_US_Alpha_CD = ‘MD’
    Then STATE_EXCEPT_IND = ‘8’
Else 
 IF FIPS_US_Alpha_CD = ‘NJ’
   IF CVRG_CD = ‘LIMLEAD’ 
     Then STATE_EXCEPT_IND = ‘3’
   Else STATE_EXCEPT_IND = ‘9’
Else STATE_EXCEPT_IND = ‘ ’


Loss Side
 (From ETL developer per comment in Custom Defect 209 pointing out Loss Side code is different than Premium Side code):

DECODE(true
                     ,PREVIOUSLY_CONVERTED_IND = 1 AND  NOT ISNULL(conv_STATE_EXCEPTION_INDICATOR),conv_STATE_EXCEPTION_INDICATOR
                     ,SRC_SYS_CD='UDEL'  AND IN(RS_FIPS_US_ALPHA_CD,'MA','MD') ,'9'
                     ,SRC_SYS_CD='UDEL', ' '
                     ,SRC_SYS_CD='ELD_PAS' ,' '
                     ,RS_FIPS_US_ALPHA_CD='MA' AND IN(SUBLINE_CD,'334','337'),'9'
                     ,RS_FIPS_US_ALPHA_CD='MD' ,'8'
                     ,RS_FIPS_US_ALPHA_CD='NJ' AND CVRG_CD='LIMLEAD', '3'
                     ,RS_FIPS_US_ALPHA_CD='NJ' ,'9'
                      ,' '
)
","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses","Defect 7580 - ENV-PAS state exception code

Custom Defect 209 - add Great American custom and remove policy symbol check for Specialty E & S",5/19/2016,dzieverink,"Defect 7580 - Environmental (ENV-PAS) state exception code should be the default of space for the 4 applicable states which are MA, MD, NJ, RI.

Custom Defect 209 - For Specialty E & S (SES-PAS) remove check for policy symbol and just use source system code = 'SES-PAS'.  Add check for Great American Custom which = 'GAC-PAS'.

12/23/15 - Added Loss Side code from Kevin who pointed out that while working Defect 209 for the Premium Side, that the Loss Side logic is different than the premium side.  Per discussion with Rick, the source system code UDEL was only implemented for Excess Liability.  They have not sent any data through for premiums.  Also, there is logic around the previously converted indicator that would only be on losses.  

sconley 5/4/16: Reformatted BR Description

dzieverink 5/19/16: 
Defect DP 37 May 2016:
Added logic for MAL-PAS
",,,,,,,,,
BR-21937,122 Rating Identification Indicator,"
","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Property_Losses",,7/31/2017,mmconley,,,,,,,,,,
BR-22591,122.1 UPR Rating Identification Indicator - Losses,"When Subline_Cd in (‘011’,’012’,’013’,’014’,’015’,’016’,’017’,’018’,’027’,’029’,’035’,’037’,’039’,’045’,’055’,’067’,’069’,’077’,’079’,’081’,’082’,’083’,’084’,’085’,’086’,’087’,’088’)
Use lookup chart called Rating Identification Ind in Excel Spreadsheet.


IF SUBLINE_CD = ‘970’
  If VW_CVRG_HIST.HSB_COVERAGE_CD in (‘010’,’012’)
    Then RATING_IDENTIFICATION_IND = ‘4’
  Else 
    RATING_IDENTIFICATION_IND = ‘3’ 
  Endif
Else
  If lk.PARENT_BUSN_CVRG_CD = ‘FPFSFPP’
   Then RATING_IDENTIFICATION_IND = ‘6’ 
  else RATING_IDENTIFICATION_IND = ‘2’",ETL - D_Stat_Property_Losses,dzieverink 1/6/17: Added logic for lookup per Rick's stat area doc for ISO Property (QC DP-1172),1/6/2017,dzieverink,"sconley 5/4/16: Reformatted BR Description

sconley 5/10/16: Corrected spelling of RATING_IDENTIFICATION_IND and source for HSB_COVERAGE_CD.",,,,,,,,,
BR-22642,122.2 UCA Rating Identification Indicator - Premiums and Losses,"If Stat_Format_Code = 'UCA'
  If FIPS_US_ALPHA_CD = 'MA'
    If RATE_MOD_FCTR_EXPERIENCE = '100' and               RATE_MOD_FCTR_SCHEDULE = '100', Then RATING_IDENT_IND = '9'
    If RATE_MOD_FCTR_EXPERIENCE <> '100'' and RATE_MOD_FCTR_SCHEDULE = '100', Then RATING_IDENT_IND = '1'
    If RATE_MOD_FCTR_EXPERIENCE <> '100' amd RATE_MOD_FCTR_SCHEDULE <> '100'', Then RATING_IDENT_IND = '7'
  
If (RATE_MOD_FCTR_EXPERIENCE = ‘000’
   and RATE_MOD_FCTR_SCHEDULE = ‘000’)
   Then RATING_IDENT_IND = ‘9’
else
If (RATE_MOD_FCTR_EXPERIENCE <> ‘100’
   Or RATE_MOD_FCTR_SCHEDULE <> ‘100’)
   Then RATING_IDENT_IND = ‘1’
Else 
    RATING_IDENT_IND = ‘9’
IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'RatingID' AND EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
THEN Set RATING_INDENTIFICATION_IND = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
Else

If
RS_FIPS_US_ALPHA_CD='MA' AND RATE_MOD_FCTR_EXPERIENCE <> '100' AND       	RATE_MOD_FCTR_SCHEDULE <> '100', '7'
Else
If ,var_OCP_IND = 1 AND RATE_MOD_FCTR_EXPERIENCE<> '100'
then , '2'
Else
var_OCP_IND = 1 
AND RATE_MOD_FCTR_SCHEDULE <>'100'
then  '2'
else
if ,var_OCP_IND = 1, '8' and 
,RATE_MOD_FCTR_EXPERIENCE <> '100' or RATE_MOD_FCTR_SCHEDULE <> '100'
then = '1'
ELSE
= '9'

OCP_IND=
lookup on the LK_CLASS_CODE_OCP table by the first column or second column to match the class code.  pull the ocp_ind back to use in the above if statement.

Decode (true, 
NOT ISNULL(:LKP.LKP_LK_CLASS_CODE_OCP_FIRST_THREE(substr(RATE_CLASS_CD,1,3))),
:LKP.LKP_LK_CLASS_CODE_OCP_FIRST_THREE(substr(RATE_CLASS_CD,1,3))
,NOT ISNULL(:LKP.LKP_LK_CLASS_CODE_OCP_EXACT_MATCH(RATE_CLASS_CD)),
:LKP.LKP_LK_CLASS_CODE_OCP_EXACT_MATCH(RATE_CLASS_CD)
,0
)

","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",DP2461 & DP2561 - Added MA logic,10/31/2018,ragarwal,"sconley 7/31/17: Moved object in DOORs, updated description, and updated links.

dzieverink 11/6/17 - added MA logic. This was added for conversion purposes, but will be needed in the future for when MA data is brough in through new world. I will leave the logic in this field for now and revisit when that project is created.

ragarwal 10/23/18: Added logic to to pass through data, if available,  from EDW.PRC_RATING_EXTENSIONS

",,,,,,,,,
BR-23464,122.3 UCA Rating Identification Indicator - Losses Commercial Auto Conversion,"if Experience = 100 then set to 9
if Experience <> 100 and Schedule = 100 then set to 1
if Experience <> 100 and Schedule <> 100 then set to 7 

",ETL - D_Stat_Auto_Losses,needed for Comml Auto conversion,7/31/2017,mmconley,sconley 7/31/17: Updated description and updated links.,,,,,,,,,
BR-22547,"122.4 UGL Rating Identification Indicator - Premiums and Losses

When building the UGL STAT Area, 

Default the Rating Indent Indicator to 0.When the source system is UDAGRI, set the Rating Indent Indicator to '9'
rule should apply for ALL GL products so no need to check for source system name or UD in the rule.","IF SRC_SYS_CD = ‘UDAGRI’  
  Then RATING_INDENT_IND = ‘9’  
   Else RATING_INDENT_IND = ‘0’
END-IF

If  Schedule Modifier or Loss Experience Modifier not in ('1','0')
     then RATING_IDENTIFICATION_IND =  1
            else RATING_IDENTIFICATION_IND =  '9'
else RATING_IDENTIFICATION_IND = ' '    
END-IF
","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses","Defect 65 - Update Rating Identification Indicator in Liability stat area for ALL GL products


",11/6/2017,dzieverink,"7/23/14 - Update Rating Identification Indicator in Liability stat area for all GL products.  Per BCS, all agree that the rule is applicable to all GL products, so we shouldnt have to put the UD name or Source System in the rule.  Also, we arent sure we would ever hit the last rule line (else RATING_INDENT_IND = 0), but if we need to keep it in, the rule should set this to a  "" "" (space).   
sconley 5/4/16: Reformatted BR Description
",,,,,,,,,
BR-21938,123 Retrospective / Participating Indicator,"
",,,5/10/2016,mmconley,sconley 5/10/16: Reformatted and made sub-rule.,,,,,,,,,
BR-23406,123.1 UGL UCA Retrospective / Participating Indicator - Premiums and Losses,Set RETRO_PAR_INDICATOR = '0',"ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,5/10/2016,mmconley,"Included in Premium Stat Areas for UCA and UGL

sconley 5/10/16: Reformatted and made sub-rule.",,,,,,,,,
BR-21939,124 Class Description Indicator,"When the STANDARD_NAME = 'CLASS_DESCRIPTION_INDICATOR' move STAT_BREAKOUT_CODE to CLASS_DESCRIPTION_INDICATOR

If FIELD_LENGTH = 2, move 0 to positions 1 
and Class_description_indicator to position 2 & 3.  ",,,2/28/2013,lkummer,,,,,,,,,,
BR-21940,125 Premium Discount Indicator,When the STANDARD_NAME = 'PREMIUM_DISCOUNT_INDICATOR' move STAT_BREAKOUT_CODE to PREMIUM_DISCOUNT_INDICATOR,,,2/28/2013,lkummer,,,,,,,,,,
BR-22645,125.1 UCA Premium Discount Indicator - Premiums,Move 0,ETL - D_Stat_Auto_Premiums,,5/4/2016,mmconley,sconley 5/4/16: Reformatted BR Description,,,,,,,,,
BR-21941,126 Premium Indicator,When the STANDARD_NAME = 'PREMIUM_INDICATOR' move STAT_BREAKOUT_CODE to PREMIUM_INDICATOR,,,2/28/2013,lkummer,,,,,,,,,,
BR-21942,127 Rate Date,,"


",,5/9/2016,mmconley,sconley 5/9/16:  Reformatted and made sub-rules,,,,,,,,,
BR-23385,127.1 UFC Rate Date - Premiums and Losses ,RATE_DATE(6)= CVRG_HIST_EFF_DT (MMYYYY),"ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,5/9/2016,mmconley,sconley 5/9/16:  Reformatted and made sub-rules,,,,,,,,,
BR-23383,127.2 UPR Rate Date - Losses,RATE_DATE(6)= CVRG_HIST_EFF_DT (MMYYYY),ETL - D_Stat_Property_Losses,,5/9/2016,mmconley,sconley 5/9/16:  Reformatted and made sub-rules,,,,,,,,,
BR-22658,127.3 UGL UCA Rate Date - Losses,RATE_DATE = Cvrg_Hist_Eff_Dt (MMYY),"ETL - D_Stat_Liability_Losses
ETL - D_Stat_Auto_Losses
",,5/9/2016,mmconley,sconley 5/9/16:  Reformatted and made sub-rules; corrected rule for UGL Losses,,,,,,,,,
BR-21943,128 Rate Month ,,"ETL - D_Stat_Liability_Losses
ETL - D_Stat_Auto_Losses",,6/22/2015,jjordan,"Column in the table , but not in the stat area.  derived from rate_date in stat area",,,,,,,,,
BR-21944,129 Rate Year  ,"When the STANDARD_NAME = 'RATE_DATE' and the FIELD_LENGTH = 6 move the last 4 digits of the STAT_BREAKOUT_CODE to RATE_YEAR

When the STANDARD_NAME = 'RATE_DATE' and the FIELD_LENGTH = 4 then the century is missing.  If the MMYY = 0000 move 00 to CC.  If the MMYY > 0000 move the last 2 digits to a YY storage field.  If the YY > 50 move 19 to CC else move 20 to CC.  Move CCYY to RATE_YEAR 
","ETL - D_Stat_Liability_Losses
ETL - D_Stat_Auto_Losses",,6/22/2015,jjordan,"Column in the table , but not in the stat area.  derived from rate_date in stat area",,,,,,,,,
BR-21945,130 Retrospective Date,"IF SRC_SYS_ CD = ‘UDAGRI’ 
 Then RETRO_DT = ‘000000’ 
  Else  
        IF SRC_SYS_CD in ('ELD_PAS',’ENV-PAS’, 'SES-PAS', 'GAC-PAS') 
        IF SRC_SYS_CD in ('ELD_PAS',’ENV-PAS’, 'SES-PAS', 'GAC-PAS', ‘DIRCTENTRY)   
   If CVRG_RETROACTIVE_DT is not null
     Then RETRO_DT = CVRG_RETROACTIVE_DT (MMYYYY)
      Else RETRO_DT = ‘000000’ 
    End-if
         Else SPACES
         End-If
End-If

Updated business rule to add ""REFAPP"":


IF SRC_SYS_ CD = UDAGRI 
 Then RETRO_DT = 000000 
Else  
        IF SRC_SYS_CD in ('ELD_PAS', 'ENV-PAS', 'SES-PAS', 'GAC-PAS', 'DIRCTENTRY', 'REFAPP’)   
             If CVRG_RETROACTIVE_DT is not null
                  Then RETRO_DT = CVRG_RETROACTIVE_DT (MMYYYY)
             Else RETRO_DT = 000000 
        Else SPACES


Per Bryan Saleeba, the code is found in ""MP_STAT_UGL_COMMON mapplet in the FDW_EDW folder.

","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses","Custom Defect 207 - request to update code to match business rule for Great American Custom

Jira Story DP-7434 with code change under Data Platform QC-1376:  Add ""DIRCTENTRY"" to condition to populate retro data if there, for SHS D&O project

8/4/17-dlburns for Rally Story US17461, QC2243 to add ""REFAPP' to the condition to populate retro data if there for General Liability project.",8/7/2017,dburns4,"When Building the UGL Stat Area, determine the Retropective Participating Date using source system.

Default Retrospective Participating Date to Spaces.

When the source system is equal to UDAGRI, set the Retrospective Participating Date to zeros.

When the source system is in (ELD_PAS, ENV-PAS, SES-PAS, GAC-PAS), and the Coverage Retroactive Date sent from the sourse system is NOT null, set the Retrospective Participating Date to the Coverage Retroactive Date received from the source.

When the source system is in (ELD_PAS, ENV-PAS, SES-PAS, GAC-PAS), and the Coverage Retroactive Date sent from the sourse system is null, set the Retrospective Participating Date to zeros.

Custom Defect 207 - Business Rule showed correct check for Great American Custom (GAC-PAS) but is out of sync with actual code.  This defect requested code update for check for GAC-PAS.

12/2315 - Changed the name of the business rule per Rick Herbig's request from ""Retrospective/Paricipating Date"" to ""Retrospective Date"" after checking with FDW BA team as well as Lori and Mollie.  

For SHS D & O project, policy data in EDW via Direct Entry.  Therefore, needed to add qualifier of ""DIRCTENTRY"" to condition so if retro date is sent, we use that date.  See Jira Story DP-7434 with code change under Data Platform QC-1376.  

8/4/17 - For General Liability project, add qualifier for CUBE of ""REFAPP"" to condition so if retro date is sent, we use that date.  See Rally Story US17461, QC2243

",,,,,,,,,
BR-21948,131 Limit Indicator,,"ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",,7/15/2013,moreilly,,,,,,,,,,
BR-22663,131.1 UGL Limit Indicator,"If src_sys_cd IN ('SES-PAS', 'GAC-PAS', 'MAL-PAS', ‘UDAGRI’, ‘ENV-PAS’,‘REFAPP’)
         then limit_ind = 1
   ELSE                
            LIMIT_IND = 0


If  SRC_SYS_CD = ‘ELD_PAS’ and RATE_CLASS_CD = ‘69999’
 Then LIMIT_IND = ‘1’  

If SRC_SYS_CD = ELD_PAS
And RATE_CLASS_CD = 81351 or 81331
And Liability Limit Provision for Claim Expenses in (‘CEIL’, ‘5050’, ‘CEAL’)
Then LIMIT_IND = 1

If SRC_SYS_CD = ELD_PAS
And RATE_CLASS_CD = 81351 or 81331
And Liability Limit Provision for Claim Expenses in (‘CEOL’, ‘CESL’)
Then LIMIT_IND = 8

        
NOTE for ELD_PAS:
CEOL= Claim Expense Outside Limit
CEIL = Claim Expense Inside Limit
5050 = Limit can only be eroded up to 50% by claim expenses
CESL= Claim Expense Separate Limit
CEAL= Claim Expense Additional Limit


It is in the UGL common mapplet so this applies to both premiums and losses.  Per Bryan Saleeba, the code is found in ""MP_STAT_UGL_COMMON mapplet in the FDW_EDW folder.



","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses","Defect 6154 added CEIL, 5050 and CEOL for ELD_PASS

Defect 7578 added CEAL and CESL for ELD_PASS

Custom Defect 208 - For Great American Custom sync up code with business rule

Jira DP-5148/ Defect 918 - From Ann Benken to have Limit Ind for TX = 1 rather than Limit Ind = 4.   This story was done by Rick Herbig and Prathima.  I am updating the DOORS information so it matches the ETL change that was done by Prathima.  I have included the actual code as well.

8/4/17-dlburns for Rally Story US174658, QC2242 to add ""REFAPP' to the condition to populate limit ind if there for General Liability project.  Also rewrote the rule to be more straightforward and put together in one IF statement all the source systems that should result in a value of 1 for the limit indicator.
",8/7/2017,dburns4,"Prior defect 6154 in early 2014 added logic for ELD_PAS for rate class code = 81351 or 81331 and liability limit provision for claim expenses for INSIDE, 50/50, OUTSIDE.

Defect 7578 Oct 2014 added logic for ELD_PAS for rate class code = 81351 or 81331 and liability limit provision for claims expenses for CESL, CEAL.

dzieverink 5/19/16: 
Defect DP 37 May 2016:
Added logic for MAL-PAS

information:
When building the UGL Stat Area, determine the Limit Indicator using the source system and the rate class. 

Default Limit Indicator to False (0).

When the source system is in (SES-PAS, GAC-PAS), and the state is NOT TX,  set the Limit Indicator to 1.

When the source system is in (SES-PAS, GAC-PAS), and the state is  TX,  set the Limit Indicator to 4.

When the source system is equal to ELD_PAS and the rate class is equal to '69999', set the Limit Indicator to True (1).  
When the source system is equal to ELD_PAS and the rate class code = ‘81351’ or ‘81331’ and liability limit provision for claim expenses = INSIDE or 50/50, set the Limit Indicator to True (1).
When the source system is equal to ELD_PAS and the rate class code = ‘81351’ or ‘81331’ and liability limit provision for claim expenses = OUTSIDE, set the Limit Indicator to 8.
When the source system is equal to ELD_PAS and the rate class code = ‘81351’ or ‘81331’ and liability limit provision for claim expenses = CESL, set the Limit Indicator to 8.
When the source system is equal to ELD_PAS and the rate class code = ‘81351’ or ‘81331’ and liability limit provision for claim expenses = CEAL, set the Limit Indicator to 1.

When the source system is in (ENV-PAS, UDAGRI), set the Limit Indicator to True (1).

Custom Defect 208 - Check for Great American Custom (GAC-PAS) was already in business rule but not in code.  This defect was to sync up the code with the business rule to check for GAC-PAS.

8/4/17 - For General Liability project, add qualifier for CUBE of ""REFAPP"" to condition for limit ind.  See Rally Story US17458, QC2242.  Also rewrote the rule to be more straightforward and put together in one IF statement all the source systems that should result in a value of 1 for the limit indicator.


",,,,,,,,,
BR-22654,131.2 UCA Limit Indicator  ,Move 1,"ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
",,4/7/2017,mmconley,,,,,,,,,,
BR-21949,132 Increased Limits Factor,,"ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Format_Premiums",,8/1/2013,moreilly,,,,,,,,,,
BR-22545,"132.1 UGL Increased Limits Factor - Premiums


When building the UGL Stat Area, determine the Increased Limits Factor using the source system.

When the source system is ELD_PAS, then set the Increased Limits Factor to 100.

For all other source systems, accept the Increased Limits Factor provided by the source.","IF SRC_SYS_CD = (’ENV-PAS’)  
     Then ‘100’
      Else
  Select INCREASED_LIMIT_FACTOR,
     From FDW.d_cvrg_rate_fctr crf
     Where crf.edw_cvrg_rating_id = COVERAGE_RATING_ID
and INCREASE_LIMITS_FCTR = (crf.INCREASED_LIMIT_FACTOR * 100)
 (left fill with 0)
                 If Not Found
                     ws.INCREASE_LIMITS_FCTR = ‘000’
                  else
                      move INCREASE_LIMITS_FCTR to ws.INCREASE_LIMITS_FCTR
                    end-if
End-if","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Format_Premiums",,8/27/2013,moreilly,,,,,,,,,,
BR-23477,132.2 UPR Increased Limits Factor - Premiums,"INCREASE_LIMITS_FCTR (1) = ‘0’
INCREASE_LIMITS_FCTR (2-4) = ws.INCREASE_LIMITS_FCTR 
If INCREASE_LIMITS_FCTR = ‘0000’ 
  Then INCREASE_LIMITS_FCTR = ‘    ‘  (4 spaces)
  (if there is not an INCREASED_LIMITS_FACTOR
   rate factor we want the default to be spaces)","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Format_Premiums",,7/19/2017,mmconley,sconley 7/19/17: Added rules to DOORs. Copied from old ETL specs.  Added links.,,,,,,,,,
BR-21950,133 Rate Departure Factor,,"ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Format_Premiums

",,8/1/2013,moreilly,"
",,,,,,,,,
BR-22560,133.1 UIM Rate Departure Factor - Premiums,,"ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Format_Premiums",,7/13/2017,mmconley,,,,,,,,,,
BR-22559,133.2 UFC Rate Departure Factor - Premiums,"If  SRC_SYS_CD = 'ELD_PAS'  
    Then RATE_DEPART_FCTR = ‘100’
Else   
 If FIPS_US_ALPHA_CD = ‘CA’
     And SUBLINE_CD = ‘965’ 
    then RATE_DEPARTURE_FACTOR = ‘170’
  Else 
    If SUBLINE_CD =’001’
      then RATE_DEPARTURE_FACTOR = ‘160’
Else 
 If FIPS_US_ALPHA_CD = ‘WA’
     And SUBLINE_CD = ‘965’ 
       then RATE_DEPARTURE_FACTOR = ‘174’
    Else 
     If SUBLINE_CD = ‘001’
        then RATE_DEPARTURE_FACTOR = ‘131’
  Else 
      RATE_DEPARTURE_FACTOR = ‘174’
Else
RATE_DEPARTURE_FACTOR = ws.RATE_DEPART_FCTR ","ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Format_Premiums","FDW_Core 8951:
Update for ELD
",6/30/2015,mmconley,6/30/15 sconley:  Updated for FDW_Core 8951,,,,,,,,,
BR-22518,"133.3 UGL Rate Departure Factor - Premiums

When building the UGL Stat Area, determine the Rate Departure Factor using source system and internal annual statement line.

When source system is equal to 'UDAGRI' and Internal Annual Statement Line in (010, 021, 030, 171), set the Rate Departure Factor to '999'

Convert all Rate Factors to a percent
Round all Rate Factors","If STAT_FORMAT_CD = 'UGL'
   Then Select 
RATE_DEPARTURE_FACTOR,
From FDW.d_cvrg_rate_fctr crf
Where crf.edw_cvrg_rating_id = COVERAGE_RATING_ID
RATE_DEPART_FCTR = .RATE_DEPARTURE_FACTOR * 100)
 	 (left fill with 0)  
             
             If Not Found
                     ws.RATE_DEPARTURE_FACTOR = ‘000’
                  else
                      move RATE_DEPARTURE_FACTOR to ws.RATE_DEPARTURE_FACTOR
                    end-if
End-if

","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Format_Premiums",,1/18/2018,bkirkpatrick,"

",,,,,,,,,
BR-22647,133.4 UCA Rate Departure Factor - Premiums,"If  ws.RATE_MOD_LOSS_COST <> ‘000’
    Then RATE_DEPART_FCTR = ws.RATE_MOD_LOSS_COST
  Else
   If ws.RATE_DEPART_FCTR <> ‘000’
      Then RATE_DEPART_FCTR = ws.RATE_DEPART_FCTR 
Else RATE_DEPART_FCTR = ‘000’","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Format_Premiums
",,8/1/2013,moreilly,,,,,,,,,,
BR-21951,134 Rate Modification Factor Experience,"When the Loss Experience Factor is provided by the source system, set the Rate Mod Factor Experience equal to the Loss Experience Factor provided.

Convert all Rate Factors to a percent
Round all Rate Factors
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Auto_Premiums

",,5/22/2014,jjordan,"4/1/14 sconley: Changed format and made sub-rules.

",,,,,,,,,
BR-22734,134.1 UFC Rate Modification Factor Experience - Premiums,"Select LOSS_EXPERIENCE_FACTOR
    From fdw.d_cvrg_rate_fctr
    Where d_cvrg_rate_fctr.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

When LOSS_EXPERIENCE_FACTOR is NULL;
SRC_SYS_CD in ( 'MYS-PAS', 'ELD_PAS','AVALON-PAS');
    Set  RATE_MOD_FACTOR_EXPERIENCE = '100'
    EXIT

When  LOSS_EXPERIENCE_FACTOR is NULL;
    Set  RATE_MOD_FACTOR_EXPERIENCE = '000'
    EXIT

 RATE_MOD_FACTOR_EXPERIENCE =  LOSS_EXPERIENCE_FACTOR *100 
    lpad with zeros to 3 digits
    EXIT","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
","AFG.mySurety_Intg 11: Default Rate Factors to 100 in the Stat Area for mySurety
FDW_Core 8951:
Default Rate Factors to 100 in the Stat Area for ELD
AFG.Avalon_Intg 20:
Default Rate Factors to 100 in the Stat Area for AVALON
",5/4/2016,mmconley,"4/17/14 sconley: Changed format and made sub-rule for UFC Premiums. Corrected Select statement.
6/26/15 sconley: Updated for AVALON
6/30/15 sconley: Updated for ELD
sconley 5/4/16: Reformatted BR Description",,,,,,,,,
BR-22733,134.2 UGL UCA Rate Modification Factor Experience - Premiums,"Select LOSS_EXPERIENCE_FACTOR
    From fdw.d_cvrg_rate_fctr
    Where d_cvrg_rate_fctr.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

if LOSS_EXPERIENCE_FACTOR is null     
    RATE_MOD_FACTOR_EXPERIENCE = '100'
else     
    RATE_MOD_FACTOR_EXPERIENCE = LOSS_EXPERIENCE_FACTOR *100 
    lpad with zeros to 3 digits
 end-if","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Auto_Premiums",,5/4/2016,mmconley,"4/17/14 sconley: Changed format and made sub-rule for UGL, UCA Premiums.  Corrected Select statement.

sconley 5/4/16: Reformatted BR Description",,,,,,,,,
BR-21952,135 Rate Modification Factor IRPM/SRP,"When building the UFC, UIM, UGL or UCA Stat Area, determine the Rate Mod Factor IRPM/SRP  using the Rate Mod Factor IRPM/SRP provided by the source system.

When the Rate Mod Factor IRPM/SRP is provided by the source system, set the Rate Mod Factor IRPM/SRP equal to the Rate Mod Factor IRPM/SRP provided.

Convert all Rate Factors to a percent
Round all Rate Factors

","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Auto_Premiums

",,5/22/2014,jjordan,"4/16/14 sconley: Changed format and made sub-rules.

",,,,,,,,,
BR-23189,135.1 UFC Rate Modification Factor IRPM - Premiums,"Select IRPM_MODIFIER
    From fdw.d_cvrg_rate_fctr
    Where d_cvrg_rate_fctr.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

When IRPM_MODIFIER is NULL;
SRC_SYS_CD in ( 'MYS-PAS', 'ELD_PAS','AVALON-PAS');
    Set RATE_MOD_FACTOR_IRPM = '100'
    EXIT

When  IRPM_MODIFIER is NULL;
    Set RATE_MOD_FACTOR_IRPM = '000'
    EXIT

RATE_MOD_FACTOR_IRPM =  IRPM_MODIFIER *100 
    lpad with zeros to 3 digits
    EXIT","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums","AFG.mySurety_Intg 11: Default Rate Factors to 100 in the Stat Area for mySurety
FDW_Core 8951:
Default Rate Factors to 100 in the Stat Area for ELD
AFG.Avalon_Intg 20:
Default Rate Factors to 100 in the Stat Area for AVALON
",5/4/2016,mmconley,"4/16/14 sconley: Changed format and made sub-rule for UFC Premiums. Corrected Select statement.
6/26/15 sconley: Updated for AVALON
6/30/15 sconley: Updated for ELD
sconley 5/4/16: Reformatted BR Description",,,,,,,,,
BR-23188,135.2 UIM UGL UCA Rate Modification Factor IRPM/SRP - Premiums,"Select  IRPM_MODIFIER
    From fdw.d_cvrg_rate_fctr
    Where d_cvrg_rate_fctr.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

if  IRPM_MODIFIER is null 
    RATE_MOD_FACTOR_IRPM_SRP = '100'
else
    RATE_MOD_FACTOR_IRPM_SRP = IRPM_MODIFIER *100 
    lpad with zeros to 3 digits
end-if","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Auto_Premiums",,7/13/2017,mmconley,"4/16/14 sconley: Changed format and made sub-rule for UIM, UGL, UCA Premiums.  Corrected Select statement.

sconley 5/4/16: Reformatted BR Description",,,,,,,,,
BR-21953,136 Rate Modification Factor Package,"When building the UFC, UIM, or  UGL Stat Area, determine the Rate Mod Factor Package  using the Rate Mod Factor  Package provided by the source system.

Default Rate Mod Factor Package  to '100'.

When the Rate Mod Factor  Package is provided by the source system, set the Rate Mod Factor  Package equal to the Rate Mod Factor Package provided.

Convert all Rate Factors to a percent
Round all Rate Factors
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Liability_Premiums
",,5/22/2014,jjordan,4/16/14 sconley: Changed format and made sub-rules.,,,,,,,,,
BR-23193,136.1 UFC Rate Modification Factor Package - Premiums,"Select PACKAGE_MODIFICATION_FACTOR
    From fdw.d_cvrg_rate_fctr
    Where d_cvrg_rate_fctr.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

When PACKAGE_MODIFICATION_FACTOR is NULL;
SRC_SYS_CD in ( 'MYS-PAS', 'ELD_PAS','AVALON-PAS');
    Set RATE_MOD_FACTOR_PACKAGE= '100'
    EXIT

When PACKAGE_MODIFICATION_FACTOR is NULL;
    Set RATE_MOD_FCTR_PACKAGE = '000'
    EXIT

RATE_MOD_FACTOR_PACKAGE = PACKAGE_MODIFICATION_FACTOR *100 
    lpad with zeros to 3 digits
    EXIT","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums","AFG.mySurety_Intg 11: Default Rate Factors to 100 in the Stat Area for mySurety
FDW_Core 8951:
Default Rate Factors to 100 in the Stat Area for ELD
AFG.Avalon_Intg 20:
Default Rate Factors to 100 in the Stat Area for AVALON",5/4/2016,mmconley,"4/17/14 sconley: Changed format and made sub-rule for UFC Premiums. Corrected Select statement.
6/26/15 sconley: Updated for AVALON
6/30/15 sconley: Updated for ELD
sconley 5/4/16: Reformatted BR Description",,,,,,,,,
BR-23190,136.2 UIM UGL Rate Modification Factor Package - Premiums,"Select PACKAGE_MODIFICATION_FACTOR
    From fdw.d_cvrg_rate_fctr
    Where d_cvrg_rate_fctr.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

if PACKAGE_MODIFICATION_FACTOR is null 
    RATE_MOD_FCTR_PACKAGE = '100'
else
    RATE_MOD_FCTR_PACKAGE= PACKAGE_MODIFICATION_FACTOR *100 
    lpad with zeros to 3 digits
end-if","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Liability_Premiums",,7/13/2017,mmconley,"4/17/14 sconley: Changed format and made sub-rule for UIM, UGL Premiums.  Corrected Select statement.

sconley 5/4/16: Reformatted BR Description",,,,,,,,,
BR-21954,137 Rate Modification Factor Schedule,"When building the UFC, UGL or UCA Stat Area, determine the Rate Mod Factor Schedule using the Schedule Modifier provided by the source system.


When the Schedule Modifier is provided by the source system, set the Rate Mod Factor  Schedule equal to the Schedule Modifier provided.

Convert all Rate Factors to a percent
Round all Rate Factors
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Auto_Premiums

",,5/22/2014,jjordan,"4/16/14 sconley: Changed format and made sub-rules.

",,,,,,,,,
BR-23195,137.1 UFC Rate Modification Factor Schedule - Premiums,"Select SCHEDULE_MODIFIER
    From fdw.d_cvrg_rate_fctr
    Where d_cvrg_rate_fctr.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

When SCHEDULE_MODIFIER is NULL;
SRC_SYS_CD in ( 'MYS-PAS', 'ELD_PAS','AVALON-PAS');
    Set RATE_MOD_FCTR_SCHEDULE= '100'
    EXIT

When SCHEDULE_MODIFIER is NULL;
    Set RATE_MOD_FCTR_SCHEDULE= '000'
    EXIT

RATE_MOD_FCTR_SCHEDULE = SCHEDULE_MODIFIER *100 
    lpad with zeros to 3 digits
    EXIT","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums","AFG.mySurety_Intg 11: Default Rate Factors to 100 in the Stat Area for mySurety
FDW_Core 8951:
Default Rate Factors to 100 in the Stat Area for ELD
AFG.Avalon_Intg 20:
Default Rate Factors to 100 in the Stat Area for AVALON
",5/4/2016,mmconley,"4/16/14 sconley: Changed format and made sub-rule for UFC Premiums. Corrected Select statement
6/26/15 sconley: Updated for AVALON
6/30/15 sconley: Updated for ELD
sconley 5/4/16: Reformatted BR Description",,,,,,,,,
BR-23194,137.2 UGL UCA Rate Modification Factor Schedule - Premiums,"Select SCHEDULE_MODFIER
    From fdw.d_cvrg_rate_fctr
    Where d_cvrg_rate_fctr.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

if SCHEDULE_MODFIER is null 
    RATE_MOD_FACTOR_SCHEDULE = '100'
else
    RATE_MOD_FACTOR_SCHEDULE = SCHEDULE_MODFIER *100 
    lpad with zeros to 3 digits
end-if","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Auto_Premiums",,5/4/2016,mmconley,"4/16/14 sconley: Changed format and made sub-rule for UGL, UCA Premiums.  Corrected Select statement.

sconley 5/4/16: Reformatted BR Description",,,,,,,,,
BR-22044,138 Rate Modification Factor Expense,"When building the UFC, UIM, UGL, or UCA Stat Area, determine the Rate Mod Factor Expense using the Expense Modifier provided by the source system.

When the Expense Modifier is provided by the source system, set the Rate Mod Factor  Expense equal to the Expense Modifier provided.

Convert all Rate Factors to a percent
Round all Rate Factors
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Auto_Premiums
",,5/22/2014,jjordan,"4/16/14 sconley: Changed format and made sub-rules.

",,,,,,,,,
BR-23183,138.1 UFC Rate Modification Factor Expense - Premiums,"Select EXPENSE_MODIFIER
    From fdw.d_cvrg_rate_fctr
    Where d_cvrg_rate_fctr.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

When EXPENSE_MODIFIER is NULL;
SRC_SYS_CD in ( 'MYS-PAS', 'ELD_PAS','AVALON-PAS');
    Set RATE_MOD_FCTR_EXPENSE= '100'
    EXIT

When EXPENSE_MODIFIER is NULL;
    Set RATE_MOD_FCTR_EXPENSE= '000'
    EXIT

RATE_MOD_FCTR_EXPENSE = EXPENSE_MODIFIER *100 
    lpad with zeros to 3 digits
    EXIT","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums","AFG.mySurety_Intg 11: Default Rate Factors to 100 in the Stat Area for mySurety
FDW_Core 8951:
Default Rate Factors to 100 in the Stat Area for ELD
AFG.Avalon_Intg 20:
Default Rate Factors to 100 in the Stat Area for AVALON
",5/4/2016,mmconley,"4/16/14 sconley: Changed format and made sub-rule for UFC Premiums. Corrected Select statement.
6/26/15 sconley: Updated for AVALON
6/30/15 sconley: Updated for ELD
sconley 5/4/16: Reformatted BR Description
",,,,,,,,,
BR-23187,138.2 UIM UGL UCA Rate Modification Factor Expense - Premiums,"Select EXPENSE_MODIFIER
    From fdw.d_cvrg_rate_fctr
    Where d_cvrg_rate_fctr.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

if EXPENSE_MODIFIER is null 
    RATE_MOD_FCTR_EXPENSE= '100'
else
    RATE_MOD_FCTR_EXPENSE = EXPENSE_MODIFIER *100 
    lpad with zeros to 3 digits
end-if","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Auto_Premiums",,7/13/2017,mmconley,"4/16/14 sconley: Changed format and made sub-rule for UIM, UGL, UCA Premiums.  Corrected Select statement.

sconley 5/4/16: Reformatted BR Description",,,,,,,,,
BR-22045,139 Rate Modification Factor Final,"When building the UFC Stat Area, determine the Rate Mod Factor Final using the Rate Mod Factor Final provided by the source system.

When the Rate Mod Factor  Final is provided by the source system, set the Rate Mod Factor Final equal to the Rate Mod Factor Final provided.

Convert all Rate Factors to a percent
Round all Rate Factors
","ETL - D_Stat_Format_Premium
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
",,5/22/2014,jjordan,4/15/14 sconley: Changed format and made a sub-rule for UFC Premiums.,,,,,,,,,
BR-23182,139.1 UFC Rate Modification Factor Final - Premiums,"Select RATE_FINAL_MODIFICATION_FACTOR
    From fdw.d_cvrg_rate_fctr
    Where d_cvrg_rate_fctr.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

When RATE_FINAL_MODIFICATION_FACTOR is NULL;
SRC_SYS_CD in ( 'MYS-PAS','ELD_PAS', 'AVALON-PAS');
    Set RATE_FINAL_MODIFICATION_FACTOR = '100'
    EXIT

When RATE_FINAL_MODIFICATION_FACTOR is NULL;
    Set RATE_FINAL_MODIFICATION_FACTOR = '000'
    EXIT

RATE_FINAL_MODIFICATION_FACTOR =  RATE_FINAL_MODIFICATION_FACTOR*100 
    lpad with zeros to 3 digits
    EXIT    ","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Premiums","AFG.mySurety_Intg 11: Default Rate Factors to 100 in the Stat Area for mySurety
FDW_Core 8951:
Default Rate Factors to 100 in the Stat Area for ELD
AFG.Avalon_Intg 20:
Default Rate Factors to 100 in the Stat Area for AVALON
",5/4/2016,mmconley,"4/15/14 sconley: Changed format and made a sub-rule for UFC Premiums.  Corrected Select statement.
6/26/15 sconley: Updated for AVALON
6/30/15 sconley: Updated for ELD

sconley 5/4/16: Reformatted BR Description
",,,,,,,,,
BR-22648,140 Rate Modification Factor Miscellaneous,"When building the UCA Stat Area, determine the Rate Mod Factor Miscellaneous  using the Rate Mod Factor  Package provided by the source system.

When the Rate Mod Factor  Package is provided by the source system, set the Rate Mod Factor  Package equal to the Rate Mod Factor Package provided.

Convert all Rate Factors to a percent
Round all Rate Factors

Select RATE_MOD_FCTR_PACKAGE
    From fdw.d_cvrg_rate_fctr
    Where d_cvrg_rate_fctr.edw_cvrg_rating_id = edw.prc_rating.prc_rating_id

if RATE_MOD_FCTR_PACKAGE is null 
    RATE_MOD_FCTR_PACKAGE = '000'
else
    RATE_MOD_FCTR_PACKAGE= RATE_MOD_FCTR_PACKAGE *100 
    lpad with zeros to 3 digits
end-if
","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Format_Premiums",,12/29/2017,mmconley,4/16/14 sconley: Corrected Select statement.,,,,,,,,,
BR-21955,"141 Mold Damage Code


","
","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Property_Losses
",,5/23/2013,moreilly,,,,,,,,,,
BR-22608,141.1 UGL Mold Damage Code - Premiums and Losses,"When Building the UGL Stat Area, determine the mold damage code using coverage code, subline and risk state.

Default Mold Damage Code to spaces zeros.
When the subline is in (‘334’, ‘335’, ‘336’, ‘337’, ‘338’, ‘339’, ‘345’, ‘346’, ‘347’) and Risk State in  (‘GA’,’NY’,’WA’), then set the mold damage code to '9'.

When mold coverage exists and the subline is NOT in  (‘334’, ‘335’, ‘336’, ‘337’, ‘338’, ‘339’, ‘345’, ‘346’, ‘347’) and Risk State is NOT in  (‘GA’,’NY’,’WA’), then set the mold damage code to '8' if form AL7487 is not on the policy transaction, else zero.

IF SUBLINE_CD in (‘334’, ‘335’, ‘336’, ‘337’, ‘338’, ‘339’, ‘345’, ‘346’, ‘347’) 
  Then
        If  FIPS_US_Alpha_CD in (‘GA’,’NY’,’WA’)
           Then MOLD_DAMAGE_CD = ‘9’
            Else
    	If  PTF_UGL_MDC_IND = ‘1’
       	   Then MOLD_DAMAGE_CODE = ‘8’ 
    	    Else SPACES  zeros
                 End-if
            End-if
     Else SPACES zeros
  End-if","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
","PTF_UGL_MDC_IND set to 1 if the form with FORM_ID in ('AL7487') exists on the policy transaction, otherwise 0.
 (per Kevin Nienaber on 4/1/14 when PDC asked question about mold damage code during UAT testing for Specialty E & S Direct Feed project).",9/1/2017,mmconley,,,,,,,,,,
BR-22606,141.2 UPR Mold Damage Code - Premiums and Losses,"/* Rules for ISO Property Sublines */
For ISO Property if the Subline Code is in ('011', '012', '013', '014', '015', '016', '017', '018', '027', '029', '031', '035', '037', '039', '045', '055', '060', '061', '067', '069', '077', '079', '081', '082', '083', '084', '085', '086', '087', '088') we need to check if FUNGUS coverage also exists for that risk and use the FUNGUS aggregate limit for the look-up.
(See comments for addtional information.)

When SUBLINE_CD in ('011', '012', '013', '014', '015', '016', '017', '018', '027', '029', '031', '035', '037', '039', '045', '055', '060', '061', '067', '069', '077', '079', '081', '082', '083', '084', '085', '086', '087', '088');

    1) CVRG_CD 'FUNGUS' does not exist for the risk or 'FUNGUS' VW_CVRG_HIST.ACTION_CD = 'D';
             Set MOLD_DAMAGE_CODE = '8';
  EXIT
    2) CVRG_CD 'FUNGUS' exists for the risk;
         'FUNGUS' VW_CVRG_HIST.ACTION_CD in ('A', 'E', 'C);
         
         /* See Policy Aggregate Limit Rules (BR-22003). For FUNGUS select APPLIES_TO_CD = EACHOCC. If EACHOCC does not exist, APPLIES_TO_CD = EACHLOC will be selected. */
         a) D_CVRG_LIMIT.AGGR_POL_TERM_LIMIT_AMT for FUNGUS <> 0;
                 Set var_PER_OCCUR_AGG_POL_TERM_LIMIT_AMT =
                 D_CVRG_LIMIT.AGGR_POL_TERM_LIMIT_AMT; 
                 Continue to Select MOLD_DAMAGE_CODE;
         
         /* When there is not an Policy Aggregate Limit for FUNGUS (for TIMELEMENT the limit may be a DUR) */
         b) D_CVRG_LIMIT.AGGR_POL_TERM_LIMIT_AMT for FUNGUS = 0;
                  Set MOLD_DAMAGE_CODE = '9'; 
                  EXIT
                    
/* Look-up using FUNGUS LIMIT_AMT */
Select MOLD_DAMAGE_CODE 
From LK_MOLD_DAMAGE_CODE
Where LK_MOLD_DAMAGE_CODE.CVRG_CD = 'FUNGUS'
   AND (LK_MOLD_DAMAGE_CODE.MOLD_CVRG_MIN_AMOUNT <= var_PER_OCCUR_AGG_POL_TERM_LIMIT_AMT <= LK_MOLD_DAMAGE_CODE.MOLD_CVRG_MAX_AMOUT);
Set MOLD_DAMAGE_CODE = LK_MOLD_DAMAGE_CODE.MOLD_DAMAGE_CODE;
EXIT

/* Rules for All Other Sublines */
/* Look for forms on the policy. */
If SUBLINE_CD in (‘115’,‘116’,’135’,’136’,’155’,’156’, ‘106’)
  Then
     If EDW FDW.LKP_PFC_PTF.PTF_UPR_MDC1_IND = ‘1’  (see BR-22207)
       Then MOLD_DAMAGE_CD = ‘A’
     Else
     If EDW FDW.LKP_PFC_PTF.PTF_UPR_MDC2_IND = ‘1’  (see BR-22208)   
       Then MOLD_DAMAGE_CD = ‘B’
  Else MOLD_DAMAGE_CD = ‘9’
Else MOLD_DAMAGE_CD = ‘ ‘ space","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses","dzieverink 1/6/17: Added Subline logic around FUNGUS coverage code per Rick's stat area doc for ISO Property (QC DP-1172)

sconley 9/15/17: Revised rules for MOLD_DAMAGE_CODE for ISO Property. Aded subline 031 to rule. (US16772, QC DP-2370)",9/18/2017,mmconley,"sconley 9/15/17: For ISO Property we need to check if FUNGUS exists and then find its risk.  If the risk has any coverages where SUBLINE_CD in ('011', '012', '013', '014', '015', '016', '017', '018', '027', '029', '031', '035', '037', '039', '045', '055', '060', '061', '067', '069', '077', '079', '081', '082', '083', '084', '085', '086', '087', '088'), set the MOLD_DAMAGE_CODE for those coverages per the rules using the Aggregate Limit for FUNGUS. There should only be 1 FUNGUS coverage per risk.
-On EDW table FDW.LKP_STAT_PREM_MOLD_DAMAGE_CODE contains the edw_trans_id, coverage_id, FUNGUS action_cd, and FUNGUS pol_risk_cvrg_id for all the risk's coverages from the query:
SELECT fdw.premium_fact_core.pol_edw_trans_id
      ,fdw.premium_fact_core.coverage_id
      ,edw.vw_cvrg_hist.action_cd
      ,edw.vw_pol_risk_cvrg.pol_risk_cvrg_id
  FROM fdw.premium_fact_core
      ,edw.vw_pol_risk_cvrg
      ,edw.vw_coverage
      ,edw.vw_cvrg_hist
WHERE premium_fact_core.pol_term_id = vw_pol_risk_cvrg.pol_term_id
   AND premium_fact_core.risk_id = vw_pol_risk_cvrg.risk_id
   AND vw_pol_risk_cvrg.coverage_id = vw_coverage.coverage_id
   AND vw_coverage.coverage_id = vw_cvrg_hist.coverage_id
   AND premium_fact_core.pol_edw_trans_id = vw_cvrg_hist.edw_trans_id
   AND vw_coverage.cvrg_cd = 'FUNGUS'
   AND vw_cvrg_hist.action_cd IN ('A', 'E', 'C', 'D')
-Then on EDW for those coverage_ids & prc_rating_ids, fields CVRG_CD_FUNGUS is set to 'FUNGUS', POLRISK_CVRG_ID_FUNGUS is set to the FUNGUS pol_risk_cvrg_id, and POL_EDW_TRANS_ID_FUNGUS is set to the FUNGUS policy edw_trans_id in FDW.S_D_STAT_FORMAT_PREMIUM_STG1. Field CVRG_CD_FUNGUS is set to 'FUNGUS'  and AGGR_POL_TERM_LIMIT_AMT is set to var_PER_OCCUR_AGG_POL_TERM_LIMIT_AMT for FUNGUS in FDW.S_D_STAT_FORMAT_PREMIUM_STG2.
-POLRISK_CVRG_ID_FUNGUS and POL_EDW_TRANS_ID_FUNGUS are used to get the Aggregate Limit for FUNGUS from D_CVRG_LIMIT.
-The Aggregate Limit for FUNGUS is stored in variable var_PER_OCCUR_AGG_POL_TERM_LIMIT_AMT and is used for the look-up to LK_MOLD_DAMAGE_CODE.",,,,,,,,,
BR-23478,142 Occupancy,,"ETL - D_Stat_Format_premiums
ETL - D_Stat_Property_Premiums",,7/28/2017,mmconley,,,,,,,,,,
BR-23479,142.1 UPR Occupancy - Premiums,OCCUPANCY = ' ' (space),"ETL - D_Stat_Format_Premiums
ETL - D_Stat_Property_Premiums",,7/28/2017,mmconley,sconley 7/28/17: Added rule to DOORs.,,,,,,,,,
BR-21956,143 FDW  Subline description,"Select FDW_CODE,
          FDW_DESC
From LK_FDW_TO_EDW_REF 
Where FDW_REF_DESC = ‘SUBLINE_CODE’ 
    and EDW_ITEM_CD = VW_COVERAGE_RATING.SUBLINE_CD
if not null
  then 
    SUBLINE_CODE = FDW_CODE
    SUBLINE_DESC = FDW_DESC
Else 
    SUBLINE_CODE = VW_COVERAGE_RATING.SUBLINE_CD
    SUBLINE_DESC = VW_COVERAGE_RATING.SUBLINE_LONG_DESC",ETL - D_Business_Cvrg,,7/28/2017,mmconley,"As of 9/2012, the only time we over write what is sent from EDW is for Subline 325",,,,,,,,,
BR-21958,144 SBP Blanket Indicator,"When EDW.VW_CVRG_REL.REL_CATG_CD = INCLINBLKT and EDW.VW_CVRG_REL.ACTION_CD <> 'D', in PREMIUM_FACT_CORE set the SBP_BLANKET_IND to 1 for the parent coverage, else set the SBP_BLANKET_IND to 0.
VW_CVRG_REL.ACTION_CD = 'D' indicates that the coverage was deleted from the blanket.

Set D_BUSINESS_CVRG.SBP_BLANKET_IND = PREMIUM_FACT_CORE.SBP_BLANKET_IND

For FIS, SBP_BLANKET_IND is NULL","ETL - Premium_Fact_Core
ETL - D_Business_Cvrg
",ENTERPRISE.Data_Platform 1562 FDW: ETL for Blanket Coverage Ind and Claims_Made_Ind in FDW (DP-7783),4/10/2017,mmconley,"sconley 3/15/17: For UDPIM if a coverage is part of a blanket coverage, in EDW VW_CVRG_REL.REL_CATG_CD = INCLINBLKT. 
The premium bearing coverage is the parent coverage and the blanket is the child coverage. 
Multiple parent coverages can have the same blanket child coverage.
BLANKET_IND is part of a unique key on D_BUSINESS_CVRG.

sconley 3/16/17: Renamed BLANKET_IND to SBP_BLANKET_IND since the field is specifically for SBP (DP-7783)

sconley 4/10/17: Added FIS comment to rule.",,,,,,,,,
BR-23455,145 Blanket Coverage Indicator,"Set BLANKET_COVERAGE_IND = VW_CVRG_HIST.BLANKET_COVERAGE_IND

For FIS, BLANKET_COVERAGE_IND is NULL","ETL - D_Business_Cvrg
ETL - Premium_Fact_Core","ENTERPRISE.Data_Platform 1562 FDW: ETL for Blanket Coverage Ind and Claims_Made_Ind in FDW (DP-7783)
",4/10/2017,mmconley,sconley 4/10/17: New field for ISO Property added to d_business_cvrg and added to key.   (DP-7783),,,,,,,,,
BR-21959,146 Premium Category and Premium Category Description,"MOVE ‘P’ and ‘Premium’
** The VW_CVRG_PREM.CATG_CD and VW_CVRG_NON_PREM.CATG_CD have multiple values, but the aggregate premium table creates only a ‘P’ record for the FDW’s use.",ETL - D_Pol_Trans_Cvrg,,11/5/2012,moreilly,This is really just a default more than a business rule,,,,,,,,,
BR-21960,147 Waived Indicator,"F VW_CVRG_PREM.WAIVED_IND <> 0 
THEN VW_CVRG_PREM.WAIVED_IND
ELSE-IF  VW_CVRG_NON_PREM.WAIVED_IND <> 0 
THEN VW_CVRG_NON_PREM.WAIVED_IND
ELSE 0  ",ETL - D_Pol_Trans_Cvrg,,11/5/2012,moreilly,,,,,,,,,,
BR-21962,148 Underwriter Codes,"Code 1 - 
    Move ‘N’   
(Reinstatement indicator not needed)

Code 2 - 
If  BUSINESS_ACTIVITY_CD = ‘CANC’ or 'NRRC' or 'CRC'
  Then 
Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘UNDERWRITER_CODE_2’
and EDW_ITEM_CD = VW_Pol_Trans.CANCEL_NON_RENEW_CD
Else ‘N’

Code 3 - 
    Move ‘0’   
(risk grade code not needed) 

Code 4 - 
If VW_reins_contr_hist.CONTR_CATG_CD = ‘F’  
   Then ‘5’
Else 
 If VW_reins_contr_hist.CONTR_CATG_CD = ‘T’  
   Then ‘9’
Else ‘0’
 
Code 5 - If VW_Pol_Trans.BUSINESS_ACTIVITY_CD
= ‘NRI’ 
and 
VW_Pol_Trans.CANCEL_NON_RENEW_CD = ‘CLS’  
  then ‘8’
Else 
  If VW_Pol_Trans.BUSINESS_ACTIVITY_CD = ‘NRI’ 
and VW_Pol_Trans.CANCEL_NON_RENEW_CD <> ‘CLS’ 
   then ‘7’
Else
   If VW_Pol_Trans.BUSINESS_ACTIVITY_CD = ‘CANC’ 
  Then ‘9’
Else
  If VWA_Pol_Term.POL_STATUS_CD = ‘E’ 
  And VW_Pol_Term_Hist.RENEWAL_STATUS_CD = ‘RENEWED’ 
   then ‘3’
Else ‘0’  
","ETL - D_Policy
ETL - D_Policy_Daily",,6/5/2013,lkummer,"underwriter codes are split out into seperate columns in d_policy(eg. underwriter_code_1), but concatinated together in d_policy_daily (underwriting_code)",,,,,,,,,
BR-21963,149 Customer ID associated with the policy,"Select customer_id
From d_customer 
Where customer_number = VWA_Pol_Term.Cust_Cd",ETL - D_Policy,,7/28/2015,mmconley,"7/28/15 sconley: EDW source is 
VW_POL_TERM_HIST.CUST_CD",,,,,,,,,
BR-21964,150 First Accounting Date,"min based on policy number, mod, trans effective
accounting_month || 01 || accounting_year",ETL - D_Policy,,11/5/2012,moreilly,,,,,,,,,,
BR-22687,151 Governing Product Value ID,"Select PRODUCT_VALUE_1_8_CODE
From lk_governing_pv_state 
Where MGMT_CD = lk.PRODUCER_B_CODE
And Pol_No_Cd = lk.POLICY_NUMBER
And Pol_Term_Eff_Dt = lk.POLICY_EFFECTIVE_DATE
And MAX (lk.PV_RANKING, lk.PV_SUB_RANKING, lk.GROSS_WRITTEN_PREM)  combination

Sort by: producer, policy, effective date, lk.PV_RANKING, lk.PV_SUB_RANKING ascending, then lk.GROSS_WRITTEN_PREM desc","ETL - D_Policy
ETL - LK_Governing_PV_State",,8/1/2013,moreilly,,,,,,,,,,
BR-21965,152 Governing State ID,"Select RISK_STATE 
From lk_governing_pv_state 
Where MGMT_CD = lk.PRODUCER_B_CODE
And Pol_No_Cd = lk.POLICY_NUMBER
And Pol_Term_Eff_Dt = lk.POLICY_EFFECTIVE_DATE
And MAX (lk.GROSS_WRITTEN_PREM)","ETL - D_Policy
ETL - LK_Governing_PV_State",,8/1/2013,moreilly,,,,,,,,,,
BR-22688,153 Product Value Rank," (CASE
	WHEN ( PV_1_2_CD IN (‘20’,’21’,’22’,’25’,’30’,’40’,’70’,’71’)
			AND PV_3_CD = ‘9’ AND PV_4_CD = ‘3’)
		THEN ‘99’
	WHEN (PV_1_2_CD = ‘50’ AND PV_3_CD = ‘5’)
		THEN ‘99’
	WHEN (PV_1_2_CD = ’60’ AND PV_3_CD = ‘K’)
		THEN ‘99’
WHEN PACKAGE_CD = IN (‘22’,’23’,’24’)
		THEN ‘99’
	WHEN (PV_1_2_CD = ‘30’
			AND PV_7_CD IN (‘0’,’1’,’2’,’3’,’4’,’5’,’6’,’7’,’8’,’9’))
		THEN ‘10’
	WHEN (PV_1_2_CD = ‘30’
			AND PV_7_CD NOT IN (‘0’,’1’,’2’,’3’,’4’,’5’,’6’,’7’,’8’,’9’))
		THEN ‘15’
	WHEN PV_1_2_CD IN (‘01’,’80’,’81’,’83’)
		THEN ‘20’
	WHEN (PV_1_2_CD = ‘50’
		AND PV_4_CD IN (‘1’,’5’,’6’,’7’,’C’,’D’,’E’,’F’))
		THEN ‘30’
	WHEN PV_1_2_CD IN ( ‘07’, ‘50’,‘60’,’61’,’62’)
		THEN ‘40’ 
	WHEN GROSS_WRITTEN_PREM = 0
		THEN ‘90’
	WHEN NET_WRITTEN_PREM = 0
		THEN ‘90’
ELSE ‘40’
END) PV_RANKING
",ETL - LK_Governing_PV_State,,8/1/2013,moreilly,,,,,,,,,,
BR-22689,154 Product Value SubRank,"(CASE
WHEN PACKAGE_CD = IN (‘22’, ’23’, ’24’)
		THEN ‘0’
WHEN (PV_1_2_CD = ‘07’ AND PV_8_CD NOT IN (‘0’,’1’))
		THEN ‘1’ 
WHEN (PV_1_2_CD = ‘60’ AND PV_7_CD NOT IN (‘1’,’2’))
		THEN ‘1’ 
WHEN PV_1_2_CD = ‘61’ 
		THEN ‘1’ 
WHEN (PV_1_2_CD = ‘62’ AND PV_7_CD NOT IN (‘1’))
		THEN ‘1’ 
	ELSE ‘0’
END) PV_SUB_RANKING
",ETL - LK_Governing_PV_State,,8/1/2013,moreilly,,,,,,,,,,
BR-21966,155 Cancellation Information,"If VW_Pol_Trans.Cancel_catg_CD <> ‘0’
  Then CANCELLATION_IND = CANCEL_CATG_CD
CANCELLATION_TYPE = CANCEL_CATG_LONG_DESC (Set to CAPS)
   else
CANCELLATION_IND = ‘N’
CANCELLATION_TYPE = 'NON CANCEL'",ETL - D_Policy,,11/5/2012,moreilly,,,,,,,,,,
BR-21967,156 New - Renewal Type,"Select VWA_Pol_Term.New_Busn_Ind 
Decode (New_Busn_Ind, 1, 'NEW')  
Decode (New_Busn_Ind, 0, 'RENEWAL') 
Else null",ETL - D_Policy,,11/5/2012,moreilly,,,,,,,,,,
BR-21968,157 New - Renewal Indicator,"Select VWA_Pol_Term.New_Busn_Ind 
Decode (New_Busn_Ind, 1, N) 
Decode (New_Busn_Ind, 0, R) 
else null",ETL - D_Policy,,11/5/2012,moreilly,,,,,,,,,,
BR-21969,158 Primary Insured ,"If source system is ""Enterprise Data Warehouse"", select the party data whose role is Primary Insured on the Policy.

Use the Insured data from the EDW to retrieve the row in the FDW d_insured table.  
the FDW in upper case ‘CAPS’",ETL - D_Policy,,6/22/2015,jjordan,,,,,,,,,,
BR-23497,158.1 POLICY_STATUS,"
select  
 D.policy_id, 
 D.policy_effective_date, 
D.expiration_date, 
D.cancellation_date,
D. policy_status,
last_day(R.report_date)
from fdw.D_policy D,
fdw.i_report_dates  R
where R.report = 'FDW'
and nvl(D.policy_status,0) <>  CASE
                                    WHEN NVL (cancellation_date
                                             ,TO_DATE ('12/31/9999'
                                                      ,'mm/dd/yyyy')) <= (SELECT LAST_DAY (report_date)
                                                                            FROM i_report_dates
                                                                           WHERE report = 'FDW')
                                    THEN
                                       'CANCELLED'
                                    WHEN expiration_date IS NULL
                                      OR expiration_date <= (SELECT LAST_DAY (report_date)
                                                               FROM i_report_dates
                                                              WHERE report = 'FDW')
                                    THEN
                                       'EXPIRED'
                                    WHEN policy_effective_date > (SELECT LAST_DAY (report_date)
                                                                    FROM i_report_dates
                                                                   WHERE report = 'FDW')
                                    THEN
                                       'FUTURE'
                                    WHEN policy_effective_date <= (SELECT LAST_DAY (report_date)
                                                                     FROM i_report_dates
                                                                    WHERE report = 'FDW')
                                     AND NVL (expiration_date
                                             ,TO_DATE ('12/31/9999'
                                                      ,'mm/dd/yyyy')) > (SELECT LAST_DAY (report_date)
                                                                           FROM i_report_dates
                                                                          WHERE report = 'FDW')
                                    THEN
                                       'INFORCE'
                                    ELSE
                                       'UNKNOWN'
                                 END

",ETL-D_POLICY,,2/23/2018,lkummer,,,,,,,,,,
BR-21970,159 Mailing Address Associated to the Primary Insured,"If source system is ""Enterprise Data Warehouse"", select the place data whose category is Mailing that is associated with the primary insured

Use the Insured data from the EDW to retrieve the row in the FDW d_insured table.  
the FDW in upper case ‘CAPS’",ETL - D_Policy,,11/5/2012,moreilly,,,,,,,,,,
BR-21971,160 Legacy Policy Number,"If VWA_Pol_Term.RENEWAL_OF_POL_TERM_NO_CD is null 
 then LEGACY_POLICY_NUMBER = VWA_Pol_Term.POL_NO_CD 
else  LEGACY_POLICY_NUMBER =  VWA_Pol_Term.RENEWAL_OF_POL_TERM_NO_CD ",ETL - D_Policy,,11/5/2012,moreilly,,,,,,,,,,
BR-21972,161 External Policy Symbol,"If  VW_Pol_term_hist.Ext_Pol_Symbol_CD = ‘0’
   Then EXTERNAL-POLICY-SYMBOL =  VWA_Pol_Term.Pol_Symbol_CD
   Else EXTERNAL-POLICY-SYMBOL = VW_Pol_term_hist.Ext_Pol_Symbol_CD",ETL - D_Policy,,11/5/2012,moreilly,,,,,,,,,,
BR-21973,162 Deductible - d_cvrg_deduct Selection Criteria,"Populate the columns in D_CVRG_DEDUCT by selecting data from EDW.VW_PRC_DEDUCTIBLE.

/* There may be a ‘TXT’ row but it will not be brought into FDW */
Select deductible rows from edw.vw_prc_deductible
    where (deductible CATG_CD in (‘AMT’, ‘ PCNT’, ‘DUR’) or DEDUCTIBLE_TXT text is numeric)
        and deductible APPLIES_TO_CD is NOT equal to INDIRECT.

The following rules select a specific row based on additional criteria.  If the criteria are not met, then any row for the cvrg_cd may be selected. 
**********************************************************************************
If there are multiple deductible rows in edw.vw_prc_deductible for CVRG_CD = ‘DCEXPAND’
    Select the row where the APPLIES_TO_CD = ‘OCCUR’ (Occurrence)
Else if only 1 deductible exists
    Select that row.

If there are multiple deductible rows in edw.vw_prc_deductible for CVRG_CD = ‘SPECIAL’
    Select the row where the APPLIES_TO_CD = ‘OCCUR’ (Occurrence)
Else if only 1 deductible exists
    Select that row.

If there are multiple deductible rows in edw.vw_prc_deductible for CVRG_CD = ‘GROUP2’
    Select the row using this ranking for the APPLIES_TO_CD = :
1) ‘NAMEDSTORM’		/* This is a ‘PCNT’ row */
2) ‘WINDCVPROP’		/* This is a ‘PCNT’ row */
3) ‘HURRICANE’		/* This is a ‘PCNT’ row */
4) ‘WINDSTORM’		/* This is an ‘AMT’ row */
       5) ‘OCCUR’			/* This is an ‘AMT’ row */

If there are multiple deductible rows in edw.vw_prc_deductible for CVRG_CD = ‘IMMTC’
    Select the row where the APPLIES_TO_CD = ‘OCCUR’ (Occurrence)
Else if only 1 deductible exists
    Select that row.

If there are multiple deductible rows in edw.vw_prc_deductible for SRC_SYS_CD = ‘ELD_PAS’
        and DEDUCTIBLE_TXT in ('per claim', ‘per indemnifiable claim’)
    Select that row. 

If there are multiple deductible rows in edw.vw_prc_deductible for SRC_SYS_CD = ‘ELD_PAS’
        and APPLIES_TO_CD = ‘CLM’
        and DEDUCT_AMT != 0
    Select that row. 

If there are multiple deductible rows in edw.vw_prc_deductible for SRC_SYS_CD = ‘ENV-PAS’
    Select the row where APPLIES_TO_CD = ‘EPROFLIAB’ (Each Professional Liability Loss)
Else
    Select the row where APPLIES_TO_CD = ‘EACHLOSS’ (Each Loss).

If edw.vw_prc_deductible DEDUCTIBLE_PURPOSE_CD = ‘ATTPOINT’ (Coverage Attachment Point)
        and fdw.premium_fact_core PRODUCT_VALUE_1_2 = '41'
    Select that row. 

If there are multiple deductible rows in edw.vw_prc_deductible for CVRG_CD = ‘EBCOV’
    Select the row where the APPLIES_TO_CD = ‘PD’ (Property Damage)
Else if only 1 deductible exists
    Select that row. 
Note: There was not a discussion about bringing multiple deductibles into FDW

/* Load AMT row and only fields DEDUCT_PCNT and DEDUCT_DUR_NO from 'PCNT' or 'DUR' rows */
/* The does not apply when CVRG_CD = ‘GROUP2’ and a ‘PCNT’ row was selected */
If there are multiple deductible rows ('AMT', 'PCNT', 'DUR') in edw.vw_prc_deductible
    Select 'AMT' row
    Select DEDUCT_PCNT field from 'PCNT' row
    Select DUR_CATG_LONG_DESC, DEDUCT_DUR_NO from 'DUR' row.


**********************************************************************************

/* If there is only a PCNT or DUR row in EDW, then all the fields from EDW should be populated in d_cvrg_deduct.*/

DEDUCT_CATG_DESC = CATG_LONG_DESC
DEDUCT_DURATION = DUR_CATG_LONG_DESC
DEDUCT_BASIS = BASIS_LONG_DESC
DEDUCT_APPLIES_TO = APPLIES_TO_LONG_DESC
DEDUCT_AMT = DEDUCT_AMT
DEDUCT_PCNT = DEDUCT_PCNT
DEDUCT_DUR_NO = DEDUCT_DUR_NO
DEDUCTIBLE_PURPOSE_CD = DEDUCTIBLE_PURPOSE_CD
DEDUCTIBLE_PURPOSE_DESC = DEDUCTIBLE_PURPOSE_DESC
POL_RISK_CVRG_ID = POL_RISK_CVRG_ID
EDW_TRANS_ID = EDW_TRANS_ID
EDW_CVRG_HIST_ID = CVRG_HIST_ID (no longer populated)
SOURCE_SYSTEM_ID = 48
CREATION_DATE = sysdate
",ETL - D_Cvrg_Deduct,"FDW_Core 8972: Update selection criteria for ENV-PAS

Enterprise.Customs 167: UGL Deductible for Attachment Point
 
UWD.PIM 17934: For IMMTC coverage select the Deductible Row where APPIES_TO_CD = 'OCCUR'

UWD.PIM 17973: Updates for PIM Contractors Equipment.  Add CATG_CD 'DUR' to the selection criteria.  Created rule for if there are multiple deductible rows ('AMT', 'PCNT', 'DUR')  .

Enterprise.Data_Platform 1394: D_CVRG_DEDUCT Updates for ISO Property (DP-6878)
",2/21/2017,mmconley,"7/7/15 sconley: Added QC ID

10/28/15 sconley: PIM 17934 All the IMMTC deductibles have the same BASIS_CD of 'OCCUR'.
Updated all occurrences of vw_cvrg_deduct to vw_prc_deductible.

11/11/15 sconley: Informatica code from Kevin.
DECODE (true
                      ,CVRG_CD='IMMTC' AND APPLIES_TO_CD='OCCUR', 100

                      ,SRC_SYS_CD='ELD_PAS' AND IN (DEDUCTIBLE_TXT,'per claim', 'per indemnifiable claim'),100
                      ,SRC_SYS_CD='ELD_PAS' AND APPLIES_TO_CD='CLM' AND DEDUCT_AMT!= 0, 200
                      ,SRC_SYS_CD='ELD_PAS',999

                      ,SRC_SYS_CD='ENV-PAS' AND APPLIES_TO_CD='EPROFLIAB',100
                      ,SRC_SYS_CD='ENV-PAS',999

                      ,CVRG_CD != 'EBCOV' AND DEDUCTIBLE_PURPOSE_CD='ATTPOINT' AND PRODUCT_VALUE_1_2 = '41',100
                      ,CVRG_CD='EBCOV' AND APPLIES_TO_CD='PD', 200

                      ,999
)

1/4/16 sconley: PIM 17973 Updates for PIM Contractors Equipment.
DEDUCTIBLE_TXT check for numeric was originally implemented for Agri Farm Equipment Breakdown (risk FEBOPS).  However, there are not any dedutibles in PROD for FEBOPS or that have been populated in test systems since 2011.  The ETL was not checking for it so I scratched it from the rule.
CVRG_HIST_ID is no longer populated so I scratched it from the rule.
Reformatted rule.  Listed fields from d_cvrg_deduct and  EDW source fields.

1/14/16 sconley: PIM 17973 Revision of rules for defect. Created rule for if there are multiple deductible rows ('AMT', 'PCNT', 'DUR') .

1/20/16 sconley: PIM 17973 Also select DUR_CATG_LONG_DESC for DUR if there are multiple deductible rows. 

2/21/17 sconley: DP-6878 Added additional rules for ISO Property",,,,,,,,,
BR-21979,163 Deductible - d_cvrg_deduct Generate  Records,"Script:  To generate deductible rows for coverage-codes that have deductibles listed on the policy form. FPECOMPHD, FPECOMPSW, FPFCOMPHD, FPFCOMPSW: A deductible of $250 applies and is hardcoded on the form.  
INSERT INTO FDW.D_CVRG_DEDUCT
SELECT
Generate next ID   CVRG_DEDUCT_ID,
 ‘Amount’ DEDUCT_CATG_DESC,
‘(none)’ DEDUCT_DURATION,
‘Occurrence’ DEDUCT_BASIS,
‘Occurrence’ DEDUCT_APPLIES_TO,
250 DEDUCT_AMT,
null DEDUCT_PCNT,
null DEDUCT_DUR_NO,
CVRG_HIST_ID EDW_CVRG_HIST_ID,
48 SOURCE_SYSTEM_ID,
sysdate CREATION_DATE,
null LAST_UPDATE_DATE
from 
VW_busn_cvrg bc,
VWA_Pol_Risk_Cvrg prc
where 
 prc.Busn_Cvrg_id = bc.Busn_Cvrg_id
and bc.cvrg_cd in (‘FPECOMPHD’, ’FPECOMPSW’, ‘FPFCOMPHD’, ’FPFCOMPSW’,’POLCOMPHD’,’POLCOMPSW’)
and prc.CVRG_HIST_ID not in 
    (select VW_CVRG_DEDUCT cd
     Where prc.CVRG_HIST_ID = cd.CVRG_HIST_ID)

INSERT INTO FDW.D_CVRG_DEDUCT
SELECT
Generate next ID   CVRG_DEDUCT_ID,
 ‘Amount’ DEDUCT_CATG_DESC,
‘(none)’ DEDUCT_DURATION,
‘Occurrence’ DEDUCT_BASIS,
‘Occurrence’ DEDUCT_APPLIES_TO,
0 DEDUCT_AMT,
null DEDUCT_PCNT,
null DEDUCT_DUR_NO,
CVRG_HIST_ID EDW_CVRG_HIST_ID,
48 SOURCE_SYSTEM_ID,
sysdate CREATION_DATE,
null LAST_UPDATE_DATE
from 
VW_busn_cvrg bc,
VWA_Pol_Risk_Cvrg prc
where 
 prc.Busn_Cvrg_id = bc.Busn_Cvrg_id
and bc.cvrg_cd in (‘POLEQEXT’, ’POLECOLL’)
and prc.CVRG_HIST_ID not in 
    (select VW_CVRG_DEDUCT cd
     Where prc.CVRG_HIST_ID = cd.CVRG_HIST_ID)
Script:  To generate deductible rows for earthquake coverage-codes that have the deductible percentages defaulted to 5%. 
For CA, earthquake is applicable for Cvrg A-D. (FPADEQK, EQENGSERV, EQRETROFIT, EQSUBLIMA, EQSUBLIMC).  EQ deductible of 15, 20 or 25 % applies and is captured by UWD and sent downstream
For KY, earthquake is applicable for Cvrg A-D, E, F, and G (FPADEQK, FPEEQK, FPFEQK, FPGEQK, EQKA, EQKB, EQKC, EQKD).  EQ deductible of 5, 10 and 15 % applies and is captured by UWD and sent downstream.
All Other States - A default deductible of 5% applies and is printed on the Dec. It is not being captured by UWD thus is not in EDW.

INSERT INTO FDW.D_CVRG_DEDUCT
SELECT
Generate next ID   CVRG_DEDUCT_ID,
 ‘Percent’ DEDUCT_CATG_DESC,
‘(none)’ DEDUCT_DURATION,
‘Occurrence’ DEDUCT_BASIS,
‘Occurrence’ DEDUCT_APPLIES_TO,
null DEDUCT_AMT,
5 DEDUCT_PCNT,
null DEDUCT_DUR_NO,
CVRG_HIST_ID EDW_CVRG_HIST_ID,
48 SOURCE_SYSTEM_ID,
sysdate CREATION_DATE,
null LAST_UPDATE_DATE
from 
VW_busn_cvrg bc,
VWA_Pol_Risk_Cvrg prc
where 
 prc.Busn_Cvrg_id = bc.Busn_Cvrg_id
and bc.cvrg_cd in (‘FPADEQK’, ‘FPEEQK’, ‘FPFEQK’, ‘FPGEQK’, ‘EQENGSERV’, ‘EQRETROFIT’, ‘EQKA’, ‘EQKB’, ‘EQKC’, ‘EQKD’,’POLEQLOFI’,’LOCEQLOFI’)
and prc.CVRG_HIST_ID not in 
    (select VW_CVRG_DEDUCT cd
     Where prc.CVRG_HIST_ID = cd.CVRG_HIST_ID)


Script: To generate deductible rows from the parent coverage-code for those coverages that do not have deductibles.

INSERT INTO FDW.D_CVRG_DEDUCT
SELECT
Generate next ID   CVRG_DEDUCT_ID,
cd2.CATG_LONG_DESC DEDUCT_CATG_DESC,
cd2.DUR_CATG_LONG_DESC DEDUCT_DURATION,
cd2.BASIS_LONG_DESC DEDUCT_BASIS,
cd2.APPLIES_TO_LONG_DESC DEDUCT_APPLIES_TO,
cd2.DEDUCT_AMT DEDUCT_AMT,
cd2.DEDUCT_PCNT DEDUCT_PCNT,
cd2.DEDUCT_DUR_NO DEDUCT_DUR_NO,
prc.cvrg_hist_id EDW_CVRG_HIST_ID,
48 SOURCE_SYSTEM_ID,
sysdate CREATION_DATE,
null LAST_UPDATE_DATE
from 
VW_BUSN_CVRG bc,
VWA_Pol_Risk_Cvrg prc,
vw_cvrg_rel cr,
VW_CVRG_DEDUCT cd2,
VW_CVRG_HIST ch2
where 
-- joins for pol-risk-cvrg
  prc.Busn_Cvrg_id = bc.Busn_Cvrg_id
-- joins for child coverage code
  and prc.COVERAGE_ID = cr.CHILD_CVRG_ID
  and prc.EDW_TRANS_ID = cr.EDW_TRANS_ID
-- join for deductible to the parent
  and ch2.EDW_TRANS_ID = cr.EDW_TRANS_ID
  and ch2.COVERAGE_ID = cr.PARENT_CVRG_ID  
  and cd2.CVRG_HIST_ID = ch2.CVRG_HIST_ID  
  and bc.RISK_CATG_CD in (‘FRMLOC’, ‘FRMSTRUCT’, ‘FRMDWL’, ‘FPP’, ‘FPPNOC’, ‘LIVESTOCK’, ‘MACHSCHED’, ‘HSF’, ‘GRAIN’, ‘PRODUCE’,  ‘MACHBLKT’, ‘TOBACCO’, ‘AGGOPS’,’FPOPS’)
and prc.CVRG_HIST_ID not in 
    (select VW_CVRG_DEDUCT cd
     Where prc.CVRG_HIST_ID = cd.CVRG_HIST_ID)

Script: To generate deductible rows for coverages that do not have a deductible from the parent coverage-code and that do not have deductible.

INSERT INTO FDW.D_CVRG_DEDUCT
SELECT
Generate next ID   CVRG_DEDUCT_ID,
cd2.CATG_LONG_DESC DEDUCT_CATG_DESC,
cd2.DUR_CATG_LONG_DESC DEDUCT_DURATION,
cd2.BASIS_LONG_DESC DEDUCT_BASIS,
cd2.APPLIES_TO_LONG_DESC DEDUCT_APPLIES_TO,
cd2.DEDUCT_AMT DEDUCT_AMT,
cd2.DEDUCT_PCNT DEDUCT_PCNT,
cd2.DEDUCT_DUR_NO DEDUCT_DUR_NO,
prc.cvrg_hist_id EDW_CVRG_HIST_ID,
48 SOURCE_SYSTEM_ID,
sysdate CREATION_DATE,
null LAST_UPDATE_DATE
from 
VW_BUSN_CVRG bc,
VWA_Pol_Risk_Cvrg prc,
vw_cvrg_rel cr,
VW_CVRG_DEDUCT cd2,
VW_CVRG_HIST ch2
where 
-- joins for pol-risk-cvrg
  prc.Busn_Cvrg_id = bc.Busn_Cvrg_id
-- joins for child coverage code
  and prc.COVERAGE_ID = cr.CHILD_CVRG_ID
  and prc.EDW_TRANS_ID = cr.EDW_TRANS_ID
-- join for deductible to the parent
  and ch2.EDW_TRANS_ID = cr.EDW_TRANS_ID
  and ch2.COVERAGE_ID = cr.PARENT_CVRG_ID  
  and cd2.CVRG_HIST_ID = ch2.CVRG_HIST_ID  
  and bc.coverage_CD in (‘POLLOFI’, ‘LOCLOFI’)
and prc.CVRG_HIST_ID not in 
    (select VW_CVRG_DEDUCT cd
     Where prc.CVRG_HIST_ID = cd.CVRG_HIST_ID)

We want to create a hierarchy to say use coverage E deductible from that policy if available, if not available on the policy use coverage F, if not available use coverage G.  In order to select coverage E we should filter on the coverage code of FPEXXX where the E in the third position from the left represents coverage E.  The same concept is true for coverage F and G being FPFXXX or FPGXXX.  If for some reason we do not get a hit make the deductible row 0.  This is only for Coverage Codes POLLOFI and LOCLOFI.

SELECT vw_cvrg_deduct.catg_cd
               ,vw_cvrg_deduct.catg_long_desc
               ,vw_cvrg_deduct.dur_catg_long_desc
               ,vw_cvrg_deduct.basis_long_desc
               ,vw_cvrg_deduct.applies_to_cd
               ,vw_cvrg_deduct.applies_to_long_desc
               ,vw_cvrg_deduct.deduct_amt
               ,vw_cvrg_deduct.deduct_pcnt
               ,vw_cvrg_deduct.deduct_dur_no
               ,a.cvrg_hist_id edw_cvrg_hist_id
               ,vw_cvrg_deduct.deductible_txt
           FROM    (SELECT PREMIUM_FACT_CORE.CVRG_CD
                          ,PREMIUM_FACT_CORE.CVRG_HIST_ID
                          ,PREMIUM_FACT_CORE.POL_EDW_TRANS_ID
                          ,FIRST_VALUE (
                              vw_cvrg_deduct.cvrg_deduct_id)
                           OVER (PARTITION BY PREMIUM_FACT_CORE.POL_EDW_TRANS_ID
                                 ORDER BY PREMIUM_FACT_CORE.CVRG_CD, PREMIUM_FACT_CORE.CVRG_HIST_ID NULLS LAST)
                              cvrg_deduct_id
                      FROM    premium_fact_core
                           LEFT JOIN
                              vw_cvrg_deduct
                           ON PREMIUM_FACT_CORE.CVRG_HIST_ID = VW_CVRG_DEDUCT.CVRG_HIST_ID
                     WHERE (   premium_fact_core.cvrg_cd IN ('POLLOFI', 'LOCLOFI')
                            OR premium_fact_core.cvrg_cd LIKE 'FPE%'
                            OR premium_fact_core.cvrg_cd LIKE 'FPF%'
                            OR premium_fact_core.cvrg_cd LIKE 'FPG%')) a
                INNER JOIN
                   vw_cvrg_deduct
                ON a.cvrg_deduct_id = vw_cvrg_deduct.cvrg_deduct_id
          WHERE cvrg_cd IN ('POLLOFI', 'LOCLOFI')
",ETL - D_Cvrg_Deduct,,6/22/2015,jjordan,The intent of this rule is to generate deductible rows in FDW based on coverage codes and risk categories,,,,,,,,,
BR-21976,"164 Statistical Format Code - Premiums

The new world STAT format codes are standard alphanumeric codes: UIM, UFC, UGL UCA, UPR, UWC

STAT format code 906 is for taxes and surcharges

STAT format code 905 is a default used when no match is found on the lookup to LK_PV_1_8_MAIN_CD_XREF",,"ETL - F_Detail_Premiums
ETL - D_Stat_Format_Premiums",,11/24/2015,moreilly,"lk table is 
lk_pv_1_8_main_cd_xref   ",,,,,,,,,
BR-22704,164.1 Statistical Format Code - Stat Format Premiums,"Select STAT_FORMAT_CD
from lk_pv_1_8_MAIN_cd_xref  lk
where  lk.CVRG_GROUP = CVRG_GROUP
    and lk.POLICY_SYMBOL = POL_SYMBOL_CD
If not found 
  Select  STAT_FORMAT_CD
  from lk_pv_1_8_MAIN_cd_xref  lk
  where  lk.CVRG_GROUP = CVRG_GROUP
      and POLICY_SYMBOL = ‘ANY’
End-if

If EDW.VW_PRC_RATING_NON_PREM.CHARGE_CATG_CD = ‘S’  or ‘T’
  Then STAT_FORMAT_CODE = ‘906’ 
Else 
  if lk.STAT_FORMAT_CD is not null 
    then  STAT_FORMAT_CODE = lk.STAT_FORMAT_CD
  Else 
   STAT_FORMAT_CODE = ‘905’
  end-if
end-if",ETL - D_Stat_Format_Premiums,,1/19/2018,mmconley,sconley 1/19/18: Added source for CHARGE_CATG_CD. CHARGE_CATG_CD applies to Taxes and Surcharges.,,,,,,,,,
BR-22703,164.2 Statistical Format Code - Detail Premiums,"Select CVRG_GROUP 
from lk_pv_1_2_cvrg_cd_xref
where lk.RISK_CATG_CD = RISK_CATG_CD
and lk.CVRG_CD = CVRG_CD
and lk.CVRG_CATG_CD = CVRG_CATG_CD
and lk.POLICY_SYMBOL = POLICY_SYMBOL

Then  
Select STAT_FORMAT_CD
From LK_PV_1_8_MAIN_CD_XREF
Where lk.CVRG_GROUP = CVRG_GROUP
And lk.POLICY_SYMBOL = POLICY_SYMBOL
And lk.STAT_PACKAGE_IND = package-ind
And lk.CLAIMS_MADE_IND = claims-made-ind

If is null 
Then STAT-FORMAT_CODE = ‘905’","ETL - F_Detail_Premiums
",,8/16/2013,moreilly,,,,,,,,,,
BR-22726,164.3 Statistical Format Code - Unearned Premiums,"Select CVRG_GROUP 
from lk_pv_1_2_cvrg_cd_xref
where lk.RISK_CATG_CD = RISK_CATG_CD
and lk.CVRG_CD = CVRG_CD
and lk.CVRG_CATG_CD = CVRG_CATG_CD
and lk.POLICY_SYMBOL = POLICY_SYMBOL

Then  
Select STAT_FORMAT_CD
From LK_PV_1_8_MAIN_CD_XREF
Where lk.CVRG_GROUP = CVRG_GROUP
And lk.POLICY_SYMBOL = POLICY_SYMBOL
And lk.STAT_PACKAGE_IND = package-ind
And lk.CLAIMS_MADE_IND = claims-made-ind

If is null 
Then STAT-FORMAT_CODE = ‘905’",ETL - F_Unearned_Premiums,,8/16/2013,moreilly,,,,,,,,,,
BR-22535,165 Statistical Format Code - Losses,"If lk.STAT_FORMAT_CD is not null 
    then
   STAT_FORMAT_CODE = lk.STAT_FORMAT_CD
Else 
   STAT_FORMAT_CODE = ‘905’",ETL - D_Stat_Format_Losses,,4/11/2013,lkummer,"lk table is
lk_pv_1_8_main_cd_xref   ",,,,,,,,,
BR-21977,166 Billing Code,"Select FDW_DESC 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘BILLING_CODE’
and EDW_ITEM_CD = BILLING_TYPE_CD",ETL - D_Policy_Support,,8/28/2015,mmconley,"EDW source:
vw_pol_term_hist.billing_catg_cd",,,,,,,,,
BR-21978,167 Audit Code,"If AUDIT_FREQUENCY_LONG_DESC <> ‘(none)’ 
Then Move AUDIT_FREQUENCY_LONG_DESC to AUDIT_CODE  (in CAPS)
Else move ‘NOT APPLICABLE’ to AUDIT_CODE",ETL - D_Policy_Support,,8/28/2015,mmconley,"sconley 8/28/15: Updated FDW field name in rule.
EDW source: vw_cvrg_hist.audit_frequency_long_desc",,,,,,,,,
BR-23285,168 Company Line,Move NULL to COMPANY_LINE,ETL - D_Policy_Support,,8/28/2015,mmconley,,,,,,,,,,
BR-23287,169 Hazard Property Code,Move '00' to HAZARD_PROPERTY_CODE,ETL - D_Policy_Support,,8/28/2015,mmconley,,,,,,,,,,
BR-23301,170 Hazard GL Code,Move '00' to HAZARD_GL_CODE,ETL - D_Policy_Support,,8/28/2015,mmconley,,,,,,,,,,
BR-23300,171 Hazard Products Code,Move '00' to HAZARD_PRODUCTS_CODE,ETL - D_Policy_Support,,8/28/2015,mmconley,,,,,,,,,,
BR-23299,172 Hazard Commercial Auto Code,Move '00' to HAZARD_COMMERCIAL_AUTO_CODE,ETL - D_Policy_Support,,8/28/2015,mmconley,,,,,,,,,,
BR-23298,173 Hazard Workers Comp Code,Move '00' to HAZARD_WORKERS_COMP_CODE,ETL - D_Policy_Support,,8/28/2015,mmconley,,,,,,,,,,
BR-23302,174 Issue Code,Move NULL to ISSUE_CODE,ETL - D_Policy_Support,,8/28/2015,mmconley,,,,,,,,,,
BR-23304,175 Kind Code,Move NULL to KIND_CODE,ETL - D_Policy_Support,,8/28/2015,mmconley,,,,,,,,,,
BR-23307,176 Mode Code,Move NULL to MODE_CODE,ETL - D_Policy_Support,,8/28/2015,mmconley,,,,,,,,,,
BR-23303,177 Original Date,Concatenate accting_mo || '01' || accting_yr as 'MM/DD/YYYY',ETL - D_Policy_Support,,9/29/2015,mmconley,"The field is derived on EDW in FDW.vw_policy_first_acctg_date as first_accounting_dt and that field is eventually moved into original_date.
EDW source: vw_edw_trans.accting_mo and vw_edw_trans.accting_yr",,,,,,,,,
BR-23306,178 Owner ID,Move NULL to OWNER_ID,ETL - D_Policy_Support,,8/31/2015,mmconley,This is populated for PRO polcies.,,,,,,,,,
BR-23305,179 Pro Zone,Move NULL to PRO_ZONE,ETL - D_Policy_Support,,8/28/2015,mmconley,,,,,,,,,,
BR-23308,180 Previous Policy Number,Move RENEWAL_OF_POL_TERM_NO_CD to PREVIOUS_POLICY_NUMBER,ETL - D_Policy_Support,,8/28/2015,mmconley,"EDW source:
vw_pol_term_hist.renewal_of_pol_term_no_cd",,,,,,,,,
BR-23309,181 PRO LOB,Move PROD_LINE_CD to PRO_LOB,ETL - D_Policy_Support,,8/31/2015,mmconley,"EDW source:
vw_pol_term_hist.prod_line_cd

FDW_EDW Mapping: m_s_d_policy_edw",,,,,,,,,
BR-23310,182 Processing Branch,Move MGMT_CD to PROCESSING_BRANCH,ETL - D_Policy_Support,,8/28/2015,mmconley,"EDW source:  vw_party_mgmt.mgmt_cd
It looks like this is a factory party.  There are rules in ADW to determine the party.  You can find the mgmt_cd for the policy in adw.pol_term_party_process_office using edw_trans_id or pol_term_id.",,,,,,,,,
BR-23311,183 Special Use A1,Move NULL to SPECIAL_USE_A1,"ETL - D_Policy_Support	",,8/31/2015,mmconley,This is populated for PRO policies.,,,,,,,,,
BR-23321,184 Special Use A2,Move NULL to SPECIAL_USE_A2,"ETL - D_Policy_Support	",,8/31/2015,mmconley,This is populated for PRO policies.,,,,,,,,,
BR-23320,185 Special Use A3,Move NULL to SPECIAL_USE_A3,"ETL - D_Policy_Support	",,8/31/2015,mmconley,This is populated for PRO policies.,,,,,,,,,
BR-23319,186 Special Use A4,Move NULL to SPECIAL_USE_A4,"ETL - D_Policy_Support	",,8/31/2015,mmconley,This is populated for PRO policies.,,,,,,,,,
BR-23318,187 Special Use B1,Move NULL to SPECIAL_USE_B1,"ETL - D_Policy_Support	",,8/31/2015,mmconley,This is populated for PRO policies.,,,,,,,,,
BR-23317,188 Special Use B2,Move NULL to SPECIAL_USE_B2,"ETL - D_Policy_Support	",,8/31/2015,mmconley,This is populated for PRO policies.,,,,,,,,,
BR-23316,189 Special Use B3,Move NULL to SPECIAL_USE_B3,"ETL - D_Policy_Support	",,8/31/2015,mmconley,This is populated for PRO policies.,,,,,,,,,
BR-23315,190 Special Use B4,Move NULL to SPECIAL_USE_B4,"ETL - D_Policy_Support	",,8/31/2015,mmconley,This is populated for PRO policies.,,,,,,,,,
BR-23314,191 Special Use B5,Move NULL to SPECIAL_USE_B5,"ETL - D_Policy_Support	",,8/31/2015,mmconley,This is populated for PRO policies.,,,,,,,,,
BR-23313,192 Special Use B6,Move NULL to SPECIAL_USE_B6,"ETL - D_Policy_Support	",,8/31/2015,mmconley,This is populated for PRO policies.,,,,,,,,,
BR-23312,193 Special Use B7,Move NULL to SPECIAL_USE_B7,"ETL - D_Policy_Support	",,8/31/2015,mmconley,This is populated for PRO policies.,,,,,,,,,
BR-23324,"194 Taxonomy Class		",Move NULL to TAXONOMY_CLASS,"ETL - D_Policy_Support	",,8/31/2015,mmconley,This is populated for PRO policies.,,,,,,,,,
BR-23322,"195 Reason Amended	",Move TRANS_REASON_CD to REASON_AMENDED,"ETL - D_Policy_Support	",,8/31/2015,mmconley,"EDW source: 
vw_pol_trans.trans_reason_cd",,,,,,,,,
BR-23323,"196 Master Company	",Move VWTA_POL_TERM_LEGAL_ENTITY.ORG_CD to MASTER_COMPANY,ETL - D_Policy_Support,,8/31/2015,mmconley,"ADW source:
vwta_pol_term_legal_entity.org_cd

This the ORG_CD for the Legal Entity party.",,,,,,,,,
BR-21981,197 Policy Original Inception Date,The VWA_POL_TERM.Original_Inception_Dt_CD is in the format MMYYY.  The ORIGINAL-INCEPT format is MM/DD/YYY.  Include a ‘1’ for the DD.,ETL - D_Policy_Support,,6/22/2015,jjordan,,,,,,,,,,
BR-21982,198 Policy State,"Select FIPS_US_Numeric_Cd,
FIPS_US_Alpha_Cd
From VWTA_POL_TERM_State_Province
Where catg_cd = ‘ST’

Select G.REIN_STATE_PROVINCE_CODE
Form D_GEOGRAPHY G
Where G.FIPS_US_Numeric_CODE = VWTA.FIPS_US_Numeric_Cd 
And G.FIPS_US_Alpha_CODE = VWTA.FIPS_US_Alpha_Cd",ETL - D_Policy_Support,,11/5/2012,moreilly,,,,,,,,,,
BR-23325,"199 Pac Code Id			","Default Value for PAC_CODE_ID is NULL.

Note:  Dec 2015 check to populate PAC Code ID on d_policy_support was added to be done for SES-PAS in addition to GAC-PAS.  Julie Jordan worked the change.

If  EDW.POL_TERM_HIST.PRODUCT_ACTIVITY_CD is not null
    If ((EDW.POLT_TERM_HIST.PRODUCT_ACTIVITY_CD = 
         FDW.D_CUSTOM_PAC_CODE.PAC_CODE)  and 
         FDW.D_CUSTOM_PAC_CODE.PAC_CODE_SOURCE is = 'GAC' ))
              Use FDW.D_CUSTOM_PAC_CODE.PAC_CODE_ID to 
                populate FDW.D_POLICY_SUPPORT.PAC_CODE_ID 
Else
      FDW.D_POLICY_SUPPORT.PAC_CODE_ID = NULL","ETL - D_Policy_Support	",Defect 176 - Mapping PAC Code ID from EDW to FDW,3/20/2017,dburns4,"It is null for all rows in PROD.  In mapping m_d_policy_support for PROD there is not an in-link for the field on the target table.  
sconley 9/28/15: In Dev Kevin has made updates for the table and mapped the field for Custom. The default value is NULL. 
dburns 1/8/16:  With the Great American Custom (GAC)project to switch to input to EDW from a direct feed, now populating PAC Code ID for GAC.
dburns for Julie Joran Dec 2015:  As part of Specialty E & S Product Recall project, Julie Jordan worked with ETL team to modify code so that PAC Code ID and D_POLICY_SUPPORT is also populated for Specialty E & S as well as GAC. So populate D_POLICY_SUPPORT if GAC-SES or SES-PAS.  I would need to investigate further what defect Julie worked the defect under Dec 2015.
",,,,,,,,,
BR-21983,200 Policy Term calculation,"Calculate
TERM = 
(((PT-EXP-YR * 12) + PT-EXP-MO) - 
((PT-EFF-YR * 12) + PT-EFF-MO))","ETL - D_Policy_Support
",,6/22/2015,jjordan,,,,,,,,,,
BR-21984,201 Payment Plan,"If pymt_plan_CD = ‘0’ move NULL
Else move pymt_plan_CD",ETL - D_Policy_Support,,11/5/2012,moreilly,,,,,,,,,,
BR-21990,202 Final Rate Amount,IF VCR.RATE_CATG_CD = ‘FINAL’ move VCR.RATE_AMT to FINAL_RATE_AMT   ,ETL - D_Cvrg_Rate,,11/5/2012,moreilly,,,,,,,,,,
BR-21991,203 Final Rate Percent,IF VCR.RATE_CATG_CD = ‘FINAL’ move VCR.RATE_PCNT to FINAL_RATE_PCNT   ,ETL - D_Cvrg_Rate,,11/5/2012,moreilly,,,,,,,,,,
BR-21992,204 Final Rate Basis Number,IF VCR.RATE_CATG_CD = ‘FINAL’ move VCR.RATE_BASIS_NO to FINAL_RATE_BASIS_NO   ,ETL - D_Cvrg_Rate,,11/5/2012,moreilly,,,,,,,,,,
BR-21993,205 Base Rate Amount,"IF VCR.RATE_CATG_CD = ‘BASE’ move VCR.RATE_AMT to BASE_RATE_AMT   
Else  IF VCR.RATE_CATG_CD = ‘MANUAL’ move VCR.RATE_AMT to BASE_RATE_AMT   ",ETL - D_Cvrg_Rate,,11/5/2012,moreilly,,,,,,,,,,
BR-21994,206 Base Rate Percent,"IF VCR.RATE_CATG_CD = ‘BASE’ move VCR.RATE_PCNT to BASE_RATE_PCNT  
Else IF VCR.RATE_CATG_CD = ‘MANUAL move VCR.RATE_PCNT to BASE_RATE_PCNT   ",ETL - D_Cvrg_Rate,,11/5/2012,moreilly,,,,,,,,,,
BR-21995,207 Base Rate Basis Number,"IF VCR.RATE_CATG_CD = ‘BASE’ move VCR.RATE_BASIS_NO to BASE_RATE_BASIS_NO   
Else IF VCR.RATE_CATG_CD = ‘MANUAL’ move VCR.RATE_BASIS_NO to BASE_RATE_BASIS_NO   ",ETL - D_Cvrg_Rate,,11/6/2013,moreilly,,,,,,,,,,
BR-21989,208 Rating Territory Code,"If VCR.RATE_CATG_CD = ‘BASE’ 
  Then  RATING_TERRITORY_CD = VCR.RATING_TERRITORY_CD
Else if VCR.RATE_CATG_CD = ‘MANUAL’ 
  Then  RATING_TERRITORY_CD = VCR.RATING_TERRITORY_CD
Else if VCR.RATE_CATG_CD = ‘FINAL’ 
  Then  RATING_TERRITORY_CD = VCR.RATING_TERRITORY_CD
Else null",ETL - D_Cvrg_Rate,Defect 44/Specialty E&S Direct Feed (Customs),4/9/2014,dburns4,"Added ""FINAL"" to rating catolog code check so territory code will flow in to FDW",,,,,,,,,
BR-21988,209 Rating Method,"If VCR.RATE_CATG_CD = ‘BASE’
  Then RATING_METHOD = VCR.RATING_METHOD_LONG_DESC
Else If VCR.RATE_CATG_CD = ‘MANUAL’
  Then RATING_METHOD = VCR.RATING_METHOD_LONG_DESC
Else If VCR.RATE_CATG_CD = ‘FINAL’
  Then RATING_METHOD = VCR.RATING_METHOD_LONG_DESC
Else null",ETL - D_Cvrg_Rate,Defect 44/Specialty E&S Direct Feed (Customs),4/9/2014,dburns4,"Added ""FINAL"" to rating catolog code check so territory code will flow in to FDW",,,,,,,,,
BR-21987,"210 Rate Zone Code	","If VCR.RATE_CATG_CD = ‘BASE’
  Then RATE_ZONE_CD = VCR.RATE_ZONE_CD
ELSE If VCR.RATE_CATG_CD = ‘MANUAL’
  Then RATE_ZONE_CD = VCR.RATE_ZONE_CD
ELSE If VCR.RATE_CATG_CD = ‘FINAL’
  Then RATE_ZONE_CD = VCR.RATE_ZONE_CD
   Else null",ETL - D_Cvrg_Rate,Defect 44/Specialty E&S Direct Feed (Customs),4/9/2014,dburns4,"Added ""FINAL"" to rating catolog code check so territory code will flow in to FDW",,,,,,,,,
BR-21985,211 ISO Reporting Territory,"If VCR.RATE_CATG_CD = ‘BASE’
  Then ISO_REPORTING_TERRITORY_CD = VCR.ISO_REPORTING_TERRITORY_CD
If VCR.RATE_CATG_CD = ‘MANUAL’
  Then ISO_REPORTING_TERRITORY_CD = VCR.ISO_REPORTING_TERRITORY_CD
If VCR.RATE_CATG_CD = ‘FINAL’
  Then ISO_REPORTING_TERRITORY_CD = VCR.ISO_REPORTING_TERRITORY_CD
   Else null",ETL - D_Cvrg_Rate,Defect 44/Specialty E&S Direct Feed (Customs),4/9/2014,dburns4,"Added ""FINAL"" to rating catolog code check so territory code will flow in to FDW",,,,,,,,,
BR-21996,212 Coverage Rate Factor based on the Rate Factor Value,"Evaluate Catg_Cd
    When  ""EXPENSE""
             Move Rate_Fctr to Expense_Modifier
     When  ""EXPER""
            Move Rate_Fctr to Loss_Experience_Modifier
     IF SYSTEM_OF_RECORD_CODE = ‘UDFC’
When “CLASSIVARI”
	Move Rate_Fctr to IRPM_Modifier.
     ELSE
 When  ""IRPM""
             Move Rate_Fctr to IRPM_Modifier
    When  ""IRPM""
             Move Rate_Fctr to IRPM_Modifier
    When  ""ML""
             Move Rate_Fctr to Multi_Location_Multiplier
   When  ""PKG""
             Move Rate_Fctr to Package_Modification_Factor
  When  ""RMF""
             Move Rate_Fctr to Rate_Modification_Factor
  When  ""SCHED""
             Move Rate_Fctr to Schedule_Modifier
  When  ""LOSFRECRDT""
             Move Rate_Fctr to Loss_Free_Credit
  When  ""TERMFACTOR'""
             Move Rate_Fctr to  Term_Factor
   When  ""INCLMTFCTR'""
             Move Rate_Fctr to Increased_Limit_Factor
  When  ""PRF'""
             Move Rate_Fctr to Pro_Rata_Factor
   When  ""WINDPROT'""
            Move Rate_Fctr to Wind_Protection_Modifier
    When  ""WINDMIT'""
           Move Rate_Fctr to Wind_Mitigation_Factor
  When  ""DFWP'""
           Move Rate_Fctr to Drug_Free_Workplace_Factor
 When  ""FIDELITY'""
           Move Rate_Fctr to Rate_Final_Modification_Factor
End-Evaluate

IF SRC_SYS_CD = ‘UDAGRI’ and IASL_CD in (‘010’,’021’,’030’,’171’)
    IF CVRG_CD in (‘CGL’, ‘CGLPRCO’)
        DECODE(CATG_CD,'LCM',
        VCRF.RATE_FCTR,9.99)
        LOSS_COST_MODIFIER
    ELSE
        MOVE 9.99 to
        LOSS_COST_MODIFIER
ELSE
    DECODE(CATG_CD,'LCM',
    VCRF.RATE_FCTR,0)  
    LOSS_COST_MODIFIER        
END-IF

IF SRC_SYS_CD = ‘UDAGRI’ and IASL_CD in (‘010’,’021’,’030’,’171’)
    IF CVRG_CD in (‘CGL’, ‘CGLPRCO’)
        DECODE(CATG_CD,'RATEDEP',
        VCRF.RATE_FCTR,9.99)
        RATE_DEPARTURE_FACTOR
    ELSE
        MOVE 9.99 to
        RATE_DEPARTURE_FACTOR
ELSE
    DECODE(CATG_CD,'RATEDEP',
    VCRF.RATE_FCTR,1)  
    RATE_DEPARTURE_FACTOR        
END-IF",ETL - D_Cvrg_Rate_Fctr,,4/17/2014,mmconley,4/17/14 sconley: Updated 'EXPER' rule.,,,,,,,,,
BR-21997,213 Underlying Limit,"If Limit_Purpose_Txt  =  ""Attachment Point""
    Then
          UNDERLYING_LIMIT_APPLIES_TO = APPLIES_TO_LONG_DESC
          UNDERLYING_LIMIT_AMT = LIMIT_AMT
          UNDERLYING_LIMIT_BASIS_CD = BASIS_CD
          UNDERLYING_LIMIT_BASIS_DESC = BASIS_LONG_DESC
     Else
           UNDERLYING_LIMIT_APPLIES_TO = ’(none)’
           UNDERLYING_LIMIT_AMT = 0
           UNDERLYING_LIMIT_BASIS_CD is null
           UNDERLYING_LIMIT_BASIS_DESC is null
End - If.
",ETL - D_Cvrg_Limit,,11/5/2012,moreilly,,,,,,,,,,
BR-23461,214 Per Occurrence Limit,"Broke the rule into 3 parts because it was getting very big and to capture that in Informatica there are multiple parts:
1) The Per Occurrence selection criteria that sets the indicator IND_PER_OCCUR
2) The ranking (RANK_PER_OCCUR) given to the limit codes as part of the DECODE 
3) Once the limits are ranked, additional criteria to populate the Per Occurrence fields ",ETL - D_Cvrg_Limit,,5/1/2017,mmconley,sconley 5/1/17: Broke the rule into 3 parts. Existing QC defect info & comments were moved to 'Per Occurrence Ranking'.  The old rule history is on 'Per Occurrence Limit Selection Criteria'.,,,,,,,,,
BR-22000,214.1 Per Occurrence Limit Selection Criteria,"/* Informatica Selection Criteria for Per Occurrence Limit */
/* If any of these conditions are met, the limit will load to the Per Occurrence limit fields

SRC_SYS_CD in ('UDPIM','BRIDGE-PAS')
PARENT_BUSN_CVRG_CD in ('BPPDIC','BIINCEEDIC','BLDGDIC','IMPROVEDIC','EXTRAEXDIC')
CVRG_CD = 'FLOOD' OR SUBLINE_CD = '930'
BASIS_CD in ('PEROCC','APL')
APPLIES_TO_CD in ('BLANKET','EACHOCC')

	Note: If Applies_To_Cd in ('PERPOLICY','ALLOSS') we set the indicator to 0, thus not bringing those rows in here. This applies to CVRG_CD = 'OTHERDIC' as well.

BASIS_CD = ‘PEROCC’
SRC_SYS_CD in (‘ENV-PAS’)
POL_SYMBOL_CD in (‘PCE’, ‘PPC’,’EEL’) 
APPLIES_TO_CD = ‘EACHAEO’

OR

/* Add PERTRIP for ISOPROP LTDINTBPP & LTDINTINPR coverages */
(LIMIT_PURPOSE_TXT <> 'Attachment Point' OR LIMIT_PURPOSE_TXT IS NULL) 
BASIS_CD in ('PEROCC','MAXPEROCC',’PERTRIP’)
SRC_SYS_CD not in ('SES-PAS','GAC-PAS')

OR

SRC_SYS_CD in (‘SES-PAS’, ‘GAC-PAS’)
BASIS_CD = ‘PEROCC’
APPLIES_TO_CD in (‘EACHOCC’, ‘ECHCOMCUSE’, ‘ANYONEITM’)

OR 

APPLIES_TO_CD = ‘POLUTNCND’",ETL - D_Cvrg_Limit,,5/15/2018,dzieverink,"sconley 5/1/17: Broke the rule into 3 parts. Existing QC defect info & comments were moved to 'Per Occurrence Ranking'.  The old rule history is on 'Per Occurrence Limit Selection Criteria'.

sconley 5/2/17: Updated the PERTRIP comment.

dzieverink 5/15/18: Added DIC limit requirements.",,,,,,,,,
BR-23462,214.2 Per Occurrence Ranking,"/* These limit conditions are ranked in Informatica in this order as part of the DECODE.  If none of the conditions are met, any limit row may be selected (hopefully there is only 1 row) and it gets the default ranking of 999. */

/* ‘DCEXPAND’ is for UDPIM SBP and ISO Property */
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD = ‘DCEXPAND’
    Select the row using this ranking for the APPLIES_TO_CD = :
      1) ‘FORENSICRV’ (Forensic Review)
2) ‘ LEGALRV’ (Legal Review)

/* ‘GROUP1’, ‘GROUP2’,’BROAD’,’SPECIAL’are premium bearing coverages for ISO Property. For other lines they are strictly Cause of Losses and not premium bearing */
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD in (‘GROUP1’, ‘GROUP2’, ‘BROAD’, ‘SPECIAL’)
    Select the row using this ranking for the APPLIES_TO_CD = :
 1) ‘EACHOCC’ (Each Occurrence)
 2) ‘BLANKET’ (Blanket)
 3) ‘OPALLITEMS’ (All Items)
 4) ‘EACHPLANT’ (Each Plant)
 5) ‘EACHTREE’ (Each Tree)
 6) ‘EACHSHRUB’ (Each Shrub)

If RISK_CATG_CD = ‘TRANSITOPS’ (I don’t think ETL is checking for TRANSITOPS)
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD in (‘INCDEBRIS’, ‘NONCTINTER’)
    Select the row where the BASIS_CD = ‘MAXPEROCC’

If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD = ‘IMMTC’
    Select the row where the APPLIES_TO_CD = ‘EACHOCC’

/* ‘ANYONELOSS’ is for UDPIM MTC & UDPIM CE */
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD in 
        (‘SPCSHIPPER’, ‘IMCE’, ‘UNDERGRND’, ‘WATERBORNE’)
    Select the row where the APPLIES_TO_CD = ‘ANYONELOSS’

/* ‘ALLITEMS’ is for UDPIM CE */
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD in (‘BORROWED’, ‘LEASED’)
   Select the row where the APPLIES_TO_CD = ‘ALLITEMS’

/* ‘MAXIMUM’ is for UDPIM CE, UDPIM SBP only has 1 APPLIES_TO_CD of ‘PERPOLICY’ */
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD = ‘DEBRIS’
   Select the row where the APPLIES_TO_CD = ‘MAXIMUM’

/* ‘ALLEMPLS’ is for UDPIM CE, UDPIM SBP only has 1 APPLIES_TO_CD of ‘PEREMP’ */
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD = ‘EMPTOOLS’
    Select the row where the APPLIES_TO_CD = ‘ALLEMPLS’

/* ‘BLANKET’ is for UDPIM CE */
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD = ‘MISCTOOLS’
    Select the row where the APPLIES_TO_CD = ‘BLANKET’ 
      
/* ‘DCBASIC’ is for UDPIM SBP and ISO Property */
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD = ‘DCBASIC’
    Select the row where the APPLIES_TO_CD = ‘FORENSICRV’ (Forensic Review)

/* For ISO Property ‘GREEN’ may have a PCNT row and an AMT row for the Per Occurrence limit. Select the PCNT row where the APPLIES_TO_CD = ‘EACHOCC’.  The LIMIT_PCNT field maps to POL_LIMIT_PCNT. If the PCNT row exists, the LIMIT_AMT is not populated. */
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD = ‘GREEN’
    Select the row where the APPLIES_TO_CD = ‘EACHOCC’

/* ‘LTDINTBPP’ & ‘LTDINTINPR’ are for ISO Property. There may be a PEROCC or PERTRIP */
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD in (‘LTDINTBPP’, ‘LTDINTINPR’)
    Select the row where the APPLIES_TO_CD = ‘EACHOCC’

/* For ISO Property ‘EQ’ there may be a EACHOCC or BLANKET */
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD  = ‘EQ’
    Select the row where the APPLIES_TO_CD = ‘EACHOCC’

/*For DIC the top order goes as follows:
	1. Applies_To = 'EACHOCC'; BASIS_CD = 'APL'
	2. Applies_To = 'BLANKET'; BASIS_CD = 'PEROCC'
	3. Applies_To = 'BLANEKT'; BASIS_CD = 'APL'

Select the row where the APPLIES_TO_CD = ‘EACHAEO’

/* If none of the conditions are met, any limit row may be selected (hopefully there is only 1 row) */
Select a row.

",,"Defect 32 - Specialty E & S direct feed project (Customs)
The information that is struck out was the original business rule 176

FDW_Core defect 5798 for ENV_PAS.  Updated to select select limit-applies-to-cd when multiple exist.

PIM 17936: Updates for PIM MTC coverages INCDEBRIS, NONCTINTER, IMMTC, SPCSHIPPER

Custom Defect 225 - Great American Custom (GAC) - Update to add check for source system code = 'GAC-PAS' for peroccur/eachocc logic (similar to what was done for 'SES-PAS' in prior custom defect 32).

PIM 17972: Updates for PIM CE coverages

ENTERPRISE.FDW_Core 5798 for ENV-PAS (Julie)

ENTERPRISE.Data_Platform 786 for GAC (DP-3507)  (Rick)

ENTERPRISE.Data_Platform 1109 for ISO Property (Rick)

ENTERPRISE.Data_Platform 1141 for ISO Property (Rick)

4/13/17, 5/2/17, 5/15/17, 5/26/17  sconley: ENTERPRISE.Data_Platform 1679 Additional updates for ISO Property (DP-8497, DP-9407, DP-9408, DP-9823)
",5/15/2018,dzieverink,"sconley 11/13/15: PIM 17936
- Need to check for risk TRANSITOPS before checking BASIS_CD since we need to check for BASIS_CD = MAXPEROCC.
- When rule was written for the defect there were multiple PEROCC limits for IMMTC and SPCHSHIPPER.  JIRA UDPIM 7972 in the adapter stopped APPLIES_TO_CD = ANYONEVEHT from going downstream so now there is only 1 PEROCC limt for those coverages.  I left the rule in place until there is a review of the limits for CUBE MTC.
- For INCDEBRIS, the PEROCC limit basis does not have an amount, only the percent, which we will map to POL_LIMIT_PCNT (see Policy Limit rule).  No rule change.  Danielle Piccinin agreed with this.

dburns 12/16/15:  Custom Defect 225 update logic to check source system code = 'GAC-PAS' for eacoccur/peroccur logic.  See crossed out and highlighted in blue changes to rule.

sconley 12/24/15: PIM 17972: 
- Additional rules for UDPIM CE coverages that have multiple applies_to_cds for PEROCC basis_cd.
- For ADDLACQ & DEBRIS, the percent will map to POL_LIMIT_PCNT (see Policy Limit rule).  The current ETL should pick the AMT row for the Per Occurrence limit.  Danielle Piccinin agreed with this.

sconley 12/5/16: Corrected QC defect # from PIM 17922 to PIM 17972.

sconley 4/13/17: Data_Platform 1679 Additional updates for ISO Property (DP-8497).  The defect also removed some code that is not necessary.  Added rules and defects that were missing from DOORs.

sconley 5/1/17: Broke the rule into 3 parts. Existing QC defect info & comments were moved to 'Per Occurrence Ranking'.  The old rule history is on 'Per Occurrence Limit Selection Criteria'.

sconley 5/2/17: Updated the GREEN coverage rules and added rule for LTDINTINPR.

sconley 5/15/17 & 5/26/17: Additional updates for ISO Property. Updated the ‘GROUP1’, ‘GROUP2’,’BROAD’,’SPECIAL’ coverage rules and added new rule for EQ coverage.  JIRA DP-8497, DP-9407, DP-9408, DP-9823 & QC 1679.

sconley 6/7/17: Corrected ISO Property EQ comment.

dzieverink 5/15/18: Added DIC ranking requirements.
",,,,,,,,,
BR-23463,214.3 Populate the Per Occcurrence fields,"/* Criteria to Populate the Per Occurrence fields */ 

When SRC_SYS_CD NOT in (‘SES-PAS’, ‘ENV-PAS’, ‘GAC-PAS’)
    PER_OCCUR_LIMIT_APPLIES_TO = APPLIES_TO_LONG_DESC 
    PER_OCCUR_LIMIT_VALUATION = VALUATION_LONG_DESC
    PER_OCCUR_LIMIT_AMT = LIMIT_AMT
    PER_OCCUR_LIMIT_ BASIS_CD = BASIS_CD 
    PER_OCCUR_LIMIT_ BASIS_DESC = BASIS_LONG_DESC
    EXIT;


When src_sys_cd in (‘SES-PAS’, ‘GAC-PAS’)
APPLIES_TO_CD in (‘EACHOCC’, ‘ECHCOMCUSE’, ‘ANYONEITM’)
    PER_OCCUR_LIMIT_APPLIES_TO = APPLIES_TO_LONG_DESC 
    PER_OCCUR_LIMIT_VALUATION = VALUATION_LONG_DESC
    PER_OCCUR_LIMIT_AMT = LIMIT_AMT
    PER_OCCUR_LIMIT_ BASIS_CD = BASIS_CD 
    PER_OCCUR_LIMIT_ BASIS_DESC = BASIS_LONG_DESC
    EXIT;


When SRC_SYS_CD = ‘ENV-PAS’ 
POL_SYMBOL_CD in (‘PCE’, ‘PPC’,’EEL’) 
APPLIES_TO_CD = ‘EACHAEO’
    PER_OCCUR_LIMIT_APPLIES_TO = APPLIES_TO_LONG_DESC 
    PER_OCCUR_LIMIT_VALUATION = VALUATION_LONG_DESC
    PER_OCCUR_LIMIT_AMT = LIMIT_AMT
    PER_OCCUR_LIMIT_ BASIS_CD = BASIS_CD 
    PER_OCCUR_LIMIT_ BASIS_DESC = BASIS_LONG_DESC
    EXIT;

When SRC_SYS_CD = ‘ENV-PAS’ 
POL_SYMBOL_CD in (‘PCE’, ‘PPC’,’EEL’) 
APPLIES_TO_CD = ‘POLUTNCND’
    PER_OCCUR_LIMIT_APPLIES_TO = APPLIES_TO_LONG_DESC 
    PER_OCCUR_LIMIT_VALUATION = VALUATION_LONG_DESC
    PER_OCCUR_LIMIT_AMT = LIMIT_AMT
    PER_OCCUR_LIMIT_ BASIS_CD = BASIS_CD 
    PER_OCCUR_LIMIT_ BASIS_DESC = BASIS_LONG_DESC
    EXIT;

When SRC_SYS_CD = ‘ENV-PAS’ 
POL_SYMBOL_CD not in (‘PCE’, ‘PPC’,’EEL’) 
APPLIES_TO_CD = ‘POLUTNCND’
    PER_OCCUR_LIMIT_APPLIES_TO = APPLIES_TO_LONG_DESC 
    PER_OCCUR_LIMIT_VALUATION = VALUATION_LONG_DESC
    PER_OCCUR_LIMIT_AMT = LIMIT_AMT
    PER_OCCUR_LIMIT_ BASIS_CD = BASIS_CD 
    PER_OCCUR_LIMIT_ BASIS_DESC = BASIS_LONG_DESC
    EXIT;


/* Defaults for when there is not a Per Occurrence limit  */
PER_OCCUR_LIMIT_APPLIES_TO = ‘(none)’
PER_OCCUR_LIMIT_VALUATION = ‘(none)’
PER_OCCUR_LIMIT_AMT = 0
PER_OCCUR_LIMIT_ BASIS_CD is NULL
PER_OCCUR_LIMIT_ BASIS_DESC is NULL
EXIT;
",,,5/1/2017,mmconley,,,,,,,,,,
BR-22001,215 Per Layer Limit,"If Basis_Cd = 'PERLAYER' 
       Then
              PER_LAYER_LIMIT_APPLIES_TO = APPLIES_TO_LONG_DESC 
              PER_LAYER_LIMIT_VALUATION =  VALUATION_LONG_DESC
              PER_LAYER_LIMIT_AMT = LIMIT_AMT 
              PER_LAYER_LIMIT_BASIS_CD = BASIS_CD
              PER_LAYER_LIMIT_BASIS_DESC = BASIS_LONG_DESC   

       Else
           PER_LAYER_LIMIT_APPLIES_TO = ’(none)’
           PER_LAYER_LIMIT_VALUATION = ’(none)’
           PER_LAYER_LIMIT_AMT = 0  
           PER_LAYER_LIMIT_BASIS_CD is null
           PER_LAYER_LIMIT_BASIS_DESC is null        
 End -if
",ETL - D_Cvrg_Limit,,11/5/2012,moreilly,,,,,,,,,,
BR-22002,216 Policy Limit,"If Basis_Cd in ('0', 'EACHACIDNT', 'EADISABLEM', 'PERDAY', 'PWEEKPACC', 'POL', 'PERCLM', 'PEREVENT', 'PERPOLYEAR', 'PERPERSN', 'EACHPERSN', 'PMONTHPACC', ''ANNUALINCR' )    
and CATG_CD <> 'TOT'
       Then
              POL_LIMIT_APPLIES_TO = APPLIES_TO_LONG_DESC 
              POL_LIMIT_VALUATION = VALUATION_LONG_DESC
              POL_LIMIT_AMT = LIMIT_AMT 
              POL_LIMIT_BASIS_CD = BASIS_CD
              POL_LIMIT_BASIS_DESC = BASIS_LONG_DESC

       Else
           POL_LIMIT_APPLIES_TO = '(none)'
           POL_LIMIT_VALUATION = '(none)'
           POL_LIMIT_AMT = 0 
           POL_LIMIT_BASIS_CD is null 
           POL_LIMIT_BASIS_DESC is null           
End -if.
If Limit_Pcnt is not null
    Then
           POL_LIMIT_PCNT = LIMIT_PCNT
End- if.",ETL - D_Cvrg_Limit,"7/25/13 SCONLEY:  UWD.PIM 15091 CR #98 - SBP enhanced Healthcare - FDW.  Add 'POL' to the Basis_Cd selection list.

FDW_Core defect 6192 - update for handling PLD limits PERCLM .

3/30/15 SCONLEY:
UWD.Fidelity_and_Crime 15486 - Add 'PEREVENT' to the Basis_Cd selection list.

2/16/16 SCONLEY: UWD.PIM 18065 - Add 'PERPOLYEAR' to the Basis_cd selection list.

3/1/17 dzieverink: Added PERPERSN, EACHPERSN, and PMONTHPACC to Basis_Cd selection. DP-5825

4/12/17 sconley: ENTERPRISE.Data_Platform 1679: Add 'ANNUALINCR' to the Basis_Cd selection list for ISO Property (DP-8497)",6/19/2017,mmconley,"3/30/15 SCONLEY: Business Rule had not been updated to add 'PEREVENT'.

11/15/15 SCONLEY: For PIM MTC coverage INCDEBRIS, the PEROCC limit basis does not have an amount, only the percent, which we will map to POL_LIMIT_PCNT.  No rule change.  Danielle Piccinin agreed with this.  (PIM defect 17936 for Per Occurrence Limit)

2/16/16 SCONLEY:  For PIM CE coverages ADDLACQ & DEBRIS, the PEROCC limit basis also has a percent, which will maps to POL_LIMIT_PCNT.  Danielle Piccinin agreed with this.  (PIM defect 17972 for CE Per Occurrence Limit)
Add new basis_cd 'PERPOLYEAR' to the selection criteria. (PIM defect 18065 for CE Policy Limit) for coverage  RENTALEXP. Basis_cd 'PDAYPOCC' will not be brought into FDW.

4/12/17 sconley: Added CATG_CD <> 'TOT' to DOORs to match Informatica. Added 'ANNUALINCR' to the Basis_Cd selection list. (QC 1679, DP-8497)

6/19/17 sconley: Added additional info to 2/16/16 comment.
",,,,,,,,,
BR-22003,217 Policy Aggregate Limit,"Select limit rows from edw.vw_prc_limit
where BASIS_CD in ('APL', 'AGGPOLGEN', 'ANNUALAGG', 'MAXPERIOD', 'AGGPERACC', 'CONTPOLTRM', 'AGGPERPCO',’AGGPOLXPCO’)
and (Limit_Purpose_Txt <> 'Attachment Point' or Limit_Purpose_Txt is NULL)

The following rules (between the asterisks) select a specific row based on additional criteria.  If the criteria are not met, then any row for the cvrg_cd may be selected. 

**********************************************************************************
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD = 'DCEXPAND'
    Select the row where the APPLIES_TO_CD = ‘RESPEXP’ (Response and Expense)
Else if only 1 limit exists
    Select that row.
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD = 'FUNGUS'
    Select the row where the APPLIES_TO_CD = ‘EACHOCC’ (Each Occurrence)
Else if only 1 limit exists
    Select that row.
If there are multiple limit rows in edw.vw_prc_limit for CVRG_CD = 'FOODCONTAM'
    Select the row where the APPLIES_TO_CD = ‘EACHOCC’ (Each Occurrence)
Else if only 1 limit exists
    Select that row.
If there are multiple limit rows in edw.vw_prc_limit for ‘RISK_CATG_CD’ = ‘PREMOPS’ and CVRG_CD = 'MANUSCRIPT’ or CVRG_CD = 'CGL'
    Select the row where the APPLIES_TO_CD = ‘GENAGG’ (General Aggregate)
Else if only 1 limit exists
    Select that row.

SRC_SYS_CD in ('UDPIM','BRIDGE-PAS')
PARENT_BUSN_CVRG_CD in ('BPPDIC','BIINCEEDIC','BLDGDIC','IMPROVEDIC','EXTRAEXDIC')
CVRG_CD = 'OTHERDIC' 
BASIS_CD = 'PEROCC'
APPLIES_TO_CD = 'PERPOLICY' <-- select the row, otherwise do not.

SRC_SYS_CD in ('UDPIM','BRIDGE-PAS')
PARENT_BUSN_CVRG_CD in ('BPPDIC','BIINCEEDIC','BLDGDIC','IMPROVEDIC','EXTRAEXDIC')
CVRG_CD = 'FLOOD' or SUBLINE_CD = '930' 
BASIS_CD = 'APL'
APPLIES_TO_CD in ('EACHOCC','BLANKET') <-- DO NOT select these rows. These rows are to be used in the PEROCC selections.


**********************************************************************************

AGGR_POL_TERM_LIMIT_APPLIES_TO = APPLIES_TO_LONG_DESC 
AGGR_POL_TERM_LIMIT_VALUATION = VALUATION_LONG_DESC
AGGR_POL_TERM_LIMIT_AMT = LIMIT_AMT
AGGR_POL_TERM_LIMIT_BASIS_CD = BASIS_CD
AGGR_POL_TERM_LIMIT_BASIS_DESC = BASIS_LONG_DESC


/* Defaults for when there is not a Per Aggregate limit */

AGGR_POL_TERM__LIMIT_APPLIES_TO = ‘(none)’
AGGR_POL_TERM__LIMIT_VALUATION = ‘(none)’
AGGR_POL_TERM__LIMIT_AMT = 0
AGGR_POL_TERM_LIMIT_BASIS_CD is null 
AGGR_POL_TERM_LIMIT_BASIS_DESC is null
",ETL - D_Cvrg_Limit,"Defect 32/Specialty E & S Direct Feed Project (Customs)

4/12/17 sconley: ENTERPRISE.Data_Platform 1679: Add rules for FUNGUS and FOODCONTAM for ISO Property (DP-8497)

01/19/17 bkirkpatrick:
ENTERPRISE.Data_Platform 2754: Add rule for Aggregate Policy limit for ISO General Liability. (US22259)",5/15/2018,dzieverink,"Added basis_cd = 'AGGPERPCO' for ENTERPRISE.Custom defect #49
sconley 4/12/17: Reformatted rule and updated selection criteria to match Informatica.  Added rules for FUNGUS & FOODCONTAM.  Moved rule for DCEXPAND from BR-21999 to this rule.  (QC 1679, DP-8497) 
bkirkpatrick 01/19/18: Updated rule for aggregate limit for ISO GL.
dzieverink 5/15/18: Added DIC limit requirements.",,,,,,,,,
BR-22189,"218 Liability Limit	","DECODE (true
                       ,SRC_SYS_CD != ‘ENV-PAS’ and
 SUBSTR(PRODUCT_VALUE_1_8, 1, 2) = '41' and var_PER_OCCUR_LIMIT_AMT != 0, LPAD(TO_CHAR(ROUND(var_PER_OCCUR_LIMIT_AMT / 1000000)),2,'0')

                       ,SRC_SYS_CD != ‘ENV-PAS’ and
SUBSTR(PRODUCT_VALUE_1_8, 1, 2) = '41', LPAD(TO_CHAR(ROUND(var_POL_LIMIT_AMT / 1000000)),2,'0')

                       ,FIPS_US_ALPHA_CD='TX' 
                              AND (var_PER_OCCUR_LIMIT_AMT != 0  OR var_AGGR_POL_TERM_LIMIT_AMT != 0)
                              AND NOT ISNULL(:LKP.LKP_LK_LIMIT_SIZE_CODE_AGGR_GL_POL_LIMIT_AGGR_LIMIT('UGL',FIPS_US_ALPHA_CD,var_PER_OCCUR_LIMIT_AMT,var_AGGR_POL_TERM_LIMIT_AMT))
                            ,:LKP.LKP_LK_LIMIT_SIZE_CODE_AGGR_GL_POL_LIMIT_AGGR_LIMIT('UGL',FIPS_US_ALPHA_CD,var_PER_OCCUR_LIMIT_AMT,var_AGGR_POL_TERM_LIMIT_AMT)

                      ,FIPS_US_ALPHA_CD = 'TX'    
                             AND var_PER_OCCUR_LIMIT_AMT = 0        
                             AND var_AGGR_POL_TERM_LIMIT_AMT != 0
                              AND NOT ISNULL(:LKP.LKP_LK_LIMIT_SIZE_CODE_AGGR_GL_POL_LIMIT_AGGR_LIMIT('UGL','XX',var_AGGR_POL_TERM_LIMIT_AMT,0))
                            ,:LKP.LKP_LK_LIMIT_SIZE_CODE_AGGR_GL_POL_LIMIT_AGGR_LIMIT('UGL','XX',var_AGGR_POL_TERM_LIMIT_AMT,0)

                       ,FIPS_US_ALPHA_CD = 'TX'
                             AND var_PER_OCCUR_LIMIT_AMT = 0 
                             AND var_AGGR_POL_TERM_LIMIT_AMT = 0
                             AND NOT ISNULL(:LKP.LKP_LK_LIMIT_SIZE_CODE_AGGR_GL_POL_LIMIT('UGL','XX',var_POL_LIMIT_AMT))
                            ,:LKP.LKP_LK_LIMIT_SIZE_CODE_AGGR_GL_POL_LIMIT('UGL','XX',var_POL_LIMIT_AMT)

                      ,FIPS_US_ALPHA_CD != 'TX'    
                             AND var_AGGR_POL_TERM_LIMIT_AMT != 0
                             AND var_PER_OCCUR_LIMIT_AMT = 0          
                             AND NOT ISNULL(:LKP.LKP_LK_LIMIT_SIZE_CODE_AGGR_GL_POL_LIMIT_AGGR_LIMIT('UGL','XX',var_AGGR_POL_TERM_LIMIT_AMT,0))
                            ,:LKP.LKP_LK_LIMIT_SIZE_CODE_AGGR_GL_POL_LIMIT_AGGR_LIMIT('UGL','XX',var_AGGR_POL_TERM_LIMIT_AMT,0)                     

                      ,FIPS_US_ALPHA_CD != 'TX'      
                             AND var_AGGR_POL_TERM_LIMIT_AMT = 0
                             AND var_PER_OCCUR_LIMIT_AMT = 0    
                             AND NOT ISNULL(:LKP.LKP_LK_LIMIT_SIZE_CODE_AGGR_GL_POL_LIMIT('UGL','XX',var_POL_LIMIT_AMT))
                            ,:LKP.LKP_LK_LIMIT_SIZE_CODE_AGGR_GL_POL_LIMIT('UGL','XX',var_POL_LIMIT_AMT)

                       ,NOT ISNULL(:LKP.LKP_LK_LIMIT_SIZE_CODE_AGGR_GL_POL_LIMIT_AGGR_LIMIT('UGL','XX',var_PER_OCCUR_LIMIT_AMT,var_AGGR_POL_TERM_LIMIT_AMT))
                              AND (var_PER_OCCUR_LIMIT_AMT != 0  OR var_AGGR_POL_TERM_LIMIT_AMT != 0)
                            ,:LKP.LKP_LK_LIMIT_SIZE_CODE_AGGR_GL_POL_LIMIT_AGGR_LIMIT('UGL','XX',var_PER_OCCUR_LIMIT_AMT,var_AGGR_POL_TERM_LIMIT_AMT)

                       ,'  '
)
",ETL - D_Stat_Liability_Losses,ENV-PAS does not handle th Umbrella limits in the same manner as other lines of business.  Exclude ENV-PAS from special logic.,11/10/2017,mmconley,,,,,,,,,,
BR-22004,219 Limit Rows for WCEMPLIAB Coverage,"To create d_cvrg_limit rows where CVRG_CD = ‘WCEMPLIAB’ when a vw_cvrg_limit row does not exist.
INSERT INTO FDW.D_CVRG_LIMIT
SELECT
Generate next ID   CVRG_LIMIT_ID,
‘Each Occurrence’ PER_OCCUR_LIMIT_APPLIES_TO,
‘(none)’ PER_OCCUR_LIMIT_VALUATION,
100000 PER_OCCUR_LIMIT_AMT,
‘(none)’ PER_LAYER_LIMIT_APPLIES_TO,
‘(none)’ PER_LAYER_LIMIT_VALUATION,
0 PER_LAYER_LIMIT_AMT,
‘Each Occurrence’ AGGR_POL_TERM_LIMIT_APPLIES_TO,
‘(none)’ AGGR_POL_TERM_LIMIT_VALUATION,
500000 AGGR_POL_TERM_LIMIT_AMT,
‘(none)’ POL_LIMIT_APPLIES_TO,
‘(none)’ POL_LIMIT_VALUATION,
0 POL_LIMIT_AMT,
Null POL_LIMIT_PCNT,
prc.cvrg_hist_id    EDW_CVRG_HIST_ID,
48  SOURCE_SYSTEM_ID,
Sysdate CREATION_DATE,
Null LAST_UPDATE_DATE,
‘(none)’  UNDERLYING_LIMIT_APPLIES_TO,
0 UNDERLYING_LIMIT_AMT
null COINSURANCE_PCNT
FROM  
VW_busn_cvrg bc,
VWA_Pol_Risk_Cvrg prc
WHERE prc.Busn_Cvrg_id = bc.Busn_Cvrg_id
AND bc.cvrg_cd = 'WCEMPLIAB' 
AND prc.CVRG_HIST_ID not in 
    (select VW_CVRG_LIMIT cl
     Where prc.CVRG_HIST_ID = cl.CVRG_HIST_ID)
",ETL - D_Cvrg_Limit,,11/5/2012,moreilly,,,,,,,,,,
BR-22136,220 Key Claim fields for Claim Adjuster,"Select KEY_CLAIM_OFFICE,
KEY_CLAIM_NUMBER,
KEY_CLAIMANT_NUMBER,
KEY_CLAIM_FEATURE,
CLAIM_NUMBER
From D_CLAIM_LEGACY_XREF
Where x.CLAIM_NO_CD = VWTA_CLAIM.CLM_NO_CD
and x.CLAIMANT_EBI_NO = VWTA_CLM_FEAT_CLAIMANT.PARTY_INST_EBI_NO 
and x.CLAIM_FEATURE_ORDER_NO = VWTA_CLM_FEAT.CLM_FEAT_ORDER_NO","ETL - D_Claim_Adjuster
ETL - F_Div_OS_Reserve",,9/23/2013,moreilly,,,,,,,,,,
BR-22137,221 Claim Adjuster Initials,"Create the ADJUSTER_INITIALS from the first character of each the FIRST_NM, MID_NM and LAST_NM 
Where PARTY_ROLE_CD = 'ASSIUSER''",ETL - D_Claim_Adjuster,,2/13/2013,moreilly,,,,,,,,,,
BR-22138,222 Claim Adjuster Activity Type Code,"If Source System = EDW
    Then Move 'I'
End-i8f",ETL - D_Claim_Adjuster,,10/17/2013,moreilly,,,,,,,,,,
BR-22139,223 Claim Adjuster Name,"Concatenate Last Name,First Name  Where PARTY_ROLE_CD = 'ASSIUSER",ETL - D_Claim_Adjuster,,2/13/2013,moreilly,,,,,,,,,,
BR-22177,224 Exclude Premium Transactions from FDW,"Select *
From D_POLICY p,
          EXCLUDE_PRODUCER e
Where p.POLICY_NUMBER = source.POLICY_NUMBER
    And p.POLICY_EFFECTIVE_DATE = source.POLICY_EFFECTIVE_DATE
    And p.PRODUCER_A_CODE = source.PRODUCER_CODE
    And p.PRODUCER_A_CODE = e.PRODUCER_CODE
    And p.souce_system_id = 48
If a row is already loaded for the policy, do not load the legacy one.  
",ETL - to exclude legacy policies,,2/28/2013,moreilly,"Create the table EXCLUDE_PRODUCER
Column Name	Data Type	Size	Optional or Required	Primary Key	Unique Key?
PRODUCER_CODE		10			1
PRODUCER_NAME		100			
POLICY_SYMBOL		5			
CREATION_DATE					
SOURCE_SYSTEM_ID					
",,,,,,,,,
BR-22181,"225 Farm Acreage	","When Building the UGL Stat Area, use the coverage code to determine the farm acreage.

Default to Zeros.

When the Coverage Code is equal to 'FPO', then set the Farm Acreage equal to the exposure amount associated to the coverage.

If CVRG_CD = ‘FPO’
  Then  FARM_ACREAGE = Exposure_amt 
 	(left fill with 0 if less than 10 bytes)
Else move ‘0000000000’  (10 zeros) 
End-if","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",,1/17/2018,mmconley,,,,,,,,,,
BR-22182,226 Farm Owned Leased Code,"When Building the UGL Stat Area, move the Farm Owned Leasde Code from the source system to the Owned Leased Code.","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",,5/2/2013,moreilly,,,,,,,,,,
BR-22183,227 Farm Type,"When Building the UGL Stat Area, move the Primary Farm Category from the source system to the Farm Type.","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",,5/2/2013,moreilly,,,,,,,,,,
BR-22184,228 Co Payment Percent,Move spaces to  'Co Payment Percent',"ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",,10/17/2013,moreilly,,,,,,,,,,
BR-22185,"229 Number of Families	","
 
","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses",,5/2/2013,moreilly,,,,,,,,,,
BR-22554,229.1 UIM Number of Families - Premiums,Set NO_OF_FAMILIES = '1',"ETL - D_Stat_Inland_Marine_Premiums

",,6/7/2016,mmconley,"sconley 8/10/15: Corrected rule to match Informatica.
1 character in UIM stat area",,,,,,,,,
BR-22553,229.2 UIM Number of Families - Losses,"When NO_OF_FAMILIES_CD = 'ONEFAMILY' OR 'TWOFAMILY' OR 'THREFAMILY'
  Set NO_OF_FAMILIES = '1'
  EXIT;

When NO_OF_FAMILIES_CD = 'GTFOURUNTS' OR 'MULTFAMILY'
  Set NO_OF_FAMILIES = '8'
  EXIT;

Set NO_OF_FAMILIES = '0'
  EXIT;","ETL - D_Stat_Inland_Marine_Losses
",,6/7/2016,mmconley,"sconley 8/10/15: Reformatted rule.
EDW source: vw_risk_structure.no_of_families_cd
1 character in UIM stat area",,,,,,,,,
BR-22551,229.3 UGL Number of Families - Premiums,"Set NO_OF_FAMILIES = ‘          ‘  (10 spaces)
  EXIT;","ETL - D_Stat_Liability_Premiums
",,6/7/2016,mmconley,"sconley 8/10/15: Broke UGL into 2 rules to match Informatica code.
10 characters in UGL stat area",,,,,,,,,
BR-23284,229.4 UGL Number of Families - Losses,"When NO_OF_FAMILIES_CD <> ‘0’
  Set NO_OF_ FAMILIES = NO_OF_FAMILIES_CD (lpad with ‘ ‘ (spaces) if less than 10 char)
  EXIT;

Set NO_OF_FAMILIES = ‘          ‘  (10 spaces)
  EXIT;",ETL - D_Stat_Liability_Losses,,6/7/2016,mmconley,"sconley 8/10/15: Broke UGL into 2 rules to match Informatica code.
EDW source: vw_risk_structure.no_of_families_cd
10 characters in UGL stat area",,,,,,,,,
BR-22186,"230 Supplemental ERP(Extended Reporting Period) Duration	","Concatenate the supplemental_erp_no || ‘ ‘ || supplemental_erp_unit_cd
(right fill with spaces)

","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",Defect 8193,6/1/2015,dburns4,"Data values will look like
 ""30 Days""

Per Julie Jordan on 2/26/15, this field was only to be populated on the premium side per PDC.  The field was added to the LK_STAT_FORMAT_TRANSLATION on both the premium and loss side.  Therefore since new field ATTACHMENT_POINT_SIZE_CODE was added and on the loss side the new field comes after these two, we will populate the Supplemental ERP Duration field with spaces so that the new field appears in the right place.

06/01/15 - adding documentation statement from Ann Benken that was initially related to the ELD project.  Ann was researching as to what was done for the ELD project with regard to SUPLERP coverage where only the expirtion date on the SUPLERP coverage changed and not on any of the other coverages.  Per Ann ""I have done some research on the Supplemental Extended Reporting period and found that the policy expiration dates should NOT change with the SUPLERP. Only the SUPLERP should have a different expiration date.""    Debbie and Rick researched that the FDW earn_expiration_date field on F_DIVISIONAL_PREMIUMS is taken from the coverage expiration date as a straight move from the EDW field to the FDW field.  ",,,,,,,,,
BR-22187,231 Supplemental ERP(Extended Reporting Period) End Date,"Move in format MMYYYY


","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses",Defect 8193,2/26/2015,dburns4,"Per Julie Jordan on 2/26/15, this field was only to be populated on the premium side per PDC.  The field was added to the LK_STAT_FORMAT_TRANSLATION on both the premium and loss side.  Therefore since new field ATTACHMENT_POINT_SIZE_CODE was added and on the loss side the new field comes after these two, we will populate the Supplemental ERP End DT field with spaces so that the new field appears in the right place.
",,,,,,,,,
BR-22680,232 Bodily Injury (BI) Deductible Code,"

Refer to business rule 100.2 for Bodily Injury (BI) deductible code
(which is DOORS ID-22801)


If  SRC_SYS_CD not!= ‘ENV-PAS’ and Product Value positions 1_2 
    or PV_1_2 = '41' and Coverage Code = 'AGRIGD'
Then select (UNDERLYING_LIMIT_AMT/1,000,000) = BI Deductible Code
If SRC_SYS_CD not = ‘ENV-PAS’ and Product Value positions 1_2 
    or PV_1_2 = '41' and Coverage Code <> 'AGRIGD' 
    and DEDUCT PURPOSE = ATTPOINT
Then select (DEDUCT_AMT/1,000,000) = BI Deductible Code
Else
Select Deduct Size CD
From LK_DEDUCT_SIZE_CODE
Where lk.STAT_CODE = 'UGL'
And LK.RISK_STATE = FIPS_US_ALPHA_CD
And LK.DEDUCT_DESC = CD.DEDUCT_BASIS
And (LK.DEDUCT_MIN_AMOUNT <= CD.DEDUCT_AMT <= LK.DEDUCT_MAX_AMOUNT)
If Not null
Then BI Deductible Code - Deduct Size CD
Else
If is null
Then
Select Deduct Size CD
From LK_DEDUCT_SIZE_CODE
Where lk.STAT_CODE = 'UGL'
And LK.RISK_STATE = 'XX'
And LK.DEDUCT_DESC = CD.DEDUCT_BASIS
And (LK.DEDUCT_MIN_AMOUNT <= CD.DEDUCT_AMT <= LK.DEDUCT_MAX_AMOUNT)
If Not null
Then BI Deductible Code = Deduct Size CD
Else BI Deductible Code = '  ' (2 spaces)
Use Pol Limit amt in Pol Limit Min/Max amoount with 'x' in Aggr Limit Min/Max amount
If Null go to the next line
If state <> 'TX' and Per Occur Limit Amt = 'x' (not equal to 0) or Aggr Pol Term Limit Amt = 'x' (not equal to 0)
Use Per Occur Limit in Pol Limit Min.Max Amount and Aggr Pol Term Limit Amt in Aggr Pol Term Limit Amt Min/Max amount.

",ETL - D_Stat_Liability_Premiums,Defect 8193,3/21/2016,moreilly,,,,,,,,,,
BR-22681,233 Physical Damage (PD) Deductible Code,"If Limit_Ind = 1
Then PD Deductible Code = BI Deductible Code
Else Null",ETL - D_Stat_Liability_Premiums,,11/10/2017,mmconley,,,,,,,,,,
BR-22682,234 Physical Damage (PD) Limit,"Move Null
",ETL - D_Stat_Liability_Premiums,,11/10/2017,mmconley,,,,,,,,,,
BR-22683,235 Bodily Injury (BI) Limit,"WHEN SRC_SYS_CD = 'ELD_PAS' and RATE_CLASS_CD = '81351'
	WHEN POL_LIMIT_AMT != 0 and 	AGGR_POL_TERM_LIMIT_AMT != 0
		SET code via LK_LIMIT_SIZE_CODE_AGGR_GL 			(POL_LIMIT_AMT, AGGR_POL_TERM_LIMIT_AMT)
		EXIT
	
	WHEN POL_LIMIT_AMT !=0 and AGGR_POL_TERM_LIMIT = 0
		SET code via LK_LIMIT_SIZE_CODE_AGGR_GL 			(POL_LIMIT_AMT)
		EXIT
	
	WHEN POL_LIMIT_AMT =0 and AGGR_POL_LIMIT != 0
		SET code via LK_LIMIT_SIZE_CODE_AGGR_GL 			(AGGR_POL_TERM_LIMIT_AMT)
		EXIT

WHEN SRC_SYS_CD != ENV-PAS and PER_OCCUR_LIMIT_AMT != 0 and PRODUCT_VALUE_1_2 = '41'
	SET BI_LIMIT = PER_OCCUR_LIMIT_AMT/1,000,000

WHEN SRC_SYS_CD != ENV-PAS and PRODUCT_VALUE_1_2 = '41'
	SET BI_LIMIT = POL_LIMIT_AMT/1,000,000

WHEN FIPS_US_ALPHA_CD = 'TX' and PER_OCCUR_LIMIT_AMT != 0 and AGGR_POL_TERM_LIMIT_AMT != 0
	SET BI_LIMIT = code from LK_LIMIT_SIZE_CODE_AGGR_GL 	('UGL', FIPS_US_ALPHA_CD, PER_OCCUR_LIMIT_AMT, 	AGGR_POL_TERM_LIMIT_AMT)
	EXIT

WHEN FIPS_US_ALPHA_CD = 'TX' and PER_OCCUR_LIMIT_AMT = 0 and AGGR_POL_TERM_LIMIT_AMT != 0
	SET BI_LIMIT = code from LK_LIMIT_SIZE_CODE_AGGR_GL 	('UGL', 'XX', AGGR_POL_TERM_LIMIT_AMT,0)
	EXIT

WHEN FIPS_US_ALPHA_CD = 'TX' and PER_OCCUR_LIMIT_AMT = 0 and AGGR_POL_TERM_LIMIT_AMT = 0
	SET BI_LIMIT = code from LK_LIMIT_SIZE_CODE_AGGR_GL 	('UGL', 'XX', POL_LIMIT_AMT)
	EXIT

WHEN FIPS_US_ALPHA_CD != 'TX' and PER_OCCUR_LIMIT_AMT = 0 and AGGR_POL_TERM_LIMIT_AMT != 0
	SET BI_LIMIT = code from LK_LIMIT_SIZE_CODE_AGGR_GL 	('UGL', 'XX', AGGR_POL_TERM_LIMIT_AMT,0)
	EXIT

WHEN FIPS_US_ALPHA_CD = 'TX' and PER_OCCUR_LIMIT_AMT = 0 and AGGR_POL_TERM_LIMIT_AMT = 0
	SET BI_LIMIT = code from LK_LIMIT_SIZE_CODE_AGGR_GL 	('UGL', 'XX', POL_LIMIT_AMT,0)
	EXIT

WHEN PER_OCCUR_LIMIT_AMT != 0 and AGGR_POL_TERM_LIMIT_AMT != 0
	SET BI_LIMIT = code from LK_LIMIT_SIZE_CODE_AGGR_GL 	('UGL', FIPS_US_ALPHA_CD, PER_OCCUR_LIMIT_AMT, 	AGGR_POL_TERM_LIMIT_AMT)
	EXIT

Default or Null value from LK table is:
	SET BI_LIMIT = ' '
	EXIT",ETL - D_Stat_Liability_Premiums,Data Platform 127 & 128,11/10/2017,mmconley,"dzieverink: 5/10/16: Updated the rule for DP 128 which was made because the lookup was only using the one value of Pol Limit Amt. It is now using the Pol Limit Amt and 0 for Aggr Limit Amt as intended to return the proper values from the LK table.

Also updated the format of the rule to be in the When/Set format for easier understanding.",,,,,,,,,
BR-23407,235.1 Previous Format of the Bodily Injury (BI) Limit,"If SRC_SYS_CD not = ‘ENV-PAS’ and Product Value_1_2 = '41' 
    then Bodily Injury Limit equals (Per Occur Limit Amt/1,000,000)
Else if SRC_SYS_CD not = ‘ENV-PAS’ and Product Value_1_2 <> '41'
Then
Select AGGR_LIMIT_SIZE_CD
From LK_LIMIT_SIZE_CODE AGGR
Where LK.STAT_CODE = 'UGL'
And LK.RISK_STATE = FIPS_US_ALPHA_CD
If this is null
Then
Select AGGR_LIMIT_SIZE_CD
From LK_LIMIT_SIZE_CODE AGGR
Where LK.STAT_CODE = 'UGL'
And LK.RISK_STATE = 'XX'
Else Null

If state = 'TX' and Per Occur Limit <> 0 or AGGR_POL_TERM_LIMIT_AMT <> 0
Use Per Occur Limit Amt in the Pol Limit MIN/MAX and AGGR_POL_TERM_LIMIT_AMT in the Aggr Limit Max/Min amount
if Null go to next line

If state = 'TX' and Per Occur Limit Amt = 'x' (not equal 0) and Aggr Pol Term Limit Amt = 'x' (not equal to 0)
Use Aggr Pol Term Limit Amt in the Pol Limit Min/Max with 'x' in the Aggr Limit Min/Max amount
If Null go to the next line

If state = 'TX' and Per Occur Limit does not equal 0 and Aggr Pol Term Limit Amt = 'x' (not equal to 0)
Use Pol Limit Amt in Pol Limit Min/Max amount
with 'x' for Aggr Limit Min/Max amount
If Null go to the next line

If state <> 'TX' and Aggr Pol Term Limit Amt <> 'x' (not equal to 0) and Per Occur Limit Amt = 'x' (not equal to 0)
Use Aggr Pol Term Limit Amt in Pol Limit Min/Max amount with 'x' for Aggr Limit Min/Max amount
If Null go to next line

If state <> 'TX' and Aggr Pol Term Limit Amt = 'x' (not equal to 0) and Per Occur Limit Amt = 'x' (not equal to 0)
Use Pol Limit amt in Pol Limit Min/Max amoount with 'x' in Aggr Limit Min/Max amount
If Null go to the next line

If state <> 'TX' and Per Occur Limit Amt = 'x' (not equal to 0) or Aggr Pol Term Limit Amt = 'x' (not equal to 0)
Use Per Occur Limit in Pol Limit Min.Max Amount and Aggr Pol Term Limit Amt in Aggr Pol Term Limit Amt Min/Max amount
This is the previous format of the rule. The new and updated rule is above.
",,,5/10/2016,dzieverink,Added a previous version of the above rule for documenting purposes.,,,,,,,,,
BR-22188,236 Receipt of Claims Notice Date,,ETL - D_Stat_Liability_Losses,,3/1/2013,lkummer,,,,,,,,,,
BR-22190,"237 Type of Loss	","
","ETL - D_Stat_Liability_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Losses
ETL - D_Stat_Property_Losses
ETL - D_Stat_Auto_Losses",,5/22/2013,moreilly,,,,,,,,,,
BR-22567,237.1 UCA Type of Loss - Losses,"If STAT_LOSS_CATG_LONG_DESC not in ('(none)') 
  Then TYPE_OF_LOSS = first 2 bytes of STAT_LOSS_CATG_LONG_DESC
Else
 If FIPS_US_Alpha_Cd = ‘TX’
    Then  TYPE_OF_LOSS = BUREAU_LOSS_LOC_CT_CD||
TX_BUREAU_LOSS_CATG_CD (first digit) 
Else  
  TYPE_OF_LOSS =  BUREAU_LOSS_LOC_CT_CD|| NON_TX_LOSS_CATG_CD (first digit) 
If null then type_of_loss = ‘00’","ETL - D_Stat_Auto_Losses
",,5/10/2016,mmconley,,,,,,,,,,
BR-22566,237.2 UPR Type of Loss - Losses,"If STAT_LOSS_CATG_LONG_DESC not in ('(none)') 
  Then TYPE_OF_LOSS = first 2 bytes of   
          STAT_LOSS_CATG_LONG_DESC
  Else
    If FIPS_US_Alpha_Cd = ‘TX’
      Then  TYPE_OF_LOSS = 
               BUREAU_LOSS_LOC_CT_CD||
               TX_BUREAU_LOSS_CATG_CD (first digit) 
      Else  TYPE_OF_LOSS =  
             BUREAU_LOSS_LOC_CT_CD||    
             NON_TX_LOSS_CATG_CD (first digit) 


/* BUREAU_LOSS_LOC_CT_CD, TX_BUREAU_LOSS_CATG_CD and NON_TX_LOSS_CATG_CD were created with UD Equine.  Later UD Agri stored STAT_LOSS_CATG_LONG_DESC.  UD Equine then changed to use STAT_LOSS_CATG_LONG_DESC.  We removed the original 3 columns from d_claim_support and added STAT_TYPE_OF_LOSS_CD.  The stat-area ETL left the code in it as a safeguard for claims that were previously booked and might have a later payment on them.  */",ETL - D_Stat_Property_Losses,,5/3/2016,mmconley,2/22/16 sconley: The fields can be found on EDW in tables FDW.S_D_STAT_FORMAT_LOSS_STG1 and FDW.S_D_STAT_FORMAT_LOSS_STG2.,,,,,,,,,
BR-22565,237.3 UIM Type of Loss - Losses,"If STAT_LOSS_CATG_LONG_DESC not in ('(none)') 
  Then TYPE_OF_LOSS = first 2 bytes of STAT_LOSS_CATG_LONG_DESC
  Else-If FIPS_US_Alpha_Cd = ‘TX’
    Then  TYPE_OF_LOSS = BUREAU_LOSS_LOC_CT_CD||
TX_BUREAU_LOSS_CATG_CD (first digit) 
    Else  TYPE_OF_LOSS =  BUREAU_LOSS_LOC_CT_CD|| NON_TX_LOSS_CATG_CD (first digit) 
Else TYPE_OF_LOSS =  ‘00’","ETL - D_Stat_Inland_Marine_Losses
",,5/10/2016,mmconley,"7/31/15 sconley: EDW source:
Vw_Claim_Feat_Hist.Stat_Loss_Catg_Long_Desc
Vw_Claim_Feat_Hist.Bureau_Loss_Ct_Cd
Vw_Claim_Feat_Hist.Non_TX_Loss_Ct_Cd
vw_place_state_province.state_province_nm
where vw_risk_place.catg_cd = 'RSA'",,,,,,,,,
BR-22564,237.4 UFC Type of Loss - Losses,"If subline = ‘965’(ISO Burglary & Theft)
    Type of loss = ‘  ‘ (2 spaces)
Else
    If subline = ‘001’(SAA-Monoline Fidelity/Crime)
        if type_of_policy = 01 or 02 
            and if  FIPS_US_Alpha_Cd <>TX
           then  type_0f_loss = ‘  ‘ (2 spaces)                                  
        else
             If STAT_LOSS_CATG_LONG_DESC not ='(none)' 
                STAT_TYPE_OF_LOSS = first 2 bytes of STAT_LOSS_CATG_LONG_DESC
          Else
            If FIPS_US_Alpha_Cd = ‘TX’
               STAT_TYPE_OF_LOSS = BUREAU_LOSS_LOC_CT_CD||
               TX_BUREAU_LOSS_CATG_CD (first digit) 
            Else  STAT_TYPE_OF_LOSS =  
                    BUREAU_LOSS_LOC_CT_CD|| NON_TX_LOSS_CATG_CD (first digit) 
     Else ‘00’",ETL - D_Stat_Crm_Fdlty_Srty_Losses,,5/10/2016,mmconley,"DECODE (true
         ,SUBLINE_CD='965'  , ' '
         ,SUBLINE_CD='001'  AND IN  (v_TYPE_OF_POLICY,   '01',   '02') AND RS_FIPS_US_ALPHA_CD <> 'TX' , ' '
         ,STAT_LOSS_CATG_LONG_DESC<>'(none)'  , SUBSTR(STAT_LOSS_CATG_LONG_DESC,1,2)
       ,RS_FIPS_US_ALPHA_CD <> 'TX'  , BUREAU_LOSS_LOC_CT_CD || SUBSTR   (NON_TX_LOSS_CATG_CD,1,1)
         ,RS_FIPS_US_ALPHA_CD = 'TX'  , BUREAU_LOSS_LOC_CT_CD || SUBSTR(TX_BUREAU_LOSS_CAT_CD,1,1) 
         ,'00'
",,,,,,,,,
BR-22562,237.5 UGL Type of Loss - Losses,"If STAT_LOSS_CATG_LONG_DESC not in ('(none)') 
  Then TYPE_OF_LOSS = first 2 bytes of STAT_LOSS_CATG_LONG_DESC
  Else-If FIPS_US_Alpha_Cd = ‘TX’
    Then  TYPE_OF_LOSS = BUREAU_LOSS_LOC_CT_CD||
TX_BUREAU_LOSS_CATG_CD (first digit) 
    Else  TYPE_OF_LOSS =  BUREAU_LOSS_LOC_CT_CD|| NON_TX_LOSS_CATG_CD (first digit) 
Else TYPE_OF_LOSS =   ‘00’
","ETL - D_Stat_Liability_Losses
",,5/10/2016,mmconley,,,,,,,,,,
BR-23448,237.6 UWC Type of Loss - Losses,"When VW_CLM_FEAT_HIST.STAT_LOSS_CATG_SHORT_DESC = '(none)' 
   Set TYPE_OF_LOSS to NULL
   EXIT;

Set TYPE_OF_LOSS = VW_CLM_FEAT_HIST.STAT_LOSS_CATG_SHORT_DESC (1st 2 positions)",ETL - D_Stat_Work_Comp_Losses,,1/9/2017,mmconley,,,,,,,,,,
BR-22192,238 Processing Office Code,"ADW view (VWTA_POL_TERM_PROCESSNG_OFFICE)  selects parties associated to the policy with a role of PO (pol_term_party_snapshot.role_cd = 'PO') which is the code for processing office 
",ETL - D_Policy_Daily,,3/5/2013,moreilly,,,,,,,,,,
BR-22193,239 Primary Farm Category,"SELECT *
FROM vw_pol_risk, 
vw_risk, 
vw_risk_hist 
WHERE vw_risk.risk_id = vw_risk_hist.risk_id 
AND vw_pol_risk.risk_id = vw_risk.risk_id   
AND vw_risk.risk_catg_cd = 'FRMBUSN'",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22194,240 Owned - Leased Code,"SELECT *
FROM vw_pol_risk, 
vw_risk, 
vw_risk_hist 
WHERE vw_risk.risk_id = vw_risk_hist.risk_id  
AND vw_pol_risk.risk_id = vw_risk.risk_id  
AND vw_risk.risk_catg_cd IN ('FRMDWL', 'FRMSTRUCT', 'BLDG')",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22195,241 Safeguard Code,"SELECT safeguard_cd
FROM vw_risk_structure_safeguard 
WHERE safeguard_cd = 'SPRINKLER'",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22196,242 Coverage Child PF,"SELECT cc.cvrg_cd 
FROM vw_cvrg_rel crel, 
vw_coverage cc  
WHERE crel.child_cvrg_id = cc.coverage_id  
AND cc.cvrg_cd IN ('BASIC', 'BROAD', 'BROADSPCL', 'SPECIAL') 
AND crel.action_cd IN ('A', 'E')),",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22197,243 Coverage Child WEX,"See BR-23454  288 Wind Catastrophe Indicator – UPR Premiums

SELECT cc.cvrg_cd 
FROM vw_cvrg_rel crel, 
vw_coverage cc  
WHERE crel.child_cvrg_id = cc.coverage_id
AND cc.cvrg_cd IN ('WINDEXCL')  
AND crel.action_cd IN ('A', 'E'))",ETL - VWA_Stat_Premiums,,3/15/2017,mmconley,3/15/17 sconley: Updated to reference BR-23454 Wind Catastrophe Indicator – UPR Premiums,,,,,,,,,
BR-22198,244 Furnished By Employer,If null then 0,ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22199,245 Principally Operated by Employee,If null then 0,ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22200,246 Special Use Category Code,If null then 0,ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22201,247 Employee Covered by Work Compensation,If null then 0,ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22202,248 UM Stacking,"SELECT * 
FROM vw_cvrg_place 
WHERE catg_cd = 'CL'
If null then 0",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22203,249 UIM Stacking,"SELECT * 
FROM vw_cvrg_place 
WHERE catg_cd = 'CL'
If null then 0",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22204,250 Policy Term Form SICC1 ,"SELECT * 
FROM vw_pol_term_form 
WHERE form_id IN ('CA2384', 'CA2386', 'CA2388', 'CA2392') 
AND action_cd IN ('A', 'E',’C’)  
IF NULL 
  THEN '0' 
ELSE '1'",ETL - VWA_Stat_Premiums,,9/1/2017,mmconley,,,,,,,,,,
BR-22205,251 Policy Term Form SICC2,"SELECT *  
FROM vw_pol_term_form 
WHERE form_id IN ('CA2385', 'CA2387', 'CA2389', 'CA2393') 
AND action_cd IN ('A', 'E',’C’) 
IF NULL 
  THEN '0' 
ELSE '1'",ETL - VWA_Stat_Premiums,,9/1/2017,mmconley,,,,,,,,,,
BR-22206,252 Policy Term Form UGL MDC (Mold Damage Code) ,"SELECT * 
FROM vw_pol_term_form 
WHERE form_id IN ('AL7487') 
AND action_cd IN ('A', 'E',’C’) 
IF NULL 
  THEN '0' 
ELSE '1'",ETL - VWA_Stat_Premiums,,10/4/2017,mmconley,sconley 10/4/17: Input to rule for UGL MOLD_DAMAGE_CODE,,,,,,,,,
BR-22207,253 Policy Term Form UPR MDC1 (Mold Damage Code),"SELECT *
FROM vw_pol_term_form 
WHERE form_id IN ('AP8741', 'AP8743') 
AND action_cd IN ('A', 'E',’C’) 
IF NULL 
  THEN FDW.LKP_PFC_PTF.PTF_UPR_MDC1_IND = '0' 
ELSE FDW.LKP_PFC_PTF.PTF_UPR_MDC1_IND = '1'",ETL - VWA_Stat_Premiums,,10/4/2017,mmconley,"sconley 9/15/17: Added staging table and field name on EDW in FDW schema.

sconley 10/4/17: Input to rule for UPR MOLD_DAMAGE_CODE",,,,,,,,,
BR-22208,254 Policy Term Form UPR MDC2 (Mold Damage Code),"SELECT * 
FROM vw_pol_term_form 
WHERE form_id IN ('AP8740', 'AP8744') 
AND action_cd IN ('A', 'E',’C’) 
IF NULL 
  THEN FDW.LKP_PFC_PTF.PTF_UPR_MDC2_IND = '0' 
ELSE FDW.LKP_PFC_PTF.PTF_UPR_MDC2_IND = '1'",ETL - VWA_Stat_Premiums,,10/4/2017,mmconley,"sconley 9/15/17: Added staging table and field name on EDW in FDW schema.

sconley 10/4/17: Input to rule for UPR MOLD_DAMAGE_CODE",,,,,,,,,
BR-22209,255 Policy Term Form UPR OLCC (Ordinance or Law Coverage Code),"SELECT *  
FROM vw_pol_term_form 
WHERE form_id IN ('AP7286', 'AP7287')
AND action_cd IN ('A', 'E',’C’) 
IF NULL 
  THEN '0' 
ELSE '1'",ETL - VWA_Stat_Premiums,,10/4/2017,mmconley,sconley 10/4/17: Input to rule for UPR ORDINANCE_LAW_COV_ID_CODE,,,,,,,,,
BR-22228,256 Policy Term Form UFC SFAA,"SELECT *  
FROM vw_pol_term_form 
WHERE form_id IN (‘CR1044’, ‘CR1009’, ‘CR2518’, ‘CR2519’, ‘CR2543’) 
AND action_cd IN ('A', 'E',’C’) 
IF NULL 
  THEN 0
ELSE 1",ETL - VWA_Stat_Premiums,,9/16/2014,mmconley,9/16/14 S. Conley:  This rule creates variable PTF_UFC_SFAA_IND used in BR-22506 UFC Coverage Code - Premiums and Losses.   Added out link to to BR-22506.  Removed quotes from values.   ,,,,,,,,,
BR-22210,257 Eliminate Spousal,If null then 0,ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22211,258 Eliminate Medical Expense,If null then 0,ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22212,259 Exclude Work Loss Benefit,If null then 0,ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22213,260 Waive PIP Benefits,If null then 0,ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22214,261 Defensive Driver Credit Indicator,"Select rate_fctr
 From vw_cvrg_rate_fctr
Where vw.coverage_rating_id = agg.coverage_rating_id
And catg_cd = ‘ACCPREVCRS’
If NULL 
  Then '0' 
Else 
 If rate_fctr < 1
   Then ‘1’
Else ‘0’",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22215,262 New York Supplemental Spousal,"Select rate_fctr
 From vw_cvrg_rate_fctr
Where vw.coverage_rating_id = agg.coverage_rating_id
And catg_cd = ‘SPOUSAL’
If NULL 
  Then '0' 
Else 
  If rate_fctr = 1
   Then ‘1’
  Else ‘0’",ETL - VWA_Stat_Premiums,,5/10/2013,moreilly,,,,,,,,,,
BR-22220,263 Additional PIP Exists (ADPIP),"Set the ADPIP_EXISTS_IND = 1 when the cvrg_cd = PIP and an ADPIP row exists  for the vehicle (at the edw_trans_id, risk_id level) 
Set ADPIP_EXISTS_IND = 0 on all other PIP rows, else set = NULL if not PIP.",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22221,264 Medical Expense Benefit Limit Amount,"Select limit_amt
Where the parent cvrg_cd in (‘ADPIP’, NIABP’)
And child cvrg_cd = ‘MEDEXPBEN’ ",ETL - VWA_Stat_Premiums,,9/17/2013,moreilly,,,,,,,,,,
BR-22222,265 Additional PIP Monthly Work Loss Amount,"Select limit_amt
Where the parent cvrg_cd in (‘ADPIP’, NIABP’)
And child cvrg_cd = ‘APMOWOLOS’ 
And basis_cd = ‘PMONTHPACC’",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22223,266 Additional PIP Aggregate  Work Loss Amount,"Select limit_amt
Where the parent cvrg_cd in (‘ADPIP’, NIABP’)
And child cvrg_cd = ‘APMOWOLOS’ 
And basis_cd = ‘AGGPERPACC’",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22224,267 Accidental Death Benefit Amount,"Select limit_amt
Where the parent cvrg_cd in (‘ADPIP’, NIABP’)
And child cvrg_cd = ‘ACCDEABEN’ ",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22225,268 Additional PIP Funeral Expense Amount,"Select limit_amt
Where the parent cvrg_cd in (‘ADPIP’, NIABP’)
And child cvrg_cd = ‘APFUNEXP’ ",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22226,269 Extended Medical Expense Benefit,"Select limit_amt
Where the parent cvrg_cd in (‘PIP’)
And child cvrg_cd = ‘XTMEDBEN’ ",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22227,270 Combination First Party Benefits,"Select limit_amt
Where the parent cvrg_cd in (‘PIP’)
And child cvrg_cd = ‘COMBNFPB’ ",ETL - VWA_Stat_Premiums,,3/13/2013,moreilly,,,,,,,,,,
BR-22240,"271 Discovery Date	","If Stat_Format_Code = 'UFC'
   Move Blank
End-If",ETL - D_Stat_Crm_Fdlty_Srty_Losses,,5/23/2013,moreilly,,,,,,,,,,
BR-22498,272 Construction Type,"

","ETL - D_Stat_Inland_Marine_Premiums	
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Property_Losses",,5/22/2013,moreilly,"for premium inland marine:
the original etl also had 
STRUCTURE_CONSTRUC_CD LIKE (‘MOB%’) in the spec.  The code does not reflect this and we are not changing at this time because there is a p&K rule that makes this field a 1 when the class code is 335, 336,  149 or 800.  This should cover all of these.  Currently the UD is not sending a null value down for structure_contruc_cd for those class codes so the p&k rule works well.   Loss have the like 'MOB' code",,,,,,,,,
BR-23348,272.1 UPR Construction Type - Premiums and Losses,"When Subline <> ‘930’ 
(rules for Non-Earthquake)
Left fill with '0' to create the 2 char construction_type.
------------------------------------------------------------------

(For ISO Property & DIC, the EDW.vw_risk_structure fields are on parent risk BLDG for risks PERSPROP, TIMELEMENT, and IMPROVMNTS. See comments.)

When SUBLINE_CD in ('015', '016', '017', '018', '035', '037', '039', '045', '055', '067', '069', '077', '079');
STRUCTURE_CONSTRUC_CD = '0';
    Set CONSTRUCTION_TYPE = '  ' (2 spaces);
    EXIT

When SUBLINE_CD in ('011, '012', '013', '014');
STRUCTURE_CONSTRUC_CD = '0';
    Set CONSTRUCTION_TYPE = '09';
    EXIT

When SUBLINE_CD in ('011, '012', '013', '014', '015', '016', '017', '018', '035', '037', '039', '045', '055', '067', '069', '077', '079');
STRUCTURE_CONSTRUC_CD in ('ALLOTHER', 'MIXEDCONST', 'MSNNONCOMB');
    Set CONSTRUCTION_TYPE = '04';
    EXIT

When SUBLINE_CD in ('011, '012', '013', '014', '015', '016', '017', '018', '035', '037', '039', '045', '055', '067', '069', '077', '079');
STRUCTURE_CONSTRUC_CD = 'FIRERES';
    Set CONSTRUCTION_TYPE = '06';
    EXIT
  
When SUBLINE_CD in ('011, '012', '013', '014', '015', '016', '017', '018', '035', '037', '039', '045', '055', '067', '069', '077', '079');
STRUCTURE_CONSTRUC_CD = 'FRAME';
    Set CONSTRUCTION_TYPE = '01';
    EXIT

When SUBLINE_CD in ('011, '012', '013', '014', '015', '016', '017', '018', '035', '037', '039', '045', '055', '067', '069', '077', '079');
STRUCTURE_CONSTRUC_CD = 'JOISTMASON';
    Set CONSTRUCTION_TYPE = '02';
    EXIT
  
When SUBLINE_CD in ('011, '012', '013', '014', '015', '016', '017', '018', '035', '037', '039', '045', '055', '067', '069', '077', '079');
STRUCTURE_CONSTRUC_CD = 'MODFIRERES';
    Set CONSTRUCTION_TYPE = '05';
    EXIT
   
When SUBLINE_CD in ('011, '012', '013', '014', '015', '016', '017', '018', '035', '037', '039', '045', '055', '067', '069', '077', '079');
STRUCTURE_CONSTRUC_CD = 'NONCOMBST';
    Set CONSTRUCTION_TYPE = '03';
    EXIT

When SUBLINE_CD in ('027', '029');
STRUCT_GROUP2_MDM_CD IS NULL;
    Set CONSTRUCTION_TYPE = '  ' (2 spaces);
    EXIT

When SUBLINE_CD in ('027', '029');
    Set CONSTRUCTION_TYPE = STRUCT_GROUP2_MDM_CD;
    EXIT

When STRUCTURE_CONSTRUC_CD IN ('FRAME', 'MOBILE') or STRUCTURE_CONSTRUC_CD like ('MOB%');
    Set CONSTRUCTION_TYPE = '1';
    EXIT

When STRUCTURE_CONSTRUC_CD IN ('BRICKVEN', 'MASON');
    Set CONSTRUCTION_TYPE = '2';
    EXIT
	 
When STRUCTURE_CONSTRUC_CD IN ('STEEL', 'NONCOMB');
    Set CONSTRUCTION_TYPE = '3';
    EXIT

Set CONSTRUCTION_TYPE = '  ' (2 spaces);
EXIT

Comments:
---------------
See BR-23466 for additional information.
For ISO Property & ISO DIC:
-The physical building attributes (fields) are on risk BLDG.
- PERSPROP, TIMELEMENT, & IMPROVMNTS are children of BLDG and the physical building attributes are not populated.
-Determine parent BLDG risk of PERSPROP, TIMELEMENT, & IMPROVMNTS risks.
-Select vw_risk_structure fields from parent BLDG in order to set construction_type for PERSPROP, TIMELEMENT, & IMPROVMNTS.
- For BLDG, select vw_risk_structure fields from BLDG in order to set construction_type.
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses","FDW_Core 10217: UPR Earthquake: New requirements for CONSTRUCTION_TYPE and NO_OF_STORIES

FDW_Core 9593: Expand CONSTRUCTION_TYPE to 2 char in UPR Stat Area for Premiums

Jira DP-1172

sconley: ENTERPRISE.Data_Platform Defect 1981 Get BLDG Attributes for PERSPROP, TIMELEMENT, IMPROVMNTS; Update UPR CONSTRUCTION_TYPE; DP-9775, US15622",7/10/2017,mmconley,"sconley 10/13/15:
Reformattted Business Rules to break-out earthquake requirements.
Subline 930 is for Earthquake.

sconley 1/25/16 Updates for FDW_Core 10217: Added left fill with '0' and make default 2 spaces.   

3/14/16 sconley: Updated QC # to 10217 for CONSTRUCTION_TYPE & NO_OF_STORIES and 9593 for Expansion of CONSTRUCTION_TYPE.

sconley 7/10/17: Updated rules with requirements for ISO Property & DIC; QC 1981, DP-9775, US15622
",,,,,,,,,
BR-22592,272.2 UPR Construction Type Earthquake - Premiums and Losses,"Select these fields from VW_RISK_STRUCTURE needed to determine CONSTRUCTION_TYPE:
(For UDPIM & BRIDGE-PAS Builders Risk, the EDW.vw_risk_structure fields are on parent risk JOBSITE.  For ISO Property & DIC, the EDW.vw_risk_structure fields are on parent risk BLDG.  See comments below.)

  STRUCTURE_CONSTRUC_CD (cannot be NULL)
  STORIES_CNT
  SQUARE_FOOTAGE_NO
  STRUCT_EARTHQUAKE_MDM_CD

/* Earthquake for ISO Property & ISO DIC */
When SUBLINE_CD = '930' 
RISK_CATG_CD in ('BLDG', 'PERSPROP', 'TIMELEMENT', 'IMPROVMNTS')
PARENT RISK_CATG_CD = 'BLDG' if RISK_CATG_CD in ('PERSPROP', 'TIMELEMENT', 'IMPROVMNTS')
VW_RISK_STRUCTURE is populated;
(rules for when vw_risk_structure is populated)
----------------------------------------------------------------------------
When STRUCT_EARTHQUAKE_MDM_CD = '1C';
    Set CONSTRUCTION_TYPE = '13';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '1D';
    Set CONSTRUCTION_TYPE = '14';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '2A';
    Set CONSTRUCTION_TYPE = '21';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '2B';
    Set CONSTRUCTION_TYPE = '22';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '3A';
    Set CONSTRUCTION_TYPE = '31';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '3B';
    Set CONSTRUCTION_TYPE = '32';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '3C';
    Set CONSTRUCTION_TYPE = '33';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '4A';
    Set CONSTRUCTION_TYPE = '41';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '4B';
    Set CONSTRUCTION_TYPE = '42';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '4C';
    Set CONSTRUCTION_TYPE = '43';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '4D';
    Set CONSTRUCTION_TYPE = '44';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '5A';
    Set CONSTRUCTION_TYPE = '51';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '5AA';
    Set CONSTRUCTION_TYPE = '55';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '5B';
    Set CONSTRUCTION_TYPE = '52';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '5C';
    Set CONSTRUCTION_TYPE = '53';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '6';
    Set CONSTRUCTION_TYPE = '60';
    EXIT

When STRUCT_EARTHQUAKE_MDM_CD = '7';
    Set CONSTRUCTION_TYPE = '70';
    EXIT

/*Default */
When STRUCT_EARTHQUAKE_MDM_CD IS NULL or VW_RISK_STRUCTURE is not populated;
    Set CONSTRUCTION_TYPE = '  ';  (2 spaces)
    EXIT


/* Earthquake for Agri and Property & Inland Marine */
When SUBLINE_CD = '930' 
SRC_SYS_CD in ('UDAGRI', 'UDPIM', 'BRIDGE-PAS');
VW_RISK_STRUCTURE is populated;
(rules for when vw_risk_structure is populated)
------------------------------------------------------------------
When STRUCTURE_CONSTRUC_CD = 'ALLOTHER';
    Set CONSTRUCTION_TYPE = '70';
    EXIT

When STRUCTURE_CONSTRUC_CD in ('JOISTMASON', 'MSNNONCOMB', 'MASON', 'BRICKVEN');
    Set CONSTRUCTION_TYPE = '55';
    EXIT

When STRUCTURE_CONSTRUC_CD = 'MIXEDCONST';
    Set CONSTRUCTION_TYPE = '53';
    EXIT

When STRUCTURE_CONSTRUC_CD in ('FIRERES', 'FIRERESIST', 'MODFIRERES', 'STEEL');
    Set CONSTRUCTION_TYPE = '41';
    EXIT

When STRUCTURE_CONSTRUC_CD in ('NONCOMB', 'NONCOMBST');
    Set CONSTRUCTION_TYPE = '32';
    EXIT

When STRUCTURE_CONSTRUC_CD in ('FRAME', 'STUCCOASB');
STORIES_CNT > 3;
    Set CONSTRUCTION_TYPE = '14';
    EXIT

When (STRUCTURE_CONSTRUC_CD in ('FRAME', 'STUCCOASB', 'MOBFTA894', 'MOBFTASCE', 'MOBFTB894', 'MOBILE', 'MOBOTFT', 'MOBUNKN');
(STORIES_CNT < 3 or STORIES_CNT IS NULL);
    Set CONSTRUCTION_TYPE = '13';
    EXIT

When STRUCTURE_CONSTRUC_CD in ('FRAME', 'STUCCOASB');
STORIES_CNT = 3;
SQUARE_FOOTAGE_NO < 3001;
    Set CONSTRUCTION_TYPE = '13';
    EXIT

When STRUCTURE_CONSTRUC_CD in ('FRAME', 'STUCCOASB');
    Set CONSTRUCTION_TYPE = '14';
    EXIT

When STRUCTURE_CONSTRUC_CD = '0';
    Set CONSTRUCTION_TYPE = '13';
    EXIT

*Default if src_sys_cd is not UDAGRI or UDPIM or BRIDGE-PAS, or if vw_risk_structure is not populated.
When SUBLINE_CD = '930';
SRC_SYS_CD not in ('UDAGRI', 'UDPIM', 'BRIDGE-PAS') or VW_RISK_STRUCTURE is not populated;
    Set CONSTRUCTION_TYPE = '13';
    EXIT


Comments:
--------------
For UDPIM & BRIDGE-PAS Builders Risk:
-The physical jobsite characteristics (fields) are on risk JOBSITE.
-The risk category for Earthquake coverage (EQ) is COVPROP.
-COVPROP is a child of JOBSITE and the physical jobsite fields are not populated.
-Determine parent JOBSITE risk of COVPROP risk.
-Select vw_risk_structure fields from parent JOBSITE in order to set construction_type for COVPROP/EQ.
-VW_RISK_STRUCTURE fields are not populated on the policy level risks, VW_POL_RISK_HIST.SCHDL_NO = 0.

For ISO Property & DIC Earthquake:
See BR-23466 for additional information.
-The physical building attributes (fields) are on risk BLDG.
-The risk categories for Earthquake coverage (EQ) are BLDG, PERSPROP, TIMELEMENT, & IMPROVMNTS.
- PERSPROP, TIMELEMENT, & IMPROVMNTS are children of BLDG and the physical building attributes are not populated.
-Determine parent BLDG risk of PERSPROP, TIMELEMENT, & IMPROVMNTS risks.
-Select vw_risk_structure fields from parent BLDG in order to set construction_type for PERSPROP, TIMELEMENT, & IMPROVMNTS EQ.
- For BLDG, select vw_risk_structure fields from BLDG in order to set construction_type for EQ..
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses","FDW_Core 10217: UPR Earthquake: New requirements for CONSTRUCTION_TYPE and NO_OF_STORIES

FDW_Core 9593: Expand CONSTRUCTION_TYPE to 2 char in UPR Stat Area for Premiums

dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202)

sconley: ENTERPRISE.Data_Platform Defect 1981 Get BLDG Attributes for PERSPROP, TIMELEMENT, IMPROVMNTS; Update UPR CONSTRUCTION_TYPE; DP-9775, US15622",7/10/2017,mmconley,"sconley 10/13/15:
Reformattted Business Rules to break-out earthquake requirements.
Subline 930 is for Earthquake. 

sconley 1/25/16: Updates for FDW_Core 10217.
These Agri risks/coverages do not have structure data in EDW:
FPOPS / POLEQLOFI
FPP / FPEEQK
FPP / FPFEQK
FRMLOC / LOCEQE
FRMLOC / LOCEQF
FRMLOC / LOCEQLOFI

For UDPIM Builders Risk:
-The physical jobsite characteristics (fields) are on risk JOBSITE.
-The risk category for Earthquake coverage (EQ) is COVPROP.
-COVPROP is a child of JOBSITE and the physical jobsite fields are not populated.
-Determine parent JOBSITE risk of COVPROP risk.
-Select vw_risk_structure fields from parent JOBSITE in order to set construction_type for COVPROP/EQ.
-VW_RISK_STRUCTURE fields are not populated on the policy level risks, VW_POL_RISK_HIST.SCHDL_NO = 0. 

3/14/16 sconley: Updated QC # to 10217 for CONSTRUCTION_TYPE & NO_OF_STORIES and 9593 for Expansion of CONSTRUCTION_TYPE.

sconley 7/10/17: Updated rules with requirements for ISO Property & DIC; QC 1981, DP-9775, US15622


",,,,,,,,,
BR-22569,272.3 UIM Construction Type - Premiums,"WHEN STRUCTURE_CONSTRUC_CD IN (‘FRAME’, ’MOBILE’) or 
   THEN ‘1’
WHEN STRUCTURE_CONSTRUC_CD = 'JOISTMASON'
   THEN '2'
WHEN STRUCTURE_CONSTRUC_CD IN (‘STEEL’, ‘BRICKVEN’, ‘NONCOMB’,         ‘MASON’,'NONCOMBST')
  THEN ‘3’
WHEN STRUCTURE_CONSTRUC_CD = 'MSNNONCOMB'
  THEN '4'
WHEN STRUCTURE_CONSTRUC_CD = 'MODFIRERES'
  THEN '5'
WHEN STRUCTURE_CONSTRUC_CD = 'FIRERES'
  THEN '6'  
ELSE ‘0’",ETL - D_Stat_Inland_Marine_Premiums,,7/31/2018,awhalen,sconley 8/28/17: Added part of rule that was missing.,,,,,,,,,
BR-22568,272.4 UIM Construction Type - Losses,"             WHEN STRUCTURE_CONSTRUC_CD IN (‘FRAME’, ’MOBILE’) or positions 1 for  3 = 'MOB' 
	THEN ‘1’
             WHEN STRUCTURE_CONSTRUC_CD IN (‘STEEL’, ‘BRICKVEN’, ‘NONCOMB’,  ‘MASON’)
	THEN ‘3’
                ELSE ‘0’             
",ETL - D_Stat_Inland_Marine_Losses,,7/13/2017,mmconley,,,,,,,,,,
BR-22500,273 Protection Code ,,"ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Property_Losses",,5/22/2013,moreilly,,,,,,,,,,
BR-22571,273.1 UIM Protection Code - Premiums and Losses,"IF FIRE_PROTECT_CLASS_CD is not null
then PROTECTION_CD = FIRE_PROTECT_CLASS_CD
          (left fill 0 if only 1 digit entered)
else PROTECTION_CD = '00'","ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses",,7/13/2017,mmconley,sconley 7/13/17 Updated to note rule is also for premiums,,,,,,,,,
BR-22570,273.2 UPR Protection Code - Premiums and Losses,"/* FIRE_PROTECT_CLASS_CD is found in EDW view VW_PLACE_PHYSICAL.FIRE_PROTECT_CLASS_CD */

/* Class Codes are for Livestock (064%), Machinery - blanket (069%), and Machinery - scheduled (071%) */
When RS_FIPS_US_ALPHA_CD < > 'LA'
RATE_CLASS_CODE in ('064%', '069%', '071%')
  Set PROTECTION_CODE = '  ' (2 spaces)
  EXIT

/* Only applies to these sublines for ISO Property. Per PDC request, sublines 081-086 are not currently used but added to rule in the event they are used in the future. */
When SUBLINE_CD in ('011', '012', '013', '014', '015', '016', '017', '018', '081', '082', '083', '084', '085', '086')
  Set PROTECTION_CODE using this conversion chart.
  FIRE_PROTECT_CLASS_CD	PROTECTION_CODE
  EDW Value			FDW Value
  0				'  ' (2 spaces)
  1				01
  10				10
  10W				20
  1X				12
  1Y				13
  2				02
  2X				22
  2Y				23
  3				03
  3X				32
  3Y				33
  4				04
  4X				42
  4Y				43
  5				05
  5X				52
  5Y				53
  6				06
  6X				62
  6Y				63
  7				07
  7X				72
  7Y				73
  8				08
  8B				19
  8X				82
  8Y				83
  9				09
  9E				15
  9S				11
  
  EXIT

/* Agri Farm Sublines */
When SUBLINE_CD in ('106', '116', '136', '156')
FIRE_PROTECT_CLASS_CD <> '0' 
FIRE_PROTECT_CLASS_CD IS NOT NULL
  Set PROTECTION_CODE = FIRE_PROTECT_CLASS_CD (left pad with 0 (zero) to make length 2(char))
  EXIT

/*
-When the Protection Class Cd is not populated for the risk, use the highest Protection Class Cd of all risks for that transaction (submission).
-This only applies to the Agri Farm Sublines listed in the rule.
-Lookup table is finding the max Protection Code for the transaction and is stored on the table as HIGHEST_FIRE_PROTECT_CLASS_CD along with the EDW_TRANS_ID. The look-up is by EDW_TRANS_ID in EDW on the FDW schema table LKP_STAT_PREM_FIRE_PROTECT. See comments for addtional information.
*/
When SUBLINE_CD in ('106', '116', '136', '156') LKP_STAT_PREM_FIRE_PROTECT.HIGHEST_FIRE_PROTECT_CLASS_CD is NOT NULL
  Set PROTECTION_CODE = HIGHEST_FIRE_PROTECT_CLASS_CD (left pad with 0 (zero) to make length 2(char))
  EXIT

/* For all other sublines Protection Code is not required for reporting so set to 2 spaces or when data does not hit any of the above logic set to 2 spaces */
Set PROTECTION_CODE = '  ' (2 spaces)","ETL - D_Stat_Property_Losses
ETL - D_Stat_Property_Premiums","FDW_Core 4484 
DP 206

QC DP-1172

sconley 3/9/17: ENTERPRISE.Data_Platform 1472 UPR Stat Area Fixes for CONSTRUCTION_CD and PROTECTION_CODE for ISO Property; DP-8024

sconley 4/7/17, 5/18/17:
ENTERPRISE.Data_Platform 1683 FDW ETL Changes for UPR PROTECTION_CODE for ISO Property; DP-8711, DP-9668
",5/18/2017,mmconley,"dzieverink - Added more source systems to the filter
dzieverink 4/9/14:
Added LA specific logic and updated the outdated business rule to include the logic supplied by Mike H currently being used in FDW.

sconley: 5/4/16: Updated BR Description

dzieverink: 5/6/16: Corrected the rule to fit what is actually in Informatica and formatted in When statements.

dzieverink 1/6/17: Added excel spreadsheet statement per Rick's stat changes word doc for ISO Property (Jira DP-1172)

sconley 3/9/17: Revised order of rules to execute for ISO Property sublines first and added the conversion chart.

Here is additional information for how staging table FDW.LKP_STAT_PREM_FIRE_PROTECT is populated in EDW.
Join on 
PREMIUM_FACT_CORE.PRC_RATING_ID = PREMIUM_RISK_STATE.PRC_RATING_ID 
AND
PREMIUM_FACT_CORE.CHARGE_CD = PREMIUM_RISK_STATE.CHARGE_CD
where 
PREMIUM_RISK_STATE.FIRE_PROTECT_CLASS_CD != '0'

Expression logic 
Highest_fire_protect_class_cd:
MAX(in_FIRE_PROTECT_CLASS_CD, NOT ISNULL(in_FIRE_PROTECT_CLASS_CD))

sconley 4/7/17, 5/18/17: PDC requested a change in how UPR PROTECTION_CODE is derived in FDW. The current rule is complicated.  PROTECTION_CODE is only required for some ISO Property sublines, a few Agri Farm sublines, and a few class codes.  We are simplifying the rules. (QC 1683, DP-8711, DP-9668 (additional sublines for TX))




",,,,,,,,,
BR-22502,274 Number of Stories,"


	

","
",,10/13/2015,mmconley,sconley 10/13/15: Removed ETL Spec Cross Reference,,,,,,,,,
BR-23347,274.1 UPR Number of Stories - Premiums and Losses,"When Subline <> ‘930’;
    Set NO_OF_STORIES = ‘  ‘ (2 spaces);
    EXIT","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses
",FDW_Core 10217: UPR Earthquake: New requirements for CONSTRUCTION_TYPE and NO_OF_STORIES,5/3/2016,mmconley,"sconley 10/13/15:
Reformattted Business Rules to break-out earthquake requirements.
Subline 930 is for Earthquake. 

3/14/16 sconley: Updated QC # to 10217 for CONSTRUCTION_TYPE & NO_OF_STORIES.
",,,,,,,,,
BR-22613,274.2 UPR Number of Stories Earthquake - Premiums and Losses,"For UDPIM Builders Risk, the EDW.vw_risk_structure fields are on parent risk JOBSITE. 
For ISO Property & DIC risks PERSPROP, TIMELEMENT, & IMPROVMNTS, the EDW.vw_risk_structure fields are on parent risk BLDG. 
See comments.

When Subline = ‘930’;
SRC_SYS_CD in (‘UDAGRI’,’UDPIM’,'BRIDGE-PAS','REFAPP');;
VW_RISK_STRUCTURE is populated
VW_RISK_STRUCTURE.STORIES_CNT is NOT NULL;
VW_RISK_STRUCTURE.STORIES_CNT <= 99;
    Set NO_OF_STORIES = VW_RISK_STRUCTURE.STORIES_CNT;
    EXIT

When Subline = ‘930’;
SRC_SYS_CD in (‘UDAGRI’,’UDPIM’,'BRIDGE-PAS','REFAPP');;
VW_RISK_STRUCTURE is populated
VW_RISK_STRUCTURE.STORIES_CNT is NOT NULL;
VW_RISK_STRUCTURE.STORIES_CNT > 99;
    Set NO_OF_STORIES = 99;
    EXIT

When Subline = ‘930’;
SRC_SYS_CD in (‘UDAGRI’,’UDPIM’,'BRIDGE-PAS','REFAPP');;
VW_RISK_STRUCTURE is populated
VW_RISK_STRUCTURE .STORIES_CNT is NULL;
    Set NO_OF_STORIES = ‘  ‘ (2 spaces);
    EXIT

When Subline = ‘930’;
SRC_SYS_CD in (‘UDAGRI’,’UDPIM’,'BRIDGE-PAS','REFAPP');;
VW_RISK_STRUCTURE is not populated
    Set NO_OF_STORIES = ‘  ‘ (2 spaces);
    EXIT

*Default if src_sys_cd is not UDAGRI or UDPIM or BRIDGE-PAS or REFAPP
Set NO_OF_STORIES = ‘  ‘ (2 spaces);
    EXIT


","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses
","FDW_Core 10217: UPR Earthquake: New requirements for CONSTRUCTION_TYPE and NO_OF_STORIES

dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202)

dzieverink 1/6/17: Added ""REFAPP"" per Rick's stat area doc for ISO Property (QC DP-1172)

sconley 7/11/17: ENTERPRISE.Data_Platform Defect 1981 Get BLDG Attributes for PERSPROP, TIMELEMENT, IMPROVMNTS; Update UPR CONSTRUCTION_TYPE; DP-9775, US15622",7/12/2017,mmconley,"sconley 10/13/15:
Reformattted Business Rules to break-out earthquake requirements.
Subline 930 is for Earthquake. 
EDW source: vw_risk_structure.stories_cnt.

UDAGRI
-Most Agri risks do not have NO_OF_STORIES populated in EDW.  
-These Agri risks/coverages do not have structure data in EDW:
FPOPS / POLEQLOFI
FPP / FPEEQK
FPP / FPFEQK
FRMLOC / LOCEQE
FRMLOC / LOCEQF
FRMLOC / LOCEQLOFI

UDPIM Builders Risk
-The physical jobsite characteristics (fields) are on risk JOBSITE.
-The risk category for Earthquake coverage (EQ) is COVPROP.
-COVPROP is a child of JOBSITE and the physical jobsite fields are not populated.
-Determine parent JOBSITE risk of COVPROP risk.
-Populate NO_OF_STORIES for COVPROP from parent JOBSITE.
-VW_RISK_STRUCTURE fields are not populated on the policy level risks, VW_POL_RISK_HIST.SCHDL_NO = 0.  

ISO Property & ISO DIC
See BR-23466 for additional information.
-The physical building attributes (fields) are on risk BLDG.
- PERSPROP, TIMELEMENT, & IMPROVMNTS are children of BLDG and the physical building attributes are not populated.
-Determine parent BLDG risk of PERSPROP, TIMELEMENT, & IMPROVMNTS risks.
-Select vw_risk_structure fields from parent BLDG in order to set no__of_stories for PERSPROP, TIMELEMENT, & IMPROVMNTS.
- For BLDG, select vw_risk_structure fields from BLDG in order to set no_of_stories.

sconley 1/25/16: FDW_Core 10217. The EDW source, STORIES_CNT, for NO_OF_STORIES is 3 bytes in EDW but only 2 characters in the UPR stat area for both premiums and losses.  Added additional rule to set NO_OF_STORIES = 99 if STORIES_CNT > 99.

3/14/16 sconley: Updated QC # to 10217 for CONSTRUCTION_TYPE & NO_OF_STORIES.

dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202)

sconley 7/11/17: Updated rules with requirements for ISO Property & DIC; QC 1981, DP-9775, US15622
",,,,,,,,,
BR-22575,274.3 UIM Number of Stories - Premiums,not currently populated in UIM premiums.  premium value is NULL,ETL - D_Stat_Inland_Marine_Premiums,,7/13/2017,mmconley,,,,,,,,,,
BR-22573,274.4 UIM Number of Stories - Losses,"if null = '00'
  else
    left pad stories count with zeros for 2 positions
end-if",ETL - D_Stat_Inland_Marine_Losses,,7/13/2017,mmconley,,,,,,,,,,
BR-22503,275 Year Built,"



","ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Property_Losses",,2/20/2017,mmconley,sconley 2/20/17: Added Premiums to the rule,,,,,,,,,
BR-22605,275.1 UPR Year Built - Premiums and Losses,"If STRUCTURE_BUILT_YR is not null
   Then YEAR_BUILT  = STRUCTURE_BUILT_YR  
Else YEAR_BUILT = ‘    ’  (4 spaces)

Comments:
---------------
For ISO Property & ISO DIC:
See BR-23466 for additional information.
-The physical building attributes (fields) are on risk BLDG.
- PERSPROP, TIMELEMENT, & IMPROVMNTS are children of BLDG and the physical building attributes are not populated.
-Determine parent BLDG risk of PERSPROP, TIMELEMENT, & IMPROVMNTS risks.
-Select vw_risk_structure fields from parent BLDG in order to set year_built for PERSPROP, TIMELEMENT, & IMPROVMNTS.
- For BLDG, select vw_risk_structure fields from BLDG in order to set year_built.","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses","sconley: ENTERPRISE.Data_Platform Defect 1981 Get BLDG Attributes for PERSPROP, TIMELEMENT, IMPROVMNTS; DP-9775, US15622",7/11/2017,mmconley,"sconley 7/11/17: Added comments to rule with requirements for ISO Property & DIC; QC 1981, DP-9775, US15622",,,,,,,,,
BR-23453,275.2 UPR Year Built Earthquake - Premiums and Losses,"If STRUCTURE_BUILT_YR is not null
   Then YEAR_BUILT  = STRUCTURE_BUILT_YR  
Else YEAR_BUILT = ‘    ’  (4 spaces)

Comments:
---------------
YEAR_BUILT is not a required  for Earthquake Reporting.  For UDPIM Builders Risk the EDW.vw_risk_structure fields are on parent risk JOBSITE.  We do not get the STRUCTURE_BUILT_YR from the parent JOBSITE so YEAR_BUILT = '    ' (4 spaces) since it is not populated for risk COVPROP.

For ISO Property & ISO DIC:
See BR-23466 for additional information.
-The physical building attributes (fields) are on risk BLDG.
- PERSPROP, TIMELEMENT, & IMPROVMNTS are children of BLDG and the physical building attributes are not populated.
-Determine parent BLDG risk of PERSPROP, TIMELEMENT, & IMPROVMNTS risks.
-Select vw_risk_structure fields from parent BLDG in order to set year_built for PERSPROP, TIMELEMENT, & IMPROVMNTS.
- For BLDG, select vw_risk_structure fields from BLDG in order to set year_built.","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses","sconley: ENTERPRISE.Data_Platform Defect 1981 Get BLDG Attributes for PERSPROP, TIMELEMENT, IMPROVMNTS; DP-9775, US15622",7/11/2017,mmconley,"sconley 2/20/17: Subline 930 is for Earthquake. 
Broke out rule for Earthquake to explain why field is not populated for Builders Risk. 

sconley 7/11/17: Added comments to rule with requirements for ISO Property & DIC; QC 1981, DP-9775, US15622",,,,,,,,,
BR-22577,275.3 UIM Year Built - Premiums,UIM Premiums does not have this currently populated. Premium default value is NULL.,ETL - D_Stat_Inland_Marine_Premiums,,6/7/2016,mmconley,,,,,,,,,,
BR-22576,275.4 UIM Year Built - Losses,"if null = '0000'
else
move structure_built_yr
end-if",ETL - D_Stat_Inland_Marine_Losses,,6/7/2016,mmconley,,,,,,,,,,
BR-22505,276 Occupation Coverage,"

","ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Property_Losses",,12/31/2013,moreilly,,,,,,,,,,
BR-22618,276.1 UPR Occupation Coverage - Losses,Move Spaces,ETL - D_Stat_Property_Losses,,5/3/2016,mmconley,,,,,,,,,,
BR-22579,276.2 UIM Occupation Coverage  - Premiums,Move Null,ETL - D_Stat_Inland_Marine_Premiums,,7/13/2017,mmconley,,,,,,,,,,
BR-22578,276.3 UIM Occupation Coverage  - Losses,Move '0',ETL - D_Stat_Inland_Marine_Losses,,7/13/2017,mmconley,,,,,,,,,,
BR-22521,"277 Cause of Loss	","If Stat_Format_Code = 'UIM
    Move ‘0’
End-If",ETL - D_Stat_Inland_Marine_Losses,,7/13/2017,mmconley,,,,,,,,,,
BR-22522,278 Coverage Inception Date,,,,7/21/2015,mmconley,7/20/15 sconley: Broke rule into 2 parts since the source for UIM losses is policy term eff date. UIM losses is the only new world stat area that populates coverage inception date.,,,,,,,,,
BR-23276,278.1 Coverage Inception Date,COVERAGE_INCEPTION_DATE = vw_cvrg_hist.cvrg_eff_dt ,"ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
",,7/21/2015,mmconley,7/21/15 sconley: Sourced from EDW,,,,,,,,,
BR-23278,278.2 UIM Coverage Inception Date - Losses,"When Stat_Format_Code = 'UIM'
   COVERAGE_INCEPTION_DT = vw_pol_term.pol_term_eff_dt (MMYY)
Exit;
","ETL - D_Stat_Format_Losses
ETL - D_Stat_Inland_Marine_Losses","Equine 8608: For Inland Marine Experience Files, the policy effective date will be mapped to the coverage inception date",5/4/2016,mmconley,7/21/15 sconley: Corrected rule and added QC defect; sourced from EDW,,,,,,,,,
BR-22595,279 Class Limit,"If Stat_Format_Code = 'UPR'
   Then Class_limit  = ‘  ’ (2 spaces)
End-If
","ETL - D_Stat_Property_Losses
",,5/9/2016,mmconley,,,,,,,,,,
BR-22599,280 Building Grade Code,"When VW_RISK_STRUCTURE.BCEG_CD is NOT NULL
  Set BLDG_GRADE_CODE = BCEG_CD 
    (If BCEG_CD is one digit include a leading ‘0’)
  EXIT

When SUBLINE_CD = ‘930’ 
  Set BLDG_GRADE_CODE = ‘99’
  EXIT

When FIPS_US_ALPHA_CD in (‘FL’, ‘WA’)
VW_RISK_STRUCTURE.BCEG_CD is NULL
  Set BLDG_GRADE_CODE = ‘99’
  EXIT

Set BLDG_GRADE_CODE = ‘  ‘ (2 spaces)
(default value)

Comments:
---------------
For ISO Property & ISO DIC:
See BR-23466 for additional information.
-The physical building attributes (fields) are on risk BLDG.
- PERSPROP, TIMELEMENT, & IMPROVMNTS are children of BLDG and the physical building attributes are not populated.
-Determine parent BLDG risk of PERSPROP, TIMELEMENT, & IMPROVMNTS risks.
-Select vw_risk_structure fields from parent BLDG in order to set bldg_grade_code for PERSPROP, TIMELEMENT, & IMPROVMNTS (including earthquake).
- For BLDG, select vw_risk_structure fields from BLDG in order to set year_built.","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses","dzieverink 1/6/17: Added statement at the top per Rick's stat area doc for ISO Property (QC DP-1172)

sconley 7/11/17: ENTERPRISE.Data_Platform Defect 1981 Get BLDG Attributes for PERSPROP, TIMELEMENT, IMPROVMNTS; DP-9775, US15622",7/26/2017,mmconley,"(Chg default for ‘FL’ & ’WA’ from ‘00’ to ‘99’, change other states default to ‘  ‘ (2 spaces))

sconley 2/28/17: Reformated BR. 
For PIM Builders Risk Earthquake, we do not have BCEG in EDW for COVPROP risk, so BLDG_GRADE_CODE will always get set to 99.

sconley 7/11/17: Added comments to rule with requirements for ISO Property & DIC; QC 1981, DP-9775, US15622

",,,,,,,,,
BR-22600,281 Coinsurance Indicator,"A coverage may have multiple rows in EDW.VW_PRC_LIMIT, but all rows will have the same COINSURANCE_PCNT. COINSURANCE_PCNT is staged on EDW in FDW.S_D_CVRG_LIMIT. The COINSURANCE_PCNT is also populated in on FDW in FDW.D_CVRG_LIMIT.

For ISO Property cvrg_cd in ('ORDLAWA', 'TERRORCB') we need to get the COINSURANCE_PCNT from sibling coverage 'GROUP1' for the risk.  Use the COINSURANCE_PCNT from 'GROUP1' for the CO_INSURANCE_IND rules for 'ORDLAWA' and 'TERRORCB'. 

For UDPIM, ORDLAWA is not premium bearing.

When COINSURANCE_PCNT IS NULL;
POL_SYMBOL_CD = 'AFP';
CVRG_CD = 'FPFBFPP';
    Set CO_INSURANCE_IND = '5';
    EXIT

When COINSURANCE_PCNT IS NULL;
POL_SYMBOL_CD = 'AFP';
CVRG_CD <> 'FPFBFPP';
    Set CO_INSURANCE_IND = '4';
    EXIT

When COINSURANCE_PCNT IS NULL;
POL_SYMBOL_CD <> 'AFP';
    Set CO_INSURANCE_IND = '9';
    EXIT

When COINSURANCE_PCNT = 0;
    Set CO_INSURANCE_IND = '9';
    EXIT

When COINSURANCE_PCNT = 50;
    Set CO_INSURANCE_IND = '1';
    EXIT

When COINSURANCE_PCNT = 60;
    Set CO_INSURANCE_IND = '2';
    EXIT

When COINSURANCE_PCNT = 70;
    Set CO_INSURANCE_IND = '3';
    EXIT

When COINSURANCE_PCNT = 80;
    Set CO_INSURANCE_IND = '4';
    EXIT

When COINSURANCE_PCNT = 90;
    Set CO_INSURANCE_IND = '5';
    EXIT

When COINSURANCE_PCNT = 100;
    Set CO_INSURANCE_IND = '6';
    EXIT

When COINSURANCE_PCNT > 100;
    Set CO_INSURANCE_IND = '7';
    EXIT

Set CO_INSURANCE_IND = '8';
    EXIT
","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses","6/17/2014 sconley:  Corrected rule in DOORs for when pol_sysmbol = 'AFP'.

7/5/17 sconley: ENTERPRISE.Data_Platform Defect 2101 UPR CO_INSURANCE_IND: New Requirement; US17085
12/18/17 sconley: Staging table on EDW is FDW.LKP_STAT_PREM_COINSRNCE_GROUP1.",12/18/2017,mmconley,"sconley 7/5/17: Reformated rule, corrected DOORs, and added comments for cvrg_cd in ('ORDLAWA', 'TERRORCB'); QC 2101; US17085",,,,,,,,,
BR-22604,282 Ordinance or Law Coverage Code,"When SUBLINE_CD in (011, 012, 013, 014, 015, 016, 017, 018, 027, 029, 035, 037, 045, 055, 067, 069, 077, 079) 
   	When CVRG_CD = 'ORDLAWB'
		Set ORDINANCE_LAW_COV_ID_CODE = '4'
		EXIT
 	When CVRG_CD = 'ORDLAWC'
		Set ORDINANCE_LAW_COV_ID_CODE_ = '3'
		EXIT
 	When COVERAGE_CODE in ('1','3') 
 CVRG_CD 'ORDLAWA' exists for the risk
‘ORDLAWA” VW_CVRG_HIST.ACTION_CD in (‘A’,’E’,’C’)
		Set ORDINANCE_LAW_COV_ID_CODE = '2'
		EXIT
	When COVERAGE_CODE in ('1','3')
 CVRG_CD 'ORDLAWA' does not exist for the risk
		Set ORDINANCE_LAW_COV_ID_CODE = '1'
		EXIT
	When RISK_CATG_CD = ‘BLDG’
		Set ORDINANCE_LAW_COV_ID_CODE = '1'
		EXIT
	Set ORDINANCE_LAW_COV_ID_CODE to ‘ ‘ (space)
		EXIT

When SUBLINE_CD in (‘116’, ‘136’, ‘156’) 
When VW_POL_TERM_FORM.FORM_ID in ('AP7286', 'AP7287')  
         		  /* Updated from '5' to '2' to match Informatica */
		Set ORDINANCE_LAW_COV_ID_CODE = ‘2’ 
		EXIT
          	Set ORDINANCE_LAW_COV_ID_CODE = ‘1’
	EXIT

Set ORDINANCE_LAW_COV_ID_CODE = ‘ ’  (space)
(default)",ETL - D_Stat_Property_Premiiums ETL - D_Stat_Property_Losses,"dzieverin 1/6/17: Added ORDLAWA, ORDLAWB, and ORDLAWC logic per Rick's stat area doc for ISO Property (QC DP-1172)

sconley 4/27/17, 5/8/17, 5/17/17: ENTERPRISE.Data_Platform 1742 FDW Updates for BUREAU_LINE_CODE, ORDINANCE_LAW_COV_ID_CODE (JIRA DP-8780, DP-9391, DP-9664)
",5/17/2017,mmconley,"sconley 4/27/17 sconley: Revised rules for ISO Property sublines.  We need to check if coverage ORDLAWA exists for the risk. At this time, ORDLAWA should only exist on BLDG. Also updated DOORs rules for Agri sublines to match Informatica (confirmed with PDC that Informatica was correct) and list which forms we are checking for. (QC defect 1742, JIRA DP-8780)
For the Agri sublines, if the forms exist on the policy, PREMIUM_FACT_CORE. PTF_UPR_OLCC_IND = 1 and the indicator is used to set ORDINANCE_LAW_COV_ID_CODE.  The PTF (policy term form) indicators are stored on EDW in FDW.LKP_PFC_PTF by EDW_TRANS_ID. 
sconley 5/1/17: Added vw_cvrg_hist for source of ORDLAWA action_cd.
sconley 5/8/17 & 5/17/17: Additional changes for the rule (DP-9391, DP-9664, QC 1742)
",,,,,,,,,
BR-22609,283 Limit Amount,"When Cvrg_Cd = 'ORCHVINE'
	Set Limit_Amt = '50000'

If Stat_format_code = 'UPR'
  Then 
        IF SRC_SYS_CD in (‘UDPIM’,'BRIDGE-PAS')
          Then LIMIT_AMOUNT = ‘0000000’
        Else
            If  POL_LIMIT_AMT is not null 
               Then LIMIT_AMOUNT = POL_LIMIT_AMT (left fill -0 to 7 digits)
               Else LIMIT_AMOUNT = ‘0000000’
            End-If
         End-If
End-If
",ETL - D_Stat_Property_Losses,"10007

dzieverink 6/20/16: Added BRIDGE-PAS per Jira DP 201 (QC DP 202)",6/20/2016,dzieverink,2/23/16 - dzieverink - Added default limit amount for the ORCHVINE coverage to the logic.,,,,,,,,,
BR-22611,284 Attachment Indicator,"
",,,1/7/2016,mmconley,1/7/16 sconley:  Changed format and made sub-rule for UPR Premiums and Losses.,,,,,,,,,
BR-23352,284.1 UPR Attachment Indicator - Premiums and Losses,"When SUBLINE_CD = '930' 
POL_SYMBOL_CD in ('APK', 'DPK', 'AGB') 
  Set ATTACHMENT_IND = '4'
  EXIT

When SUBLINE_CD = '930' 
POL_SYMBOL_CD not in ('APK', 'DPK', 'AGB') 
  Set ATTACHMENT_IND = '1'
  EXIT

Set ATTACHMENT_IND = ' ' (space)
(default is ' ' (space))","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses","UWD.PIM 18006: Updates to UPR stat area for Builders Risk Earthquake coverage for premiums and losses.

dzieverink 6/20/16: Removed UDPIM logic since it is not in Informatica. It doesn't use the policy symbols so it get a '1' returned anyway. Per Jira DP 201 (QC DP 202)",6/20/2016,dzieverink,"1/7/16 sconley: 
-Subline '930' is Earthquake.
-UDPIM SBP Earthquake coverage is not premium bearing.
-Changed format and made sub-rule for UPR Premiums and Losses. 
-UWD.PIM 18006: Updated for PIM Builders Risk earthquake.",,,,,,,,,
BR-23379,285 Loss Cost Date,,,,5/9/2016,mmconley,,,,,,,,,,
BR-23380,285.1 UPR Loss Cost Date - Premiums,Move '    ' (4 spaces),,,5/9/2016,mmconley,5/9/16 sconley: Added rule.,,,,,,,,,
BR-23367,286 Rate Grade,,,,5/3/2016,mmconley,,,,,,,,,,
BR-22612,286.1 UPR Rate Grade -Premiums and Losses,"When SUBLINE_CD = ‘930’;
Stat Area COVERAGE_CODE in ('2', '3');
Stat Area TYPE_OF_COVERAGE in ('1', ' 3');
VW_RISK_PERSONAL_PROPERTY.CONTENTS_RATE_GRADE_MDM_CD is NOT NULL;
  Set RATE_GRADE based on W_RISK_PERSONAL_PROPERTY.CONTENTS_RATE_GRADE_MDM_CD
  CONTENTS_RATE_GRADE_MDM_CD = ‘HIGH’	
    Set RATE_GRADE = ‘1’;
  CONTENTS_RATE_GRADE_MDM_CD = ‘MODERATE’
    Set RATE_GRADE = ‘2’;
  CONTENTS_RATE_GRADE_MDM_CD = ‘DAMAGEABLE’
    Set RATE_GRADE = ‘3’;
  CONTENTS_RATE_GRADE_MDM_CD = ‘SLIGHT’
    Set RATE_GRADE = ‘4’;
  EXIT

When SUBLINE_CD = ‘930’;
Stat Area COVERAGE_CODE in ('2', '3');
Stat Area TYPE_OF_COVERAGE in ('2', '4');
VW_RISK_PERSONAL_PROPERTY.CONTENTS_SUSPECT_GRADE_MDM_CD is NOT NULL;
  Set RATE_GRADE based on VW_RISK_PERSONAL_PROPERTY.CONTENTS_SUSPECT_GRADE_MDM_CD
  CONTENTS_SUSPECT_GRADE_MDM_CD = ‘HIGH’
    Set RATE_GRADE = ‘H’;
  CONTENTS_SUSPECT_GRADE_MDM_CD = ‘MEDIUM’
    Set RATE_GRADE = ‘M’;
  CONTENTS_SUSPECT_GRADE_MDM_CD = ‘LOW’
    Set RATE_GRADE = ‘S’;
  EXIT

When SUBLINE_CD = ‘930’;
CVRG_CD in ('EQKC', 'FPEEQK', 'FPFEQK', 'EQSUBLIMC');
  Set RATE_GRADE = ‘4’;
  EXIT
  
Set RATE_GRADE = ‘ ‘ (space);
  EXIT","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses","dzieverink 1/6/17: Added logic around Content Category lookups per Rick's stat area doc for ISO Property (QC DP 1172 & 1129)

sconley 2/17/17: Revised rules to check if CONTENTS_SUSCEPT_GRADE_MDM_CD or CONTENTS_SUSCEPT_GRADE_MDM_CD are NULL.
JIRA Stories DP-7797 & DP-7887, ENTERPRISE.Data_Platform Defect 1422

sconley 5/22/17: ENTERPRISE.Data_Platform 1916 Additional change for ISO Property (DP-9666)",5/22/2017,mmconley,"5/3/16 sconley:
-Subline '930' is Earthquake
-The coverages listed in the rule are for Agri.
-UDPIM SBP Earthquake coverage is not premium bearing.
-UDPIM Builders Risk Earthquake coverage is premium bearing but RATE_GRADE is not applicable so it is set to ' ' (space). This is not specifically called out in the rule.
-Changed format and made sub-rule for UPR Premiums and Losses. 

2/16/17 sconley: Added check for if Contents Rate Grade Category or Contents Susceptibility Category are NULL.  If they are NULL we want the code to drop down to the original rules.
The Rate Grade is derived and stored in variables var_CONTENTS_RATE_GRADE_MDM_CD or var_CONTENTS_SUSCEPT_GRADE_MDM_CD in Informatica so if the MDM CDs are not populated or are not listed in the rule, the variables will be NULL.
4/26/17 sconley: For ISO Property, RATE_GRADE will only be populated for PERSPROP Earthquake coverage. It will always be ‘ ‘ (space) for BLDG and TIMELEMENT. 

5/22/17 sconley: Additional change to the rule for ISO Property (DP-9666, QC 1916)

 

",,,,,,,,,
BR-22619,287 Policy Form,"If Stat_format_code = 'UPR'

If  lk_minor_line_pkg_xref.COVERAGE_CODE_ FORM_CODE is not null
  Then POLICY_FORM = COVERAGE_CODE_FORM_CODE 
Else
   If Subline in (‘105’,’106’)
     Then 
     If CVRG_CHILD_PF = ‘BASIC’
       Then POLICY_FORM = ‘1’
     Else
     if CVRG_CHILD_PF = ‘BROAD’
       Then POLICY_FORM = ‘2’
     Else
     if CVRG_CHILD_PF in ( ‘BROADSPCL’)
       Then POLICY_FORM = ‘3’
     Else
      if CVRG_CHILD_PF in ( ‘SPECIAL’)
       Then POLICY_FORM = ‘6’
   Else 
       POLICY_FORM = ‘9’
Else 
    POLICY_FORM =  ‘ ’  (space)
End-if","ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses",,7/19/2017,mmconley,sconley 7/19/17: Added d_stat_property_premiums to the ETL Cross Reference.,,,,,,,,,
BR-23378,288 Sprinkler ID,,,,5/9/2016,mmconley,,,,,,,,,,
BR-22622,288.1 UPR Sprinkler ID - Premiums and Losses,"When VW_RISK_STRUCTURE_SAFEGUARD.SAFEGUARD_CD = SPRINKLER;
   Set SPRINKLER_ID = 1;
   EXIT
 
Set SPRINKLER_ID = 0;
   EXIT

Comments:
---------------
ISO Property & DIC
See BR-23466 for additional information.
-The physical building attributes (fields) are on risk BLDG.
- PERSPROP, TIMELEMENT, & IMPROVMNTS are children of BLDG and the physical building attributes are not populated.
-Determine parent BLDG risk of PERSPROP, TIMELEMENT, & IMPROVMNTS risks.
-Select vw_risk_structure_safeguard fields from parent BLDG in order to set sprinkler_id for PERSPROP, TIMELEMENT, & IMPROVMNTS.
- For BLDG, select vw_risk_structure_safeguard fields from BLDG in order to set sprinkler_id.
","ETL- D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses","sconley 7/12/17: ENTERPRISE.Data_Platform Defect 2101 UPR CO_INSURANCE_IND, RISK_INDICATOR  SPRINKLER_ID, TYPE_OF_COVERAGE: New Requirements; US17230",7/26/2017,mmconley,"sconley 5/9/16:  Reformatted and added Premiums to the rule.

sconley 7/12/17: Added comments to rule with requirements for ISO Property & DIC; QC 2101, US17230",,,,,,,,,
BR-23451,289 Replacement Cost Endorsement,,,,2/6/2017,mmconley,,,,,,,,,,
BR-23450,289.1 UPR Replacement Cost Endorsement - Premiums,"/* Set Indicator variable based on presence of form */
When VW_POL_TERM_FORM.FORM_ID = ‘AP7249’
  Set REPLACEMENT_COST_IND = '1'
Else
  Set REPLACEMENT_COST_IND = '0'

/* Populate field in UPR stat area.  */
When VW_RISK_PERSONAL_PROPERTY.CONTENTS_REPLACEMENT_VALUE_AMT IS NOT NULL
  Set REPLACEMENT_COST_ENDORSEMENT = '1'
  EXIT

Set REPLACEMENT_COST_ENDORSEMENT = REPLACEMENT_COST_IND",ETL - D_Stat_Property_Premiums,Enterprise.Data_Platform #1129,6/27/2017,mmconley,"sconley 2/6/17: Reformatted rule.  Rule revised by DP-6568, DP Defect 1129.  Corrections made with DP-7636. 

Form AP7249 is used by Agribusiness. On EDW table FDW.LKP_STAT_PREM_PTF_AP7249 is used in the  mapping that loads to STG2 table.

VW_RISK_PERSONAL_PROPERTY.CONTENTS_REPLACEMENT_VALUE_AMT is populated by ISO Property.  
Both are used to populate REPLACEMENT_COST_ENDORSEMENT.",,,,,,,,,
BR-23454,290 Wind Catastrophe Indicator - UPR Premiums,"/* For ISO Property, if WINDEXCL coverage exists for the risk, then VW_RISK_HIST.WIND_EXCL_IND = ‘1’ and we need to set the WIND_CATASTROPHE_IND for every coverage on that risk.  The indicator also gets set in PREMIUM_FACT_CORE_STG2.WIND_EXCL_IND. */

When VW_RISK_HIST.WIND_EXCL_IND = ‘1’
    Set WIND_CATASTROPHE_IND = ‘9’
    EXIT

/* If cvrg_cd WINDEXCL exists (there may be multiple occurrences per transaction), find the parent coverage of WINDEXCL in vw_cvrg_rel when vw_cvrg_rel.action_cd in ('A', 'E',’C’) and populate LKP_STAT_PREM_WINDEXCL with the policy transaction EDW_TRANS_ID and COVERAGE_ID of the parent coverage.  
Then for those coverage_ids & prc_rating_ids, on EDW set:  FDW.S_D_STAT_FORMAT_PREMIUM_STG1.CVRG_CHILD_WEX = 'WINDEXCL (for look-up to LKP_STAT_PREM_WINDEXCL)
FDW.S_D_STAT_FORMAT_PREMIUM_STG2 CVRG_CD_CHILD_WEX = 'WINDEXCL' (for UPR mapping). */

When D_STAT_FORMAT_PREMIUM_STG2.CVRG_CD_CHILD_WEX = ‘WINDEXCL’
    Set WIND_CATASTROPHE_IND = ‘9’
    EXIT

/*If neither condition is met */
Set WIND_CATASTROPHE_IND = ‘A’	",ETL - D_Stat_Property_Premiums,sconley 3/15/17: ENTERPRISE.Data_Platform 1551 UPR Stat Area Fixes for RISK_INDICATOR and WIND_CATASTROPHE_IND for ISO Property (JIRA DP-8424),3/15/2017,mmconley,"sconley 3/15/17: Created new Business Rule. Reformated, added comments, and revised for ISO Property (DP-8424, defect 1551)",,,,,,,,,
BR-22626,291 Limit Size Code,"If Stat_Format_Code = 'UCA'

Select  NVL(POL_LIMIT_AMT,0)  POL_LIMIT_AMT,
          NVL(AGGR_POL_TERM_LIMIT_AMT,0)  AGGR_POL_TERM_LIMIT_AMT,
          APPLIES_TO_LONG_DESC
from FDW.d_cvrg_limit  cl 
Where cl.edw_cvrg_hist_id = CVRG_HIST_ID
   
If FIPS_US_ALPHA_CD in (‘NY’, ‘VA’)
   And SUBLINE_CD = ‘623’
Then 
Select AGGR_LIMIT_SIZE_CD 
  From lk_limit_size_code_aggr
  Where lk.STAT_CODE = ‘UCA’
  And lk.CVRG_CD = CVRG_CD
  And lk.RISK_STATE = FIPS_US_ALPHA_CD
  And (lk.POL_LIMIT_MIN_AMOUNT <= cl.POL_LIMIT_AMT <= lk.POL_LIMIT_MAX_AMOUNT)
And (lk.AGGR_LIMIT_MIN_AMOUNT <= cl.AGGR_POL_TERM_LIMIT_AMT <= lk.AGGR_LIMIT_MAX_AMOUNT)
If is null 
  Then ws.LIMIT_SIZE_CD = ‘  ’ (2 spaces)
Else  Ws.LIMIT_SIZE_CD = AGGR_LIMIT_SIZE_CD
Else

If FIPS_US_ALPHA_CD = ‘NJ’
   And  SUBLINE_CD = ‘615’
  Then 
Select LIMIT_SIZE_CD 
  From lk_limit_size_code
  Where lk.STAT_CODE = ‘UCA’
  And lk.CVRG_CD = CVRG_CD
  And lk.LIMIT_DESC = APPLIES_TO_LONG_DESC
  And lk.RISK_STATE = FIPS_US_ALPHA_CD
  And (lk.LIMIT_MIN_AMOUNT <= cl.POL_LIMIT_AMT <= lk.LIMIT_MAX_AMOUNT)
If is null
   then 
Select LIMIT_SIZE_CD 
  From lk_limit_size_code
  Where lk.STAT_CODE = ‘UCA’
  And lk.CVRG_CD = CVRG_CD
  And lk.LIMIT_DESC = ‘PIP Limits’
  And lk.RISK_STATE = FIPS_US_ALPHA_CD
  And (lk.LIMIT_MIN_AMOUNT <= cl.POL_LIMIT_AMT <= lk.LIMIT_MAX_AMOUNT)
  Else  Ws.LIMIT_SIZE_CD = LIMIT_SIZE_CD
Else  

If FIPS_US_ALPHA_CD = ‘PA’
  If CVRG_CD in (‘ADPIP’,’NIABP’)
   Then
   Select LIMIT_CODE
   From LK_LIMIT_SIZE_CODE_PA_PIP lk
   Where (lk.MEDICAL_MIN_AMT <= MEDEXPBEN_AMT <= lk.MEDICAL_MAX_AMT)
   And lk.WORK_LOSS_MNTH_AMT = APMOWOLOS_MNTH_AMT
   And lk.WORK_LOSS_AGG_AMT = APMOWOLOS_AGG_AMT
   And lk.ACCIDENTAL_DEATH_AMT = ACCDEABEN_AMT
   And lk.FUNERAL_EXPENSE_AMT = APFUNEXP_AMT
   If not null 
     Then Ws.LIMIT_SIZE_CD  = LIMIT_CODE
    Else
    If CVRG_CD in (‘PIP’,’NIBP’,’PEPIP’)
      then Ws.LIMIT_SIZE_CD = ‘09’
Else 

If FIPS_US_ALPHA_CD = ‘MN’
  and SUBLINE_CD = ‘615’
  Then
  Select LIMIT_CODE
  From LK_LIMIT_SIZE_CODE_MN_PIP lk
  Where lk.MEDICAL_EXPENSE_AMT = MEDEXPBEN_AMT
  And lk.WORK_LOSS_AGGR_AMT = APMOWOLOS_AGG_AMT
  And lk.EXCL_WORK_LOSS_BENEFIT_=  EXCLUDE_WORK_LOSS_BENEFITS_IND
  If not null 
  Then Ws.LIMIT_SIZE_CD  = LIMIT_CODE
Else 

If FIPS_US_ALPHA_CD = ‘CT’
  and SUBLINE_CD = ‘615’
  Then
  Select LIMIT_CODE
  From LK_LIMIT_SIZE_CODE_CT_PIP lk
  Where (lk.MEDICAL_MIN_AMT <= MEDEXPBEN_AMT <= lk.MEDICAL_MAX_AMT)
  And (lk.WORK_LOSS_MIN_AMT <= APMOWOLOS_MTH_AMT <= lk.WORK_LOSS_MAX_AMT)
   If not null 
    Then Ws.LIMIT_SIZE_CD  = LIMIT_CODE
Else

If FIPS_US_ALPHA_CD = ‘UT’
  and SUBLINE_CD = ‘615’
  Then
  Select LIMIT_CODE
  From LK_LIMIT_SIZE_CODE_UT_PIP lk
  Where (lk.MEDICAL_MIN_AMT <= MEDEXPBNEP_AMT <= lk.MEDICAL_MAX_AMT)
  And (lk.WORK_LOSS_MIN_AMT <= WKLOSSEP_AMT <= lk.WORK_LOSS_MAX_AMT)
  And lk.EXCLUDE_LOSS_OF_INCOME_BENEFITS_IND = EXCLUDE_LOSS_OF_INCOME_IND
   If not null 
    Then Ws.LIMIT_SIZE_CD  = LIMIT_CODE
Else 

If FIPS_US_ALPHA_CD = ‘KS’
  and SUBLINE_CD = ‘615’
  and CVRG_CD = 'PIP'
	then PIP_LIMIT = '01'
Else

If FIPS_US_ALPHA_CD = 'DC'
   and Subline_CD = '615'
   Then
   Select LIMIT_CODE
   From LK_LIMIT_SIZE_CODE_DC_PIP
   Where (lk.MEDICAL_MIN_AMT <= MEDEXPBNEP <= lk.MEDICAL_MAX_AMT)
   And (lk.WORK_LOSS_MIN_AMT <= WKLOSSEP_AMT <= lk.WORK_LOSS_MAX_AMT)
   And (lk.FUNERAL_EXPENSE_MIN_AMT <= FUNEXPEP <= lk.FUNERAL_EXPENSE_MAX_AMT)
Else

Select LIMIT_SIZE_CD 
  From lk_limit_size_code
  Where lk.STAT_CODE = ‘UCA’
  And lk.CVRG_CD = CVRG_CD
  And lk.RISK_STATE = FIPS_US_ALPHA_CD
  And (lk.LIMIT_MIN_AMOUNT <= MEDEXPBNEP_AMT <= lk.LIMIT_MAX_AMOUNT)
Else

Select LIMIT_SIZE_CD 
  From lk_limit_size_code
  Where lk.STAT_CODE = ‘UCA’
  And lk.CVRG_CD = CVRG_CD
  And lk.RISK_STATE = FIPS_US_ALPHA_CD
  And (lk.LIMIT_MIN_AMOUNT <= cl.POL_LIMIT_AMT <= lk.LIMIT_MAX_AMOUNT)
If is null
   then 
 Select LIMIT_SIZE_CD 
  From lk_limit_size_code
  Where lk.STAT_CODE = ‘UCA’
  And lk.CVRG_CD = CVRG_CD
  And lk.RISK_STATE = ‘XX’  
  And (lk.LIMIT_MIN_AMOUNT <= cl.POL_LIMIT_AMT <= lk.LIMIT_MAX_AMOUNT)
If is null 
  Then  Ws.LIMIT_SIZE_CD = LIMIT_SIZE_CD

When Subline_Cd in ('611','620','621','622','623') Set LIMIT_SIZE_CD = '  ' (2 spaces)

Else
LIMIT_SIZE_CD = '01'
","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,1/9/2018,dzieverink,"dzieverink 1/9/18: Updated rules for NY and VA to change default to '  ' (2 spaces). Also, changed the end of the entire logic to have a subline filter to set '  ' (2 spaces) for any liability row that drops out of the lookups or state specific logic. We also kept the '01' default for all other rows that might drop past that piece of code. This was completed using QC DP-2410.",,,,,,,,,
BR-22628,291.1 Bodily Injury Limit,"If CVRG_CD in ( ‘LIAB’, ‘LIABBI’)
  then BODILY_INJURY_LIMIT = LIMIT_SIZE_CD 
else  BODILY_INJURY_LIMIT = ‘  ’  (2 spaces) ","ETL - D_Stat_Auto_Premiums

",,7/3/2013,jjordan,,,,,,,,,,
BR-22629,291.2 Medical Payment Limit,"If SUBLINE_CD = ‘620’
   Then MED_PAY_LIMIT = LIMIT_SIZE_CD
Else MED_PAY_LIMIT = ‘  ’  (2 spaces)","ETL - D_Stat_Auto_Premiums

",,7/3/2013,jjordan,,,,,,,,,,
BR-22630,291.3 Property Damage Limit,"If CVRG_CD = ‘LIABPD’
 then PROPERTY_DAMAGE_LIMIT = LIMIT_SIZE_CD 
else  PROPERTY_DAMAGE_LIMIT = ‘  ’  
(2 spaces) ","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
",,7/3/2013,jjordan,,,,,,,,,,
BR-22631,291.4 Unisured Limit,"If FIPS_US_ALPHA_CD = 'WA'
  and if SUBLINE_CD = '623'
	then UNINSURED_LIMIT = '  ' (2 spaces)
Else
If SUBLINE_CD in ( ‘621’, ‘623’)
   Then UNINSURED_LIMIT = LIMIT_SIZE_CD
Else UNINSURED_LIMIT = ‘  ’ (2 spaces)","ETL - D_Stat_Auto_Premiums

",12557,2/23/2016,dzieverink,dzieverink - added WA specific logic,,,,,,,,,
BR-22632,291.5 Underinsured Limit,"If FIPS_US_ALPHA_CD = 'WA'
  and if SUBLINE_CD = '623'
	then UNDERINSURED_LIMIT = LIMIT_SIZE_CD
Else
If SUBLINE_CD = ‘622’
 Then UNDERINSURED_LIMIT = LIMIT_SIZE_CD
Else UNDERINSURED_LIMIT = ‘  ’ (2 spaces)","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
",12557,2/23/2016,dzieverink,dzieverink - added WA specific logic,,,,,,,,,
BR-22661,291.6 Liability Limit,"If CVRG_CD in ( ‘LIAB’, ‘LIABBI’)
  then BODILY_INJURY_LIMIT = LIMIT_SIZE_CD 
else  BODILY_INJURY_LIMIT = ‘  ’  (2 spaces) ","ETL - D_Stat_Auto_Losses
",,7/3/2013,jjordan,,,,,,,,,,
BR-22662,291.7 Medical or Unisured Limit,"f SUBLINE_CD in (‘620’, ‘621’, ‘623’)
   Then MED_OR_UNINSURED_LIMIT = ws.LIMIT_SIZE_CD 
Else MED_OR_UNINSURED_LIMIT = ‘  ’ (2 spaces)","ETL - D_Stat_Auto_Losses
",,7/3/2013,jjordan,,,,,,,,,,
BR-22624,292 PIP Limit Code,"If Stat_Format_Code = ""UCA'

IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'PIPLimitCode' 
AND
EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
THEN 
Set PIP_LIMIT = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
Else

If FIPS_US_ALPHA_CD = ‘MD’
  If SUBLINE_CD = ‘615’

    If WAIVE_PIP_BENEFITS_IND = ‘1’
        Then PIP_LIMIT = ‘05’
    Else
      If WAIVE_PIP_BENEFITS_IND = ‘0’
         Then PIP_LIMIT = ‘01’
      Else PIP_LIMIT = ‘09’
  Else

If FIPS_US_ALPHA_CD = 'DE'
 and Subline_Cd = '615'
	If Aggr_Pol_Term_Limit_Amt = 0
	    If ADPIP_EXISTS_IND = 0
		If POL_LIMIT_AMT_ADPIP = 30000
			Then PIP_LIMIT = '15'
	   If ADPIP_EXISTS_IND = 1
		If POL_LIMIT_AMT_ADPIP = '20000' Then PIP_LIMIT = '12'
		If POL_LIMIT_AMT_ADPIP = '70000' Then PIP_LIMIT = '13'
		If POL_LIMIT_AMT_ADPIP ='270000' Then PIP_LIMIT ='14'
			Else PIP_LIMIT = '19'
	If Aggr_Pol_Term_Limit_Amt < > 0
                   If ADPIP_EXISTS_IND = 0
		If POL_LIMIT_AMT_ADPIP = '30000' 
			Then PIP_LIMIT = '05'
	  If ADPIP_EXISTS_IND = 1
		If POL_LIMIT_AMT_ADPIP ='10000' Then PIP_LIMIT = '02'
		If POL_LIMIT_AMT_ADPIP ='35000' Then PIP_LIIMIT = '03'
		If POL_LIMIT_AMT_ADPIP ='85000' Then PIP_LIMIT = '04'
			Else PIP_LIMIT = '09'
	

If FIPS_US_ALPHA_CD = ‘WA’
    If BASIC_PIP_INCREASED_LIMITS_IND = ‘1’
        Then PIP_LIMIT = ‘05’
    Else
      If BASIC_PIP_INCREASED_LIMITS_IND = ‘0’
         Then PIP_LIMIT = ‘03’
   Else PIP_LIMIT = ‘48’
  Else

If FIPS_US_ALPHA_CD = ‘KS’
    If MEDEXBNEP_AMT = 0
        Then PIP_LIMIT = ‘01’
   Else 
     If MEDEXBNEP_AMT = 12500
        Then PIP_LIMIT = ‘02’
    Else
       If MEDEXBNEP_AMT = 27500
          Then PIP_LIMIT = ‘03’
    Else 
         PIP_LIMIT = ‘09’


If FIPS_US_ALPHA_CD = 'MI'
 If EXCESS_PIP_WORK_LOSS_IND = 1
 and EXCESS_PIP_MEDICAL_EXP_IND = 0 or null
 	Then PIP_LIMIT = '02'
 If EXCESS_PIP_MEDICAL_EXP_IND = 1
 and EXCESS_WORK_LOSS_IND = 0 or null
	Then PIP_LIMIT = '03'
 If EXCESS_PIP_MEDICAL_EXP_IND = 1
  and EXCESS_WORK_LOSS_IND = 1
	Then PIP_LIMIT = '04'
Else PIP_LIMIT = '01'

If FIPS_US_ALPHA_CD = ‘UT’
  and SUBLINE_CD = ‘615’
  Then
  Select LIMIT_CODE
  From LK_LIMIT_SIZE_CODE_UT_PIP lk
  Where (lk.MEDICAL_MIN_AMT <= MEDEXPBNEP_AMT <= lk.MEDICAL_MAX_AMT)
  And (lk.WORK_LOSS_MIN_AMT <= WKLOSSEP_AMT <= lk.WORK_LOSS_MAX_AMT)
  And lk.EXCLUDE_LOSS_OF_INCOME_IND = ExcludeLossOfIncomeBenefitsInd
   If not null 
    Then Ws.LIMIT_SIZE_CD  = LIMIT_CODE

If FIPS_US_ALPHA_CD = 'NJ'
  If CVRG_CD in ('NIBP', 'NIABP')
	then PIP_LIMIT = '09'
  If CVRG_CD in ('MEPIP', 'PEPIP')
	then PIP_LIMIT = '47'
  If ADPIP_EXISTS_IND = 0
    If ELIM_NON_MDCL_EXP_BNFT_IND = 1
	then PIP_LIMIT = '25'
    Else PIP_LIMIT = '01'

  If ADPIP_EXISTS_IND = 1
    If AGGINCMBEN_EXISTS_IND = 1
      If POL_LIMIT_APPLIES_TO_ADPIP = 'Individually to Named Insured Only'
	When LIMIT_AMT = 100 then PIP_LIMIT = '13'
	When LIMIT_AMT = 125 then PIP_LIMIT = '14'
	When LIMIT_AMT = 175 then PIP_LIMIT = '15'
	When LIMIT_AMT = 250 then PIP_LIMIT = '16'
	When LIMIT_AMT = 400 then PIP_LIMIT = '17'
	When LIMIT_AMT = 500 then PIP_LIMIT = '18'
	When LIMIT_AMT = 600 then PIP_LIMIT = '19'
	When LIMIT_AMT = 700 then PIP_LIMIT = '20'
	When LIMIT_AMT =        then PIP_LIMIT = ' ' (space)
      
  If ADPIP_EXISTS_IND = 1
    If AGGINCMBEN_EXISTS_IND = 1
	When LIMIT_AMT = 100 then PIP_LIMIT = '38'
	When LIMIT_AMT = 125 then PIP_LIMIT = '39'
	When LIMIT_AMT = 175 then PIP_LIMIT = '40'
	When LIMIT_AMT = 250 then PIP_LIMIT = '41'
	When LIMIT_AMT = 400 then PIP_LIMIT = '42'
	When LIMIT_AMT = 500 then PIP_LIMIT = '43'
	When LIMIT_AMT = 600 then PIP_LIMIT = '44'
	When LIMIT_AMT = 700 then PIP_LIMIT = '45'
	When LIMIT_AMT =        then PIP_LIMIT = ' ' (space)

   If ADPIP_EXISTS_IND = 1
     If POL_LIMIT_APPLIES_TO_ADPIP = 'Individually to Named Insured Only'
	When LIMIT_AMT = 100 then PIP_LIMIT = '02'
	When LIMIT_AMT = 125 then PIP_LIMIT = '03'
	When LIMIT_AMT = 175 then PIP_LIMIT = '04'
	When LIMIT_AMT = 250 then PIP_LIMIT = '05'
	When LIMIT_AMT = 400 then PIP_LIMIT = '06'
	When LIMIT_AMT = 500 then PIP_LIMIT = '10'
	When LIMIT_AMT = 600 then PIP_LIMIT = '11'
	When LIMIT_AMT = 700 then PIP_LIMIT = '12'
	When LIMIT_AMT =        then PIP_LIMIT = ' ' (space)

    If ADPIP_EXISTS_IND = 1
	When LIMIT_AMT = 100 then PIP_LIMIT = '30'
	When LIMIT_AMT = 125 then PIP_LIMIT = '31'
	When LIMIT_AMT = 175 then PIP_LIMIT = '32'
	When LIMIT_AMT = 250 then PIP_LIMIT = '33'
	When LIMIT_AMT = 400 then PIP_LIMIT = '34'
	When LIMIT_AMT = 500 then PIP_LIMIT = '35'
	When LIMIT_AMT = 600 then PIP_LIMIT = '36'
	When LIMIT_AMT = 700 then PIP_LIMIT = '37'
	When LIMIT_AMT =        then PIP_LIMIT = ' ' (space)

If LIMIT_SIZE_CD is not null
     then 
         PIP_LIMIT = LIMIT_SIZE_CD
     else
        PIP_LIMIT = ‘01’
Else  
       PIP_LIMIT = ‘  ‘ (2 spaces)
end-if","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,10/31/2018,ragarwal,"ragarwal 10/23/18: Added logic to to pass through data, if available,  from EDW.PRC_RATING_EXTENSIONS",,,,,,,,,
BR-22623,293 PIP Rating Basis,"If  Stat_Format_Code = 'UCA'

IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'PIPRatingBasis' AND 
EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
THEN
Set PIP_RATING_BASIS_CD = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
Else

If SUBLINE_CD = ‘615’
  
If FIPS_US_ALPHA_CD = ‘KS’
  Then
     Select PIP_RATING_BASIS_CD 
     From LK_PIP_RATING_BASIS_CODE_KS lk
       Where lk.vehicle_category_cd = VEHICLE_CATEGORY_CD
        And lk.special_use_catg_cd = SPECIAL_USE_CATG_CD
       And lk.furnished_by_employer_ind = VEHICLE_REGULAR_USE_IND
       And lk.owner_operated_ind = OWNER_OPERATED_IND
    Else PIP_RATING_BASIS_CD = '0'

If FIPS_US_ALPHA_CD = 'DC'
     Select PIP_RATING_BASIS_CD
     From LK_PIP_RATING_BASIS_CODE_DC lk
       Where lk.vehicle_category_cd = VEHICLE_CATEGORY_CD
        And lk.employee_covered_by_wc_ind = EMPLOYEE_COVERED_BY_WC_IND
        And lk.principal_oper_employee_ind = PRINCIPAL_OPER_EMPLOYEE_IND
       And lk.special_use_catg_cd = SPECIAL_USE_CATG_CD
      And lk.vehicle_govt_sponsored_ind = VEHICLE_GOVT_SPONSORED_IND
   Else PIP_RATING_BASIS_CD = '09'

Else

   Select PIP_RATING_BASIS_CD 
   From LK_PIP_RATING_BASIS_CODE lk
   Where Lk.risk_state = FIPS_US_ALPHA_ST
      And lk.vehicle_category_cd = VEHICLE_CATEGORY_CD
      And lk.employee_covered_by_wc_ind = EMPLOYEE_COVERED_BY_WC_IND 
      And lk.principal_oper_employee_ind = PRINCIPAL_OPER_EMPLOYEE_IND
      And lk.special_use_catg_cd = SPECIAL_USE_CATG_CD
     And lk.furnished_by_employer_ind = FURNISHED_BY_EMPLOYER_IND 
     And lk.owner_operated_ind = OWNER_OPERATED_IND
     And lk.mdcl_exp_as_scndry_option_ind = MDCL_EXP_AS_SCNDRY_OPTION_IND
     And lk.vehicle_travel_class_cd = VEHICLE_TRAVEL_CLASS_CD
     If is null (2) 
       Then 
          Select PIP_RATING_BASIS_CD 
          From LK_PIP_RATING_BASIS_CODE lk
         Where Lk.risk_state = FIPS_US_ALPHA_ST
          And lk.vehicle_category_cd = VEHICLE_CATEGORY_CD
         And lk.employee_covered_by_wc_ind = EMPLOYEE_COVERED_BY_WC_IND 
         And lk.principal_oper_employee_ind = PRINCIPAL_OPER_EMPLOYEE_IND
         And lk.special_use_catg_cd = ‘0’ 
         And lk.furnished_by_employer_ind =FURNISHED_BY_EMPLOYER_IND 
         And lk.owner_operated_ind = OWNER_OPERATED_IND
         And lk.mdcl_exp_as_scndry_option_ind = MDCL_EXP_AS_SCNDRY_OPTION_IND
         And lk.vehicle_travel_class_cd = VEHICLE_TRAVEL_CLASS_CD
         If is null (3)
             Then  PIP_RATING_BASIS = ‘0’ 
         Else (3)
              PIP_RATING_BASIS = lk.PIP_RATING_BASIS_CD
         End-if (3)
    Else (2)
        PIP_RATING_BASIS = lk.PIP_RATING_BASIS_CD
    End-if (2)

Else (Not subline 615)
  PIP_RATING_BASIS = ‘ ’ (one space)
End-if

","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
",,10/31/2018,ragarwal,"ragarwal 10/23/18: Added logic to to pass through data, if available,  from EDW.PRC_RATING_EXTENSIONS",,,,,,,,,
BR-22625,294 PIP Deductible Code,"If Stat_Format_Code = ""UCA'


IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'PIPLimitCode' 
AND
EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
THEN 
Set PIP_DEDUCTIBLE = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
Else

If SUBLINE_CD = ‘615’
 Then
Select DEDUCT_AMT
          DEDUCT_APPLIES_TO
From FDW d_cvrg_deduct cd
Where cd.edw_cvrg_hist_id = CVRG_HIST_ID
 
If is null
   DEDUCT_AMT = 0
   DEDUCT_APPLIES_TO = ‘Full Coverage’

  Select DEDUCT_SIZE_CD 
  From lk_deduct_size_code
  Where lk.STAT_CODE = ‘UCA’
  And lk.CVRG_CD = CVRG_CD
  And lk.DEDUCT_DESC = cd.DEDUCT_APPLIES_TO    
  And lk.RISK_STATE = FIPS_US_ALPHA_CD
  And (lk.DEDUCT_MIN_AMOUNT <= cd.DEDUCT_AMT <= lk.DEDUCT_MAX_AMOUNT)

If is null
   then 
 Select DEDUCT_SIZE_CD 
 From lk_deduct_size_code
 Where lk.STAT_CODE = ‘UCA’
 And lk.CVRG_CD = CVRG_CD
 And lk.DEDUCT_DESC = cd.DEDUCT_APPLIES_TO
 And lk.RISK_STATE = ‘XX’  
 And (lk.DEDUCT_MIN_AMOUNT <= cd.DEDUCT_AMT <= lk.DEDUCT_MAX_AMOUNT)

  If is null 
    Then  PIP_DEDUCTIBLE = ‘01’
  Else 
     PIP_DEDUCTIBLE = DEDUCT_SIZE_CD
ELSE 
    PIP_DEDUCTIBLE = ‘  ’ (2 spaces)","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
",,10/31/2018,ragarwal,"ragarwal 10/23/18: Added logic to to pass through data, if available,  from EDW.PRC_RATING_EXTENSIONS",,,,,,,,,
BR-22633,295 OTC Collision Coverage,"If Stat_Format_Code = 'UCA'

(IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'CoverageCodeOTC' AND EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL) 
OR 
(IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'CoverageCodeCollision' AND EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL)
THEN 
Set OTC_COLL_COVERAGE = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
Else
If SUBLINE_CD = ‘618’
   Then  
  Select OTC_COLL_CVRG_CD 
  From lk_otc_coll_cvrg_code lk
  Where lk.CVRG_CD = CVRG_CD
   And lk.RISK_CATG_CD = RISK_CATG_CD
  And lk.PARENT_BUSN_CVRG_CD = PARENT_BUSN_CVRG_CD 
  And lk.RISK_STATE = FIPS_US_ALPHA_CD
 If found OTC_COLL_COVERAGE = OTC_COLL_CVRG_CD

 If is null
  Then  
   Select OTC_COLL_CVRG_CD 
   From lk_otc_coll_cvrg_code lk
   Where lk.CVRG_CD = CVRG_CD
    And lk.RISK_CATG_CD = RISK_CATG_CD
  And lk.PARENT_BUSN_CVRG_CD = PARENT_BUSN_CVRG_CD 
  And lk.RISK_STATE = ‘XX’ 
 If not null 
then OTC_COLL_COVERAGE = OTC_COLL_CVRG_CD

 If is null
  Then OTC_COLL_COVERAGE = ‘000‘

If OTC_COLL_COVERAGE = ‘DEDUCT’
  If BASIS_CD = ‘EADISABLEM’
   Then 
   Select LIMIT_SIZE_CD 
   From lk_limit_size_code
   Where lk.STAT_CODE = ‘UCA’
    And lk.CVRG_CD = CVRG_CD
    And lk.RISK_STATE = ‘XX’
    And (lk.LIMIT_MIN_AMOUNT <=   cl.POL_LIMIT_AMT <= lk.LIMIT_MAX_AMOUNT)
 If not null
   Then OTC_COLL_COVERAGE = LIMIT_SIZE_CD
  Else
  If cd.DEDUCT_AMT is null 
       DEDUCT_AMT = 0
  Then 
  Select DEDUCT_SIZE_CD 
  From lk_deduct_size_code
  Where lk.STAT_CODE = ‘UCA’
    And lk.CVRG_CD = CVRG_CD
    And lk.RISK_STATE = FIPS_US_ALPHA_CD
    And lk.DEDUCT_DESC = cd.DEDUCT_BASIS    
    And (lk.DEDUCT_MIN_AMOUNT <=   cd.DEDUCT_AMT <= lk.DEDUCT_MAX_AMOUNT)
 If not null
 Then OTC_COLL_COVERAGE = DEDUCT_SIZE_CD
 Else   
   If is null and Policy_Version begins with Z (converted policies)
   Then 
  Select DEDUCT_SIZE_CD 
  From lk_deduct_size_code
  Where lk.STAT_CODE = ‘UCA’
    And lk.CVRG_CD = CVRG_CD
    And lk.RISK_STATE = FIPS_US_ALPHA_CD
    And (lk.DEDUCT_MIN_AMOUNT <=   cd.DEDUCT_AMT <= lk.DEDUCT_MAX_AMOUNT)
 If not null
 Then OTC_COLL_COVERAGE = DEDUCT_SIZE_CD
   If is null
   Then
   Select DEDUCT_SIZE_CD 
   From lk_deduct_size_code
   Where lk.STAT_CODE = ‘UCA’
     And lk.CVRG_CD = CVRG_CD
     And lk.RISK_STATE = ‘XX’ 
     And (lk.DEDUCT_MIN_AMOUNT <=   cd.DEDUCT_AMT <= lk.DEDUCT_MAX_AMOUNT)
  If not null 
   Then OTC_COLL_COVERAGE = DEDUCT_SIZE_CD
  Else  
   If is null
     Then OTC_COLL_COVERAGE = ‘000‘ 
Else 
    OTC_COLL_COVERAGE = ‘   ‘  (3 spaces)","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses","dzieverink 8/29/17: DP-2173
Added logic for converted policies. We now do another lookup on the LK_Deduct_Table for converted policies if nothing is returned from previous lookups. This new lookup uses the Cvrg_Cd, FIPS_US_ALPHA, and Deduct_Amt",10/31/2018,ragarwal,"ragarwal 10/23/18: Added logic to to pass through data, if available,  from EDW.PRC_RATING_EXTENSIONS",,,,,,,,,
BR-22634,296 Anti-Thelf Device,"If Stat_Format_Code = 'UCA'
IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'AntiTheftDevice' 
AND 
EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
THEN 
Set ANTI_THEFT_DEVICE = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
Else
Select lk.ANTI_THEFT_DEVICE_ISO 
From lk_anti_theft_device  lk
Where lk.ANTI_THEFT_DEVICE_CD = ANTI_THEFT_DEVICE_CD 
And lk.RISK_STATE = FIPS_US_ALPHA_CD

  If is null
     Then ANTI_THEFT_DEVICE = ‘ ‘
  Else ANTI_THEFT_DEVICE = lk.ANTI_THEFT_DEVICE_ISO","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,10/31/2018,ragarwal,"ragarwal 10/23/18: Added logic to to pass through data, if available,  from EDW.PRC_RATING_EXTENSIONS",,,,,,,,,
BR-22635,297 Original Cost New,"If Stat_Format_Code = 'UCA'
If COST_NEW_AMT > 999000
   Then ORIGINAL_COST_NEW = ‘999’
Else
  If COST_NEW_AMT > 0
   Then ORIGINAL_COST_NEW = (COST_NEW_AMT / 1000) rounded with no decimals (left pad with 0)
Else 
  If STATED_VALUE_AMT > 999000
    Then ORIGINAL_COST_NEW = ‘999’
Else 
  If STATED_VALUE_AMT > 0
   Then ORIGINAL_COST_NEW = (STATED_VALUE_AMT / 1000) rounded with no decimals (left pad with 0)
Else 
    ORIGINAL_COST_NEW = ‘000’","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Premiums",,7/3/2013,jjordan,,,,,,,,,,
BR-22636,298 Price Bracket,"If Original Cost New or Stated Amount is between 1 and 1999 report 001 in Price_Bracket.
If Original Cost New or Stated Amount is greater than or equal to 2000,  and less than 999000, then divide the amount by 1000 and truncate. (ie Value = 998999; 998999/1000 = 998.999) then report 998 in Price_Bracket.
If Original Cost New or Stated Amount is greater than or equal to 999,000 then report '999' in Price Bracket
If both the Original Cost New and Stated Amount are nulls or zeros, then report ‘000’ in Price Bracket.
If both the Original Cost New and Stated Amount have values greater than 0, then use the value you in the Stated Amount to determine the Price Bracket.

Psuedo Code:
If Stat_Format_Code = 'UCA'
IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'VehiclePriceBracket' 
AND 
EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
THEN
Set PRICE_BRACKET = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
ELSE
       If STATED_VALUE_AMT is Between (1 and 1999)
           Then PRICE_BRACKET = ‘001’
       Else
           If STATED_VALUE_AMT >= 999000
              Then PRICE_BRACKET = ‘999’
           Else 
               If STATED_VALUE_AMT > 0
                  Then PRICE_BRACKET = (STATED_VALUE_AMT / 1000) truncated  (left pad with 0)
                   Else 
                         If COST_NEW_AMT is Between (1 and 1999)
                             Then PRICE_BRACKET = ‘001’
                         Else
                             If COST_NEW_AMT >= 999000
                                Then PRICE_BRACKET = ‘999’
                             Else 
                                 If COST_NEW_AMT > 0
                                     Then PRICE_BRACKET = (COST_NEW_AMT / 1000) truncated  (left pad with 0)
                                  Else
                                        PRICE_BRACKET = '000'
                                   end-if 
                                end-if
                              end-if
                           end-if
                       end-if
                    end-if
Else
      Continue
End-if                       

 ","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,10/31/2018,ragarwal,"The intent of this rule is to set the Price Bracket for the UCA STAT area for Reporting purposes.  The Price Bracket will be set using either the Original Cost New or Stated Amount as provided by the source system.  The Price Bracket should be reported in thousands, and truncated.  If neither the Original Cost New or Stated Amount are provided, then the Price Bracket should be defaulted to 000. If both the Original Cost New or Stated Amount are provided, Stated Amount should be used to determine Price Bracket.

ragarwal 10/23/18: Added logic to to pass through data, if available,  from EDW.PRC_RATING_EXTENSIONS
",,,,,,,,,
BR-22637,299 Value Rating Unit,"If Stat_Format_Code = 'UCA'
  IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'ValuePerRatingUnit' 
  AND 
  EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
  THEN 
  Set VALUE_RATING_UNIT = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
  Else
If COST_NEW_AMT > 0
   Then VALUE_RATING_UNIT = ‘B’
Else  
If STATED_VALUE_AMT > 0
    Then VALUE_RATING_UNIT = ‘A’
Else
    VALUE_RATING_UNIT = ‘0’","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,10/31/2018,ragarwal,"ragarwal 10/23/18: Added logic to to pass through data, if available,  from EDW.PRC_RATING_EXTENSIONS",,,,,,,,,
BR-22638,300 Age Code,"If Stat_Format_Code = 'UCA'
  IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'AgeOfVehicle' 
  AND 
  EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
  THEN 
  Set AGE_CODE = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
  Else
  If FIPS_US_ALPHA_CD = 'MA'  
    If RATING_AGE = '1', Then AGE_CODE = '1'
    If RATING_AGE = '2', Then AGE_CODE = '2'
    If RATING_AGE = '3', Then AGE_CODE = '3'
    If RATING_AGE = '4', Then AGE_CODE = '4'
    If RATING_AGE = '5', Then AGE_CODE = '5'
    If RATING_AGE = '6', Then AGE_CODE = '6'
    If RATING_AGE = '7', Then AGE_CODE = '7'
    If RATING_AGE = '8', Then AGE_CODE = '8'
    If RATING_AGE = '9' and Vehcile_Yr > 1980, '9'
    If RATING_AGE = '9' amd Vehicle_Yr <= 1980. '0'
  Else
If RATING_AGE = 1
  Then AGE_CODE = ‘1’
Else
 if RATING_AGE = 2
  Then AGE_CODE = ‘2’
Else
 if RATING_AGE = 3
  Then AGE_CODE = ‘3’
Else
 if RATING_AGE = 4
  Then AGE_CODE = ‘4’
Else
 if RATING_AGE = 5
  Then AGE_CODE = ‘5’
Else
 if RATING_AGE = 6
  Then AGE_CODE = ‘A’
Else
 if RATING_AGE = 7
  Then AGE_CODE = ‘B’
Else
 if RATING_AGE = 8
  Then AGE_CODE = ‘C’
Else
 if RATING_AGE = 9
  Then AGE_CODE = ‘D’
Else
 if RATING_AGE = 10
  Then AGE_CODE = ‘E’
Else
 if RATING_AGE = 11
  Then AGE_CODE = ‘F’
Else
 if RATING_AGE > 11
  Then AGE_CODE = ‘X’
Else AGE_CODE = ‘ ‘

If Pol_Version_Cd begins with ""Z"" and var_RATING_AGE_CONV <= 0
 Then Age_Code = 1
If Pol_Version_Cd begins with ""Z""
  Then Age_Code = var_Rating_Age_Conv
Else
  Age_Code = Rating_Age
","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses","dzieverink 8/29/17: DP-2179 added logic for converted policies (version begins with Z).

DP2461 & DP2561 - Added MA logic",10/31/2018,ragarwal,"dzieverink 11/6/17 - added MA logic

ragarwal 10/23/18: Added logic to to pass through data, if available,  from EDW.PRC_RATING_EXTENSIONS",,,,,,,,,
BR-23465,300.1 Rating Age,"If Accounting Month < 10, then Rating Age = Accounting Year – Model Year + 1

If Accounting Month >= 10, then Rating Age = Accounting Year – Model Year + 2

If Rating Age <= 0, then Rating Age = 1

",ETL - D_Stat_Auto_Losses,element needed for commercial auto conversion,7/3/2017,jjordan,,,,,,,,,,
BR-22639,301 MOD ID,"If Stat_Format_Code = 'UCA'
If FIPS_US_ALPHA_CD in (‘CA’, ’CT’, ’ FL’, ‘GA’, ‘ID’, ‘IL’, ‘IN’, ‘MA’, ‘MD’, ‘MT’)
  And ws.RATE_MOD_FCTR_PACKAGE <> ‘000’
  And ws.RATE_DRUG_FREE_WRKPL <> ‘000’
    Then MOD_ID = ‘5’
Else
  If FIPS_US_ALPHA_CD in (‘CA’, ’CT’, ’ FL’, ‘GA’, ‘ID’, ‘IL’, ‘IN’, ‘MA’, ‘MD’, ‘MT’)
  And ws.RATE_MOD_FCTR_PACKAGE <> ‘000’
    Then MOD_ID = ‘3’
Else
 If ws.RATE_DRUG_FREE_WRKPL <> ‘000’
  Then MOD_ID = ‘1’
else
  MOD_ID = ‘0’",ETL - D_Stat_Auto_Premiums,,7/2/2013,jjordan,,,,,,,,,,
BR-22640,302 Zone Rating Code Garage,"If Stat_Format_Code = 'UCA'
IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'Zone' 
AND 
EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
THEN 
Set ZONE_RATING_CODE_G = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
Else
If GARAGE_ZONE_CD is null 
  Then ZONE_RATING_CODE_G = ‘0’
Else 
  Select PRNCPL_GARAGE_ZONE_CD 
  From LK_AUTO_GARAGE_ZONE lk
  Where GARAGE_ZONE_CD (pos. 1-2)  = lk.GARAGE_ZONE_CD
  If not null
    Then ZONE_RATING_CODE_G = lk.PRNCPL_GARAGE_ZONE_CD
  Else ZONE_RATING_CODE_G = ‘0’","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
",,10/31/2018,ragarwal,"ragarwal 10/23/18: Added logic to to pass through data, if available,  from EDW.PRC_RATING_EXTENSIONS",,,,,,,,,
BR-22641,303 Zone Rating Code Destination,"If Stat_Format_Code = 'UCA'
IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'Zone' 
AND 
EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
THEN 
Set ZONE_RATING_CODE_D = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
Else
If DESTINATION_ZONE_CD is null 
   Then ZONE_RATING_CODE_D =  ‘00’
Else 
   ZONE_RATING_CODE_D = 
 DESTINATION_ZONE_CD (first 2 positions, pad with 0 if only 1 digit provided)","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,10/31/2018,ragarwal,"ragarwal 10/23/18: Added logic to to pass through data, if available,  from EDW.PRC_RATING_EXTENSIONS",,,,,,,,,
BR-22650,304 Size of Risk,Move 0,ETL - D_Stat_Auto_Premiums,,10/17/2013,moreilly,,,,,,,,,,
BR-22651,305 Rate,Move '0000000',ETL - D_Stat_Auto_Premiums,,10/17/2013,moreilly,,,,,,,,,,
BR-22652,306 Aggregate Limit Indicator,Move Spaces ,"ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,10/17/2013,moreilly,,,,,,,,,,
BR-22655,307 Coverage Indicator,Move '0',ETL - D_Stat_Auto_Premiums,,10/17/2013,moreilly,,,,,,,,,,
BR-22656,308 Vehicle Count,"If VEHICLE_COUNT is null
   Then VEHICLE_COUNT = ‘000’
Else VEHICLE_COUNT = VEHICLE_COUNT 
(left pad with 0)","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,7/3/2013,jjordan,,,,,,,,,,
BR-22657,309 Vehicle ID Number,"If RISK_CATG_CD = ‘VEH’
   If VEHICLE_ID_NO is null 
      Then VEHICLE_ID_NO = ‘000’
   Else VEHICLE_ID_NO = VEHICLE_ID_NO 
  (left pad 0) 
Else VEHICLE_ID_NO = ‘000’","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,7/3/2013,jjordan,,,,,,,,,,
BR-22660,310 Facility Loss Type,Move '0',ETL - D_Stat_Auto_Losses,,10/17/2013,moreilly,,,,,,,,,,
BR-23442,311 Injury Type Code,"When VW_CLM_FIN_TRANS.INJURY_TYPE_CD = '0'
   Set INJURY_TYPE_CODE to '  ' (2 spaces)
   EXIT;

Set INJURY_TYPE_CODE = VW_CLM_FIN_TRANS.INJURY_TYPE_CD",ETL - D_Stat_Work_Comp_Losses,,1/4/2017,mmconley,"1/4/17 sconley: Added rule.  
EDW source -  VW_CLM_FIN_TRANS.INJURY_TYPE_CD",,,,,,,,,
BR-23445,312 Weekly Wage,"When VW_CLM_FEAT_PARTY.PARTY_ROLE_CD = 'claimant'
   Set WEEKLY_WAGE = VW_CLM_FEAT_PARTY_HIST.AVG_WEEKLY_WAGE_AMT (left pad with 0)
(If WEEKLY_WAGE is greater than 9999, it is truncated to 9999)",ETL - D_Stat_Work_Comp_Losses,,1/9/2017,mmconley,,,,,,,,,,
BR-23446,313 Claimant Date of Birth,"When VW_CLM_FEAT_PARTY.PARTY_ROLE_CD = 'claimant'
  Set CLAIMANT_DATE_OF_BIRTH (YYMMDD) = VW_PARTY_PERSON.BIRTH_DT ","ETL - D_Stat_Work_Comp_Losses
",,1/5/2017,mmconley,,,,,,,,,,
BR-23447,314 Settlement Method,"When VW_CLM_FEAT_HIST.SETTLEMENT_TYPE_CD = '0' OR is NULL
   Set SETTLEMENT_METHOD to '  ' (2 spaces)
   EXIT;

Set SETTLEMENT_METHOD = VW_CLM_FEAT_HIST.SETTLEMENT_TYPE_CD","ETL - D_Stat_Work_Comp_Losses
",,1/5/2017,mmconley,,,,,,,,,,
BR-23449,315 Jurisdiction State,,"ETL - D_Stat_Work_Comp_Losses
",,1/9/2017,mmconley,,,,,,,,,,
BR-22665,316 Class Description,Move EDW.REF_RATE_CLASS.REF_RATE_CLASS_LONG_NM to FDW.D_BUSINESS.CVRG.CLASS_CODE_DESC,ETL - D_Business_Cvrg,S. Conley: Added with FDW_Core 4074 & 4683 at request of Bonds / MySurety Direct Entry project,11/19/2013,mmconley,"Per Mollie Auberger on 8/13/13, the class code description will be null for FIS rows. The field should be added to the end of the D_BUSINESS_CVRG table.  That way no changes should be needed for the FIS load.

If, perchance, any changes should be required to anything FIS-related, whoever makes these changes to accommodate Bonds’ request should also make the FIS-related changes (Mollie will be happy to peer-review), and the cost charged to Bonds, not FIS.
",,Business,Dimension,,,,,,
BR-22694,317 Chart of Accounts ID ,"Select CHART_OF_ACCOUNTS_ID
From D_CHART_OF_ACCOUNTS
Where ACCOUNT_NUMBER_1_9_CODE =  ‘000000000’","ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums",,6/22/2015,jjordan,,,,,,,,,,
BR-22698,"318 Source Record Type	","Move '01'					","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums",,10/17/2013,moreilly,,,,,,,,,,
BR-22699,"319 Source Record Sub-Type	",Move '02',"ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums",,10/17/2013,moreilly,,,,,,,,,,
BR-22700,"320 Source Producer Group	","Move 'EW'	","ETL - F_Divisional_Premiums
ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums",,10/17/2013,moreilly,,,,,,,,,,
BR-22701,321 Change Amount Calculation,,"ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums
ETL - F_Divisional_Losses",,12/24/2013,moreilly,,,,,,,,,,
BR-22729,321.1 Change Amount Calculation - F Detail Premiums,"If Direct_Ceded_Assumed_CD = ‘C’
   (EARNED_CHANGE_AMOUNT * -1)
Else  CHANGE_AMOUNT = EARNED_CHANGE_AMOUNT",ETL - F_Detail_Premiums,,12/24/2013,moreilly,,,,,,,,,,
BR-22728,321.2 Change Amount Calculation - F Unearned Premiums,"When Building the Unearned record:
If Direct_Ceded_Assumed_CD = ‘C’
   (UNEARNED_CHANGE_AMOUNT * -1)
Else CHANGE_AMOUNT = UNEARNED_CHANGE_AMOUNT



When Building the Inforce record:
Move 0 to CHANGE_AMOUNT
",ETL - F_Unearned_Premiums,,9/18/2013,moreilly,,,,,,,,,,
BR-22776,321.3 Change Amount Calculation - F Divisional Losses,"If CLM_FIN_TRANS_CATG_CD = ‘Payment’
And loss_catg_cd = ‘claimcost’
If Direct_Ceded_Assumed_CD = ‘C’
  LOSS_PYMT_CHG_AMT * -1 
Else 
  LOSS_PYMT_CHG_AMT

If CLM_FIN_TRANS_CATG_CD = ‘Payment’
And loss_catg_cd = ‘expense’
If Direct_Ceded_Assumed_CD = ‘C’
  EXPENSE_PYMT_CHG_AMT * -1 
Else 
  EXPENSE_PYMT_CHG_AMT

If CLM_FIN_TRANS_CATG_CD = ‘RECOVERY’
And loss_catg_cd = ‘expense’

If Direct_Ceded_Assumed_CD = ‘C’
    EXPENSE_RECV_CHG_AMT * -1 
else
     EXPENSE_RECV_CHG_AMT * -1 

If CLM_FIN_TRANS_CATG_CD = ‘RECOVERY’ 
And loss_catg_cd = ‘claimcost’
 If Direct_Ceded_Assumed_CD = ‘C’
   LOSS_RECV_CHG_AMT
else
   LOSS_RECV_CHG_AMT * -1 

If CLM_FIN_TRANS_CATG_CD = ‘Reserve’
And loss_catg_cd = ‘claimcost’
If Direct_Ceded_Assumed_CD = ‘C’
  LOSS_RESV_CHG_AMT * -1 
Else 
  LOSS_RESV_CHG_AMT

Create Reserve takedown
If CLM_FIN_TRANS_CATG_CD = ‘Payment’
And loss_catg_cd = ‘claimcost’
Set the output CLM_FIN_TRANS_CATG_CD = ‘Reserve’
If Direct_Ceded_Assumed_CD = ‘C’
  LOSS_RESV_CHG_AMT * -1 
Else 
  LOSS_RESV_CHG_AMT 

Do not load any expense Reserve rows to the FDW.  (per Joe Poli)
If CLM_FIN_TRANS_CATG_CD = ‘Reserve’
And loss_catg_cd = ‘expense’

Do not load any RECORES rows to the FDW.    (per Joe Poli)
If CLM_FIN_TRANS_CATG_CD = ‘RECORES’ 
And loss_catg_cd = ‘expense’
",ETL - F_Divisional_Losses,,10/18/2013,lkummer,"** recoveries are negative in FDW**
Updated the sign on the Recovery per Dan Kuderer.",,,,,,,,,
BR-22702,322 Balance Amount Calculation,,"ETL - F_Detail_Premiums
ETL - F_Unearned_Premiums",,8/19/2013,moreilly,,,,,,,,,,
BR-22731,322.1 Balance Amount Calculation - F_Divisional_Premiums,"If Direct_Ceded_Assumed_CD = ‘C’
   (EARNED_AMOUNT * -1)
Else BALANCE_AMOUNT = EARNED_AMOUNT",ETL - F_Detail_Premiums,,8/19/2013,moreilly,,,,,,,,,,
BR-22730,322.2 Balance Amount Calculation - F_Unearned_Premiums,"When Building the Unearned record:
If Direct_Ceded_Assumed_CD = ‘C’
   (UNEARNED_AMOUNT * -1)
Else BALANCE_AMOUNT = UNEARNED_AMOUNT


When Building the Inforce record:
If VW_EARNINGS_MTHLY.CVRG_END_DT < EDW_PROCESS_CONTROL sysdate 
Then BALANCE-AMOUNT = 0
Else BALANCE-AMOUNT = VW_EARNINGS_MTHLY.PREMIUM_AMOUNT
",ETL - F_Unearned_Premiums,,8/19/2013,moreilly,,,,,,,,,,
BR-22705,323 Tax Location Code,"Select FIPS_US_Alpha_Cd,
     FIPS_US_Numeric_Cd,
     TAX_LOC_CD,
     POSTAL_CD
From VWTA_Risk_State_Province
Where CATG_CD = ‘RSA’
If TAX_LOC_CD is null
  Then TAX_LOC_CD = ‘00000’
   
Select REIN_STATE_PROVINCE_CODE
from D_GEOGRAPHY G
where FIPS_US_Alpha_Cd = G.FIPS_US_Alpha_Code
  and FIPS_US_Numeric_Cd = G.FIPS_US_Numeric_Code
If is null
  then REIN_STATE_PROVINCE_CODE = ‘00’

TAX-LOCATION-CODE= REIN_STATE_PROVINCE_CODE||TAX_LOC_CD
  Else 
     TAX-LOCATION-CODE = ‘0000000’","ETL - F_Detail_Premiums
ETL - D_Premium_Items
ETL - F_Divisional_Premiums",,12/5/2016,dburns4,"1/30/14: Added F_Divisional_Premiums to the ETL Spec Cross Reference.  Field is SOURCE_TAX_LOCATION.

12/5/16 - Per Blake Ryan, Entrprise BA, for all business units, there are specific states where tax location code would be populated, otherwise would be ""00000'.  Per Blake, tax location code would be populated when FIPS_US_ALPHA_CD in  ('AL', 'AR', 'FL', 'GA', 'IL', 'KS', 'KY', 'LA', 'NJ', 'NY', 'NC', 'ND', 'SC').  Per Michele O'Reilly, there is a tax location service that is called by the source.

",,,,,,,,,
BR-23262,324 Zip Code ID with Policy Daily,"Select ZIP_CODE_ID 
from   D_ZIP_CODE 
where  VWTA_PARTY_STATE_PROVINCE.POSTAL_CD (first 5 bytes) = D_ZIP_CODE.ZIP_CODE

If not found 
  Select ZIP_CODE_ID
  from   D_ZIP_CODE
  where  ZIP_CODE = ‘00000’

Move ZIP_CODE_ID to D_POLICY_DAILY.ZIP_CODE_ID",ETL - D_Policy_Daily,,6/22/2015,jjordan,"The intent of this rule is to determine the zip code associated to the insured so that the zip code id can be stored in the policy daily dimension entity.

7/17/14 sconley: Added rule to DOORS.
I believe the data from ADW.VWTA_PARTY_PLACE_PROVINCE is for the Primary Place row (PRIM_PLACE_IND = 1).
D_ZIP_CODE only has U.S. postal codes and is sourced from the mainframe.  Non U.S. zip codes will get the id for the '00000' row.",,,,,,,,,
BR-23263,325 Zip Code ID with Policy Renewal,"Move  D_POLICY_DAILY.ZIP_CODE_ID to A_POLICY_RENEWALS.ZIP_CODE_ID

",ETL - A_POLICY_RENEWALS,,6/22/2015,jjordan,7/17/14 sconley: Added rule to DOORs.,,,,,,,,,
BR-22735,326 Zip Code ID with Place,"If COUNTRY_NM = ‘United States’ (or could use ISO_COUNTRY_CD = ‘US’)
    Select ZIP_CODE_ID 
    from D_ZIP_CODE 
     where VWTA_Pol_Risk_State_Province.Postal_Cd (first 5 bytes) =   D_ZIP_CODE.ZIP_CODE

   if not found 
       Then select ID where ZIP_CODE = ‘00000’
   else
       move the zip_code_id selected to the d_place.zip_code_id
   end-if
end-if",ETL - D_Place,,6/22/2015,jjordan,"The intent of this rule is to determine the zip code associated to the risk so that the zip code id can be stored in the place dimension entity.
",,,,,,,,,
BR-22736,327 Geography ID with Place,"Select GEOGRAPHY_ID 
from D_GEOGRAPHY
where  VWTA_Pol_Risk_State_Province.FIPS_US_Alpha_Cd = D_GEOGRAPHY.FIPS_US_Alpha_Cd
and VWTA_Pol_Risk_State_Province.FIPS_US_Numeric_Cd = D_GEOGRAPHY.FIPS_US_Numeric_Cd
if not found select ID
   where STATE_PROVINCE_CODE = ‘Def’
   move geography_id to d_place.geography_id
else
   move geography_id to d_place.geography_id
end-if",ETL - D_Place,,6/22/2015,jjordan,"The intent of this rule is to determine the geography dimension id associated to the risk so that the geography id can be stored in the place dimension entity.
",,,,,,,,,
BR-22737,328 Risk Address,"Select 
       STREET_ADDR_1
       STREET_ADDR_2
       STREET_ADDR_3
       STREET_ADDR_4
       CITY
       STATE
       ZIP_CODE
       POSTAL_CD
      COUNTY
      COUNTRY
      TAX LOCATION CODE
       
From  VWTA_Pol_Risk_State_Province
Where CATG_CD = ‘RSA’",ETL - D_Place,,9/12/2013,moreilly,,,,,,,,,,
BR-22738,329 Location Name,Assign the location_nm to all d-place rows for the policy and not just the to the row with the risk-catg-cd = FRMLOC,ETL - D_Place,,9/12/2013,moreilly,,,,,,,,,,
BR-22739,330 Contact Name,"If VW_POL_TERM_PARTY.ROLE_CD = 'PRICONTCT'
   Then select this row
Else if null 
   Then select row where VW_POL_TERM_PARTY.ROLE_CD = 'PRI'  ",ETL - D_Place,,9/12/2013,moreilly,,,,,,,,,,
BR-22740,331 Contact Phone with Area Code,"If PRIM_PHONE_IND = 1
  Then select this row
Else if null 
   Then select row PRIM_PHONE_IND = 0
     And PHONE_CATG_CD = ‘PW’ 
     Then PHONE_CATG_CD = ‘PH’ 
      Then PHONE_CATG_CD = ‘CE’
      Then PHONE_CATG_CD = ‘0’",ETL - D_Place,,9/12/2013,moreilly,,,,,,,,,,
BR-22741,332 Owner Tenant Code,Assign the owner-tenant-cd to all d-place rows for the policy and not just the to the row with the risk-catg-cd = FRMDWL,ETL - D_Place,,9/12/2013,moreilly,,,,,,,,,,
BR-22744,333 Claim ID,,"ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - D_Claim_Hist",,9/30/2013,moreilly,,,,,,,,,,
BR-22805,333.1 Select Claim ID for Divisional Losses and Expense Payments,"Select x.CLAIM_NUMBER 
from ADW.CLAIM_LEGACY_XREF x 
where  CLAIM_NO_CD = clm_no_cd 
and x.CLAIM_FEATURE_ORDER_NO = clm_feat_order_no

Select CLAIM_ID
From D_CLAIM
Where CLAIM_NUMBER = x.CLAIM_NUMBER
And POLICY_ID = policy_id
And PRODUCER_PROFIT_CENTER_ID = a_producer_profit_center_id 
","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses",,9/30/2013,moreilly,,,,,,,,,,
BR-22803,333.2 Select Claim ID for Claim History Dimension,"Select CLAIM_ID 
from D_CLAIM
where claim_number = C.claim_number",ETL - D_Claim_Hist,,9/30/2013,moreilly,,,,,,,,,,
BR-22750,334 Catastrophe Code ID,,"ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
ETL - D_Claim_Hist
",,11/11/2013,dzieverink,,,,,,,,,,
BR-22817,334.1 Catastrophe Code ID for Claims History,"Select CATASTROPHE_CODE_ID
From D_CATASTROPHE_CODE
Where serial_no_cd = C.catastrophe_code
And event_yr = C.catastrophe_year
And begin_dt - C.begin_dt",ETL - D_Claim_Hist,,10/1/2013,dzieverink,,,,,,,,,,
BR-22819,334.2 Catastrophe Code ID,"Select  SERIAL_NO_CD, 
      EVENT_YR, 
      EVENT_CATG_LONG_DESC
From VWTA_CLM_EVENT_CAT
Where VWTA_CLAIM.EVENT_CAT_ID = VWTA_CLM_EVENT_CAT.EVENT_CAT_ID
If row is found
 Then  
  CATASTROPHE-CODE = SERIAL_NO_CD
  CATASTROPHE-YEAR = EVENT_YR
  CATASTROPHE-TYPE = EVENT_CATG_LONG_DESC
Else 
  CATASTROPHE-CODE = ‘0’
  CATASTROPHE-YEAR =  VWTA_CLAIM.LOSS_DT (YYYY)
  CATASTROPHE-TYPE = ‘Internal’
End-if

Select CATASTROPHE_CODE_ID 
From D_CATASTROPHE_CODE
Where CATASTROPHE_CODE = serial_no_cd
and CATASTROPHE_YEAR = event_yr
and CATASTROPHE_TYPE = event_catg_long_desc
and BUSN_UNIT_NM = event_busn_nm
  If null
 Then 
Select CATASTROPHE_CODE_ID 
From D_CATASTROPHE_CODE
Where  CATASTROPHE_CODE = ‘0’
and CATASTROPHE_YEAR =  loss_dt 
and CATASTROPHE-TYPE = ‘Internal’
and BUSN_UNIT_NM = null ","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
",,6/22/2015,jjordan,"The intent of this rule is to associate the appropriate catastrophe code associated with the Financial transaction.
",,,,,,,,,
BR-22864,334.3 Catastrophe Code ID for Catastrophe Code Dimension,"Select LAST_ID_VALUE
From TABLE_KEYS
Where TABLE_NAME = 'D_CATASTROPHE_CODE'
Continue to generate the ID value.",ETL - D_Catastrophe_Code,,10/2/2013,dzieverink,,,,,,,,,,
BR-22751,335 Loss Items ID,"Select FDW_CODE “claim_cd”
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘CLAIM_TYPE_CODE’
and EDW_ITEM_CD = Clm_fin_trans_catg_cd 

Select FDW_CODE “status_cd”
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘MASTER_STATUS_CODE’
and EDW_ITEM_CD = Status_catg_cd

Select LOSS_ITEMS_ID
From D_LOSS_ITEMS 
Where CLAIM_TYPE_CODE = claim_cd
And LOSS_TYPE_CODE = ‘0’
And MASTER_STATUS_CODE = status_cd
And PIP_TYPE_OF_LOSS_CODE = ‘0’
And PIP_FINAL_BENEFITS_INDICATOR = null
And NJ_PIP_INDICATOR = null
And TYPE_DISABILITY_CODE = null","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
",,9/18/2013,moreilly,,,,,,,,,,
BR-22752,336 Expense Payment ID,"Select EXPENSE_PAYMENT_ID 
From D_EXPENSE_PAYMENT_CODE
where EXPENSE_PAYMENT_CODE = lineitem_catg_cd",ETL - F_Div_Expense_Payment,,9/16/2013,moreilly,,,,,,,,,,
BR-22754,337 Draft Region Number,"If PRFX_NO is not NULL
   Then DRAFT-REGION-NUMBER = PRFX_NO 
Else 
If REGION_CD <> ‘0’ 
  Then DRAFT-REGION-NUMBER = REGION_CD
Else null","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses",,9/18/2013,moreilly,,,,,,,,,,
BR-22755,338 Payment Amount,"If clm_fin_trans_catg_cd= ‘Payment’
  And loss_catg_cd = ‘expense’
  If Direct_Ceded_Assumed_CD = ‘C’
    EXPENSE_PYMT_CHG_AMT * -1
  Else 
    EXPENSE_PYMT_CHG_AMT 
  end-if
end-if",ETL - F_Div_Expense_Payment,,9/17/2013,moreilly,,,,,,,,,,
BR-22756,339 Stop Payment Code,"If CHECK_STATUS_CATG_CD = ‘Stopped’
 Then STOP_PAYMENT_CODE  = ‘Y’ 
else null
end-if","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses",,9/18/2013,moreilly,,,,,,,,,,
BR-22757,340 Stop Payment Date,"If CHECK_STATUS_CATG_CD = ‘Stopped’
 Then STOP_PAYMENT_DATE  = TRANS_EFF_DT   
else null  
end-if","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses",,9/18/2013,moreilly,,,,,,,,,,
BR-22758,341 Incurred Effected Amount,"If CHECK_STATUS_CATG_CD = ‘Stopped’
  INCURRED_EFFECT_AMOUNT = 0
Else 
If clm_fin_trans_catg_cd= ‘Payment’
 And loss_catg_cd = ‘expense’
 If Direct_Ceded_Assumed_CD = ‘C’
   EXPENSE_PYMT_CHG_AMT * -1 
 Else 
   EXPENSE_PYMT_CHG_AMT",ETL - F_Div_Expense_Payment,,9/17/2013,moreilly,,,,,,,,,,
BR-22759,342 Reinsurance Percent,"Select LIMIT_PCNT
From VW_REINS_CONTR_LIMIT 
Where CATG_CD = ‘PCNT’
And REINS_LIMIT_PUR_CD = ‘CDPART’
If a row does not exist, move 0",ETL - F_Div_Expense_Payment,,9/17/2013,moreilly,,,,,,,,,,
BR-22765,343 Contractor Number,CONTRACTOR_NUMBER = ‘000000’,ETL - F_Div_Expense_Payment,,9/17/2013,moreilly,,,,,,,,,,
BR-22760,344 Contractor ID,"Select CONTRACTOR_ID 
From D_CONTRACTOR
Where CONTRACTOR_NUMBER = ‘000000’
and PERSONAL_COMMERCIAL_INDICATOR = ‘2’",ETL - F_Div_Expense_Payment,,9/17/2013,moreilly,,,,,,,,,,
BR-22761,345 Master Status Code,"Select FDW_CODE 
from LK_FDW_TO_EDW_REF 
where FDW_REF_DESC = ‘MASTER_STATUS_CODE’
and EDW_ITEM_CD = Status_catg_cd","ETL - F_Div_Expense_Payment
ETL - F_Div_OS_Reserve
ETL - D_CLAIM

",,2/4/2015,lkummer,"This field is figured in the EDW_ADW mappings:
m_s_clm_feat_date_clm_feat_date
m_s_clm_feat_date_agg_clm_fin_trans_expense
m_s_clm_feat_date_agg_clm_fin_trans

valuesof edw_item_code
 0 = OPEN, 1 = OPEN, 2 = CLOSED",,,,,,,,,
BR-22762,346 Accident State ID,,"ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses
ETL - F_Div_OS_Reserve
ETL - D_Claim_Hist
",,11/11/2013,dzieverink,,,,,,,,,,
BR-22771,346.1 Accident State ID associated with the Divisional Expense Payment Financial Transaction,"Select GEOGRAPHY_ID 
from D_GEOGRAPHY 
where FIPS_US_ALPHA_CODE = 
loss_loctn_fips_us_alpha_cd
 and FIPS_US_NUMERIC_CODE = loss_loctn_fips_us_numeric_cd",ETL - F_Div_Expense_Payment,,9/18/2013,moreilly,,,,,,,,,,
BR-22770,346.2 Accident State ID associated with the Divisional Loss Financial Transaction,"IF loss_loctn_fips_us_alpha_cd in (‘ –‘)
   Then 
   Select GEOGRAPHY_ID 
   From D_GEOGRAPHY 
   where REIN_STATE_PROVINCE_CODE = ‘99’ 
ELSE 
  Select GEOGRAPHY_ID 
  from D_GEOGRAPHY  
  where FIPS_US_ALPHA_CODE = 
loss_loctn_fips_us_alpha_cd
  and FIPS_US_NUMERIC_CODE = loss_loctn_fips_us_numeric_cd","ETL - F_Divisional_Losses
",,9/18/2013,moreilly,,,,,,,,,,
BR-22798,346.3 Accident State ID associated with the Divisional Outstanding Reserve Financial Transaction,"Where CLM_PLACE_CATG_CD = ‘LOSSLOCTN’
Select GEOGRAPHY_ID 
from D_GEOGRAPHY 
where FIPS_US_Alpha_Cd = FIPS_US_ALPHA_CODE
and FIPS_US_Numeric_Cd = FIPS_US_NUMERIC_CODE",ETL - F_Div_OS_Reserve,,11/11/2013,dzieverink,,,,,,,,,,
BR-22811,346.4 Accident State ID associated with the Claim History,"Select FIPS_US_ALPHA_CD,
       FIPS_US_NUMERIC_CD

From VWTA_CLM_LOSSLOCTN
Where CLM_Place_Catg_Cd = 'LOSSLOCTN'

Select GEOGRAPHY_ID
From D_GEOGRAPHY G2
Where FIPS_US_ALPHA_CD = G2.FIPS_US_ALPHA_CD and
FIPS_US_NUMERIC_CD = G2.FIPS_US_NUMERIC_Code",ETL - D_Claim_Hist,,9/30/2013,dzieverink,,,,,,,,,,
BR-22766,347 Claim Financial Transaction ID,"Select CLAIM_FIN_TRANS_ID 
From D_CLAIM_FIN_TRANS cft
Where COST_CATG_CD = cft.COST_CATG_CD
and CLM_FIN_TRANS_CATG_CD = cft.CLAIM_FIN_TRANS_CATG_CD
and LOSS_CATG_CD = cft.LOSS_CATG_CD
and FIN_TRANS_GRP_CG_CD = cft.FIN_TRANS_GROUP_CATG_CD
and FIN_TRNS_STAT_CATG_CD = cft.FIN_TRANS_STATUS_CATG_CD
and LINEITEM_CATG_CD = cft.LINEITEM_CATG_CD
and PYMT_CATG_CD = cft.PAYMENT_CATG_CD
and COLLECTION_CATG_CD = cft.COLLECTION_CATG_CD
and COLLECTION_DTL_CATG_CD = cft.COLLECTION_DETAIL_CATG_CD

If not found move 0","ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses","FDW_Core 4596: No code change. Updated rule to match the code.  EDW field vw_clm_fin_trans_hist.fin_trns_stat_catg_cd is not used in the look-up.  Speculate it is because the fin_trns_stat_catg_cd can change many times during an accounting month and the cardinality between tables clm_fin_trans and clm_find_trans_lineitem / clm_fin_trans_hist is one-to-many, so it would take a lot of logic to determine which status the transaction should pick-up.   Explained the situation to the downstream users and fin_trans_status_catg_cd is not used in any reporting, so decision was made not to add the field to the look-up code. ",11/21/2013,mmconley,"EDW Source Fields
vw_clm_fin_trans.cost_catg_cd
vw_clm_fin_trans.clm_fin_trans_catg_cd 
vw_clm_fin_trans.loss_catg_cd
vw_clm_fin_trans.fin_trans_grp_cg_cd
vw_clm_fin_trans_hist.fin_trns_stat_catg_cd
vw_clm_fin_trans_lineitem.lineitem_catg_cd
vw_clm_fin_trans_pymt.pymt_catg_cd 
vw_clm_fin_trans_collection.collection_catg_cd

Because fin_trns_stat_catg_cd is not part of the look-up but is part of the business key, multiple rows may be returned and the ETL will arbitrarily pick one and attached the claim_fin_trans_id to f_divisional_losses and f_div_expense_payment.  FDW field d_claim_fin_trans.fin_trans_status_catg_cd is not used in any reporting, so decision was made not to add the field to the look-up code (FDW_Core 4596). 

Collection_detail_catg_cd does not exist in EDW or FDW so it was removed from Doors BR.

",,,,,,,,,
BR-22767,348 Draft Accounting Date,concatenate accting_mo || 01 || accting_yr,"ETL - F_Div_Expense_Payment
ETL - F_Divisional_Losses",,9/18/2013,moreilly,,,,,,,,,,
BR-22768,349 Paid Transaction ID and Reserve Transaction ID,"If Direct_Ceded_Assumed_CD in (‘A’, ‘C’)
  IF contr_catg_CD <> ‘0’
    Then CONTRACT-TYPE  = contr_catg_cd  
  Else 
 IF Involuntary_catg_cd = ‘F’ 
    Then CONTRACT-TYPE = 'FACILITY'
  Else  CONTRACT-TYPE = ‘0’
IF EXPENSE_PAYMENT_CATEGORY_CD in  (S, X)
Then RECOVERY-TYPE = Expense_payment_category_cd
Else 
If collection_catg_cd <> 0 
 Then RECOVERY-SOURCE-CODE = collection_catg_cd
Else ‘0’

(Select * 
from lk_transaction_type
Where SOURCE_TRANSACTION_TYPE = Direct_Ceded_Assumed_CD
Aand SOURCE_CONTRACT_TYPE_CODE = CONTRACT-TYPE
And Source_System_Id = 48

Select * 
From lk_amount_type
Where MAJOR_SOURCE_CODE = clm_fin_trans_catg_cd
And MINOR_SOURCE_CODE = loss_catg_cd
And RECOVERY_SOURCE_CODE = RECOVERY-TYPE
And Source_System_Id = 48)

Then
Select TRANSACTION_ITEMS_ID 
From D_TRANSACTION_ITEMS 
Where AMOUNT_CATEGORY_1_DESC = lk.amount_category_1_desc
And AMOUNT_CATEGORY_2_DESC = lk.amount_category_2_desc
And AMOUNT_CATEGORY_3_DESC = lk.amount_category_3_desc
And AMOUNT_CATEGORY_4_DESC = lk.amount_category_4_desc
And AMOUNT_CATEGORY_5_DESC = lk.amount_category_5_desc
And REIN_TRANSACTION_TYPE_CODE = lk.rein_transaction_type_code
And SUB_SYSTEM_DESC = lk.sub_system_desc
And SOURCE_SYSTEM_ID = lk.source_system_id ",ETL - F_Divisional_Losses,,6/22/2015,jjordan,"The intent of this rule is to set both the Paid Transaction ID and the Reserve Transaction ID using the lookup tables for transaction type and amount type.  Once returned these values are then used to access the transaction items dimension table.  The Transaction Items ID is placed in both the Paid Transaction ID and the Reserve Transaction ID.
",,,,,,,,,
BR-22772,350 Claim Items ID,"Select x.CLAIM_NUMBER 
from ADW.CLAIM_LEGACY_XREF x 
where  CLAIM_NO_CD = clm_no_cd 
and x.CLAIM_FEATURE_ORDER_NO = clm_feat_order_no

Select CLAIM_ITEMS_ID 
from D_CLAIM_ITEMS
Where KEY_CLAIM_OFFICE = SUBSTR(x.CLAIM_NUMBER,1,3)
And KEY_OFFICE_NUMBER = SUBSTR(x.CLAIM_NUMBER,4,6)
And KEY_CLAIMANT_NUMBER = SUBSTR(x.CLAIM_NUMBER,10,3)
And AVERAGE_RESERVE_INDICATOR = null
And CLAIM_SYMBOL_CODE = claim_symbol_cd",ETL - F_Divisional_Losses,,9/18/2013,moreilly,,,,,,,,,,
BR-22773,351 Draft Serial Number,"If CLM_FIN_TRANS_CATG_CD = ‘RECOVERY’ 
    Then DRAFT-SERIAL-NUMBER = collection_recpt_no
Else 
   DRAFT-SERIAL-NUMBER = CHECK_NO",ETL - F_Divisional_Losses,,9/18/2013,moreilly,,,,,,,,,,
BR-22796,352 Contract Category,"If Direct_Ceded_Assumed_CD in (‘A’, ‘C’)
  IF contr_catg_CD <> ‘0’
    move contr_catg_CD  to CONTRACT-TYPE
  ELSE-IF Involuntary_CATG_CD = ‘F’ 
    move ‘FACILITY’ to CONTRACT-TYPE
  ELSE ‘0’

Select FDW row for SOURCE_SYSTEM_ID = 48",ETL - F_Div_OS_Reserve,,9/23/2013,moreilly,,,,,,,,,,
BR-22802,"353 Select Minor Line, Parent Business Coverage, IASL and Package Code","If VWA.POL_SYMBOL_CD in (‘AFP’)
 And B1.RISK_CATG_CD in (‘FPOPS’, ’FRMLOC’)
 And B1.CVRG_CD in ('TAXSURCHRG', 'BMPTAXSUR', 'BRMPTAXSUR')
Then 
  Select 
   PARENT_BUSN_CVRG_CD,
   MINOR_LINE_CD, 
   PACKAGE_CD,
   IASL_CD,
   PC_IND ,
   COVERAGE_CODE_FORM_CODE
 From LK_MINOR_LINE_PKG_XREF LK
 Where LK.CVRG_CD = B1.CVRG_CD
  And LK.POLICY_SYMBOL = VWA.POL_SYMBOL_CD
  And LK.RISK_CATG_CD = B1.RISK_CATG_CD
  And LK.CVRG_CATG_CD = B1.CVRG_CATG_CD
  And LK.SUBLINE_CD = ‘NR’
  And LK.CAUSE_OF_LOSS = ‘BROAD’
  And LK.STAT_PACKAGE_IND = ph.PACKAGE_IND
  And LK.CLAIMS_MADE_IND = ch.CLAIMS_MADE_IND

Else  
 Select 
   PARENT_BUSN_CVRG_CD,
   MINOR_LINE_CD, 
   PACKAGE_CD,
   IASL_CD,
   PC_IND ,
   COVERAGE_CODE_FORM_CODE
 From LK_MINOR_LINE_PKG_XREF LK 
 Where LK.CVRG_CD = B1.CVRG_CD
  And LK.POLICY_SYMBOL = VWA.POLICY_SYMBOL
  And LK.RISK_CATG_CD = B1.RISK_CATG_CD
  And LK.CVRG_CATG_CD = B1.CVRG_CATG_CD
  And LK.SUBLINE_CD = CR.SUBLINE_CD
  And LK.STAT_PACKAGE_IND = ph.PACKAGE_IND
  And LK.CLAIMS_MADE_IND = ch.CLAIMS_MADE_IND

If row is not found
 Then 
   Select 
    PARENT_BUSN_CVRG_CD,
    MINOR_LINE_CD, 
    PACKAGE_CD,
    IASL_CD,
    PC_IND ,
    COVERAGE_CODE_FORM_CODE
 From LK_MINOR_LINE_PKG_XREF LK
 Where LK.CVRG_CD = B1.CVRG_CD
  And LK.POLICY_SYMBOL = VWA.POLICY_SYMBOL
  And LK.RISK_CATG_CD = B1.RISK_CATG_CD
  And LK.CVRG_CATG_CD = B1.CVRG_CATG_CD
  And LK.STAT_PACKAGE_IND = ph.PACKAGE_IND
  And LK.CLAIMS_MADE_IND = ch.CLAIMS_MADE_IND
  
If row is not found
 Then 
   Select 
    PARENT_BUSN_CVRG_CD,
    MINOR_LINE_CD, 
    PACKAGE_CD,
    IASL_CD,
    PC_IND ,
    COVERAGE_CODE_FORM_CODE
 From LK_MINOR_LINE_PKG_XREF LK
 Where LK.CVRG_CD = B1.CVRG_CD
  And LK.POLICY_SYMBOL = ‘ANY’
  And LK.RISK_CATG_CD = B1.RISK_CATG_CD
  And LK.CVRG_CATG_CD = B1.CVRG_CATG_CD
  And LK.STAT_PACKAGE_IND = ph.PACKAGE_IND
  And LK.CLAIMS_MADE_IND = ch.CLAIMS_MADE_IND",ETL - Minor Line Pkg Code Assignments,,7/31/2015,mmconley,"7/31/15 sconley:
EDW source fields
LK.Cvrg_Cd = Vw_Coverage.Cvrg_Cd
And
LK.Policy_Symbol = Vw_Pol_Term_Hist.Pol_Symbol_Cd
And
LK.Risk_Catg_Cd = Vw_Risk.Risk_Catg_Cd
And
LK.Cvrg_Catg_Cd = Vw_Busn_Cvrg.Cvrg_Catg_Cd
And
LK.Stat_Package_Ind = Vw_Pol_Term_Hist.Package_Ind
And
LK.Claims_Made_Ind = Vw_Cvrg_Hist.Claims_Made_Ind",,,,,,,,,
BR-22820,354 Open Date,,"ETL - D_Claim_Hist
ETL - D_Claim",,10/15/2013,dzieverink,,,,,,,,,,
BR-22927,354.1 Open Date for Claims,"The date in which a claim feature (Claim Feature ID) is recorded as financially open for the first time in the Company's warehousing systems.  This is from a loss perspective and expense perspective.

In the instance where the feature is re-opened, this value will not change.

This field is populated only if the primary adjuster verifies an exposure for the feature and initially determines that future liability exists.  The feature's direct or assumed loss reserve and/or direct or assumed expense reserve will be changed from zero to an actual value at this time.  A loss payment or expense payment without the express creation of a loss or expense reserve will also result in this field being populated.

Date = date of first reserve (loss or expense) OR date of first payment (loss or expense) whichever is first.
",ETL - D_Claim,,10/15/2013,dzieverink,,,,,,,,,,
BR-22928,354.2 Open Date for Claims History,"Select *
From clm_feat_date,
      EDW_accting_mo
Where accting_yr = E.accting_yr
And accting_mo = E.accting_yr",ETL - D_Claim_Hist,,10/15/2013,dzieverink,,,,,,,,,,
BR-22822,355 Claim Number,,"ETL - D_Claim_Legacy_Xref
ETL - D_Claim
ETL - A_NAL_Losses_EDW
ETL - D_Structured_Settlement
ETL - D_Claim_Support
ETL - Lk_Nal_Claim_Unit_Xref
ETL - D_Claim_Hist
",,12/23/2013,moreilly,,,,,,,,,,
BR-22836,355.1 Claim Number,Concatenate (KEY_CLAIM_OFFICE || KEY_CLAIM_NUMBER || KEY_CLAIMANT_NUMBER || KEY_CLAIM_FEATURE),ETL - D_Claim_Legacy_Xref,,10/1/2013,dzieverink,,,,,,,,,,
BR-22885,355.2 Claim Number for Structured Settlement,"Select CLAIM_NUMBER from
CLAIM_LEGACY_XREF",ETL - D_Structured_Settlement,,10/21/2013,dzieverink,,,,,,,,,,
BR-22944,355.3 Claim Number,"Select CLAIM_NUMBER
from D_CLAIM_LEGACY_XREF x
where x.CLAIM_NO_CD = vwta_CLAIM.CLM_NO_CD and
x.CLAIMANT_EBI_NO = VWTA_CLM_FEAR_CLAIMANT.PARTY_INST_EBI_NO and
x.CLAIM_FEATURE_ORDER_NO = vwta_CLM_FEAT.CLM_FEAT_ORDER_NO","ETL - D_Claim_Support
ETL - Lk_Nal_Claim_Unit_Xref
ETL - D_Claim_Hist",,12/23/2013,moreilly,,,,,,,,,,
BR-22823,356 Key Claim Office,Move positions 1-3 of the CLM_NO_CD to KEY_CLAIM_OFFICE,ETL - D_Claim_Legacy_Xref,,11/11/2013,dzieverink,,,,,,,,,,
BR-22824,357 Key Claim Number,Move positions 4-9 of the CLM_NO_CD to KEY_CLAIM_NUMBER,ETL - D_Claim_Legacy_Xref,,11/11/2013,dzieverink,,,,,,,,,,
BR-23073,357.1 Key Claim Number,Move positions 4-9 of the CLM_NO_CD to KEY_CLAIM_NUMBER,ETL - D_Claim_Legacy_Xref,,11/11/2013,dzieverink,,,,,,,,,,
BR-22825,358 Key Claimant Number,Set KEY_CLAIMANT_NUMBER = 01,ETL - D_Claim_Legacy_Xref,,10/1/2013,dzieverink,,,,,,,,,,
BR-22872,359 Last Update Date,Move Null,"ETL - D_Customer
",,11/11/2013,dzieverink,,,,,,,,,,
BR-23282,360 Loss Date,LOSS_DATE = vw_clm_hist.loss_dt,"ETL - D_Claim
ETL - D_Claim_Hist ",,7/21/2015,mmconley,7/21/15 sconley: Added rule; sourced from EDW,,,,,,,,,
BR-22929,361 Close Date,"The date in which a claim feature (Claim Feature ID) is recorded as financially closed for the first time in the Company's warehousing systems.  This is from a loss and expense perspective.

In the instance where the feature is re-opened, this value will not change.  

This field is populated only if a previous Claim Feature Initial Open Date exists for a specific feature and the adjuster’s initial interpretation determines that no future liability exists.  The feature's original direct or assumed loss reserve AND original direct or assumed expense reserve will be changed from an actual value to zero at this time.  If either reserve remains open, the claim feature remains open.  The field is populated only with both reserves are set to zero.

Date = date when both loss and expense reserve = 0 for the first time.
",ETL - D_Claim,,10/16/2013,dzieverink,,,,,,,,,,
BR-22930,362 Re-Open Date,"Each date where a claim feature (Claim Feature ID) was previously closed for financial reporting purposes, but the current primary adjuster receives knowledge that once again future liability exists and therefore needs to re-open the closed feature.  This is also from a loss or expense perspective.  Note: additional loss or expense payments without the establishment of loss or expense reserves will not result in a re-open date.

The date is only populated if the feature has been either:
[1] Previously initially closed and never previously re-opened, or
[2] Previously re-closed.  

The feature's direct or assumed loss and/or expense reserve will be changed from zero to an actual value at this time.

In the case of multiple re-opens, each re-open date will be captured and stored.
",ETL - D_Claim,,10/16/2013,dzieverink,,,,,,,,,,
BR-22931,363 Re-Close Date,"Each date where a claim feature (Claim Feature ID) was previously re-opened for financial reporting purposes, but the current adjuster receives knowledge that once again future liability no longer exists.  This is from a loss and expense perspective.

This date is only populated if the feature has previously been re-opened and financial risk no longer exists.  The feature's direct or assumed loss AND direct or assumed expense reserve will be changed from an actual value to zero at this time.  If either reserve remains open, the claim feature remains open.  The field is populated only with both reserves are set to zero.

In the case of multiple re-opens, each re-close date will be captured and stored.
",ETL - D_Claim,,10/16/2013,dzieverink,,,,,,,,,,
BR-22942,364 Profit Center,,"ETL - A_Auto_Premiums
ETL - A_Private_Auto_Premiums
",,11/11/2013,dzieverink,,,,,,,,,,
BR-23051,364.1 Profit Center for Auto Premiums,"Select CURRENT_PROFIT_CENTER
from D_PRODUCER_PROFIT_CENTER","ETL - A_Auto_Premiums
ETL - A_Private_Auto_Premiums",,10/28/2013,dzieverink,,,,,,,,,,
BR-22943,365 Policy Number,Select POLICY_NUMBER from D_POLICY,"ETL - A_Auto_Premiums
ETL - A_Private_Auto_Premiums",,10/22/2013,dzieverink,,,,,,,,,,
BR-22964,"366 Insured Phone	",AREA_CD || PHONE_NUMBER,,,10/24/2013,dzieverink,,,,,,,,,,
BR-22950,367 Legal Entity Code,"Select VW_Party_Org.SHORT_NM,
From VW_Party_ORG,
D_Company
Where D_COMPANY.COMPANY_CODE = VW_Party_Org.ORG_CD",ETL - D_Company,,10/22/2013,dzieverink,,,,,,,,,,
BR-22951,368 ISO Code,"Select VW_Party_Org.ISO_CD,
From VW_Party_ORG,
D_Company
Where D_COMPANY.COMPANY_CODE = VW_Party_Org.ORG_CD",ETL - D_Company,,10/22/2013,dzieverink,,,,,,,,,,
BR-22952,369 AMB Code,"Select VW_Party_Org.AMB_CD,
From VW_Party_ORG,
D_Company
Where D_COMPANY.COMPANY_CODE = VW_Party_Org.ORG_CD",ETL - D_Company,,10/22/2013,dzieverink,,,,,,,,,,
BR-23085,370 Reinsurance Contract Number Code,"Select *  
From D_REINSURANCE_COMPANY d
Where d.REINS_CONTRACT_NO_CODE = VW_REINS_CONTR.CONTR_NO_CD
If found, do nothing.

If not found
Select *  
From D_REINSURANCE_COMPANY d
Where d.REINSURANCE_COMPANY_CODE = VW_REINS_CONTR.CONTR_NO_CD (first 4 digits) 

Generate next row in D_REINSURANCE_COMPANY 
where all the columns are populated 
from the row found and populate the d.REINS_CONTRACT_NO_CODE from the  VW_REINS_CONTR.CONTR_NO_CD 

INSERT INTO FDW.D_REINSURANCE_COMPANY
SELECT
  Generate next ID REINSURANCE_COMPANY_ID ,
  REINSURANCE_COMPANY_CODE ,   
  REINSURANCE_COMPANY_DESC ,
  SET_ID ,
  SOURCE_SYSTEM_ID ,
  SYSDATE,                 
  null LAST_UPDATE_DATE ,   
  CONTR_NO_CD REINS_CONTRACT_NO_CODE           
FROM  FDW.D_REINSURANCE_COMPANY
WHERE REINSURANCE_COMPANY_CODE  = CONTR_NO_CD
AND REINSURANCE_COMPANY_CODE = REINS_CONTRACT_NO_CODE",ETL - D_Reinsurance_Company,,10/28/2013,dzieverink,,,,,,,,,,
BR-23230,"371 Policy Status	","Rule executed in script of vwa_pol_term_hist in ADW
         ,CASE
             WHEN vw_pol_term_hist.cancel_dt <= process_dt.edw_busn_dt
             THEN
                'C'
             WHEN vw_pol_term_hist.pol_term_exp_dt <= process_dt.edw_busn_dt
             THEN
                'E'
             WHEN vw_pol_term.pol_term_eff_dt > process_dt.edw_busn_dt
             THEN
                'A'
             ELSE
                'I'
          END
             pol_status_cd
         ,CASE
             WHEN vw_pol_term_hist.cancel_dt <= process_dt.edw_busn_dt
             THEN
                'Cancelled'
             WHEN vw_pol_term_hist.pol_term_exp_dt <= process_dt.edw_busn_dt
             THEN
                'Expired'
             WHEN vw_pol_term.pol_term_eff_dt > process_dt.edw_busn_dt
             THEN
                'Advance'
             ELSE
                'Inforce'
          END
             pol_status_desc
",,,6/5/2014,lkummer,,,,,,,,,,
BR-23246,372 Aggregate Deductible Amount,Use the 4 digit Scope Class Code for this policy's aggregated deductible,"ETL - D_Stat_Work_Comp_Premiums
ETL - D_Stat_Work_Comp_Losses",,7/11/2014,lkummer,,,,Dimension,,,,,,
BR-23254,373 Aggregate Deductible Dollars,"TBD
Aggregate Deductible Dollar amount 
will this be populated when deductible amount is not?   (2 different class codes)","ETL - D_Stat_Work_Comp_Premiums
ETL - D_Stat_Work_Comp_Losses",,7/11/2014,lkummer,,,,,,,,,,
BR-23248,"374 Deductible Type	","(need to Review) 
Identify the type of deductible that is applied to the policy.   If there is no deductible value should be 00.   If the deductible applies for Medical Losses only value is 01.
If the deductible applies to Indemnity losses only, then the value is 02.   If the Deductible applies proportionately to the medical and indemnity portions of the loss then the value is 03.   
","ETL - D_Stat_Work_Comp_Premiums
ETL - D_Stat_Work_Comp_Losses",,7/14/2014,lkummer,,,,,,,,,,
BR-23249,"375 Dividend Plan	","TBD
map to EDW 
currently GAI is not writing this business, but per Paul M they might in the future
additional work will be needed at that time.   
Default for now.  ",ETL - D_Stat_Work_Comp_Premiums,,7/15/2014,lkummer,,,,,,,,,,
BR-23252,376 Transaction Type Code," ISO field to describe the level of statistical coding for the premium or loss record.  A value of 1 indicates full coding and 2 is limited coding.  The fields that need to be defined for limited coding are at the following link:
https://www.silverplume.com/sponline/SPSage.aspx?cmd=doc&id=601448
","ETL - D_Stat_Liability_Premiums
ETL - D_Stat_Liability_Losses
ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Inland_Marine_Losses
ETL - D_Stat_Property_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses
ETL - D_Stat_Crm_Fdlty_Srty_Premiums
ETL - D_Stat_Crm_Fdlty_Srty_Losses",,6/25/2014,lkummer,,,,Dimension,,,,,,
BR-23503,"377 Stated_amt_code	","Liability and PIP will use the data field STATED_AMT_CODE instead of Value_Rating_Unit and if COST_NEW_AMT > 0, STATED_AMT_CODE = blank.  
IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'StatedAmountIdentifier'' AND EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
THEN Set STATED_AMT_CODE = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE
Else
If STATED_VALUE_AMT > 0 then STATED_AMT_CODE = ‘S’.
","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,10/31/2018,ragarwal,,,,,,,,,,
BR-23253,378 Exposure Coverage Code,"Exposure Coverage Act Code 
governing law
BR TBD based on the following values:
Code	Type of Exposure Coverage
00	For Use With Statistical Codes Only
01	State Act or Federal Act Excluding USL&HW and Federal Coal Mine Health and Safety Act
02	USL&HW F-Classes or USL&HW Coverage on Non-F-Classes:
03	Coverage Under the Federal Coal Mine Health and Safety Act Only
04	Coverage Under the Federal Coal Mine Health and Safety Act and the State Act
05	Oil and Other minerals Over Water.  N/A in CA, DE, MA, MI, MN, NC, NJ, NY, PA, WI
06	Coverage Under State Act Excluding Medical Coverage
07	Excess Benefits Coverage: Applies in Maryland, Virginia, and West Virginia only, as follows:
08	Reserved for Future Use
09	Endorsed Maritime Coverage
10	Voluntary Compensation Coverage
",ETL - D_Stat_Work_Comp_Premiums,,7/15/2014,lkummer,,,,Dimension,,,,,,
BR-23255,379 Rate Amount,"The Manual Base Rate
Use d_cvrg_rate.base_rate_amt
","ETL - D_Stat_Work_Comp_Premiums
",,7/14/2014,lkummer,The source for this field should flow from code currently in place to populate d_cvrg_rate table from EDW,,,,,,,,,
BR-23439,380 Retro Plan Code,,,,12/30/2016,mmconley,sconley 12/30/16: Reformatted and made sub-rules.,,,,,,,,,
BR-23256,380.1 UWC Retro Plan Code - Premiums,"TBD based on the following values:
L = Retro Rated, Large Risk Alternative Rating Applicable
R = Retro Rated, Not Large Risk Alternative Rating Applicable
N = Not Retro Rated",ETL - D_Stat_Work_Comp_Premiums,,12/30/2016,mmconley,"EDW will have to model this
There is not a field for this currently

sconley 12/30/16: Reformatted and made sub-rules.",,,,,,,,,
BR-23440,380.2 UWC Retro Plan Code - Losses,Move 'N' to RETRO_PLAN_CODE,ETL - D_Stat_Work_Comp_Losses,,12/30/2016,mmconley,"sconley 12/30/16: Reformatted and made sub-rules.
Per Lori's notes, the front-end will review at a later time.",,,,,,,,,
BR-23496,381 PREM_INCOME_CATEGORY_30_CODE,"Select FDW_CODE
From LK_FDW_TO_EDW_REF
Where FDW_REF_DESC = ‘PREM_INCOME_CATEGORY_30_CODE’ 
and EDW_ITEM_CD = VW_PRC_RATING_NON_PREM.CHARGE_CATG_CD 

If NOT NULL
Then PREM_INCOME_CATEGORY_30_CODE = FDW_CODE
Else PREM_INCOME_CATEGORY_30_CODE = ‘I’","ETL - F_DIVISIONAL_PREMIUMS
ETL - F_DETAIL_PREMIUMS",,1/19/2018,mmconley,"sconley 1/19/18: Added to DOORs.  PREM_INCOME_CATEGORY_30_CODE is used to select the row from D_PREMIUM_CATEGORY.
For Tax and Surcharges, VW_PRC_RATING_NON_PREM.CHARGE_CATG_CD will equal 'T' or 'S'.  When not a T&S, we should not get a hit and set PREM_INCOME_CATEGORY_30_CODE to 'I'. ",,,,,,,,,
BR-23333,382 SIC Desc,Move NULL to SIC_DESC,"ETL - D_Stat_Inland_Marine_Premiums
ETL - D_Stat_Liability_Premiums",,7/13/2017,mmconley,"SIC_DESC is not in the UIM stat area but it exists on d_stat_inland_marine_premiums. The field is NULL for UIM.
SIC_DESC is not in the UGL stat area but it exists on d_stat_liability_premiums.  The field is NULL for all stat_format_codes.

Th original intent was to populate the field by selecting sic_desc from lk_pv_5_6_naics_cd_xref using the first 4 digits of the sic_code. It was later decided that a user should retrieve the description as needed for reporting from lk_pv_5_6_naics_cd_xref.  Since the column was added to the tables, it was decided not to delete it.   ",,,,,,,,,
BR-23355,"383  Custom Tables	","Great American Custom (GAC) project switched to a Direct Feed to EDW, for PREMIUMS ONLY, instead of obtaining data from CSV files.  A spreadsheet was created of all the CUSTOM FDW tables showing the original input to the Custom table, core FDW table name, Custom FDW table name, some fields that are central to the Custom process and are not carried (for the most part) in the FDW Core tables, whether the process or table was impacted by the project as well as the Custom Defect that was created for the table.  				","ETL - D_CUSTOM_PAC_CODE
ETL - D_POLICY
ETL - D_POLICY_CUSTOM
ETL - D_POLICY_SUPPORT
ETL - F_DETAIL_PREMIUMS_ASSCN
ETL - F_DETAIL_PREMIUMS
ETL - F_DIVISIONAL_PREMIUMS",Custom Defect 190,1/8/2016,dburns4,"The spreadsheet is attached to the Custom Defect 190 as the attachment called ""Custom Table List_UPDATED_01_05_16.xlsx"". 

For the GAC project, changes were also made to existing business rules not related to the Custom tables and these changes and defects are documents under the appropriate business rule.",,,,,,,,,
BR-23410,384 POLICY CONVERSION,"There are two pieces to the policy conversion process that was used for two conversions - one was ELD and the other was for Speciality E & S.  The first piece consisted of a ""driver"" process that consisted of a specific identifier for the policies that then drove the system to go to the conversion logic.  The second piece consisted of a table that was then built of policy information based on getting certain fields from data that was currently in FDW.  The goal was to have all the policy information needed to build Premium Fact Core.

The policy conversion driver:
This logic was used to identify the policy as one that should go through conversion logic.  The policy version code field was populated by the conversion team with a unique value.  In the case of the conversion from PRO for ELD and Specialty E & S, the policy version code field was populated with “Z%” where % stood for the zone in PRO.  Following is the actual logic:

SUBSTR (premium_fact_core.pol_version_cd,1,1) = 'Z'
   AND premium_fact_core.pol_symbol_cd <> 'AMP'

The policy conversion table:
If the driver condition was met, the next step would be to build a table that contains the converting policy information.  This table called “A_POL_CONV” (which would contain all the policy attributes) was then used to update Premium Fact Core.  Using the policy number provided by the conversion team, the field on the policy conversion table would be populated based on getting existing data from various FDW tables.  The following fields were on the policy conversion table:

Policy Number   (POLICY_NUMBER)
Policy Effective Date   (POLICY_EFFECTIVE_DATE)
Policy Version Code   (POLICY_VERSION_CD)
Policy Module   (POLICY_MODULE)
Policy Symbol   (POLICY_SYMBOL)
Producer Code   (PRODUCER_B_CODE)
Company Code   (COMPANY_CODE)
Class Code  (if this is NULL populate as '0')  (CLASS_CODE)
State Code  (which is the risk state) (FIPS_US_ALPHA_CODE)
Minor Line Code   (MINOR_LINE_CODE)
Product Detail ID   (PRODUCT_DETAIL_ID)
Product Value 1_8 ID   (PRODUCT_VALUE_1_8_ID)
Product Value ID   (PRODUCT_VALUE_ID)
CREATION_DATE
LAST_UPDATE_DATE.

From D_POLICY comes (where policy number and policy id on D_POLICY and F_DIVISIONAL_PREMIUMS match ):
Policy Number
Policy Effective Date
Policy Version Code
Policy Module
Policy Symbol
Producer Code.

From D_COMPANY comes (where company id on D_COMPANY and F_DIVISIONAL_PREMIUMS match):
Company Code

From D_STAT_DATA_PREMIUMS comes (where stat data id’s match on D_STAT_DATA_PREMIUMS and F_DIVISIONAL_PREMIUMS):
Class Code

From D_GEOGRAPHY comes (where geography id from D_GEOGRAPHY matches risk state id from F_DIVISIONAL_PREMIUMS):
State Code (fips_us_alpha_code)

From D_PRODUCT_DETAIL comes (where product detail id on D_PRODUCT_DETAIL and F_DIVISIONAL_PREMIUMS match):
Minor Line Code

From F_DIVISIONAL_PREMIUMS comes:
Product Detail ID
Product Value 1_8 ID
Product Value ID.

Additional conditions were:
-	Written Premium
-	Direct, Assumed
-	Not from system id  = 48.


It is important to build correct policy information because if there is also a claim conversion involved, the claim inherits many of the policy attributes as F_DIVISIONAL_LOSSES is being built.

Following is the actual logic for  POL CONV table:

SELECT policy_number
      ,policy_effective_date
      ,policy_version_cd
      ,policy_module
      ,policy_symbol
      ,producer_b_code
      ,company_code
      ,CASE
          WHEN class_code IS NULL
          THEN
             '0'
          ELSE
             class_code
       END
          class_code
      ,fips_us_alpha_code
      ,minor_line_code
      ,product_detail_id
      ,product_value_1_8_id
      ,product_value_id
  FROM (SELECT p.policy_number
              ,p.policy_effective_date
              ,p.policy_version_cd
              ,p.policy_module
              ,p.policy_symbol
              ,p.producer_b_code
              ,c.company_code
              ,sd.class_code
              ,g.fips_us_alpha_code
              ,pd.minor_line_code
              ,f.product_detail_id
              ,f.product_value_1_8_id
              ,f.product_value_id
              ,ROW_NUMBER ()
               OVER (
                  PARTITION BY p.policy_number
                              ,p.policy_effective_date
                              ,p.policy_version_cd
                              ,p.policy_module
                              ,p.policy_symbol
                              ,p.producer_b_code
                              ,c.company_code
                              ,sd.class_code
                              ,g.fips_us_alpha_code
                              ,pd.minor_line_code
                  ORDER BY f.creation_date DESC)
                  rn
          FROM fdw.f_divisional_premiums f
              ,fdw.d_policy p
              ,fdw.d_geography g
              ,fdw.d_stat_data_premiums sd
              ,fdw.d_transaction_items t
              ,fdw.d_company c
              ,fdw.d_producer_profit_center pc
              ,fdw.d_product_detail pd
              ,fdw.a_policy_conv_driver
         WHERE f.policy_id = p.policy_id
           AND f.stat_data_id = sd.stat_data_id
           AND f.risk_state_id = g.geography_id
           AND f.written_transaction_id = t.transaction_items_id
           AND f.company_id = c.company_id
           AND f.product_detail_id = pd.product_detail_id
           AND f.a_producer_profit_center_id = pc.producer_profit_center_id
           AND t.amount_category_2_desc = 'Written'
           --AND t.rein_transaction_type_desc = 'Direct'
           AND t.rein_type_reporting_category_1 in ('Direct','Assumed')
           AND pd.package_code NOT IN ('22', '23', '24')
           AND f.source_system_id <> '48'
           AND a_policy_conv_driver.policy_number = p.policy_number
           AND a_policy_conv_driver.pol_term_eff_dt = p.policy_effective_date)
WHERE rn = 1
",,This information was provided by Rick Herbig and don't have a defect number.,5/13/2016,dburns4,5/13/16 - Adding to DOORS since not documented elsewhere.,,,,,,,,,
BR-23411,385 CLAIM CONVERSION,"There was a specific driver for the claim conversion process that then drove the system to go to the conversion logic.  A table was then built of claim information based on getting certain fields from data that was currently in FDW.  The goal was to have all the claim information needed to build Loss Fact Core.

The claim conversion driver:
This logic was used to identify the claim as one that should go through conversion logic.  The logic is:

LOSS_FACT_CORE.PREVIOUSLY_CONVERTED_IND=1


The claim conversion table:
If the driver condition was met, the next step would be to build a table that contains the converting claim information.  This table called “A_CLAIM_CONV” (which would contain all the claim attributes) was then used to update Loss Fact Core.  Using the claim number provided by the conversion team, the field on the claim conversion table would be populated based on getting existing data from various FDW tables.  The following fields were on the claim conversion table:

CLAIM_NUMBER
REIN_TYPE_REPORTING_CATEGORY_1
POLICY_NUMBER
POLICY_EFFECTIVE_DATE
COMPANY_CODE
CLASS_CODE
FIPS_US_ALPHA_CODE
POLICY_VERSION_CD
POLICY_MODULE
POLICY_SYMBOL
PRODUCER_B_CODE
MINOR_LINE_CODE
PRODUCT_DETAIL_ID
PRODUCT_VALUE_1_8_ID
PRODUCT_VALUE_ID
STAT_FORMAT_CODE
STAT_DATA_ID
STAT_FORMAT_ID

From D_CLAIM comes (where claim id on D_CLAIM and F_DIVISIONAL_LOSSES match):
Claim Number.

From D_TRANSACTION_ITEMS (where transaction items id on D_TRANSACTION_ITEMS and F_DIVISIONAL_LOSSES paid_transaction_id match):
REIN_TYPE_REPORTING_CATEGORY_1.

From D_POLICY comes (where policy id on D_POLICY and F_DIVISIONAL_LOSSES match ):
Policy Number
Policy Effective Date
Policy Version Code
Policy Module
Policy Symbol
Producer Code.

From D_COMPANY comes (where company id on D_COMPANY and F_DIVISIONAL_LOSSES match):
Company Code

From D_STAT_DATA_LOSSES comes (where stat data id’s match on D_STAT_DATA_LOSSES and F_DIVISIONAL_LOSSES):
Class Code

From D_GEOGRAPHY comes (where geography id from D_GEOGRAPHY matches risk state id from F_DIVISIONAL_LOSSES):
State Code (fips_us_alpha_code)

From F_DIVISIONAL_LOSSES comes:
Product Detail ID
Product Value 1_8 ID
Product Value ID.

Additional conditions were:
-	Transaction Accounting Year
-	Direct, Assumed.

Following is the actual logic for  CLAIM CONV table:


SELECT policy_number
         ,claim_number
         ,stat_format_code
         ,rein_type_reporting_category_1
         ,policy_effective_date
         ,policy_version_cd
         ,policy_module
         ,policy_symbol
         ,producer_b_code
         ,company_code
         ,CASE
             WHEN class_code IS NULL
             THEN
                '0'
             ELSE
                class_code
          END
             class_code
         ,fips_us_alpha_code
         ,product_detail_id
         ,product_value_1_8_id
         ,product_value_id
         ,stat_data_id
         ,stat_format_id
     FROM (SELECT p.policy_number
                 ,sf.stat_format_code
                 ,d.claim_number
                 ,t.rein_type_reporting_category_1
                 ,p.policy_effective_date
                 ,p.policy_version_cd
                 ,p.policy_module
                 ,p.policy_symbol
                 ,p.producer_b_code
                 ,c.company_code
                 ,sd.class_code
                 ,g.fips_us_alpha_code
                 ,f.product_detail_id
                 ,f.product_value_1_8_id
                 ,f.product_value_id
                 ,sd.stat_data_id
                 ,sf.stat_format_id
                 ,ROW_NUMBER ()
                  OVER (
                     PARTITION BY p.policy_number
                                ,sf.stat_format_code
                                 ,d.claim_number
                                 ,t.rein_type_reporting_category_1
                                 ,p.policy_effective_date
                                 ,p.policy_version_cd
                                 ,p.policy_module
                                 ,p.policy_symbol
                                 ,p.producer_b_code
                                 ,c.company_code
                                 ,sd.class_code
                                 ,g.fips_us_alpha_code
                     ORDER BY f.creation_date DESC)
                     rn
             FROM fdw.f_divisional_losses f
                 ,fdw.d_policy p
                 ,fdw.d_geography g
                 ,fdw.d_stat_data_losses sd
                 ,fdw.d_transaction_items t
                 ,fdw.d_company c
                 ,fdw.d_producer_profit_center pc
                 ,fdw.d_product_detail pd
                 ,fdw.d_stat_format_losses sf
                 ,fdw.d_claim d
                 ,fdw.a_claim_conv_driver
            WHERE f.policy_id = p.policy_id
              AND f.stat_data_id = sd.stat_data_id
              AND f.risk_state_id = g.geography_id
              AND f.paid_transaction_id = t.transaction_items_id
              AND f.company_id = c.company_id
              AND f.product_detail_id = pd.product_detail_id
              AND f.a_producer_profit_center_id = pc.producer_profit_center_id
             AND sf.stat_format_id = f.stat_format_id
              AND d.claim_id = f.claim_id
              AND f.transaction_accounting_year >= 2005
              AND a_claim_conv_driver.claim_number = d.claim_number
              --AND t.rein_type_reporting_category_1 = 'Direct'
              AND t.rein_type_reporting_category_1 in ('Direct','Assumed') 
     )
    WHERE rn = 1




",,Information provided by Rick Herbig.  Do not have a defect number.,5/13/2016,dburns4,5/13/16 - Adding to DOORS since not documented elsewhere.,,,,,,,,,
BR-23412,386 WESTPORT POLICY CONVERSION,"For the Westport conversion, Corporate Claims determined that they wanted to have specific values for certain fields.  The fields were policy symbol = SDS, producer code = 311085, profit center = 3070.  The Westport policy data in D_POLICY at the time of conversion was not always complete since it was such old information.  Because of the requirement to use specific values for certain fields as well as the policy data not always being complete, trying to do a lookup on existing FDW tables was not possible since not all the data fields are the same.  This meant we could not use the policy conversion process described above under the section ""POLICY CONVERSION"".  A new lookup table was created that contained the fields needed to build PREMIUM FACT CORE.  This new lookup table was used rather than using the A_POL_CONV driver and A_POL_CONV table logic discussed above.  For Westport, the new lookup table was called A_POL_CONV_WESTPORT and contains:

Policy Number
Policy Effective Date
Policy Version Code (0)
Policy Module (00 if no value found in D_POLICY)
Policy Symbol (SDS)
Producer Code  (311085)
Company Code
Class Code  (provided by PDC)
State Code  (which is the risk state)
Product Detail ID
Product Value 1_8 ID
Product Value ID
Minor Line Code  (0)
CREATION_DATE
LAST_UPDATE_DATE.

A lookup table called LK_CLAIM_WESTPORT.xls was created initially to load the A_POL_CONV_WESTPORT table and can be found attached to Defect 8892.

The Westport policy conversion driver logic:
If previously converted indicator = '1'
  and source busines unit = 'Personal Lines Division'
     use the A_POL_CONV_WESTPORT table to get the policy information needed to build Premium Fact Core.

In order to be able to add Westport policy data later, it was decided that A_POL_CONV_WESTPORT would contain a ""default"" row and values were agreed upon with PDC and rest of team.  For the default row:

Policy Number = ANY
Policy Effective Date = 1/1/1901
Policy Version Code = AN
Policy Module = AN
Policy Symbol = SDS
Producer Code = 311085
Company Code = AN
Class Code = ANY
State Code  (which is the risk state) = ANY
Product Detail ID = 4352
Product Value 1_8 ID = 37070
Product Value ID = 23
Minor Line Code = 0.


",,Defect 8892,5/13/2016,dburns4,"5/13/16 - Adding information on the Westport Policy Conversion which was done in October 2015 as only documented in the actual Defect 8892.  The Westport Policy conversion was similar in some aspects to the information documented above under ""Policy Conversion"" but Corporate Claims had specific ""standard"" values they wanted to use for certain fields so these fields would not match what was actually in the FDW system on the policy originally.  This policy data was brought in to EDW using the GOLDE bulk upload process so that the policy data would be in EDW.   Then PSAR could access the policy information in EDW so that claims could be entered via Claim Center.

5/13/16 - I have asked Kevin for a copy of the actual conversion logic so that I can add more information.",,,,,,,,,
BR-23413,387 Suit Accounting Date,"EDW has the following logic that sets it. 
iif (SUIT_INDICATOR=1, to_char (TRANS_EFF_DT, 'yyyymm' ),NULL) 

FDW uses input SUIT-ACCOUNTING-DATE",ETL - D_Claim,,7/11/2016,jjordan,,,,,,,,,,
BR-23460,388 D_POLICY_DAILY,The view to load D_POLICY_DAILY on FDW is found on EDW in FDW schema VW_D_POLICY_DAILY,ETL - D_Policy_Daily,,4/13/2017,mmconley,4/13/17 sconley: Added information to DOORs,,,,,,,,,
BR-23466,389 Push Down BLDG Attributes (ISO Property & DIC),"Background
For ISO Property and DIC, the physical building attributes (fields) are on risk BLDG.
PERSPROP, TIMELEMENT, and IMPROVMNTS are children of BLDG and the physical building attributes are not populated for those risks.
New Requirement
PDC needs data from the BDLG risk to set stat fields CONTRUCTION_TYPE, YEAR_BUILT, and BUILDING_GRADE_CODE for PERSPROP, TIMELEMENT, and IMPROVMNTS in d_stat_property_premiums and d_stat_property_losses, which are sourced from the UPR stat area.  
The exception is that if EQ coverage (subline 930) exists for PERSPROP, TIMELEMENT, and IMPROVMNTS, then we need to use the STRUCT_EARTHQUAKE_MDM_CD that is populated those risks.
Business Rules for Premiums and Losses (These will be incorporated into current rules):
Determine parent BLDG risk of PERSPROP, TIMELEMENT, and IMPROVMNTS risks.
Select for BLDG parent risk from VW_RISK_STRUCTURE (EDW)
  STRUCTURE_CONSTRUC_CD
  BCEG_CD
  STRUCTURE_BUILT_YR
  STRUCTURE_EARTHQUAKE_MDM_CD 
  STORIES_CNT
  STRUCT_GROUP2_MDM_CD
  
Store these fields in LKP_PFC_RISK_STRUCTURE and LKP_PFC_RISK_STRUCTURE_STG1 for the PRC_RATING_ID.  The data for this rule is identified by LKP_PFC_RISK_STRUCTURE_STG1.MY_RULE = 3. (At this time, only the above fields in these LKP tables are populated and used to set stat area fields for these risks.  If all fields are populated in the future PDC is ok with this because the reporting will only pull the data needed.)

Use these fields for setting the UPR stat area fields for the child risks PERSPROP, TIMELEMENT, and IMPROVMNTS following the existing rules but adding CONTRUCTION_TYPE additional rule for earthquake:
CONSTRUCTION_TYPE  (see DOORs rules BR-23348 271.1 and BR-22592 271.2 for detailed rules)
    When SUBLINE_CD = ‘930’ (earthquake) use STRUCT_EARTHQUAKE_MDM_CD
    Else use STRUCTURE_CONSTRUC_CD
BLDG_GRADE_CODE
YEAR_BUILT
","ETL - D_Stat_Format_Premiums
ETL - D_Stat_Format_Losses
ETL - D_Stat_Property_Premiums
ETL - D_Stat_Property_Losses","sconley: ENTERPRISE.Data_Platform Defect 1981 Get BLDG Attributes for PERSPROP, TIMELEMENT, IMPROVMNTS; Update UPR CONSTRUCTION_TYPE; DP-9775, US15622",7/26/2017,mmconley,sconley 7/10/17: Added rule to DOORs and linked to stat area fields.,,,,,,,,,
BR-23499,"390 Rate_amount	","Coverage Code	Rate or Factor?	Rate Basis	Class Code(s)	Rate_Amount populated for legacy?	Source Column for Rate_Amount	Multiplier for Rate_Amount	Comments
ADMIRALTY	RATE	Payroll			Final_Rate_Pcnt	1000	
ARAPFACTOR	FACTOR		0277	Yes	Rate_Modification_Factor	1000	
ATOMENERGY	RATE	Payroll			Final_Rate_Pcnt	1000	
AUDNONCMPL	FACTOR		9757	Yes	Rate_Modification_Factor	1000	
BMPADMLTY	N/A		9849	N/A	N/A	N/A	
BMPDELBINT	N/A		9681, 9682, 9683	No	N/A	N/A	
BMPFELA	N/A		9849	N/A	N/A	N/A	
BMPINCLIM	N/A		9848	Yes	N/A	N/A	
BMPSTOPGAP	N/A		9823, 9827, 9832	No	N/A	N/A	
BMPWAIVSUB	N/A		0930, 9118	No	N/A	N/A	
BMPWRKCMP	N/A		0990	No	N/A	N/A	
CATSTROPHE	RATE	Payroll	9741	Yes	Final_Rate_Pcnt	1000	
CCPAP	FACTOR		9046	Yes	Rate_Modification_Factor	1000	
CERTRISKMG	FACTOR		9883	N/A	Rate_Modification_Factor	1000	Class code not found in PRO
COALDIS	RATE	Payroll	0164	Yes	Final_Rate_Pcnt	1000	
COINSCRD	FACTOR				Rate_Modification_Factor	1000	
DMP	FACTOR		9874	Yes	Rate_Modification_Factor	1000	
DRUGFREE	FACTOR		9841, 9846	Yes	Drug_Free_Workplace_Factor	1000	
DRUGSAFE	FACTOR		9753	N/A	Rate_Modification_Factor	1000	Class code not found in PRO
ELDELIBINT	FACTOR		9681, 9682, 9683	Yes	Increased_Limit_Factor	(value - 1)*1000	
ELINCADM	FACTOR		9817 - 9822, 9840	N/A	Increased_Limit_Factor	(value - 1)*1000	Class codes not found in PRO
ELINCFELA	FACTOR		9817 - 9822, 9840	N/A	Increased_Limit_Factor	(value - 1)*1000	Class codes not found in PRO
ELINCRLIM	FACTOR		Various	Yes	Increased_Limit_Factor	(value - 1)*1000	OnCore multiplies by 10000, PRO by 1000
EMPPDDED	N/A		5711, 5712, 5803	No	N/A	N/A	Deductible and coinsurance amounts are attached to this coverage
EXPCONSTNT	RATE	Flat Charge	0900	No	N/A	N/A	
EXPMOD	FACTOR		9898	Yes	Loss_Experience_Modifier	1000	
FELA	RATE	Payroll		Yes	Final_Rate_Pcnt	1000	
FINCHRG					N/A	N/A	
FLEXRATE	FACTOR		9658		Rate_Modification_Factor	1000	Class code not found in PRO
FRA	FACTOR		0994, 0998	Yes	Rate_Modification_Factor	1000	PRO uses the rate for Rate_Amount, but it can be a debit or credit, so we should treat it as a factor instead
INTDEDCRD	FACTOR		9664	N/A	Rate_Modification_Factor	(1 - value)*1000	Class code not found in PRO
LGDEDCRD	FACTOR		9663, 9664, etc.	Rarely	Rate_Modification_Factor	(1 - value)*1000	
LOSSCONST	N/A		0032	No	N/A	N/A	
LOSSMNGMT	FACTOR		9880	Yes	Rate_Modification_Factor	1000	
LRARO	FACTOR		5937, 5938	Yes	Rate_Modification_Factor	1000	
MERITRATE	FACTOR		9884, 9885, 9886	Yes	Rate_Modification_Factor	1000	
MNGDCARE	FACTOR		9874	Yes	Rate_Modification_Factor	1000	
PREMDISC	FACTOR		0063, 0100	Yes	Rate_Modification_Factor	(1 - value)*1000	
PREVINJ	FACTOR				Rate_Modification_Factor	1000	
RATEDEV	FACTOR		9034 - 9039	N/A	Rate_Modification_Factor	1000	Class codes not found in PRO
REPATRIATE	RATE	Flat Charge	9606	Yes	N/A	N/A	Rate_Amount always 0001000 in PRO
RETROADJFE	RATE	Flat Charge	0045	Rarely	N/A	N/A	
RETROSPRED	RATE	Flat Charge	0045	Rarely	N/A	N/A	
RETURNSAFE	FACTOR		9743	Yes	Rate_Modification_Factor	1000	
SAFEINCENT	FACTOR		9748	Yes	Rate_Modification_Factor	1000	
SAFEPATHND	FACTOR		9651	N/A	Rate_Modification_Factor	1000	Class code not found in PRO
SAFETY	FACTOR		9890	Yes	Safety_Pgm_Factor	1000	
SCHEDMOD	FACTOR		9887, 9889	Yes	Schedule_Modifier	1000	
SERVICEFEE	RATE	Flat Charge			N/A	N/A	
SHORTRATE	FACTOR		0931, 9776	Yes	Rate_Modification_Factor	1000	
SMLDEDCRD	FACTOR		9941 (9663, 9664, 9657)	Yes	Rate_Modification_Factor	(1 - value)*1000	
SPLCMPFUND	FACTOR		0174	Yes	Rate_Modification_Factor	1000	
STOPGAP	RATE	Payroll	9823, 9827, 9832	Rarely	Final_Rate_Pcnt	1000	
SUPPLDIS	RATE	Payroll			Final_Rate_Pcnt	1000	
SUPTLDIS	RATE	Payroll			Final_Rate_Pcnt	1000	
TAXSURCHRG	RATE	Premium	N/A	N/A	Final_Rate_Pcnt	N/A	
TERROR	RATE	Payroll	9740	Yes	Final_Rate_Pcnt	1000	
TRANSPORT	RATE	Flat Charge			N/A	N/A	
WAIVESUBRO	FACTOR		0930, 9118, 9115	Yes	Rate_Modification_Factor	(value - 1)*10000	
WORKCOMP	RATE	Various	Various	Yes	Final_Rate_Pcnt	1000	
WORKSTUDY	RATE	Flat Charge	9428, 9447	N/A	N/A	N/A	Class codes not found in PRO
",ETL - D_Stat_Work_Comp_Premiums,,7/31/2018,lkummer,,,,,,,,,,
BR-23500,"391 Tools and Equipment Code	",Rule TBD ,ETL - D_Policy,,7/31/2018,lkummer,,,,,,,,,,
BR-23505,392 Buildings and Open Lots,"IF STAT_FORMAT_CODE='UCA'
IF EDW.PRC_RATING_EXTENSIONS.EXTENSION_NAME = 'BuildingsOpenLots' AND EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE is NOT NULL
THEN Set BLDG_OPEN_LOTS_CODE = EDW.PRC_RATING_EXTENSIONS.EXTENSION_VALUE","ETL - D_Stat_Auto_Premiums
ETL - D_Stat_Auto_Losses",,10/23/2018,ragarwal,"Single digit code that applies to the Phyical Damage Format Area for Garage Risks.
Valid Values:
1 	Buildings
2	Standard Open Lots
3 	Non Standard Open Lots
4	Miscellaneous Types - Buildings
5	Miscellaneous Types - Open Lots	
",,,,,,,,,
BR-23515,393 Master Policy Number,"Use the EDW.POL_TERM_ID and the EDW.POL_TRANS_ID for the policy. Perform a lookup  in the LKP_PFC_MASTER_POLICY table to see if it has a master policy number for the certificate.  If it has one then it is set to master policy number. Otherwise, set to NULL. .
",ETL - D_Policy,,3/27/2019,amiller6,,,,,,,,,,
